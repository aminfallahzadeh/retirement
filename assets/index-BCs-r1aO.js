import{c as R,j as e,r as c,u as q,M as I,P as v,a as f,C as D,b as F,L as P,F as N,d as S,e as z,T as y,f as j,I as b,E as A,g as L,h as B,i as E,s as m,B as k,k as $,R as H,l as M,m as K}from"./index-Bx2CJIsO.js";import{S as O}from"./SelectInput-CaBxy0Jf.js";const V=R(e.jsx("path",{d:"M14.17 5 19 9.83V19H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9.83c0-.53-.21-1.04-.59-1.41l-4.83-4.83c-.37-.38-.88-.59-1.41-.59M7 15h10v2H7zm0-4h10v2H7zm0-4h7v2H7z"}),"TextSnippetOutlined"),G=({columns:t,data:s,topBarActions:a,bottomBarActions:i,scroll:r,props:u,isLoading:d,isFetching:x})=>{const[p,h]=c.useState({}),o=q({columns:t,data:s,renderTopToolbarCustomActions:()=>a,renderBottomToolbarCustomActions:()=>i,muiLinearProgressProps:{color:"info",sx:{height:2}},muiCircularProgressProps:{color:"info"},muiTopToolbarProps:a?{sx:{overflow:"none"}}:void 0,muiTableHeadProps:a?{sx:{zIndex:0}}:void 0,muiTableBodyRowProps:({row:n})=>({onClick:()=>h(()=>({[n.id]:!0})),selected:p[n.id],sx:{cursor:"pointer"}}),localization:I,paginationDisplayMode:"pages",enableFullScreenToggle:!1,positionToolbarAlertBanner:"none",enableStickyHeader:!0,enableStickyFooter:!0,enableDensityToggle:!1,enableFilterMatchHighlighting:!1,muiTableBodyCellProps:{align:"center",sx:{fontFamily:"IranYekan",borderRight:"1px solid #cfcfcf"}},muiTableHeadCellProps:{align:"center",sx:{borderRight:"1px solid #cfcfcf",fontFamily:"Vazir",fontWeight:"600"}},initialState:{density:"compact"},enablePagination:!r,enableBottomToolbar:!r,muiTableContainerProps:r?{sx:{height:"300px"}}:void 0,muiPaginationProps:r?void 0:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:n=>e.jsx(v,{...n,page:f(n.page),slots:{previous:D,next:F,first:P,last:N}})},getRowId:n=>n.id,onRowSelectionChange:h,state:{rowSelection:p,isLoading:d,showProgressBars:x},...u});return e.jsx(S,{table:o})},w=({role:t})=>[{accessorKey:"requestRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:s})=>e.jsx("div",{children:f(s)})},{accessorKey:"requestNO",header:"شماره درخواست",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:f(s)})},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"درخواست کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:z(s)})},{accessorKey:"senderInfo",header:"بررسی درخواست",enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(y,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s.original.requestTypeNameFa})," ",e.jsx("br",{}),e.jsx("span",{children:s.original.personName})]}),children:e.jsx(j,{to:s.original.requestTypeID==="62A54585-F331-434A-9027-C9F3060F683A"?`/retirement/group-slips?requestID=${s.original.id}`:s.original.requestTypeID==="EC1E7E50-9815-442F-9CCB-27F47AB05199"?`/retirement/group-slips?requestID=${s.original.id}&personID=${s.original.personID}`:s.original.requestTypeID==="6E7BA26E-A1DC-4A5E-9700-17820A36158D"?`/retirement/batch-statements?requestID=${s.original.id}`:`/retirement/retired?personID=${s.original.personID}&Role=${t==null?void 0:t.value}&requestID=${s.original.id}`,children:e.jsx("span",{children:e.jsx(b,{color:"success",sx:{padding:"0"},children:e.jsx(V,{color:"success"})})})})})},{accessorKey:"observe",header:"مشاهده درخواست",enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(y,{title:f(s.original.requestNO),children:e.jsx(j,{to:`/retirement/request?requestID=${s.id}&Role=${t==null?void 0:t.value}&type=${s.original.requestTypeID}`,children:e.jsx("span",{children:e.jsx(b,{sx:{padding:"0"},color:"info",children:e.jsx(A,{color:"info"})})})})})}],Q=(t,s,a)=>t.map(i=>({value:i[s],label:i[a]})),_=()=>{const[t,s]=c.useState([]),a=L(),{control:i,setValue:r}=B({}),[u,{isLoading:d,isFetching:x}]=E(),p=c.useCallback(async()=>{const o=await u().unwrap(),n=Q(o==null?void 0:o.itemList,"url","itemName");s(n),a(m(n[0])),r("role",n[0])},[a,u,r]);c.useEffect(()=>{p()},[p]),c.useEffect(()=>()=>{a(m(null))},[a]);const h=o=>{a(o?m(o):m(null))};return e.jsx("div",{style:{width:"300px",height:"40px",margin:"10px auto"},children:e.jsx(O,{control:i,options:t,isLoading:d||x,onValueChange:h,name:"role",label:"نقش",required:!1})})},W=({isLoading:t,isFetching:s,handleRefresh:a})=>e.jsxs(k,{sx:{display:"flex",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[t||s?e.jsx(b,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx($,{size:20,value:100})}):e.jsx(y,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(b,{"aria-label":"refresh",color:"info",onClick:a,children:e.jsx(H,{fontSize:"small"})})})}),e.jsx(_,{})]}),Y=()=>{const[t,s]=c.useState([]),{role:a}=M(n=>n.role),[i,{isLoading:r,isFetching:u}]=K(),d=c.useCallback(async n=>{try{const g=await i({Role:n}).unwrap(),T=g==null?void 0:g.itemList.map((l,C)=>({id:l.requestID,requestRowNum:C+1,requestNO:l.requestNO||"-",requestTypeID:l.requestTypeID,personID:l.personID,requestTypeNameFa:l.requestTypeNameFa,personName:l.personFirstName+" "+l.personLastName||"-",date:l.requestDate,body:l.requestText}));s(T)}catch(g){console.log(g)}},[i]);c.useEffect(()=>{a?d(a==null?void 0:a.value):s([])},[a,d]);const p=W({isLoading:r,isFetching:u,handleRefresh:()=>{a&&d(a==null?void 0:a.value)}}),h=w({role:a});return e.jsx(G,{columns:h,data:t,topBarActions:p,scroll:!1,isLoading:r,isFetching:u})};function X(){return e.jsxs("section",{className:"flex-col",children:[e.jsx("div",{className:"title-primary--container flex-row flex-center",children:e.jsxs("h4",{className:"title-primary",children:[e.jsx("span",{className:"title-primary--underline"}),"کارتابل"]})}),e.jsx(Y,{})]})}export{X as Cartable};
