import{r,bN as C,y as I,j as s,bo as o,bO as N,T as f,L as P,I as l,h as S,b8 as v,bb as D,B as z,C as L,bn as F,bp as O,bq as k,br as w,bs as B}from"./index-DF4pKFh6.js";import{g as E}from"./requestApi-lBVSXTjA.js";import{S as K}from"./index-DIPzbFa-.js";/* empty css                 */import{d as A}from"./table-options-DAFCvKg_.js";import{R as M}from"./Refresh-DKFM6g1E.js";function W(){const[c,d]=r.useState({}),[m,b]=r.useState([]),g=C(),u=new URLSearchParams(g.search),n=u.get("Role"),x=u.get("personID"),{data:p,isSuccess:h,isLoading:R,isFetching:j,error:t,refetch:i}=E({Role:n,personID:x});r.useEffect(()=>{if(i(),h){const e=p.itemList.map(a=>({id:a.requestID,type:a.requestTypeID,requestNO:a.requestNO||"-",personId:a.personID,requestTypeNameFa:a.requestTypeNameFa||"-",personName:a.personName||"-",date:a.requestDate||"-",body:a.requestText||"-"}));b(e),sessionStorage.setItem("requests",JSON.stringify(e))}},[p,h,i]),r.useEffect(()=>{var e;t&&I.error(((e=t==null?void 0:t.data)==null?void 0:e.message)||t.error,{autoClose:2e3})},[t]);const q=()=>{i()},y=r.useMemo(()=>[{accessorKey:"id",header:"شماره درخواست",size:20,Cell:({renderedCellValue:e})=>s.jsx("div",{children:o(e)})},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"ارسال کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:e})=>s.jsx("div",{children:o(N(e))})},{accessorKey:"observeReq",header:"مشاهده درخواست",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:e})=>s.jsx(f,{title:o(e.original.requestNO),children:s.jsx(P,{to:`/retirement/request?requestID=${e.id}&Role=${n}&type=${e.original.type}`,children:s.jsx(l,{color:"primary",sx:{padding:"0"},children:s.jsx(S,{})})})})}],[n]),T=v({...A,columns:y,data:m,muiTableBodyRowProps:({row:e})=>({onClick:()=>d(()=>({[e.id]:!0})),selected:c[e.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>s.jsx(z,{children:j?s.jsx(l,{"aria-label":"refresh",color:"info",disabled:!0,children:s.jsx(L,{size:20,value:100})}):s.jsx(f,{title:"بروز رسانی",children:s.jsx("span",{children:s.jsx(l,{"aria-label":"refresh",color:"info",onClick:q,children:s.jsx(M,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:e=>s.jsx(F,{...e,page:o(e.page),slots:{previous:O,next:k,first:w,last:B}})},getRowId:e=>e.id,onRowSelectionChange:d,state:{rowSelection:c}});return s.jsx(s.Fragment,{children:R?s.jsx("div",{className:"skeleton-lg",children:s.jsx(K,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):s.jsx(D,{table:T})})}export{W as default};
