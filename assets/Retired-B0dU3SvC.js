import{z as te,r,j as e,A as Ue,x as Oe,D as _,F as ve,T as F,L as ne,I as E,E as Fe,H as qe,B as H,C as B,P as _e,J as Me,K as ze,M as Be,N as Ge,Q as Ke,S as je,U as oe,u as os,h as ge,V as is,W as ls,X as Le,Y as I,Z as ye,_ as v,$ as Se,a0 as Ce,a1 as cs,a2 as ds,a3 as k,a4 as us,a5 as se,a6 as ps,a7 as Ne,a8 as ms,a9 as hs,aa as xs,ab as fs,ac as Is,ad as bs,ae as Ds,af as js,ag as gs,ah as ys,ai as Ss,aj as Cs,ak as Ns,al as Rs,am as Ts,an as Es,ao as As,ap as Ls,aq as Ps,ar as ks,as as Us,at as Os,au as vs,av as Fs,aw as qs,ax as _s,ay as Ms,az as zs,aA as Bs,aB as Gs,aC as Ks,t as ae,aD as Re,aE as W,aF as ie,i as we,aG as ws,aH as $s,aI as Hs,aJ as Pe,aK as Vs,aL as Qs,aM as Ws,aN as Ys,aO as Js,aP as Te,aQ as Zs,aR as Xs,aS as ea,aT as sa,aU as $,aV as aa,aW as ta,aX as ra,aY as na,aZ as oa,a_ as ia,a$ as la,b0 as ca,R as $e,f as He,b1 as Ve,b2 as Qe,b3 as xe,b4 as We,b5 as Ye,b6 as Je,G as Ze,b7 as da,b8 as Xe,b9 as ua,ba as pa,bb as ma,bc as ha,bd as xa,be as ce,bf as fa,bg as Ia,bh as ba,bi as Da,bj as ja}from"./index-DXCdSF22.js";import{u as ga,a as ya,c as Sa,F as Ca}from"./createTree-BYLLbMdw.js";import{T as Na}from"./Title-CXUyA-6G.js";import{b as Ra}from"./requestApi-CYZhB6RA.js";import{S as es}from"./index--Q8AZj1D.js";/* empty css                 */import{d as ss}from"./table-options-MD7QrcYG.js";import{R as Ie}from"./Refresh-D51HVlme.js";import{u as Ta,S as Ea}from"./SlipFormTemplate-CGXpnQ0a.js";import{M as Aa}from"./Modal-DZ1i30kW.js";import{c as U,S as O}from"./SelectInput-n_FKm4Tr.js";import{p as as,D as fe,a as Ee}from"./convertFormData-BUxtWht_.js";import{C as ee}from"./CustomCheckBox-BUVPTtAw.js";import{T as ke}from"./TextArea-BHv_Ex3g.js";import{D as Ae}from"./DoneOutlined-BUCchpo2.js";import{E as le}from"./EditOutlined-WpSofIET.js";import{u as z,a as La,b as Pa}from"./useFetchLookUpData-CgT59kGn.js";import{S as ka}from"./StatusHistoryGrid-CbHUmerM.js";import{u as Ua}from"./sharedApi-D7HSSvIH.js";import{u as Oa,a as va}from"./relatedApi-CVoSP0mb.js";import{D as ts}from"./DeleteOutline-CnYtgzAi.js";import{A as rs}from"./Add-kJeSkpMy.js";import{u as Fa,a as qa}from"./heirApi-DCQsV0tN.js";import{R as _a}from"./RetiredStatementsGrid-bO7-HkBa.js";import{A as de,a as ue,b as pe,c as me}from"./ArrowDropDown-BkaB17sQ.js";import{T as Ma,a as za,b as he}from"./TabPanel-DOEcZMiq.js";import"./index-DUcA4vph.js";import"./excel-icon-Dq0N6FeV.js";import"./module-BUdup7B7.js";import"./typeof-QjJsDpFa.js";import"./react-select-animated.esm-DtxqCo1G.js";import"./defineProperty-DJACW-dl.js";import"./useCloseCalender-DJvUplAt.js";import"./fractionApi-COwViYEV.js";import"./statementApi-CK5Z6mj3.js";const Ba=()=>{const[s]=te(),[d,t]=r.useState([]),[m,R]=r.useState([]),h=s.get("personID"),{data:y,isLoading:a,isSuccess:x,refetch:p}=ga(),{data:D,isLoading:i,isSuccess:u,refetch:c}=ya(h);r.useEffect(()=>{u&&R(D.itemList)},[u,D]),r.useEffect(()=>{if(x){const C=Sa(y.itemList);t(C)}},[x,y]);const S=r.useCallback(()=>{p(),c()},[p,c]);return e.jsx(Ca,{structure:d,files:m,isLoading:a||i,refetch:S,access:"files"})};function Ga(){const[s,d]=r.useState({}),[t,m]=r.useState([]),R=Ue(),h=new URLSearchParams(R.search),y=h.get("Role"),a=h.get("personID"),{data:x,isSuccess:p,isLoading:D,isFetching:i,error:u,refetch:c}=Ra({Role:y,personID:a});r.useEffect(()=>{if(c(),p){const o=x.itemList.map(N=>({id:N.requestID,type:N.requestTypeID,requestNO:N.requestNO||"-",personId:N.personID,requestTypeNameFa:N.requestTypeNameFa||"-",personName:N.personName||"-",date:N.requestDate||"-",body:N.requestText||"-"}));m(o),sessionStorage.setItem("requests",JSON.stringify(o))}},[x,p,c]),r.useEffect(()=>{var o;u&&Oe.error(((o=u==null?void 0:u.data)==null?void 0:o.message)||u.error,{autoClose:2e3})},[u]);const S=()=>{c()},C=r.useMemo(()=>[{accessorKey:"id",header:"شماره درخواست",size:20,Cell:({renderedCellValue:o})=>e.jsx("div",{children:_(o)})},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"ارسال کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:o})=>e.jsx("div",{children:_(ve(o))})},{accessorKey:"observeReq",header:"مشاهده درخواست",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:o})=>e.jsx(F,{title:_(o.original.requestNO),children:e.jsx(ne,{to:`/retirement/request?requestID=${o.id}&Role=${y}&type=${o.original.type}`,children:e.jsx(E,{color:"primary",sx:{padding:"0"},children:e.jsx(Fe,{})})})})}],[y]),A=qe({...ss,columns:C,data:t,muiTableBodyRowProps:({row:o})=>({onClick:()=>d(()=>({[o.id]:!0})),selected:s[o.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsx(H,{children:i?e.jsx(E,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(B,{size:20,value:100})}):e.jsx(F,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(E,{"aria-label":"refresh",color:"info",onClick:S,children:e.jsx(Ie,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:o=>e.jsx(_e,{...o,page:_(o.page),slots:{previous:Me,next:ze,first:Be,last:Ge}})},getRowId:o=>o.id,onRowSelectionChange:d,state:{rowSelection:s}});return e.jsx(e.Fragment,{children:D?e.jsx("div",{className:"skeleton-lg",children:e.jsx(es,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(Ke,{table:A})})}function Ka(){const[s,d]=r.useState({}),[t,m]=r.useState([]),[R,h]=r.useState(null),[y,a]=r.useState(!1),x=Ue(),D=new URLSearchParams(x.search).get("personID"),{data:i,isLoading:u,isSuccess:c,isFetching:S,error:C,refetch:A}=Ta({personID:D,payType:"M"}),P=()=>{A()};r.useEffect(()=>{if(c){const n=i.itemList.map((L,G)=>({id:L.payID,payRowNum:G+1,payCreditAmount:L.payCreditAmount,payDebitAmount:L.payDebitAmount,payAmount:L.payAmount,payDate:L.payDate,currentYear:L.currentYear,currentMonth:L.currentMonth}));m(n)}},[c,A,i]),r.useEffect(()=>{var n;C&&Oe.error(((n=C==null?void 0:C.data)==null?void 0:n.message)||C.error,{autoClose:2e3})},[C]);const o=()=>{a(!0)},N=r.useMemo(()=>[{accessorKey:"payRowNum",header:"ردیف",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:_(n)})},{accessorKey:"payCreditAmount",header:"مبلغ بستانکاری",size:20,Cell:({renderedCellValue:n})=>e.jsxs("div",{children:[je(_(n))," ","ریال"]})},{accessorKey:"payDebitAmount",header:"مبلغ بدهکاری",size:20,Cell:({renderedCellValue:n})=>e.jsxs("div",{children:[je(_(n))," ","ریال"]})},{accessorKey:"payAmount",header:"مبلغ کل",size:20,Cell:({renderedCellValue:n})=>e.jsxs("div",{children:[je(_(n))," ","ریال"]})},{accessorKey:"payDate",header:"تاریخ پرداخت",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:ve(n)})},{accessorKey:"currentYear",header:"سال مالی",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:_(n)})},{accessorKey:"currentMonth",header:"ماه مالی",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:_(n)})},{accessorKey:"downloadRetiredSlip",header:"مشاهده/چاپ",enableSorting:!1,enableColumnActions:!1,size:20,Cell:()=>e.jsx(F,{title:"دانلود و مشاهده فیش",children:e.jsx(E,{color:"primary",sx:{padding:"0"},onClick:o,children:e.jsx(Fe,{})})})}],[]),f=qe({...ss,columns:N,data:t,renderTopToolbarCustomActions:()=>e.jsx(H,{children:S?e.jsx(E,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(B,{size:20,value:100})}):e.jsx(F,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(E,{"aria-label":"refresh",color:"info",onClick:P,children:e.jsx(Ie,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:n=>e.jsx(_e,{...n,page:_(n.page),slots:{previous:Me,next:ze,first:Be,last:Ge}})},muiTableBodyRowProps:({row:n})=>({onClick:()=>d(()=>({[n.id]:!0})),selected:s[n.id],sx:{cursor:"pointer"}}),getRowId:n=>n.id,onRowSelectionChange:d,state:{rowSelection:s}});return r.useEffect(()=>{const n=Object.keys(f.getState().rowSelection)[0];h(n||null)},[f,s]),e.jsxs(e.Fragment,{children:[y&&R&&e.jsx(Aa,{closeModal:()=>a(!1),children:e.jsx(Ea,{payID:R})},R),u?e.jsx("div",{className:"skeleton-lg",children:e.jsx(es,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(Ke,{table:f})]})}const wa=["personFirstName","personLastName","personNationalCode","personCertificateNo","personFatherName","genderID","personBirthDate","personBirthPlace","personPreviousNam","personIsSacrificedFamily","personIsWarrior","personIsChildOfSacrificed","personIsValiant","personIsSacrificed","personIsCaptive","retiredID","personPhone","personCellPhone","backupPhone","backupFirstName","backupLastName","personEmail","educationTypeID","personCountryID","personStateID","personCityID","personRegion","personArea","personPostalCode","housingTypeID","maritalStatusID","personDeathDate","personAddress","personDescription"],$a=["retiredGroup","retiredOrganizationID","retiredLastPosition","employmentTypeID","retirementDate","pensionaryStatusID","pensionaryStartdate","retiredJobDegreeCoef","retiredGrantDuration","retiredRealDuration"],Ha=["bankID","bankBranchID","accountNo","ledgerCode","insuranceCoef","insuranceAmount"],Va=()=>{const[s,d]=oe(!1),[t]=te(),m=os(),R=t.get("personID"),h=r.useMemo(()=>["genderID","personCountryID","personStateID","personCityID","housingTypeID","educationTypeID","maritalStatusID"],[]),y=r.useMemo(()=>["personDeathDate","personBirthDate"],[]),{control:a,handleSubmit:x,formState:{errors:p},setValue:D}=ge(),{data:i,isLoading:u,isFetching:c,isSuccess:S,refetch:C}=is(R),[A,{isLoading:P}]=ls(),{lookUpItems:o,lookUpItemsIsLoading:N}=z({lookUpType:"Gender"}),f=r.useMemo(()=>U(o,"lookUpID","lookUpName"),[o]),{lookUpItems:l,lookUpItemsIsLoading:n}=z({lookUpType:"EducationType"}),L=r.useMemo(()=>U(l,"lookUpID","lookUpName"),[l]),{lookUpItems:G,lookUpItemsIsLoading:Y}=z({lookUpType:"Country"}),V=r.useMemo(()=>U(G,"lookUpID","lookUpName"),[G]),{lookUpItems:Q,lookUpItemsIsLoading:J}=z({lookUpType:"State"}),K=r.useMemo(()=>U(Q,"lookUpID","lookUpName"),[Q]),{lookUpItems:re,lookUpItemsIsLoading:b}=z({lookUpType:"City"}),q=r.useMemo(()=>U(re,"lookUpID","lookUpName"),[re]),{lookUpItems:w,lookUpItemsIsLoading:be}=z({lookUpType:"HousingType"}),T=r.useMemo(()=>U(w,"lookUpID","lookUpName"),[w]),{lookUpItems:g,lookUpItemsIsLoading:j}=z({lookUpType:"MaritialStatus"}),De=r.useMemo(()=>U(g,"lookUpID","lookUpName"),[g]),ns=async Z=>{const X=Ee(Z,h,y),M=await A(X).unwrap();C(),d(),ie.success(M.message)};return r.useEffect(()=>{if(S){const Z=i==null?void 0:i.itemList[0];m(Le((Z==null?void 0:Z.personDeathDate)!==null));const X=as(Z,h,y,{genderID:f,educationTypeID:L,personCountryID:V,personStateID:K,personCityID:q,housingTypeID:T,maritalStatusID:De});Object.keys(X).forEach(M=>{wa.includes(M)&&X[M]===null?D(M,""):D(M,X[M])})}return()=>{m(Le(null))}},[m,S,i==null?void 0:i.itemList,D,f,V,L,K,q,T,De,y,h]),e.jsx(e.Fragment,{children:u||c?e.jsx(H,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(B,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:x(ns),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(I,{name:"personFirstName",label:ye,rules:v,required:!0,control:a,editable:s,type:"text"}),e.jsx(I,{name:"personLastName",label:Se,rules:v,required:!0,control:a,editable:s,type:"text"}),e.jsx(I,{name:"personNationalCode",label:Ce,rules:{...cs,...v},required:!0,control:a,editable:s,type:"text"}),e.jsx(I,{name:"personCertificateNo",label:ds,rules:{...k,...v},required:!0,control:a,editable:s,type:"text"}),e.jsx(I,{name:"personFatherName",label:us,rules:se,required:!0,control:a,editable:s,type:"text"}),e.jsx(O,{name:"genderID",control:a,label:ps,required:!0,isClearable:!0,isDisabled:!s,options:f,isLoading:N,rules:v,errors:p}),e.jsx(fe,{name:"personBirthDate",label:Ne,control:a,disabled:!s,required:!0,errors:p,rules:v,setValue:D}),e.jsx(I,{name:"personBirthPlace",label:ms,rules:se,required:!1,control:a,editable:s,type:"text"}),e.jsx(I,{name:"personPreviousName",label:hs,rules:se,required:!1,control:a,editable:s,type:"text"}),e.jsxs("div",{className:s?"checkboxContainer col-span-3":"checkboxContainer--disabled col-span-3",children:[e.jsx("p",{className:"inputBox__form--readOnly-label",children:xs}),e.jsx(ee,{disabled:!s,control:a,label:fs,name:"personIsSacrificedFamily"}),e.jsx(ee,{disabled:!s,control:a,label:Is,name:"personIsWarrior"}),e.jsx(ee,{disabled:!s,control:a,label:bs,name:"personIsChildOfSacrificed"}),e.jsx(ee,{disabled:!s,control:a,label:Ds,name:"personIsValiant"}),e.jsx(ee,{disabled:!s,control:a,label:js,name:"personIsSacrificed"}),e.jsx(ee,{disabled:!s,control:a,label:gs,name:"personIsCaptive"})]}),e.jsx(I,{name:"retiredID",label:ys,required:!1,control:a,editable:!1,type:"text"}),e.jsx(I,{name:"personPhone",label:Ss,required:!1,rules:k,control:a,editable:s,type:"text"}),e.jsx(I,{name:"personCellPhone",label:Cs,required:!1,rules:Ns,control:a,editable:s,type:"text"}),e.jsx(I,{name:"backupPhone",label:Rs,required:!1,rules:k,control:a,editable:s,type:"text"}),e.jsx(I,{name:"backupFirstName",label:Ts,required:!1,rules:se,control:a,editable:s,type:"text"}),e.jsx(I,{name:"backupLastName",label:Es,required:!1,rules:se,control:a,editable:s,type:"text"}),e.jsx(I,{name:"personEmail",label:As,required:!1,rules:Ls,control:a,editable:s,type:"text"}),e.jsx(O,{name:"educationTypeID",control:a,label:Ps,required:!1,isClearable:!0,isDisabled:!s,options:L,isLoading:n}),e.jsx(O,{name:"personCountryID",control:a,label:ks,required:!1,isClearable:!0,isDisabled:!s,options:V,isLoading:Y}),e.jsx(O,{name:"personStateID",control:a,label:Us,required:!1,isClearable:!0,isDisabled:!s,options:K,isLoading:J}),e.jsx(O,{name:"personCityID",control:a,label:Os,required:!1,isClearable:!0,isDisabled:!s,options:q,isLoading:b}),e.jsx(I,{name:"personRegion",label:vs,required:!1,control:a,editable:s,rules:k,type:"text"}),e.jsx(I,{name:"personArea",label:Fs,required:!1,control:a,editable:s,rules:k,type:"text"}),e.jsx(I,{name:"personPostalCode",label:qs,required:!1,control:a,editable:s,rules:_s,type:"text"}),e.jsx(O,{name:"housingTypeID",control:a,label:Ms,required:!1,isClearable:!0,isDisabled:!s,options:T,isLoading:be}),e.jsx(O,{name:"maritalStatusID",control:a,label:zs,required:!1,isClearable:!0,isDisabled:!s,options:De,isLoading:j}),e.jsx(fe,{name:"personDeathDate",label:Bs,control:a,disabled:!s,required:!1,setValue:D}),e.jsx(ke,{name:"personAddress",label:Gs,required:!0,control:a,editable:s,containerClassNames:"col-span-3"}),e.jsx(ke,{name:"personDescription",label:Ks,required:!0,control:a,editable:s,containerClassNames:"col-span-4 row-span-2"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(ae,{dir:"ltr",endIcon:e.jsx(Ae,{}),disabled:!s,variant:"contained",type:"submit",loading:P,color:"success",children:e.jsx("span",{children:Re})}),e.jsx(ae,{dir:"ltr",endIcon:e.jsx(le,{}),onClick:d,disabled:s,variant:"contained",color:"primary",children:e.jsx("span",{children:W})})]})]})})})},Qa=()=>{const[s,d]=r.useState([]),[t,m]=oe(!1),[R]=te(),h=R.get("personID"),{personDeathDate:y}=we(T=>T.person),a=r.useMemo(()=>["retiredOrganizationID","employmentTypeID","pensionaryStatusID"],[]),x=r.useMemo(()=>["retirementDate","pensionaryStartdate"],[]),{control:p,handleSubmit:D,formState:{errors:i},setValue:u}=ge(),{data:c,isSuccess:S,isLoading:C,isFetching:A,refetch:P}=ws(h),{data:o,isSuccess:N,isLoading:f,isFetching:l,refetch:n}=$s(h),[L,{isLoading:G}]=Hs(),{organizations:Y,organizationIsLoading:V}=La({}),{lookUpItems:Q,lookUpItemsIsLoading:J}=z({lookUpType:"EmploymentType"}),{pensionaryStatus:K,pensionaryStatusIsLoading:re}=Pa({pensionaryStatusCategory:"R",pensionaryStatusIsDead:y}),b=r.useMemo(()=>U(Y,"organizationID","organizationName"),[Y]),q=r.useMemo(()=>U(Q,"lookUpID","lookUpName"),[Q]),w=r.useMemo(()=>U(K,"pensionaryStatusID","pensionaryStatusName"),[K]);r.useEffect(()=>{if(S){const T=c==null?void 0:c.itemList[0];if(T){const g={...T};Object.keys(g).forEach(j=>{j==="retirementDate"&&(g[j]=g[j]===null?null:Pe(g[j])),j==="pensionaryStartdate"&&(g[j]=g[j]===null?null:Pe(g[j])),u(j,g[j])})}}},[S,c==null?void 0:c.itemList,u]);const be=async T=>{const g=Ee(T,a,x),j=await L({...g,retiredGroup:parseInt($(T.retiredGroup)),retiredJobDegreeCoef:parseInt($(T.retiredJobDegreeCoef)),retiredRealDuration:parseInt($(T.retiredRealDuration)),retiredGrantDuration:parseInt($(T.retiredGrantDuration)),personID:h}).unwrap();m(),P(),n(),ie.success(j.message)};return r.useEffect(()=>{if(S){const T=c==null?void 0:c.itemList[0],g=as(T,a,x,{retiredOrganizationID:b,employmentTypeID:q,pensionaryStatusID:w});Object.keys(g).forEach(j=>{$a.includes(j)&&g[j]===null?u(j,""):u(j,g[j])})}},[S,c==null?void 0:c.itemList,b,q,w,u,a,x]),r.useEffect(()=>{if(N){const T=o==null?void 0:o.itemList.map((g,j)=>({id:g.pensionaryID,isActive:g.pensionaryIsActive,pensionaryStatusRowNum:j+1,pensionaryStatusName:g.pensionaryStatusName||"-",pensionaryStartdate:g.pensionaryStartdate||"-"}));d(T)}},[N,o==null?void 0:o.itemList]),e.jsx(e.Fragment,{children:C||A?e.jsx(H,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(B,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:D(be),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(I,{name:"retiredGroup",label:Vs,control:p,required:!0,editable:t,rules:{...v,...k},type:"text"}),e.jsx(O,{name:"retiredOrganizationID",control:p,label:Qs,required:!0,isClearable:!0,isDisabled:!t,options:b,isLoading:V,rules:v,errors:i}),e.jsx(I,{name:"retiredLastPosition",label:Ws,control:p,required:!1,editable:t,rules:se,type:"text"}),e.jsx(O,{name:"employmentTypeID",control:p,label:Ys,required:!0,isClearable:!0,isDisabled:!t,options:q,isLoading:J,rules:v,errors:i}),e.jsx(fe,{name:"retirementDate",label:Js,control:p,disabled:!t,required:!1,errors:i,rules:v,setValue:u}),e.jsx(O,{name:"pensionaryStatusID",control:p,label:Te,required:!0,isClearable:!0,isDisabled:!t,options:w,isLoading:re,rules:v,errors:i}),e.jsx(fe,{name:"pensionaryStartdate",label:Zs,control:p,disabled:!t,required:!0,errors:i,rules:v,setValue:u}),e.jsx(I,{name:"retiredJobDegreeCoef",label:Xs,control:p,required:!1,editable:t,rules:k,type:"text"}),e.jsx(I,{name:"retiredGrantDuration",label:ea,control:p,required:!1,editable:t,rules:k,type:"text"}),e.jsx(I,{name:"retiredRealDuration",label:sa,control:p,required:!1,editable:t,rules:k,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(ae,{dir:"ltr",endIcon:e.jsx(Ae,{}),disabled:!t,variant:"contained",type:"submit",loading:G,color:"success",children:e.jsx("span",{children:Re})}),e.jsx(ae,{dir:"ltr",endIcon:e.jsx(le,{}),onClick:m,disabled:t,variant:"contained",color:"primary",children:e.jsx("span",{children:W})})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(ka,{data:s,isLoading:f,isFetching:l})]})})})},Wa=()=>{const[s,d]=oe(!1),[t,m]=r.useState([]),[R]=te(),h=R.get("personID"),y=r.useMemo(()=>["bankID","bankBranchID"],[]),a=r.useMemo(()=>[],[]),{control:x,handleSubmit:p,formState:{errors:D},setValue:i,watch:u}=ge(),c=u("bankID"),{lookUpItems:S,lookUpItemsIsLoading:C}=z({lookUpType:"Bank"}),A=r.useMemo(()=>U(S,"lookUpID","lookUpName"),[S]),[P,{isLoading:o,isFetching:N}]=Ua(),f=r.useMemo(()=>U(t,"lookUpID","lookUpName"),[t]),{data:l,isSuccess:n,isLoading:L,isFetching:G,refetch:Y}=aa(h),[V,{isLoading:Q}]=ta(),J=r.useCallback(async b=>{const q=await P({lookUpType:"BankBranch",lookUpParentID:b}).unwrap();m(q.itemList)},[P]),K=async b=>{const q=Ee(b,y,a),w=await V({...q,accountNo:$(b.accountNo)||null,ledgerCode:parseInt($(b.ledgerCode))||null,insuranceAmount:parseFloat($(b.insuranceAmount))||null,insuranceCoef:parseFloat($(b.insuranceCoef))||null,personID:h}).unwrap();Y(),d(),ie.success(w.message)};return r.useEffect(()=>{c?J(c.value):(i("bankBranchID",null),m([]))},[c,J,i]),r.useEffect(()=>{n&&({...l},Object.keys(l).forEach(b=>{Ha.includes(b)&&l[b]===null?i(b,""):i(b,l[b])}))},[n,l,i]),r.useEffect(()=>{n&&A.length>0&&i("bankID",A.find(b=>b.value===l.bankID))},[n,l,i,A]),r.useEffect(()=>{n&&f.length>0&&i("bankBranchID",f.find(b=>b.value===l.bankBranchID))},[n,l,i,f]),e.jsx(e.Fragment,{children:L||G?e.jsx(H,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(B,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:p(K),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(O,{name:"bankID",control:x,label:ra,required:!1,isClearable:!0,isDisabled:!s,options:A,isLoading:C,errors:D}),e.jsx(O,{name:"bankBranchID",control:x,label:na,required:!1,isClearable:!0,isDisabled:!s,options:f,isLoading:o||N,errors:D}),e.jsx(I,{name:"accountNo",label:oa,rules:k,required:!1,control:x,editable:s,type:"text"}),e.jsx(I,{name:"ledgerCode",label:ia,rules:k,required:!1,control:x,editable:s,type:"text"}),e.jsx(I,{name:"insuranceCoef",label:la,rules:k,required:!1,control:x,editable:s,type:"text"}),e.jsx(I,{name:"insuranceAmount",label:ca,rules:k,required:!1,control:x,editable:s,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(ae,{dir:"ltr",endIcon:e.jsx(Ae,{}),disabled:!s,variant:"contained",type:"submit",loading:Q,color:"success",children:e.jsx("span",{children:Re})}),e.jsx(ae,{dir:"ltr",endIcon:e.jsx(le,{}),onClick:d,disabled:s,variant:"contained",color:"primary",children:e.jsx("span",{children:W})})]})]})})})},Ya=(s,d)=>[{accessorKey:"relatedRowNo",header:$e,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"personNationalCode",header:Ce,size:20},{accessorKey:"personFirstName",header:ye,size:20},{accessorKey:"personLastName",header:Se,size:20},{accessorKey:"pensionaryIsUnderGauranteeText",header:Te,size:20},{accessorKey:"personBirthDate",header:Ne,size:20,Cell:({renderedCellValue:t})=>e.jsx("div",{children:He(t)})},{accessorKey:"relationshipWithParentName",header:Ve,size:20},{accessorKey:"updateRelated",header:W,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:t})=>e.jsx(F,{title:`${W} "${t.original.personFirstName} ${t.original.personLastName}"`,children:e.jsx(ne,{to:`${Qe}?mode=update&id=${s}&personID=${t.original.id}`,children:e.jsx(le,{color:"success"})})})},{accessorKey:"deleteRelated",header:xe,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:t})=>e.jsx(F,{title:`${xe} "${t.original.personFirstName} ${t.original.personLastName}"`,children:e.jsx(E,{color:"error",onClick:()=>d(t.original.pensionaryID),sx:{padding:"0"},children:e.jsx(ts,{})})})}],Ja=(s,d,t,m)=>e.jsxs(H,{children:[d||s?e.jsx(E,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(B,{size:20,value:100})}):e.jsx(F,{title:We,children:e.jsx("span",{children:e.jsx(E,{"aria-label":"refresh",color:"info",onClick:t,children:e.jsx(Ie,{fontSize:"small"})})})}),d||s?e.jsx(E,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(B,{size:20,value:100})}):e.jsx(F,{title:Ye,children:e.jsx(ne,{to:`${Qe}?mode=create&id=${m}`,children:e.jsx(E,{"aria-label":"refresh",color:"success",children:e.jsx(rs,{fontSize:"small"})})})})]}),Za=()=>{const[s,d]=r.useState([]),[t,m]=oe(!1),[R,h]=r.useState(""),[y]=te(),a=y.get("personID"),{data:x,isSuccess:p,isLoading:D,isFetching:i,refetch:u}=Oa(a),[c,{isLoading:S}]=va();r.useEffect(()=>{if(p){const f=x.itemList.map((l,n)=>({id:l.personID,relatedRowNo:n+1,pensionaryID:l.pensionaryID,personBirthDate:l.personBirthDate,personNationalCode:l.personNationalCode,personFirstName:l.personFirstName,personLastName:l.personLastName,pensionaryIsUnderGauranteeText:l.pensionaryIsUnderGauranteeText,relationshipWithParentName:l.relationshipWithParentName}));d(f)}},[p,x]);const C=async()=>{const f=await c({pensionaryID:R}).unwrap();m(),u(),ie.success(f.message)},P=Ya(a,f=>{h(f),m()}),o=Ja(D,i,u,a);return e.jsxs(e.Fragment,{children:[e.jsx(Je,{open:t,onClose:m,isLoading:S,handleRemove:C}),e.jsx(Ze,{data:s,columns:P,scroll:!1,topBarActions:o,isLoading:D,isFetching:i})]})},Xa=(s,d)=>[{accessorKey:"heirRowNo",header:$e,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"heirNationalCode",header:Ce,size:20},{accessorKey:"heirFirstName",header:ye,size:20},{accessorKey:"heirLastName",header:Se,size:20},{accessorKey:"heirPensionaryIsUnderGauranteeText",header:Te,size:20},{accessorKey:"heirBirthDate",header:Ne,size:20,Cell:({renderedCellValue:t})=>e.jsx("div",{children:He(t)})},{accessorKey:"heirRelationshipWithParentName",header:Ve,size:20},{accessorKey:"heirParentPersonNationalCode",header:da,size:20},{accessorKey:"updateHeir",header:W,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:t})=>e.jsx(F,{title:`${W} "${t.original.personFirstName} ${t.original.personLastName}"`,children:e.jsx(ne,{to:`${Xe}?mode=update&id=${s}&personID=${t.original.id}`,children:e.jsx(le,{color:"success"})})})},{accessorKey:"deleteRelated",header:xe,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:t})=>e.jsx(F,{title:`${xe} "${t.original.personFirstName} ${t.original.personLastName}"`,children:e.jsx(E,{color:"error",onClick:()=>d(t.original.pensionaryID),sx:{padding:"0"},children:e.jsx(ts,{})})})}],et=(s,d,t,m)=>e.jsxs(H,{children:[d||s?e.jsx(E,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(B,{size:20,value:100})}):e.jsx(F,{title:We,children:e.jsx("span",{children:e.jsx(E,{"aria-label":"refresh",color:"info",onClick:t,children:e.jsx(Ie,{fontSize:"small"})})})}),d||s?e.jsx(E,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(B,{size:20,value:100})}):e.jsx(F,{title:Ye,children:e.jsx(ne,{to:`${Xe}?mode=create&id=${m}`,children:e.jsx(E,{"aria-label":"refresh",color:"success",children:e.jsx(rs,{fontSize:"small"})})})})]}),st=()=>{const[s,d]=r.useState(""),[t,m]=r.useState([]),[R,h]=oe(!1),[y]=te(),a=y.get("personID"),{data:x,isLoading:p,isSuccess:D,isFetching:i,refetch:u}=Fa(a),[c,{isLoading:S}]=qa();r.useEffect(()=>{if(D){const f=x.itemList.map((l,n)=>({id:l.personID,heirRowNo:n+1,pensionaryID:l.pensionaryID,heirNationalCode:l.personNationalCode,heirFirstName:l.personFirstName,heirLastName:l.personLastName,heirPensionaryIsUnderGauranteeText:l.pensionaryIsUnderGauranteeText,heirBirthDate:l.personBirthDate,heirRelationshipWithParentName:l.relationshipWithParentName,heirParentPersonNationalCode:l.parentPersonNationalCode}));m(f)}},[D,x]);const C=async()=>{const f=await c({pensionaryID:s}).unwrap();u(),h(),ie.success(f.message)},P=Xa(a,f=>{d(f),h()}),o=et(p,i,u,a);return e.jsxs(e.Fragment,{children:[e.jsx(Je,{open:R,onClose:h,isLoading:S,handleRemove:C}),e.jsx(Ze,{data:t,columns:P,scroll:!1,topBarActions:o,isLoading:p,isFetching:i})]})},_t=()=>{const[s,d]=r.useState("1"),{personDeathDate:t}=we(h=>h.person),m=(h,y)=>{d(y)};return e.jsxs("section",{className:"flex-col mb-20",children:[e.jsx(Na,{title:ua,back:!0}),e.jsxs("div",{"data-name":"retired-forms",children:[e.jsxs(de,{children:[e.jsx(ue,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(pe,{}),children:pa}),e.jsx(me,{children:e.jsx(Va,{})})]}),e.jsxs(de,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(ue,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(pe,{}),children:ma}),e.jsx(me,{children:e.jsx(Qa,{})})]}),e.jsxs(de,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(ue,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(pe,{}),children:ha}),e.jsx(me,{children:e.jsx(Wa,{})})]}),e.jsxs(de,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(ue,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(pe,{}),children:xa}),e.jsx(me,{children:e.jsx(Ba,{})})]})]}),e.jsx("div",{"data-name":"retired-grids",children:e.jsxs(Ma,{value:s,children:[e.jsx(H,{sx:{bgcolor:"background.paper",borderRadius:1},children:e.jsxs(za,{onChange:m,"aria-label":"tabs",variant:"fullWidth",children:[e.jsx(ce,{label:t?fa:Ia,value:"1"}),e.jsx(ce,{label:ba,value:"2"}),e.jsx(ce,{label:Da,value:"3"}),e.jsx(ce,{label:ja,value:"4"})]})}),e.jsx(he,{value:"1",sx:{padding:"0"},children:t?e.jsx(st,{}):e.jsx(Za,{})}),e.jsx(he,{value:"2",sx:{padding:"0"},children:e.jsx(e.Fragment,{children:e.jsx(_a,{})})}),e.jsx(he,{value:"3",sx:{padding:"0"},children:e.jsx(Ka,{})}),e.jsx(he,{value:"4",sx:{padding:"0"},children:e.jsx(Ga,{})})]})})]})};export{_t as default};
