import{di as G,dT as d,r as l,h as F,j as e,K as B,N as y,v as Q,bu as V,ax as z}from"./index-75zhT6gl.js";import{c as q,S as v}from"./SelectInput-BjDhIOA9.js";import{T as A}from"./TextArea-CVFp6v9D.js";import"./react-select-animated.esm-p7Pyr3H5.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";const K=G.injectEndpoints({endpoints:n=>({getLookup:n.query({query:({lookupType:o,lookupName:i})=>{let r=`${d}/GetLookup?LookupType=${o}`;return i&&(r+=`&lookUpName=${i}`),{url:r}}}),getLookupDistinct:n.query({query:()=>({url:`${d}/GetLookupDistinct`})}),insertLookup:n.mutation({query:o=>({url:`${d}/InsertLookup`,method:"POST",body:o})}),getLookupParent:n.query({query:o=>({url:`${d}/GetLookupParent?lookupType=${o}`})})})}),{useLazyGetLookupQuery:se,useGetLookupDistinctQuery:R,useInsertLookupMutation:M,useLazyGetLookupParentQuery:H}=K,J=()=>{var N,S;const[n,o]=l.useState([]),[i,r]=l.useState([]),{handleSubmit:I,control:p,formState:{errors:L},watch:P,reset:T,setValue:k,unregister:x}=F({defaultValues:{title:"",type:null,parent:null,description:""}}),t=P(),{data:u,isLoading:O,isSuccess:g}=R(),[h,{isLoading:w,isFetching:D}]=H(),[$,{isLoading:C}]=M(),j=l.useCallback(async()=>{var c,a;const s=await h((c=t==null?void 0:t.type)==null?void 0:c.value).unwrap(),m=q(s.itemList,"id","lookUpName");s.itemList.length===0&&((a=t==null?void 0:t.type)!=null&&a.value)&&x("parent"),r(m)},[h,(N=t==null?void 0:t.type)==null?void 0:N.value,x]),E=async s=>{var a,f,U,b;const m={lookUpID:"string",lookUpType:(a=s.type)==null?void 0:a.value,lookUpTypeName:(f=s.type)==null?void 0:f.label,lookUpName:s.title,lookUpParentID:((U=s.parent)==null?void 0:U.value)||"",lookUpDescription:s.description,lookUpParentIDName:((b=s.parent)==null?void 0:b.label)||"",isDeleted:!1},c=await $(m).unwrap();z.success(c.message),T()};return l.useEffect(()=>{if(g){const s=q(u.itemList,"lookUpType","lookUpTypeName");o(s)}},[u==null?void 0:u.itemList,g]),l.useEffect(()=>{var s;(s=t==null?void 0:t.type)!=null&&s.value?j():(k("parent",null),r([]))},[(S=t==null?void 0:t.type)==null?void 0:S.value,j,k]),e.jsx("section",{className:"flex-col formContainer",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:I(E),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsx(B,{name:"title",label:"عنوان",control:p,required:!0,rules:y}),e.jsx(v,{name:"type",label:"نوع",options:n,control:p,rules:y,required:!0,isClearable:!0,isLoading:O,errors:L}),i&&i.length>0&&e.jsx(v,{name:"parent",label:"از مجموعه",rules:y,options:i,isLoading:w||D,control:p,required:!0,isClearable:!0,errors:L}),e.jsx(A,{name:"description",label:"شرح",control:p,required:!0,rules:y,containerClassNames:"col-span-3 row-span-2"})]}),e.jsx("div",{className:"flex mr-auto",children:e.jsx(Q,{dir:"ltr",endIcon:e.jsx(V,{}),loading:C,variant:"contained",type:"submit",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})},ne=()=>e.jsxs("section",{className:"flex-col",children:[e.jsx("div",{className:"title-primary--container flex-row flex-center",children:e.jsxs("h4",{className:"title-primary",children:[e.jsx("span",{className:"title-primary--underline"}),"اطلاعات پایه ۲"]})}),e.jsx(J,{})]});export{ne as default};
