import{R as S,dM as D,dN as j,j as e,T as v,dO as N,f as y,dP as w,I as O,D as b,r as c,ax as A,dQ as L,G as k,h as F,K,N as p,Z as P,v as q,au as z,av as G,k as M,dR as B}from"./index-75zhT6gl.js";import{T as V}from"./TextArea-CVFp6v9D.js";import{u as _,a as Q,b as U}from"./announceApi-IFWFCRgA.js";import{a as W}from"./convertFormData-NijAPJh_.js";import{D as Z}from"./DeleteOutline-5zdRqkOy.js";const H=t=>[{accessorKey:"announceRowNo",header:S,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"announceTitle",header:D,size:20},{accessorKey:"announceDesc",header:j,size:20,Cell:({renderedCellValue:s,row:n})=>e.jsx(v,{title:e.jsx("p",{children:n.original.description}),children:e.jsx("p",{style:{width:"80ch",textOverflow:"ellipsis",overflow:"hidden"},children:s})}),muiTableBodyCellProps:{align:"right"}},{accessorKey:"announceRunDate",header:N,size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:y(s)})},{accessorKey:"deleteAnnounce",header:w,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:s})=>e.jsx(O,{color:"error",onClick:()=>t(s.original.id),sx:{padding:"0"},children:e.jsx(Z,{})})}],J=({triggerRefetch:t})=>{const[s,n]=b(!1),[r,m]=c.useState(null),[x,f]=c.useState([]),{data:l,isLoading:h,isFetching:g,isSuccess:i,refetch:a}=_({}),[u,{isLoading:T}]=Q(),R=o=>{m(o),n()},C=c.useCallback(async()=>{const o=await u({announceID:r,isDeleted:!0}).unwrap();n(),a(),A.success(o.message)},[u,r,a,n]),I=H(R);return c.useEffect(()=>{if(i){const o=l.itemList.map((d,E)=>({id:d.announceID,announceRowNo:E+1,announceTitle:d.title,announceDesc:d.description,announceRunDate:d.runDate}));f(o)}},[i,l]),c.useEffect(()=>{a()},[t,a]),e.jsxs(e.Fragment,{children:[e.jsx(L,{open:s,onClose:n,isLoading:T,handleRemove:C}),e.jsx(k,{data:x,columns:I,scroll:!1,isLoading:h,isFetching:g})]})},X=()=>{const[t,s]=b(!1),{control:n,handleSubmit:r,formState:{errors:m},setValue:x}=F(),[f,{isLoading:l}]=U(),h=async i=>{const a=W(i,[],["runDate"]),u=await f({...a,runDate:a.runDate,isDelete:!1}).unwrap();s(),A.success(u.message)};return e.jsxs("section",{className:"flex-col",children:[e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:r(h),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx(K,{name:"title",label:D,rules:p,required:!0,control:n,type:"text"}),e.jsx(P,{name:"runDate",label:N,control:n,required:!0,errors:m,rules:p,setValue:x}),e.jsx(V,{name:"description",label:j,required:!0,rules:p,control:n,containerClassNames:"col-span-3 row-span-2"})]}),e.jsx("div",{className:"flex-row mr-auto",children:e.jsx(q,{dir:"ltr",endIcon:e.jsx(z,{}),variant:"contained",type:"submit",loading:l,color:"success",children:e.jsx("span",{children:G})})})]}),e.jsx(J,{triggerRefetch:t})]})},te=()=>e.jsxs("section",{className:"flex-col u-margin-bottom-xl",children:[e.jsx(M,{title:B,back:!0}),e.jsx(X,{})]});export{te as default};
