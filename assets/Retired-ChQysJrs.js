import{c as Sn,j as e,r as o,b as cs,t as ps,p as ne,B as Ce,C as ye,v as z,w as N,m as be,S as Ds,x as Js,q as u,y as Zs,z as on,A as Cs,D as Is,E as vs,I as oe,T as Ne,P as Ss,F as Bs,H as _s,J as ks,K as Os,M as Ps,N as Le,Q as ln,U as rn,l as Xs,V as Ns,L as Bn,W as Ws,X as _n,Y as cn,u as kn,Z as an,_ as te,$ as On,a0 as fe,a1 as Pn,a2 as Mn,a3 as Fn,a4 as Ln,a5 as Re,a6 as Rn,a7 as ys,a8 as Tn,a9 as An,aa as Un,ab as En,ac as qn,ad as wn,ae as $n,af as zn,ag as Hn,ah as Yn,ai as Gn,aj as Kn,ak as Wn,al as Vn,am as Qn,an as Jn,ao as Zn,ap as Xn,aq as ea,ar as sa,as as na,at as aa,au as ta,av as oa,aw as la,ax as ra,ay as ia,az as ca,aA as pa,aB as ua,aC as da,aD as ma,aE as pn,aF as un,aG as dn,R as ha,aH as Vs,aI as xa,G as ga,d as mn,aJ as ja,aK as Na,aL as fa,aM as ya,aN as Ia,aO as ba,aP as Ca,aQ as Da,aR as va,aS as Sa,aT as Ba,aU as _a,aV as ka,aW as Oa,aX as Us,aY as Pa,aZ as Ma,a_ as Fa,a$ as La,b0 as Ra}from"./index-CS2lvWxn.js";import{u as en}from"./sharedApi-Dtybq87C.js";import{u as Ta,a as Aa,b as sn,c as Ua,d as Ea,e as qa,f as wa,R as $a}from"./RetiredStatementsGrid-CIMDq4ak.js";import{u as Q,a as Ys,b as Ms,c as za}from"./useFetchLookUpData-B775jqf-.js";import{i as Fs,S as Y}from"./react-select-animated.esm-U-6UGiCh.js";import{o as G,s as x,a as K}from"./reactSelect-BGq5yAQc.js";import{E as Ls}from"./EditOutlined-kq_Tm1Pb.js";import{u as Ha,a as Ya,c as Ga,F as Ka}from"./createTree-Dc1XmXaK.js";import{T as Wa}from"./Title-B5OsNEYi.js";/* empty css                 */import{M as is}from"./Modal-IEKXK9eT.js";import{u as Rs,m as ce,C as pe,d as he,a as me}from"./datePicker-u0vsggqJ.js";import{d as Ts}from"./table-options-DyxI3P7g.js";import{R as As}from"./Refresh-Dlgairf-.js";import{S as Gs}from"./index-BzthygOX.js";import{D as hn}from"./DeleteOutline-C_inLjJh.js";import{A as xn}from"./Add-DidByUXC.js";import{b as Va}from"./requestApi-BD0jsSFT.js";import{E as gn}from"./VisibilityOutlined-BFQA47Hm.js";import{u as Qa,S as Ja}from"./SlipFormTemplate-CBAW4HOq.js";import{c as Be,S as _e}from"./SelectInput-BHQ5z_oY.js";import{T as tn}from"./TextArea-d5LUmlOT.js";import{a as Qs,c as Za}from"./dateConverter-DkppR6V0.js";import{A as Es,a as qs,b as ws,c as $s}from"./ArrowDropDown-BT-_di5i.js";import{T as Xa,a as et,b as zs}from"./TabPanel-3Ygz2Sbh.js";import"./statementApi-TLDw6OXS.js";import"./module-DS5ByQ9z.js";import"./InfoOutlined-SmOfTvCO.js";import"./index-CPK1yoH2.js";import"./excel-icon-Dq0N6FeV.js";import"./numberConverter-BO73yQ0O.js";const jn=Sn(e.jsx("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"}),"DoneOutlined");function st(){const[l,g]=o.useState(!1),b=Fs(),[O,v]=o.useState([]),{handleSubmit:f,formState:{errors:P},control:p,register:U,watch:j,setValue:E}=cs(),d=j(),q=ps(),$=new URLSearchParams(q.search).get("personID"),[H,{isLoading:J}]=Ta(),[Z,{isLoading:i,isFetching:F}]=en(),{lookUpItems:L,lookUpItemsIsLoading:X,lookUpItemsIsFetching:n}=Q({lookUpType:"Bank"}),m=G(L,"lookUpID","lookUpName"),T=G(O,"lookUpID","lookUpName"),{data:A,isSuccess:se,isLoading:ee,isFetching:s,error:W}=Aa($),_=o.useCallback(async h=>{try{const S=await Z({lookUpType:"BankBranch",lookUpParentID:h}).unwrap();v(S.itemList)}catch(S){console.log(S)}},[Z,v]);o.useEffect(()=>{se&&Object.keys(A).forEach(h=>{E(h,A[h])})},[se,A,E]),o.useEffect(()=>{var h;W&&ne.error(((h=W==null?void 0:W.data)==null?void 0:h.message)||W.error,{autoClose:2e3})},[W]),o.useEffect(()=>{d.bankID&&_(d.bankID)},[d.bankID,_]);const c=()=>{g(!0)},t=async()=>{var h;try{const S=await H({...d,ledgerCode:parseInt(u(d.ledgerCode))||null,insuranceAmount:parseFloat(u(d.insuranceAmount))||null,insuranceCoef:parseFloat(u(d.insuranceCoef))||null,accountNo:u(d.accountNo),personID:$}).unwrap();g(!1),ne.success(S.message,{autoClose:2e3})}catch(S){console.log(S),ne.error(((h=S==null?void 0:S.data)==null?void 0:h.message)||S.error,{autoClose:2e3})}};return o.useEffect(()=>{console.log(d)},[d]),e.jsx(e.Fragment,{children:ee||s?e.jsx(Ce,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ye,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:f(t),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"bankID",control:p,render:({field:{onChange:h}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:b,options:m,onChange:S=>h(S?S.value:null),isDisabled:!l,value:m.find(S=>S.value===(d==null?void 0:d.bankID)),id:"bankID",name:"bankID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"بانک"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:X||n})}),e.jsx("label",{htmlFor:"bankID",className:d!=null&&d.bankID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"بانک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"bankBranchID",control:p,render:({field:{onChange:h}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:b,options:T,onChange:S=>h(S?S.value:null),isDisabled:!l||i||F||!d.bankID,value:T.find(S=>S.value===(d==null?void 0:d.bankBranchID))||null,id:"bankBranchID",name:"bankBranchID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شعبه"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:i||F})}),e.jsx("label",{htmlFor:"bankBranchID",className:d!=null&&d.bankBranchID&&T.some(h=>h.value===d.bankBranchID)?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شعبه"})]}),e.jsxs("div",{className:"inputBox__form",children:[P.accountNo&&e.jsx("span",{className:"error-form",children:P.accountNo.message}),e.jsx("input",{disabled:!l||ee,type:"text",id:"accountNo",name:"accountNo",value:N(d==null?void 0:d.accountNo)??"",className:"inputBox__form--input",required:!0,...U("accountNo",{pattern:{value:/^[۰-۹0-9]+$/,message:"شماره حساب باید فقط شامل اعداد باشد"}})}),e.jsx("label",{htmlFor:"accountNo",className:"inputBox__form--label",children:"شماره حساب"})]}),e.jsxs("div",{className:"inputBox__form",children:[P.ledgerCode&&e.jsx("span",{className:"error-form",children:P.ledgerCode.message}),e.jsx("input",{disabled:!l,type:"text",id:"ledgerCode",name:"ledgerCode",value:N(d==null?void 0:d.ledgerCode)??"",className:"inputBox__form--input",required:!0,...U("ledgerCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"دفتر کل باید فقط شامل اعداد باشد"}})}),e.jsx("label",{htmlFor:"ledgerCode",className:"inputBox__form--label",children:"دفتر کل"})]}),e.jsxs("div",{className:"inputBox__form",children:[P.insuranceCoef&&e.jsx("span",{className:"error-form",children:P.insuranceCoef.message}),e.jsx("input",{disabled:!l,type:"text",id:"insuranceCoef",name:"insuranceCoef",value:N(d==null?void 0:d.insuranceCoef)??"",className:"inputBox__form--input",required:!0,...U("insuranceCoef",{pattern:{value:/^[۰-۹0-9]+([.,٫][۰-۹0-9]+)?$/,message:"ضریب بیمه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{htmlFor:"insuranceCoef",className:"inputBox__form--label",children:"ضریب بیمه"})]}),e.jsxs("div",{className:"inputBox__form",children:[P.insuranceAmount&&e.jsx("span",{className:"error-form",children:P.insuranceAmount.message}),e.jsx("input",{disabled:!l,type:"text",id:"insuranceAmount",name:"insuranceAmount",value:N(d==null?void 0:d.insuranceAmount)??"",className:"inputBox__form--input",required:!0,...U("insuranceAmount",{pattern:{value:/^[۰-۹0-9]+$/,message:"بیمه تبعی باید فقط شامل اعداد باشد"}})}),e.jsx("label",{htmlFor:"insuranceAmount",className:"inputBox__form--label",children:"بیمه تبعی"})]})]}),e.jsxs("div",{style:{marginRight:"auto"},className:"flex-row",children:[e.jsx(be,{dir:"ltr",endIcon:e.jsx(Ds,{}),loading:J,disabled:!l,onClick:f,type:"submit",variant:"contained",color:"success",children:e.jsx("span",{children:"ذخیره"})}),e.jsx(Js,{dir:"ltr",endIcon:e.jsx(Ls,{}),onClick:c,disabled:l,variant:"contained",color:"primary",children:e.jsx("span",{children:"ویرایش"})})]})]})})})}const nt=()=>{const[l]=Zs(),[g,b]=o.useState([]),[O,v]=o.useState([]),f=l.get("personID"),{data:P,isLoading:p,isSuccess:U,refetch:j}=Ha(),{data:E,isLoading:d,isSuccess:q,refetch:M}=Ya(f);o.useEffect(()=>{q&&v(E.itemList)},[q,E]),o.useEffect(()=>{if(U){const H=Ga(P.itemList);b(H)}},[U,P]);const $=o.useCallback(()=>{j(),M()},[j,M]);return e.jsx(Ka,{structure:g,files:O,isLoading:p||d,refetch:$,access:"files"})},at=on.injectEndpoints({endpoints:l=>({getRelatedListByParentPersonID:l.query({query:g=>({url:`${Cs}/GetRelatedListByParentPersonID?parentPersonID=${g}`})}),getRelated:l.query({query:g=>({url:`${Cs}/GetRelated?personID=${g}`})}),insertRelated:l.mutation({query:g=>({url:`${Cs}/InsertRelated`,method:"POST",body:g})}),updateRelated:l.mutation({query:g=>({url:`${Cs}/UpdateRelated`,method:"POST",body:g})}),removeRelated:l.mutation({query:({pensionaryID:g})=>({url:`${Cs}/RemoveRelated?pensionaryID=${g}`,method:"POST"})})})}),{useGetRelatedListByParentPersonIDQuery:tt,useGetRelatedQuery:ot,useInsertRelatedMutation:lt,useUpdateRelatedMutation:rt,useRemoveRelatedMutation:it}=at;function ct({setShowCreateRelatedModal:l,refetch:g}){const b=o.useRef(null),O=o.useRef(null),v=o.useRef(null),f=o.useRef(null),P=o.useRef(null),[p,U]=o.useState(null),[j,E]=o.useState(null),[d,q]=o.useState(null),[M,$]=o.useState(null),[H,J]=o.useState(null),[Z,i]=o.useState(!1),[F,L]=o.useState(!1),[X,n]=o.useState(!1),[m,T]=o.useState(!1),[A,se]=o.useState(!1),{handleSubmit:ee,formState:{errors:s},control:W,register:_,watch:c}=cs(),t=c(),[r,{isLoading:h}]=lt(),S=ps(),V=new URLSearchParams(S.search).get("personID"),le=Fs(),{relationships:ue,relationshipIsLoading:ns,relationshipIsFetching:de}=Ys(),{pensionaryStatus:ae,pensionaryStatusIsLoading:ie,pensionaryStatusIsFetching:Te}=Ms({pensionaryStatusCategory:"L"}),{lookUpItems:as,lookUpItemsIsLoading:ke,lookUpItemsIsFetching:re}=Q({lookUpType:"MaritialStatus"}),{lookUpItems:De,lookUpItemsIsLoading:Ae,lookUpItemsIsFetching:ts}=Q({lookUpType:"EducationType"}),{lookUpItems:os,lookUpItemsIsLoading:Ue,lookUpItemsIsFetching:xe}=Q({lookUpType:"UniversityType"}),{lookUpItems:ls,lookUpItemsIsLoading:Ee,lookUpItemsIsFetching:qe}=Q({lookUpType:"Country"}),{lookUpItems:we,lookUpItemsIsLoading:$e,lookUpItemsIsFetching:ze}=Q({lookUpType:"State"}),{lookUpItems:He,lookUpItemsIsLoading:Ye,lookUpItemsIsFetching:Ge}=Q({lookUpType:"City"}),Oe=G(ue,"relationshipID","relationshipName"),Ke=G(ae,"pensionaryStatusID","pensionaryStatusName"),We=G(as,"lookUpID","lookUpName"),Ve=G(De,"lookUpID","lookUpName"),Qe=G(os,"lookUpID","lookUpName"),Je=G(ls,"lookUpID","lookUpName"),Ze=G(we,"lookUpID","lookUpName"),Pe=G(He,"lookUpID","lookUpName"),rs=R=>{U(R),L(!1)},w=R=>{E(R),n(!1)},I=R=>{q(R),T(!1)},ge=R=>{$(R),se(!1)},je=R=>{J(R),i(!1)},Xe=R=>{L(R)},us=R=>{n(R)},Me=R=>{i(R)},ds=R=>{T(R)},ms=R=>{se(R)},hs=async()=>{var R;try{let C,Ie,ve,Fe,B;p?(C=new Date(p),C.setMinutes(C.getMinutes()-C.getTimezoneOffset())):C=null,H?(B=new Date(H),B.setMinutes(B.getMinutes()-B.getTimezoneOffset())):B=null,j?(Ie=new Date(j),Ie.setMinutes(Ie.getMinutes()-Ie.getTimezoneOffset())):Ie=null,d?(ve=new Date(d),ve.setMinutes(ve.getMinutes()-ve.getTimezoneOffset())):ve=null,M?(Fe=new Date(M),Fe.setMinutes(Fe.getMinutes()-Fe.getTimezoneOffset())):Fe=null;const y=await r({...t,parentPersonID:V,relationshipWithParentID:u(t.relationshipWithParentID),personCertificateNo:u(t.personCertificateNo),personNationalCode:u(t.personNationalCode),pensionaryStatusID:u(t.pensionaryStatusID),maritalStatusID:u(t.maritalStatusID),educationTypeID:u(t.educationTypeID),universityID:u(t.universityID),personPhone:u(t.personPhone),personCellPhone:u(t.personCellPhone),personCellPhone2:u(t.personCellPhone2),personRegion:parseInt(u(t.personRegion))||null,personArea:parseInt(u(t.personArea))||null,personCountryID:u(t.personCountryID),personCityID:u(t.personCityID),personStateID:u(t.personStateID),personPostalCode:u(t.personPostalCode),backupPhone:u(t.backupPhone),backupCellphone:u(t.backupCellphone),personBirthDate:C,personMaritalDate:Ie,selfEmployeeStartDate:ve,selfEmployeeEndDate:Fe,pensionaryStartDate:B}).unwrap();l(!1),g(),ne.success(y.message,{autoClose:2e3})}catch(C){console.log(C),ne.error(((R=C==null?void 0:C.data)==null?void 0:R.message)||C.error,{autoClose:2e3})}};return Rs([b,O,v,f,P],[L,n,T,se,i]),e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:ee(hs),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"relationshipWithParentID",control:W,rules:{required:!0},render:({field:{onChange:R}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:le,options:Oe,onChange:C=>R(C?C.value:null),value:Oe.find(C=>C.value===(t==null?void 0:t.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:ns||de})}),e.jsxs("label",{className:t!=null&&t.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),s.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personFirstName&&e.jsx("span",{className:"error-form",children:s.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.personFirstName)||"",name:"personFirstName",id:"personFirstName1",required:!0,..._("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName1",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personLastName&&e.jsx("span",{className:"error-form",children:s.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.personLastName)||"",name:"personLastName",id:"personLastName1",required:!0,..._("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personNationalCode&&e.jsx("span",{className:"error-form",children:s.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(t==null?void 0:t.personNationalCode)??"",name:"personNationalCode",id:"personNationalCode2",required:!0,..._("personNationalCode",{required:"کد ملی را وارد کنید",minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personCertificateNo&&e.jsx("span",{className:"error-form",children:s.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(t==null?void 0:t.personCertificateNo)??"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,..._("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificateNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personFatherName&&e.jsx("span",{className:"error-form",children:s.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,..._("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:p,onChange:rs,format:"jYYYY/jMM/jDD",onOpenChange:Xe,suffixIcon:e.jsx(pe,{color:"action"}),open:F,style:he,wrapperStyle:me,pickerProps:{ref:b}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:j,onChange:w,format:"jYYYY/jMM/jDD",onOpenChange:us,suffixIcon:e.jsx(pe,{color:"action"}),open:X,style:he,wrapperStyle:me,pickerProps:{ref:O}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ عقد"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personBirthPlace&&e.jsx("span",{className:"error-form",children:s.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.personBirthPlace)||"",name:"personBirthPlace",id:"personBirthPlace1",required:!0,..._("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"pensionaryStatusID",control:W,rules:{required:!0},render:({field:{onChange:R}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:le,options:Ke,onChange:C=>R(C?C.value:null),value:Ke.find(C=>C.value===(t==null?void 0:t.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت وابسته"]}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:ie||Te})}),e.jsxs("label",{className:t!=null&&t.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت وابسته"]}),s.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:"وضعیت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:H,defaultValue:null,onChange:je,onOpenChange:Me,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(pe,{color:"action"}),open:Z,style:he,wrapperStyle:me,pickerProps:{ref:P}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"maritalStatusID",control:W,render:({field:{onChange:R}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:le,options:We,onChange:C=>R(C?C.value:null),value:We.find(C=>C.value===(t==null?void 0:t.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:ke||re})}),e.jsx("label",{className:t!=null&&t.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"educationTypeID",control:W,render:({field:{onChange:R}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:le,options:Ve,onChange:C=>R(C?C.value:null),value:Ve.find(C=>C.value===(t==null?void 0:t.educationTypeID)),name:"educationTypeID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"مدرک تحصیلی"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Ae||ts})}),e.jsx("label",{className:t!=null&&t.educationTypeID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"مدرک تحصیلی"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.educationTypeCaption&&e.jsx("span",{className:"error-form",children:s.educationTypeCaption.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.educationTypeCaption)||"",name:"educationTypeCaption",id:"educationTypeCaption",required:!0,..._("educationTypeCaption",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"educationTypeCaption",children:"عنوان مدرک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"universityID",control:W,render:({field:{onChange:R}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:le,options:Qe,onChange:C=>R(C?C.value:null),value:Qe.find(C=>C.value===(t==null?void 0:t.universityID)),name:"universityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"دانشگاه"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Ue||xe})}),e.jsx("label",{className:t!=null&&t.universityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"دانشگاه"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.universityCaption&&e.jsx("span",{className:"error-form",children:s.universityCaption.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.universityCaption)||"",name:"universityCaption",id:"universityCaption",required:!0,..._("universityCaption",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"universityCaption",children:"واحد دانشگاهی"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personCellPhone&&e.jsx("span",{className:"error-form",children:s.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone",value:(t==null?void 0:t.personCellPhone)||"",id:"personCellPhone1",required:!0,..._("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone1",children:"تلفن همراه ۱"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personCellPhone2&&e.jsx("span",{className:"error-form",children:s.personCellPhone2.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone2",value:(t==null?void 0:t.personCellPhone2)||"",id:"personCellPhone22",required:!0,..._("personCellPhone2",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone22",children:"تلفن همراه ۲"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personPhone&&e.jsx("span",{className:"error-form",children:s.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPhone",value:(t==null?void 0:t.personPhone)||"",id:"personPhone1",required:!0,..._("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"},maxLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone1",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personRegion&&e.jsx("span",{className:"error-form",children:s.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personRegion",value:(t==null?void 0:t.personRegion)||"",id:"personRegion1",required:!0,..._("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personArea&&e.jsx("span",{className:"error-form",children:s.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personArea",value:(t==null?void 0:t.personArea)||"",id:"personArea1",required:!0,..._("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCountryID",control:W,render:({field:{onChange:R}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:le,options:Je,onChange:C=>R(C?C.value:null),value:Je.find(C=>C.value===(t==null?void 0:t.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Ee||qe})}),e.jsx("label",{className:t!=null&&t.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personStateID",control:W,render:({field:{onChange:R}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:le,options:Ze,onChange:C=>R(C?C.value:null),value:Ze.find(C=>C.value===(t==null?void 0:t.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:$e||ze})}),e.jsx("label",{className:t!=null&&t.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCityID",control:W,render:({field:{onChange:R}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:le,options:Pe,onChange:C=>R(C?C.value:null),value:Pe.find(C=>C.value===(t==null?void 0:t.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Ye||Ge})}),e.jsx("label",{className:t!=null&&t.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personPostalCode&&e.jsx("span",{className:"error-form",children:s.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPostalCode",value:(t==null?void 0:t.personPostalCode)??"",id:"personPostalCode1",required:!0,..._("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personSpecialDisease&&e.jsx("span",{className:"error-form",children:s.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personSpecialDisease",value:(t==null?void 0:t.personSpecialDisease)||"",id:"personSpecialDisease1",required:!0,..._("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[s.personAddress&&e.jsx("span",{className:"error-form",children:s.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personAddress",value:(t==null?void 0:t.personAddress)||"",id:"personAddress1",required:!0,..._("personAddress",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف و اعداد فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[s.personDescription&&e.jsx("span",{className:"error-form",children:s.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",required:!0,name:"personDescription",value:(t==null?void 0:t.personDescription)||"",id:"personDescription1",..._("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription1",children:"توضیحات"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات خویش فرمایی"})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form col-span-2",children:[s.selfEmployeeTypeName&&e.jsx("span",{className:"error-form",children:s.selfEmployeeTypeName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"selfEmployeeTypeName",value:(t==null?void 0:t.selfEmployeeTypeName)||"",id:"selfEmployeeTypeName",required:!0,..._("selfEmployeeTypeName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"selfEmployeeTypeName",children:"وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:d,onChange:I,format:"jYYYY/jMM/jDD",onOpenChange:ds,suffixIcon:e.jsx(pe,{color:"action"}),open:m,style:he,wrapperStyle:me,pickerProps:{ref:v}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ شروع"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:M,onChange:ge,format:"jYYYY/jMM/jDD",onOpenChange:ms,suffixIcon:e.jsx(pe,{color:"action"}),open:A,wrapperStyle:me,pickerProps:{ref:f}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ پایان"})]}),e.jsxs("div",{className:"inputBox__form col-span-4",children:[s.selfEmployeeDesc&&e.jsx("span",{className:"error-form",children:s.selfEmployeeDesc.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",name:"selfEmployeeDesc",value:(t==null?void 0:t.selfEmployeeDesc)||"",id:"selfEmployeeDesc",required:!0,..._("selfEmployeeDesc",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف و اعداد فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"selfEmployeeDesc",children:"توضیحات"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:"اطلاعات پشتیبان"})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[s.backupFirstName&&e.jsx("span",{className:"error-form",children:s.backupFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupFirstName",value:(t==null?void 0:t.backupFirstName)||"",id:"backupFirstName1",required:!0,..._("backupFirstName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupFirstName1",children:"نام"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.backupLastName&&e.jsx("span",{className:"error-form",children:s.backupLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupLastName",value:(t==null?void 0:t.backupLastName)||"",id:"backupLastName1",required:!0,..._("backupLastName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupLastName1",children:"نام خانوادگی"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.backupRelation&&e.jsx("span",{className:"error-form",children:s.backupRelation.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupRelation",value:(t==null?void 0:t.backupRelation)||"",id:"backupRelation",required:!0,..._("backupRelation",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupRelation",children:"نسبت"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.backupPhone&&e.jsx("span",{className:"error-form",children:s.backupPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupPhone",value:(t==null?void 0:t.backupPhone)||"",id:"backupPhone",required:!0,..._("backupPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"},maxLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupPhone",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.backupCellphone&&e.jsx("span",{className:"error-form",children:s.backupCellphone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupCellphone",value:(t==null?void 0:t.backupCellphone)||"",id:"backupCellphone",required:!0,..._("backupCellphone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن همراه باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه ثابت باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه ثابت باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupCellphone",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[s.backupAddress&&e.jsx("span",{className:"error-form",children:s.backupAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupAddress",value:(t==null?void 0:t.backupAddress)||"",id:"backupAddress",required:!0,..._("backupAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupAddress",children:"نشانی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(be,{dir:"ltr",endIcon:e.jsx(Ds,{}),onClick:ee,loading:h,type:"submit",variant:"contained",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})}function Nn({statusHistoryTableData:l,isLoading:g,isFetching:b,handleRefresh:O}){const[v,f]=o.useState({pageIndex:0,pageSize:3}),P=o.useMemo(()=>[{accessorKey:"pensionaryStatusRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:j})=>e.jsx("div",{children:N(j)})},{accessorKey:"pensionaryStatusName",header:"وضعیت",size:20,Cell:({renderedCellValue:j})=>e.jsx("div",{children:N(j)})},{accessorKey:"pensionaryStartdate",header:"تاریخ شروع",size:20,Cell:({renderedCellValue:j})=>e.jsx("div",{children:Is(j)})},{accessorKey:"isActive",header:"وضعیت",size:20,Cell:({renderedCellValue:j})=>e.jsx("div",{children:j===!0?"فعال":"غیرفعال"})}],[]),p=vs({...Ts,columns:P,data:l,muiTopToolbarProps:{sx:{overflow:"none"}},muiTableBodyRowProps:({row:j})=>({sx:{color:j.original.isActive?"#087a30":"","& td":{color:j.original.isActive?"#087a30":""}}}),muiTableHeadProps:{sx:{zIndex:0}},renderTopToolbarCustomActions:()=>e.jsx(Ce,{children:g||b?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ye,{size:20,value:100})}):e.jsx(Ne,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"info",onClick:O,children:e.jsx(As,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:j=>e.jsx(Ss,{...j,page:N(j.page),slots:{previous:Bs,next:_s,first:ks,last:Os}})},initialState:{density:"compact",sorting:[{id:"isActive",desc:!0}]},onPaginationChange:f,state:{pagination:v}});return e.jsx(Ps,{table:p})}function pt({setShowEditRelatedModal:l,personID:g,refetch:b}){const O=o.useRef(null),v=o.useRef(null),f=o.useRef(null),P=o.useRef(null),p=o.useRef(null),[U,j]=o.useState(null),[E,d]=o.useState(null),[q,M]=o.useState(null),[$,H]=o.useState(null),[J,Z]=o.useState(null),[i,F]=o.useState(!1),[L,X]=o.useState(!1),[n,m]=o.useState(!1),[T,A]=o.useState(!1),[se,ee]=o.useState(!1),[s,W]=o.useState([]),{handleSubmit:_,formState:{errors:c},control:t,register:r,watch:h,setValue:S}=cs(),a=h(),[V,{isLoading:le}]=rt(),ue=Fs(),de=new URLSearchParams(location.search).get("personID"),{data:ae,isSuccess:ie,isLoading:Te,isFetching:as,refetch:ke,error:re}=sn(g),{data:De,isSuccess:Ae,isFetching:ts,isLoading:os,refetch:Ue,error:xe}=ot(g);o.useEffect(()=>{if(ke(),ie){const k=ae==null?void 0:ae.itemList.map((D,ss)=>({id:D.pensionaryID,pensionaryStatusRowNum:ss+1,isActive:D.pensionaryIsActive,pensionaryStatusName:D.pensionaryStatusName||"-",pensionaryStartdate:Le(D.pensionaryStartdate)||"-"}));W(k)}return()=>{W([])}},[ke,ie,ae]),o.useEffect(()=>{Ue(),Ae&&Object.keys(De).forEach(k=>{S(k,De[k])})},[Ae,De,Ue,S]),o.useEffect(()=>{var k;xe&&xe.status!=="FETCH_ERROR"&&ne.error(((k=xe==null?void 0:xe.data)==null?void 0:k.message)||xe.error,{autoClose:2e3})},[xe]),o.useEffect(()=>{var k;re&&(console.log(re),ne.error(((k=re==null?void 0:re.data)==null?void 0:k.message)||re.error,{autoClose:2e3}))},[re]);const{relationships:ls,relationshipIsLoading:Ee,relationshipIsFetching:qe}=Ys(),{pensionaryStatus:we,pensionaryStatusIsLoading:$e,pensionaryStatusIsFetching:ze}=Ms({pensionaryStatusCategory:"L"}),{lookUpItems:He,lookUpItemsIsLoading:Ye,lookUpItemsIsFetching:Ge}=Q({lookUpType:"MaritialStatus"}),{lookUpItems:Oe,lookUpItemsIsLoading:Ke,lookUpItemsIsFetching:We}=Q({lookUpType:"EducationType"}),{lookUpItems:Ve,lookUpItemsIsLoading:Qe,lookUpItemsIsFetching:Je}=Q({lookUpType:"UniversityType"}),{lookUpItems:Ze,lookUpItemsIsLoading:Pe,lookUpItemsIsFetching:rs}=Q({lookUpType:"Country"}),{lookUpItems:w,lookUpItemsIsLoading:I,lookUpItemsIsFetching:ge}=Q({lookUpType:"State"}),{lookUpItems:je,lookUpItemsIsLoading:Xe,lookUpItemsIsFetching:us}=Q({lookUpType:"City"}),Me=G(ls,"relationshipID","relationshipName"),ds=G(we,"pensionaryStatusID","pensionaryStatusName"),ms=G(He,"lookUpID","lookUpName"),hs=G(Oe,"lookUpID","lookUpName"),bs=G(Ve,"lookUpID","lookUpName"),R=G(Ze,"lookUpID","lookUpName"),C=G(w,"lookUpID","lookUpName"),Ie=G(je,"lookUpID","lookUpName"),ve=k=>{j(k),F(!1)},Fe=k=>{d(k),X(!1)},B=k=>{M(k),m(!1)},y=k=>{H(k),A(!1)},Se=k=>{Z(k),ee(!1)},es=k=>{ee(k)},Ks=k=>{F(k)},In=k=>{X(k)},bn=k=>{m(k)},Cn=k=>{A(k)};o.useEffect(()=>{j(Le(a==null?void 0:a.personBirthDate))},[a==null?void 0:a.personBirthDate]),o.useEffect(()=>{d(Le(a==null?void 0:a.personMaritalDate))},[a==null?void 0:a.personMaritalDate]),o.useEffect(()=>{M(Le(a==null?void 0:a.selfEmployeeStartDate))},[a==null?void 0:a.selfEmployeeStartDate]),o.useEffect(()=>{H(Le(a==null?void 0:a.selfEmployeeEndDate))},[a==null?void 0:a.selfEmployeeEndDate]);const Dn=()=>{ke()},vn=async()=>{var k;try{let D,ss,xs,gs,js;U?(D=new Date(U),D.setMinutes(D.getMinutes()-D.getTimezoneOffset())):D=null,J?(js=new Date(J),js.setMinutes(js.getMinutes()-js.getTimezoneOffset())):js=null,E?(ss=new Date(E),ss.setMinutes(ss.getMinutes()-ss.getTimezoneOffset())):ss=null,q?(xs=new Date(q),xs.setMinutes(xs.getMinutes()-xs.getTimezoneOffset())):xs=null,$?(gs=new Date($),gs.setMinutes(gs.getMinutes()-gs.getTimezoneOffset())):gs=null;const nn=await V({...a,parentPersonID:de,relationshipWithParentID:u(a.relationshipWithParentID),personCertificateNo:u(a.personCertificateNo),personNationalCode:u(a.personNationalCode),pensionaryStatusID:u(a.pensionaryStatusID),maritalStatusID:u(a.maritalStatusID),educationTypeID:u(a.educationTypeID),universityID:u(a.universityID),personPhone:u(a.personPhone),personCellPhone:u(a.personCellPhone),personCellPhone2:u(a.personCellPhone2),personRegion:parseInt(u(a.personRegion))||null,personArea:parseInt(u(a.personArea))||null,personCountryID:u(a.personCountryID),personCityID:u(a.personCityID),personStateID:u(a.personStateID),personPostalCode:u(a.personPostalCode),backupPhone:u(a.backupPhone),backupCellphone:u(a.backupCellphone),personBirthDate:D,personMaritalDate:ss,selfEmployeeStartDate:xs,selfEmployeeEndDate:gs,pensionaryStartDate:js}).unwrap();console.log(nn),l(!1),b(),ne.success(nn.message,{autoClose:2e3})}catch(D){console.log(D),ne.error(((k=D==null?void 0:D.data)==null?void 0:k.message)||D.error,{autoClose:2e3})}};return Rs([O,v,f,P,p],[F,X,m,A,ee]),e.jsx(e.Fragment,{children:os||ts?e.jsx(Ce,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ye,{color:"primary"})}):e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:_(vn),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"relationshipWithParentID",control:t,rules:{required:!0},render:({field:{onChange:k}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:ue,options:Me,onChange:D=>k(D?D.value:null),value:Me.find(D=>D.value===(a==null?void 0:a.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Ee||qe})}),e.jsxs("label",{className:a!=null&&a.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),c.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personFirstName&&e.jsx("span",{className:"error-form",children:c.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.personFirstName)||"",name:"personFirstName",id:"personFirstName2",required:!0,...r("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName2",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personLastName&&e.jsx("span",{className:"error-form",children:c.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.personLastName)||"",name:"personLastName",id:"personLastName1",required:!0,...r("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personNationalCode&&e.jsx("span",{className:"error-form",children:c.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(a==null?void 0:a.personNationalCode)??"",name:"personNationalCode",id:"personNationalCode2",required:!0,...r("personNationalCode",{required:"کد ملی را وارد کنید",minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personCertificateNo&&e.jsx("span",{className:"error-form",children:c.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(a==null?void 0:a.personCertificateNo)??"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,...r("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificateNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personFatherName&&e.jsx("span",{className:"error-form",children:c.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,...r("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:Le(U),onChange:ve,format:"jYYYY/jMM/jDD",onOpenChange:Ks,suffixIcon:e.jsx(pe,{color:"action"}),open:i,style:he,wrapperStyle:me,pickerProps:{ref:O}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:E,onChange:Fe,format:"jYYYY/jMM/jDD",onOpenChange:In,suffixIcon:e.jsx(pe,{color:"action"}),open:L,style:he,wrapperStyle:me,pickerProps:{ref:v}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ عقد"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personBirthPlace&&e.jsx("span",{className:"error-form",children:c.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.personBirthPlace)||"",name:"personBirthPlace",id:"personBirthPlace1",required:!0,...r("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"pensionaryStatusID",control:t,rules:{required:!0},render:({field:{onChange:k}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:ue,options:ds,onChange:D=>k(D?D.value:null),value:ds.find(D=>D.value===(a==null?void 0:a.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت وابسته"]}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:$e||ze})}),e.jsxs("label",{className:a!=null&&a.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت وابسته"]}),c.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:"وضعیت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:J,defaultValue:null,onChange:Se,onOpenChange:es,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(pe,{color:"action"}),open:se,style:he,wrapperStyle:me,pickerProps:{ref:p}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"maritalStatusID",control:t,render:({field:{onChange:k}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:ue,options:ms,onChange:D=>k(D?D.value:null),value:ms.find(D=>D.value===(a==null?void 0:a.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Ye||Ge})}),e.jsx("label",{className:a!=null&&a.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"educationTypeID",control:t,render:({field:{onChange:k}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:ue,options:hs,onChange:D=>k(D?D.value:null),value:hs.find(D=>D.value===(a==null?void 0:a.educationTypeID)),name:"educationTypeID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"مدرک تحصیلی"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Ke||We})}),e.jsx("label",{className:a!=null&&a.educationTypeID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"مدرک تحصیلی"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.educationTypeCaption&&e.jsx("span",{className:"error-form",children:c.educationTypeCaption.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.educationTypeCaption)||"",name:"educationTypeCaption",id:"educationTypeCaption",required:!0,...r("educationTypeCaption",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"educationTypeCaption",children:"عنوان مدرک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"universityID",control:t,render:({field:{onChange:k}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:ue,options:bs,onChange:D=>k(D?D.value:null),value:bs.find(D=>D.value===(a==null?void 0:a.universityID)),name:"universityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"دانشگاه"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Qe||Je})}),e.jsx("label",{className:a!=null&&a.universityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"دانشگاه"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.universityCaption&&e.jsx("span",{className:"error-form",children:c.universityCaption.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.universityCaption)||"",name:"universityCaption",id:"universityCaption",required:!0,...r("universityCaption",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"universityCaption",children:"واحد دانشگاهی"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personCellPhone&&e.jsx("span",{className:"error-form",children:c.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone",value:N(a==null?void 0:a.personCellPhone)??"",id:"personCellPhone1",required:!0,...r("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone1",children:"تلفن همراه ۱"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personCellPhone2&&e.jsx("span",{className:"error-form",children:c.personCellPhone2.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone2",value:N(a==null?void 0:a.personCellPhone2)??"",id:"personCellPhone22",required:!0,...r("personCellPhone2",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone22",children:"تلفن همراه ۲"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personPhone&&e.jsx("span",{className:"error-form",children:c.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPhone",value:N(a==null?void 0:a.personPhone)||"",id:"personPhone1",required:!0,...r("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"},maxLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone1",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personRegion&&e.jsx("span",{className:"error-form",children:c.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personRegion",value:N(a==null?void 0:a.personRegion)??"",id:"personRegion1",required:!0,...r("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personArea&&e.jsx("span",{className:"error-form",children:c.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personArea",value:N(a==null?void 0:a.personArea)??"",id:"personArea1",required:!0,...r("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCountryID",control:t,render:({field:{onChange:k}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:ue,options:R,onChange:D=>k(D?D.value:null),value:R.find(D=>D.value===(a==null?void 0:a.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Pe||rs})}),e.jsx("label",{className:a!=null&&a.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personStateID",control:t,render:({field:{onChange:k}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:ue,options:C,onChange:D=>k(D?D.value:null),value:C.find(D=>D.value===(a==null?void 0:a.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:I||ge})}),e.jsx("label",{className:a!=null&&a.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCityID",control:t,render:({field:{onChange:k}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:ue,options:Ie,onChange:D=>k(D?D.value:null),value:Ie.find(D=>D.value===(a==null?void 0:a.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Xe||us})}),e.jsx("label",{className:a!=null&&a.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personPostalCode&&e.jsx("span",{className:"error-form",children:c.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPostalCode",value:N(a==null?void 0:a.personPostalCode)??"",id:"personPostalCode1",required:!0,...r("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personSpecialDisease&&e.jsx("span",{className:"error-form",children:c.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personSpecialDisease",value:(a==null?void 0:a.personSpecialDisease)||"",id:"personSpecialDisease1",required:!0,...r("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[c.personAddress&&e.jsx("span",{className:"error-form",children:c.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personAddress",value:(a==null?void 0:a.personAddress)||"",id:"personAddress1",required:!0,...r("personAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[c.personDescription&&e.jsx("span",{className:"error-form",children:c.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",name:"personDescription",value:(a==null?void 0:a.personDescription)||"",id:"personDescription1",required:!0,...r("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription1",children:"توضیحات"})]})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(Nn,{statusHistoryTableData:s,isLoading:Te,isFetching:as,handleRefresh:Dn}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:"اطلاعات خویش فرمایی"})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form col-span-2",children:[c.selfEmployeeTypeName&&e.jsx("span",{className:"error-form",children:c.selfEmployeeTypeName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"selfEmployeeTypeName",value:(a==null?void 0:a.selfEmployeeTypeName)||"",id:"selfEmployeeTypeName",required:!0,...r("selfEmployeeTypeName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"selfEmployeeTypeName",children:"وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:q,onChange:B,format:"jYYYY/jMM/jDD",onOpenChange:bn,suffixIcon:e.jsx(pe,{color:"action"}),open:n,style:he,wrapperStyle:me,pickerProps:{ref:f}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ شروع"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:$,onChange:y,format:"jYYYY/jMM/jDD",onOpenChange:Cn,suffixIcon:e.jsx(pe,{color:"action"}),open:T,style:he,wrapperStyle:me,pickerProps:{ref:P}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ پایان"})]}),e.jsxs("div",{className:"inputBox__form col-span-4",children:[c.selfEmployeeDesc&&e.jsx("span",{className:"error-form",children:c.selfEmployeeDesc.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",name:"selfEmployeeDesc",value:(a==null?void 0:a.selfEmployeeDesc)||"",id:"selfEmployeeDesc",required:!0,...r("selfEmployeeDesc",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف و اعداد فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"selfEmployeeDesc",children:"توضیحات"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:"اطلاعات پشتیبان"})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[c.backupFirstName&&e.jsx("span",{className:"error-form",children:c.backupFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupFirstName",value:(a==null?void 0:a.backupFirstName)||"",id:"backupFirstName1",required:!0,...r("backupFirstName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupFirstName1",children:"نام"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.backupLastName&&e.jsx("span",{className:"error-form",children:c.backupLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupLastName",value:(a==null?void 0:a.backupLastName)||"",id:"backupLastName1",required:!0,...r("backupLastName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupLastName1",children:"نام خانوادگی"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.backupRelation&&e.jsx("span",{className:"error-form",children:c.backupRelation.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupRelation",value:(a==null?void 0:a.backupRelation)||"",id:"backupRelation",required:!0,...r("backupRelation",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupRelation",children:"نسبت"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.backupPhone&&e.jsx("span",{className:"error-form",children:c.backupPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupPhone",value:N(a==null?void 0:a.backupPhone)??"",id:"backupPhone",required:!0,...r("backupPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupPhone",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.backupCellphone&&e.jsx("span",{className:"error-form",children:c.backupCellphone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupCellphone",value:N(a==null?void 0:a.backupCellphone)??"",id:"backupCellphone",required:!0,...r("backupCellphone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن همراه باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه ثابت باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه ثابت باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupCellphone",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[c.backupAddress&&e.jsx("span",{className:"error-form",children:c.backupAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupAddress",value:(a==null?void 0:a.backupAddress)||"",id:"backupAddress",required:!0,...r("backupAddress",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف و اعداد فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupAddress",children:"نشانی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(be,{dir:"ltr",endIcon:e.jsx(Ds,{}),variant:"contained",onClick:_,type:"submit",loading:le,color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})})}function ut(){const[l,g]=o.useState({}),[b,O]=o.useState([]),[v,f]=o.useState(!1),[P,p]=o.useState(!1),[U,j]=o.useState(!1),[E,d]=o.useState(""),[q,M]=o.useState(""),[$,{isLoading:H}]=it(),J=ps(),i=new URLSearchParams(J.search).get("personID"),{data:F,isSuccess:L,isLoading:X,isFetching:n,refetch:m,error:T}=tt(i);o.useEffect(()=>{if(m(),L){const r=F.itemList.map((h,S)=>({id:h.personID,relatedRowNum:S+1,pensionaryID:h.pensionaryID,relatedBirthDate:h.personBirthDate,relatedNtionalCode:h.personNationalCode,relatedFirstName:h.personFirstName,relatedLastName:h.personLastName,relatedStatus:h.pensionaryIsUnderGauranteeText,relation:h.relationshipWithParentName}));O(r)}},[L,F,m]),o.useEffect(()=>{var r;T&&(console.log(T),ne.error(((r=T==null?void 0:T.data)==null?void 0:r.message)||T.error,{autoClose:2e3}))},[T]);const A=()=>{m()},se=()=>{f(!0)},ee=()=>{p(!0)},s=()=>{j(!0)},W=async()=>{var r;try{const h=await $({pensionaryID:q}).unwrap();m(),j(!1),ne.success(h.message,{autoClose:2e3})}catch(h){console.log(h),ne.error(((r=h==null?void 0:h.data)==null?void 0:r.message)||h.error,{autoClose:2e3})}},_=o.useMemo(()=>[{accessorKey:"relatedRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:r})=>e.jsx("div",{children:N(r)})},{accessorKey:"relatedNtionalCode",header:"کد ملی",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:N(r)})},{accessorKey:"relatedFirstName",header:"نام",size:20},{accessorKey:"relatedLastName",header:"نام خانوادگی",size:20},{accessorKey:"relatedStatus",header:"وضعیت",size:20},{accessorKey:"relatedBirthDate",header:"تاریخ تولد",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:N(Is(r))})},{accessorKey:"relation",header:"نسبت",size:20},{accessorKey:"editRelatedAction",header:"ویرایش",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:r})=>e.jsx(Ne,{title:`ویرایش "${r.original.relatedFirstName} ${r.original.relatedLastName}"`,children:e.jsx(oe,{color:"success",onClick:ee,sx:{padding:"0"},children:e.jsx(Ls,{})})})},{accessorKey:"deleteRelatedAction",header:"حذف",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:r})=>e.jsx(Ne,{title:`حذف "${r.original.relatedFirstName} ${r.original.relatedLastName}"`,children:e.jsx(oe,{color:"error",onClick:s,sx:{padding:"0"},children:e.jsx(hn,{})})})}],[]),c=vs({...Ts,columns:_,data:b,muiTableBodyRowProps:({row:r})=>({onClick:()=>g(()=>({[r.id]:!0})),selected:l[r.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsxs(Ce,{children:[n?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ye,{size:20,value:100})}):e.jsx(Ne,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"info",onClick:A,children:e.jsx(As,{fontSize:"small"})})})}),n?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ye,{size:20,value:100})}):e.jsx(Ne,{title:e.jsx("span",{style:{fontFamily:"sahel",fontSize:"0.8rem"},children:"ایجاد وابسته"}),children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"success",onClick:se,children:e.jsx(xn,{fontSize:"small"})})})})]}),muiPaginationProps:{shape:"rounded",showRowsPerPage:!1,size:"small",renderItem:r=>e.jsx(Ss,{...r,page:N(r.page),slots:{previous:Bs,next:_s,first:ks,last:Os}})},getRowId:r=>r.id,onRowSelectionChange:g,state:{rowSelection:l}});return o.useEffect(()=>{const r=Object.keys(c.getState().rowSelection)[0];if(r){const h=ln(b,r);d(r),M(h==null?void 0:h.pensionaryID)}},[c,l,b]),e.jsx(e.Fragment,{children:X||n?e.jsx("div",{className:"skeleton-lg",children:e.jsx(Gs,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsxs(e.Fragment,{children:[v?e.jsx(is,{title:"ایجاد وابسته",closeModal:()=>f(!1),children:e.jsx(ct,{setShowCreateRelatedModal:f,refetch:m})}):P&&E?e.jsx(is,{title:"ویرایش اطلاعات وابسته",closeModal:()=>p(!1),children:e.jsx(pt,{setShowEditRelatedModal:p,personID:E,refetch:m})}):U?e.jsxs(is,{title:"حذف وابسته",closeModal:()=>j(!1),children:[e.jsx("p",{className:"paragraph-primary",children:"آیا از حذف این وابسته اطمینان دارید؟"}),e.jsxs("div",{className:"flex-row flex-center",children:[e.jsx(be,{dir:"ltr",endIcon:e.jsx(rn,{}),onClick:W,loading:H,variant:"contained",color:"success",children:e.jsx("span",{children:"بله"})}),e.jsx(Js,{dir:"ltr",endIcon:e.jsx(Xs,{}),onClick:()=>j(!1),variant:"contained",color:"error",children:e.jsx("span",{children:"خیر"})})]})]}):null,e.jsx(Ps,{table:c})]})})}const dt=on.injectEndpoints({endpoints:l=>({getHeirListByParentPersonID:l.query({query:g=>({url:`${Ns}/GetHeirListByParentPersonID?parentPersonID=${g}`})}),getHeir:l.query({query:g=>({url:`${Ns}/GetHeir?personID=${g}`})}),insertHeir:l.mutation({query:g=>({url:`${Ns}/InsertHeir`,method:"POST",body:g})}),updateHeir:l.mutation({query:g=>({url:`${Ns}/UpdateHeir`,method:"POST",body:g})}),updateHeirAccount:l.mutation({query:({token:g,data:b})=>({url:`${Ns}/UpdateHeirAccount`,method:"POST",body:b,headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`}})}),removeHeir:l.mutation({query:({pensionaryID:g})=>({url:`${Ns}/RemoveHeir?pensionaryID=${g}`,method:"POST"})})})}),{useGetHeirListByParentPersonIDQuery:mt,useLazyGetHeirListByParentPersonIDQuery:oo,useGetHeirQuery:ht,useRemoveHeirMutation:xt,useUpdateHeirMutation:gt,useInsertHeirMutation:jt}=dt;function Nt({setShowEditHeirModal:l,personID:g,refetch:b}){const O=o.useRef(null),v=o.useRef(null),f=o.useRef(null),[P,p]=o.useState([]),[U,j]=o.useState([]),[E,d]=o.useState(null),[q,M]=o.useState(!1);o.useState(null);const[$,H]=o.useState(null),[J,Z]=o.useState(null),[i,F]=o.useState(!1),[L,X]=o.useState(!1),{handleSubmit:n,formState:{errors:m},control:T,register:A,watch:se,setValue:ee}=cs(),s=se(),[W,{isLoading:_}]=gt(),c=Fs(),r=new URLSearchParams(location.search).get("personID"),[h,{isLoading:S,isFetching:a}]=en(),{data:V,isSuccess:le,isLoading:ue,isFetching:ns,refetch:de,error:ae}=sn(g),{data:ie,isSuccess:Te,isLoading:as,isFetching:ke,error:re,refetch:De}=ht(g);o.useEffect(()=>{if(de(),le){const B=V==null?void 0:V.itemList.map((y,Se)=>({id:y.pensionaryID,isActive:y.pensionaryIsActive,pensionaryStatusRowNum:Se+1,pensionaryStatusName:y.pensionaryStatusName||"-",pensionaryStartdate:Le(y.pensionaryStartdate)||"-"}));j(B)}return()=>{j([])}},[de,le,V]),o.useEffect(()=>{De(),Te&&Object.keys(ie).forEach(B=>{ee(B,ie[B])})},[Te,ie,De,ee]),o.useEffect(()=>{var B;re&&re.status!=="FETCH_ERROR"&&ne.error(((B=re==null?void 0:re.data)==null?void 0:B.message)||re.error,{autoClose:2e3})},[re]),o.useEffect(()=>{var B;ae&&(console.log(ae),ne.error(((B=ae==null?void 0:ae.data)==null?void 0:B.message)||ae.error,{autoClose:2e3}))},[ae]);const{relationships:Ae,relationshipIsLoading:ts,relationshipIsFetching:os}=Ys(),{lookUpItems:Ue,lookUpItemsIsLoading:xe,lookUpItemsIsFetching:ls}=Q({lookUpType:"MaritialStatus"}),{lookUpItems:Ee,lookUpItemsIsLoading:qe,lookUpItemsIsFetching:we}=Q({lookUpType:"Country"}),{lookUpItems:$e,lookUpItemsIsLoading:ze,lookUpItemsIsFetching:He}=Q({lookUpType:"State"}),{lookUpItems:Ye,lookUpItemsIsLoading:Ge,lookUpItemsIsFetching:Oe}=Q({lookUpType:"City"}),{pensionaryStatus:Ke,pensionaryStatusIsLoading:We,pensionaryStatusIsFetching:Ve}=Ms({pensionaryStatusCategory:"H"}),{lookUpItems:Qe,lookUpItemsIsLoading:Je,lookUpItemsIsFetching:Ze}=Q({lookUpType:"Bank"}),Pe=G(Ae,"relationshipID","relationshipName"),rs=G(Ue,"lookUpID","lookUpName"),w=G(Ee,"lookUpID","lookUpName"),I=G($e,"lookUpID","lookUpName"),ge=G(Ye,"lookUpID","lookUpName"),je=G(Ke,"pensionaryStatusID","pensionaryStatusName"),Xe=G(Qe,"lookUpID","lookUpName"),us=G(P,"lookUpID","lookUpName"),Me=o.useCallback(async B=>{try{const y=await h({lookUpType:"BankBranch",lookUpParentID:B}).unwrap();p(y.itemList)}catch(y){console.log(y)}},[h,p]);o.useEffect(()=>{s.bankID&&Me(s.bankID)},[s.bankID,Me]),o.useEffect(()=>{s.bankID&&Me(s.bankID)},[s.bankID,Me]);const ds=B=>{d(B),M(!1)},ms=B=>{Z(B),F(!1)},hs=B=>{H(B),X(!1)},bs=B=>{X(B)},R=B=>{M(B)},C=B=>{F(B)};o.useEffect(()=>{d(Le(s==null?void 0:s.personBirthDate))},[s==null?void 0:s.personBirthDate]),o.useEffect(()=>{Z(Le(s==null?void 0:s.personBaseFinishDate))},[s==null?void 0:s.personBaseFinishDate]);const Ie=()=>{de()},ve=async()=>{var B;try{let y,Se,es;E?(y=new Date(E),y.setMinutes(y.getMinutes()-y.getTimezoneOffset())):y=null,$?(Se=new Date($),Se.setMinutes(Se.getMinutes()-Se.getTimezoneOffset())):Se=null,J?(es=new Date(J),es.setMinutes(es.getMinutes()-es.getTimezoneOffset())):es=null;const Ks=await W({...s,relationshipWithParentID:u(s==null?void 0:s.relationshipWithParentID),personNationalCode:u(s==null?void 0:s.personNationalCode),personCertificateNo:u(s==null?void 0:s.personCertificateNo),personBirthDate:y,maritalStatusID:u(s==null?void 0:s.maritalStatusID),personPhone:u(s==null?void 0:s.personPhone),personCellPhone:u(s==null?void 0:s.personCellPhone),personRegion:parseInt(u(s==null?void 0:s.personRegion))||null,personArea:parseInt(u(s==null?void 0:s.personArea))||null,personCountryID:u(s==null?void 0:s.personCountryID),personStateID:u(s==null?void 0:s.personStateID),personCityID:u(s==null?void 0:s.personCityID),personPostalCode:u(s==null?void 0:s.personPostalCode),pensionaryStatusID:u(s==null?void 0:s.pensionaryStatusID),personBaseFinishDate:es,bankID:u(s==null?void 0:s.bankID),bankBranchID:u(s==null?void 0:s.bankBranchID),accountNo:u(s==null?void 0:s.accountNo),insuranceCoef:parseFloat(u(s==null?void 0:s.insuranceCoef))||0,insuranceAmount:parseFloat(u(s==null?void 0:s.insuranceAmount))||0,ledgerCode:parseInt(u(s.ledgerCode))||0,parentPersonID:r,pensionaryStartDate:Se}).unwrap();l(!1),b(),ne.success(Ks.message,{autoClose:2e3})}catch(y){console.log(y),ne.error(((B=y==null?void 0:y.data)==null?void 0:B.message)||y.error,{auroClose:2e3})}};return Rs([O,v,f],[M,F,X]),e.jsx(e.Fragment,{children:as||ke?e.jsx(Ce,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ye,{color:"primary"})}):e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:n(ve),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"relationshipWithParentID",control:T,rules:{required:!0},render:({field:{onChange:B}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:c,options:Pe,onChange:y=>B(y?y.value:null),value:Pe.find(y=>y.value===(s==null?void 0:s.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:ts||os})}),e.jsxs("label",{className:s!=null&&s.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),m.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personFirstName&&e.jsx("span",{className:"error-form",children:m.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personFirstName)||"",name:"personFirstName",id:"personFirstName1",required:!0,...A("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName1",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personLastName&&e.jsx("span",{className:"error-form",children:m.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personLastName",value:(s==null?void 0:s.personLastName)||"",id:"personLastName1",required:!0,...A("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personNationalCode&&e.jsx("span",{className:"error-form",children:m.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.personNationalCode)??"",name:"personNationalCode",id:"personNationalCode2",required:!0,...A("personNationalCode",{required:"کد ملی را وارد کنید",minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personCertificateNo&&e.jsx("span",{className:"error-form",children:m.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.personCertificateNo)||"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,...A("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificatetNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personFatherName&&e.jsx("span",{className:"error-form",children:m.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,...A("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:E,onChange:ds,format:"jYYYY/jMM/jDD",onOpenChange:R,suffixIcon:e.jsx(pe,{color:"action"}),open:q,style:he,wrapperStyle:me,pickerProps:{ref:O}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personBirthPlace&&e.jsx("span",{className:"error-form",children:m.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personBirthPlace",value:(s==null?void 0:s.personBirthPlace)||"",id:"personBirthPlace1",required:!0,...A("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"maritalStatusID",control:T,render:({field:{onChange:B}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:c,options:rs,onChange:y=>B(y?y.value:null),value:rs.find(y=>y.value===(s==null?void 0:s.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:xe||ls})}),e.jsx("label",{className:s!=null&&s.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personPhone&&e.jsx("span",{className:"error-form",children:m.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.personPhone)||"",name:"personPhone",id:"personPhone11",required:!0,...A("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone11",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personCellPhone&&e.jsx("span",{className:"error-form",children:m.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.personCellPhone)||"",name:"personCellPhone",id:"personCellPhone222",required:!0,...A("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone222",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personArea&&e.jsx("span",{className:"error-form",children:m.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.personArea)||"",name:"personArea",id:"personArea1",required:!0,...A("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personRegion&&e.jsx("span",{className:"error-form",children:m.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personRegion",value:N(s==null?void 0:s.personRegion)||"",id:"personRegion1",required:!0,...A("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCountryID",control:T,render:({field:{onChange:B}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:c,options:w,onChange:y=>B(y?y.value:null),value:w.find(y=>y.value===(s==null?void 0:s.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:qe||we})}),e.jsx("label",{className:s!=null&&s.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personStateID",control:T,render:({field:{onChange:B}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:c,options:I,onChange:y=>B(y?y.value:null),value:I.find(y=>y.value===(s==null?void 0:s.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:ze||He})}),e.jsx("label",{className:s!=null&&s.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCityID",control:T,render:({field:{onChange:B}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:c,options:ge,onChange:y=>B(y?y.value:null),value:ge.find(y=>y.value===(s==null?void 0:s.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Ge||Oe})}),e.jsx("label",{className:s!=null&&s.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personPostalCode&&e.jsx("span",{className:"error-form",children:m.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.personPostalCode)||"",name:"personPostalCode",id:"personPostalCode1",required:!0,...A("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.personSpecialDisease&&e.jsx("span",{className:"error-form",children:m.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personSpecialDisease)||"",name:"personSpecialDisease",id:"personSpecialDisease1",required:!0,...A("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[m.personAddress&&e.jsx("span",{className:"error-form",children:m.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.personAddress)||"",name:"personAddress",id:"personAddress1",required:!0,...A("personAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[m.personDescription&&e.jsx("span",{className:"error-form",children:m.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.personDescription)||"",name:"personDescription",id:"personDescription",required:!0,...A("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription",children:"توضیحات"})]})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات وظیفه بگیری "})}),e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"pensionaryStatusID",control:T,rules:{required:!0},render:({field:{onChange:B}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:c,options:je,onChange:y=>B(y?y.value:null),value:je.find(y=>y.value===(s==null?void 0:s.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:We||Ve})}),e.jsxs("label",{className:s!=null&&s.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),m.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:$,defaultValue:null,onChange:hs,onOpenChange:bs,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(pe,{color:"action"}),open:L,style:he,wrapperStyle:me,pickerProps:{ref:f}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:J,onChange:ms,format:"jYYYY/jMM/jDD",onOpenChange:C,suffixIcon:e.jsx(pe,{color:"action"}),open:i,style:he,wrapperStyle:me,pickerProps:{ref:v}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",disabled:!0,value:N(s==null?void 0:s.heirID)||"-",name:"heirID",id:"heirID",...A("heirID")}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"heirID",children:"شماره وظیفه بگیری"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",disabled:!0,value:N(Is(s==null?void 0:s.pensionaryStartDate))||"-",name:"pensionaryStartDate",id:"pensionaryStartDate",...A("pensionaryStartDate")}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"pensionaryStartDate",children:"تاریخ وظیفه بگیری"})]})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(Nn,{statusHistoryTableData:U,isLoading:ue,isFetching:ns,handleRefresh:Ie}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات بانکی وظیفه بگیر "})}),e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"bankID",control:T,render:({field:{onChange:B}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:c,options:Xe,onChange:y=>B(y?y.value:null),value:Xe.find(y=>y.value===(s==null?void 0:s.bankID)),id:"bankID",name:"bankID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"بانک"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Je||Ze})}),e.jsx("label",{htmlFor:"bankID",className:s!=null&&s.bankID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"بانک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"bankBranchID",control:T,render:({field:{onChange:B}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:c,options:us,onChange:y=>B(y?y.value:null),isDisabled:S||a||!s.bankID,value:us.find(y=>y.value===(s==null?void 0:s.bankBranchID))||null,id:"bankBranchID",name:"bankBranchID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شعبه"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:S||a})}),e.jsx("label",{htmlFor:"bankBranchID",className:s!=null&&s.bankBranchID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شعبه"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.accountNo&&e.jsx("span",{className:"error-form",children:m.accountNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.accountNo)||"",name:"accountNo",id:"accountNoHeir",required:!0,...A("accountNo",{pattern:{value:/^[۰-۹0-9]+$/,message:"شماره حساب باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"accountNoHeir",children:"شماره حساب"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.ledgerCode&&e.jsx("span",{className:"error-form",children:m.ledgerCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.ledgerCode)||"",name:"ledgerCode",id:"ledgerCodeHeir",required:!0,...A("ledgerCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"ردیف ورثه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"ledgerCodeHeir",children:"ردیف ورثه"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.insuranceCoef&&e.jsx("span",{className:"error-form",children:m.insuranceCoef.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.insuranceCoef)||"",name:"insuranceCoef",id:"insuranceCoefHeir",required:!0,...A("insuranceCoef",{pattern:{value:/^[۰-۹0-9]+([.,][۰-۹0-9]+)?$/,message:"از اعداد یا اعشار استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceCoefHeir",children:"ضریب بیمه"})]}),e.jsxs("div",{className:"inputBox__form",children:[m.insuranceAmount&&e.jsx("span",{className:"error-form",children:m.insuranceAmount.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(s==null?void 0:s.insuranceAmount)||"",name:"insuranceAmount",id:"insuranceAmountHeir",required:!0,...A("insuranceAmount",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceAmountHeir",children:"بیمه تبعی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(be,{dir:"ltr",endIcon:e.jsx(Ds,{}),onClick:n,type:"submit",loading:_,variant:"contained",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})})}function ft({setShowCreateHeirModal:l,refetch:g}){const b=o.useRef(null),O=o.useRef(null),v=o.useRef(null),[f,P]=o.useState(null),[p,U]=o.useState(!1),[j,E]=o.useState(null),[d,q]=o.useState(null),[M,$]=o.useState(!1),[H,J]=o.useState(!1),{handleSubmit:Z,formState:{errors:i},control:F,register:L,watch:X}=cs(),n=X(),[m,{isLoading:T}]=jt(),[A,se]=o.useState([]),ee=ps(),W=new URLSearchParams(ee.search).get("personID"),_=Fs(),[c,{isLoading:t,isFetching:r}]=en(),{relationships:h,relationshipIsLoading:S,relationshipIsFetching:a}=Ys(),{lookUpItems:V,lookUpItemsIsLoading:le,lookUpItemsIsFetching:ue}=Q({lookUpType:"MaritialStatus"}),{lookUpItems:ns,lookUpItemsIsLoading:de,lookUpItemsIsFetching:ae}=Q({lookUpType:"Country"}),{lookUpItems:ie,lookUpItemsIsLoading:Te,lookUpItemsIsFetching:as}=Q({lookUpType:"State"}),{lookUpItems:ke,lookUpItemsIsLoading:re,lookUpItemsIsFetching:De}=Q({lookUpType:"City"}),{pensionaryStatus:Ae,pensionaryStatusIsLoading:ts,pensionaryStatusIsFetching:os}=Ms({pensionaryStatusCategory:"H"}),{lookUpItems:Ue,lookUpItemsIsLoading:xe,lookUpItemsIsFetching:ls}=Q({lookUpType:"Bank"}),Ee=G(h,"relationshipID","relationshipName"),qe=G(V,"lookUpID","lookUpName"),we=G(ns,"lookUpID","lookUpName"),$e=G(Ae,"pensionaryStatusID","pensionaryStatusName"),ze=G(ie,"lookUpID","lookUpName"),He=G(ke,"lookUpID","lookUpName"),Ye=G(Ue,"lookUpID","lookUpName"),Ge=G(A,"lookUpID","lookUpName"),Oe=o.useCallback(async w=>{try{const I=await c({lookUpType:"BankBranch",lookUpParentID:u(w)}).unwrap();se(I.itemList)}catch(I){console.log(I)}},[c,se]);o.useEffect(()=>{n.bankID&&Oe(n.bankID)},[n.bankID,Oe]);const Ke=w=>{P(w),U(!1)},We=w=>{q(w),$(!1)},Ve=w=>{E(w),J(!1)},Qe=w=>{J(w)},Je=w=>{U(w)},Ze=w=>{$(w)},Pe=async()=>{var w;try{let I,ge,je;f?(I=new Date(f),I.setMinutes(I.getMinutes()-I.getTimezoneOffset())):I=null,j?(je=new Date(j),je.setMinutes(je.getMinutes()-je.getTimezoneOffset())):je=null,d?(ge=new Date(d),ge.setMinutes(ge.getMinutes()-ge.getTimezoneOffset())):ge=null;const Xe=await m({...n,relationshipWithParentID:u(n==null?void 0:n.relationshipWithParentID),personNationalCode:u(n==null?void 0:n.personNationalCode),personCertificateNo:u(n==null?void 0:n.personCertificateNo),personBirthDate:I,maritalStatusID:u(n==null?void 0:n.maritalStatusID),personPhone:u(n==null?void 0:n.personPhone),personCellPhone:u(n==null?void 0:n.personCellPhone),personRegion:parseInt(u(n==null?void 0:n.personRegion))||null,personArea:parseInt(u(n==null?void 0:n.personArea))||null,personCountryID:u(n==null?void 0:n.personCountryID),personStateID:u(n==null?void 0:n.personStateID),personCityID:u(n==null?void 0:n.personCityID),personPostalCode:u(n==null?void 0:n.personPostalCode),pensionaryStatusID:u(n==null?void 0:n.pensionaryStatusID),personBaseFinishDate:ge,bankID:u(n==null?void 0:n.bankID),bankBranchID:u(n==null?void 0:n.bankBranchID),accountNo:u(n==null?void 0:n.accountNo),insuranceCoef:parseFloat(u(n==null?void 0:n.insuranceCoef))||0,insuranceAmount:parseFloat(u(n==null?void 0:n.insuranceAmount))||0,ledgerCode:parseInt(u(n.ledgerCode))||0,parentPersonID:W,pensionaryStartDate:je}).unwrap();l(!1),g(),ne.success(Xe.message,{autoClose:2e3})}catch(I){console.log(I),ne.error(((w=I==null?void 0:I.data)==null?void 0:w.message)||I.error,{autoClose:2e3})}};return Rs([b,O],[U,$]),e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:Z(Pe),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"relationshipWithParentID",control:F,rules:{required:!0},render:({field:{onChange:w}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:_,options:Ee,onChange:I=>w(I?I.value:null),value:Ee.find(I=>I.value===(n==null?void 0:n.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:S||a})}),e.jsxs("label",{className:n!=null&&n.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),i.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personFirstName&&e.jsx("span",{className:"error-form",children:i.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personFirstName",value:(n==null?void 0:n.personFirstName)||"",id:"personFirstName1",required:!0,...L("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName1",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personLastName&&e.jsx("span",{className:"error-form",children:i.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personLastName)||"",name:"personLastName",id:"personLastName1",required:!0,...L("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personNationalCode&&e.jsx("span",{className:"error-form",children:i.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personNationalCode",value:N(n==null?void 0:n.personNationalCode)||"",id:"personNationalCode2",required:!0,...L("personNationalCode",{required:"کد ملی را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personCertificateNo&&e.jsx("span",{className:"error-form",children:i.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(n==null?void 0:n.personCertificateNo)||"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,...L("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificateNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personFatherName&&e.jsx("span",{className:"error-form",children:i.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,...L("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:f,onChange:Ke,format:"jYYYY/jMM/jDD",onOpenChange:Je,suffixIcon:e.jsx(pe,{color:"action"}),open:p,style:he,wrapperStyle:me,pickerProps:{ref:b}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personBirthPlace&&e.jsx("span",{className:"error-form",children:i.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personBirthPlace)||"",name:"personBirthPlace",id:"personBirthPlace1",required:!0,...L("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"maritalStatusID",control:F,render:({field:{onChange:w}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:_,options:qe,onChange:I=>w(I?I.value:null),value:qe.find(I=>I.value===(n==null?void 0:n.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:le||ue})}),e.jsx("label",{className:n!=null&&n.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personPhone&&e.jsx("span",{className:"error-form",children:i.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(n==null?void 0:n.personPhone)||"",name:"personPhone",id:"personPhone11",required:!0,...L("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone11",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personCellPhone&&e.jsx("span",{className:"error-form",children:i.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone",value:N(n==null?void 0:n.personCellPhone)||"",id:"personCellPhone222",required:!0,...L("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone222",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personArea&&e.jsx("span",{className:"error-form",children:i.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(n==null?void 0:n.personArea),name:"personArea",id:"personArea1",required:!0,...L("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personRegion&&e.jsx("span",{className:"error-form",children:i.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(n==null?void 0:n.personRegion),name:"personRegion",id:"personRegion1",required:!0,...L("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCountryID",control:F,render:({field:{onChange:w}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:_,options:we,onChange:I=>w(I?I.value:null),value:we.find(I=>I.value===(n==null?void 0:n.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:de||ae})}),e.jsx("label",{className:n!=null&&n.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personStateID",control:F,render:({field:{onChange:w}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:_,options:ze,onChange:I=>w(I?I.value:null),value:ze.find(I=>I.value===(n==null?void 0:n.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:Te||as})}),e.jsx("label",{className:n!=null&&n.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCityID",control:F,render:({field:{onChange:w}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:_,options:He,onChange:I=>w(I?I.value:null),value:He.find(I=>I.value===(n==null?void 0:n.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:re||De})}),e.jsx("label",{className:n!=null&&n.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personPostalCode&&e.jsx("span",{className:"error-form",children:i.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPostalCode",value:N(n==null?void 0:n.personPostalCode)||"",id:"personPostalCode1",required:!0,...L("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personSpecialDisease&&e.jsx("span",{className:"error-form",children:i.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personSpecialDisease",value:(n==null?void 0:n.personSpecialDisease)||"",id:"personSpecialDisease1",required:!0,...L("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[i.personAddress&&e.jsx("span",{className:"error-form",children:i.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(n==null?void 0:n.personAddress)||"",name:"personAddress",id:"personAddress1",required:!0,...L("personAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[i.personDescription&&e.jsx("span",{className:"error-form",children:i.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",value:N(n==null?void 0:n.personDescription)||"",name:"personDescription",id:"personDescription",required:!0,...L("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription",children:"توضیحات"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات وظیفه بگیری "})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"pensionaryStatusID",control:F,rules:{required:!0},render:({field:{onChange:w}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:_,options:$e,onChange:I=>w(I?I.value:null),value:$e.find(I=>I.value===(n==null?void 0:n.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:ts||os})}),e.jsxs("label",{className:n!=null&&n.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),i.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:j,defaultValue:null,onChange:Ve,onOpenChange:Qe,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(pe,{color:"action"}),open:H,style:he,wrapperStyle:me,pickerProps:{ref:v}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(ce.InputDatePicker,{value:d,onChange:We,format:"jYYYY/jMM/jDD",onOpenChange:Ze,suffixIcon:e.jsx(pe,{color:"action"}),open:M,style:he,wrapperStyle:me,pickerProps:{ref:O}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ مبنای قطع سهم"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات بانکی وظیفه بگیر "})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"bankID",control:F,render:({field:{onChange:w}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:_,options:Ye,onChange:I=>w(I?I.value:null),value:Ye.find(I=>I.value===(n==null?void 0:n.bankID)),id:"bankID",name:"bankID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"بانک"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:xe||ls})}),e.jsx("label",{htmlFor:"bankID",className:n!=null&&n.bankID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"بانک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"bankBranchID",control:F,render:({field:{onChange:w}})=>e.jsx(Y,{closeMenuOnSelect:!0,components:_,options:Ge,onChange:I=>w(I?I.value:null),isDisabled:t||r||!n.bankID,value:Ge.find(I=>I.value===(n==null?void 0:n.bankBranchID))||null,id:"bankBranchID",name:"bankBranchID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شعبه"}),noOptionsMessage:x.noOptionsMessage,loadingMessage:x.loadingMessage,styles:K,isLoading:t||r})}),e.jsx("label",{htmlFor:"bankBranchID",className:n!=null&&n.bankBranchID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شعبه"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.accountNo&&e.jsx("span",{className:"error-form",children:i.accountNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(n==null?void 0:n.accountNo)||"",name:"accountNo",id:"accountNoHeir",required:!0,...L("accountNo",{pattern:{value:/^[۰-۹0-9]+$/,message:"شماره حساب باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"accountNoHeir",children:"شماره حساب"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.ledgerCode&&e.jsx("span",{className:"error-form",children:i.ledgerCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:N(n==null?void 0:n.ledgerCode)||"",name:"ledgerCode",id:"ledgerCodeHeir",required:!0,...L("ledgerCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"ردیف ورثه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"ledgerCodeHeir",children:"ردیف ورثه"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.insuranceCoef&&e.jsx("span",{className:"error-form",children:i.insuranceCoef.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"insuranceCoef",value:N(n==null?void 0:n.insuranceCoef)||"",id:"insuranceCoefHeir",required:!0,...L("insuranceCoef",{pattern:{value:/^[۰-۹0-9]+([.,][۰-۹0-9]+)?$/,message:"از اعداد یا اعشار استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceCoefHeir",children:"ضریب بیمه"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.insuranceAmount&&e.jsx("span",{className:"error-form",children:i.insuranceAmount.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.insuranceAmount)||"",name:"insuranceAmount",id:"insuranceAmountHeir",required:!0,...L("insuranceAmount",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceAmountHeir",children:"بیمه تبعی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(be,{dir:"ltr",endIcon:e.jsx(Ds,{}),onClick:Z,type:"submit",loading:T,variant:"contained",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})}function yt(){const[l,g]=o.useState({}),[b,O]=o.useState([]),[v,f]=o.useState(!1),[P,p]=o.useState(!1),[U,j]=o.useState(!1),[E,d]=o.useState(""),[q,M]=o.useState(""),$=ps(),J=new URLSearchParams($.search).get("personID"),[Z,{isLoading:i}]=xt(),{data:F,isLoading:L,isSuccess:X,isFetching:n,error:m,refetch:T}=mt(J);o.useEffect(()=>{if(T(),X){const r=F.itemList.map((h,S)=>({id:h.personID,heirRowNum:S+1,pensionaryID:h.pensionaryID,personNationalCode:h.personNationalCode,personFirstName:h.personFirstName,personLastName:h.personLastName,pensionaryIsUnderGauranteeText:h.pensionaryIsUnderGauranteeText,personBirthDate:h.personBirthDate,relationshipWithParentName:h.relationshipWithParentName,parentPersonNationalCode:h.parentPersonNationalCode}));O(r)}},[X,F,T]),o.useEffect(()=>{var r;m&&(console.log(m),ne.error(((r=m==null?void 0:m.data)==null?void 0:r.message)||m.error,{autoClose:2e3}))},[m]);const A=()=>{T()},se=()=>{p(!0)},ee=()=>{f(!0)},s=()=>{j(!0)},W=async()=>{var r;try{const h=await Z({pensionaryID:q}).unwrap();j(!1),T(),ne.success(h.message,{autoClose:2e3})}catch(h){console.log(h),ne.error(((r=h==null?void 0:h.data)==null?void 0:r.message)||h.error,{autoClose:2e3})}},_=o.useMemo(()=>[{accessorKey:"heirRowNum",header:"ردیف",size:20,enableColumnActions:!1,enableSorting:!1,Cell:({renderedCellValue:r})=>e.jsx("div",{children:N(r)})},{accessorKey:"personNationalCode",header:"کد ملی",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:N(r)})},{accessorKey:"personFirstName",header:"نام",size:20},{accessorKey:"personLastName",header:"نام خانوادگی",size:20},{accessorKey:"pensionaryIsUnderGauranteeText",header:"وضعیت",size:20},{accessorKey:"personBirthDate",header:"تاریخ تولد",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:N(Is(r))})},{accessorKey:"relationshipWithParentName",size:20,header:"نسبت"},{accessorKey:"parentPersonNationalCode",header:"شماره پرونده",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:N(r)})},{accessorKey:"editHeirAction",header:"ویرایش",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:r})=>e.jsx(Ne,{title:`ویرایش "${r.original.personFirstName} ${r.original.personLastName}"`,children:e.jsx(oe,{color:"success",onClick:ee,sx:{padding:"0"},children:e.jsx(Ls,{})})})},{accessorKey:"deleteHeirAction",header:"حذف",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:r})=>e.jsx(Ne,{title:`حذف "${r.original.personFirstName} ${r.original.personLastName}"`,children:e.jsx(oe,{color:"error",onClick:s,sx:{padding:"0"},children:e.jsx(hn,{})})})}],[]),c=vs({...Ts,columns:_,data:b,muiTableBodyRowProps:({row:r})=>({onClick:()=>g(()=>({[r.id]:!0})),selected:l[r.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsxs(Ce,{children:[n?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ye,{size:20,value:100})}):e.jsx(Ne,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"info",onClick:A,children:e.jsx(As,{fontSize:"small"})})})}),n?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ye,{size:20,value:100})}):e.jsx(Ne,{title:e.jsx("span",{style:{fontFamily:"sahel",fontSize:"0.8rem"},children:"ایجاد موظف"}),children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"success",onClick:se,children:e.jsx(xn,{fontSize:"small"})})})})]}),muiPaginationProps:{shape:"rounded",showRowsPerPage:!1,size:"small",renderItem:r=>e.jsx(Ss,{...r,page:N(r.page),slots:{previous:Bs,next:_s,first:ks,last:Os}})},getRowId:r=>r.id,onRowSelectionChange:g,state:{rowSelection:l}});return o.useEffect(()=>{const r=Object.keys(c.getState().rowSelection)[0];if(r){const h=ln(b,r);d(r),M(h==null?void 0:h.pensionaryID)}},[c,l,b]),e.jsx(e.Fragment,{children:L||n?e.jsx("div",{className:"skeleton-lg",children:e.jsx(Gs,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsxs(e.Fragment,{children:[v&&E?e.jsx(is,{title:"ویرایش اطلاعات موظف",closeModal:()=>f(!1),children:e.jsx(Nt,{setShowEditHeirModal:f,personID:E,refetch:T})}):U?e.jsxs(is,{title:"حذف موظف",closeModal:()=>j(!1),children:[e.jsx("p",{className:"paragraph-primary",children:"آیا از حذف این موظف اطمینان دارید؟"}),e.jsxs("div",{className:"flex-row flex-center",children:[e.jsx(be,{dir:"ltr",endIcon:e.jsx(rn,{}),onClick:W,loading:i,variant:"contained",color:"success",children:e.jsx("span",{children:"بله"})}),e.jsx(Js,{dir:"ltr",endIcon:e.jsx(Xs,{}),onClick:()=>j(!1),variant:"contained",color:"error",children:e.jsx("span",{children:"خیر"})})]})]}):P?e.jsx(is,{title:"ایجاد موظف",closeModal:()=>p(!1),children:e.jsx(ft,{setShowCreateHeirModal:p,refetch:T})}):null,e.jsx(Ps,{table:c})]})})}function It(){const[l,g]=o.useState({}),[b,O]=o.useState([]),v=ps(),f=new URLSearchParams(v.search),P=f.get("Role"),p=f.get("personID"),{data:U,isSuccess:j,isLoading:E,isFetching:d,error:q,refetch:M}=Va({Role:P,personID:p});o.useEffect(()=>{if(M(),j){const i=U.itemList.map(F=>({id:F.requestID,type:F.requestTypeID,requestNO:F.requestNO||"-",personId:F.personID,requestTypeNameFa:F.requestTypeNameFa||"-",personName:F.personName||"-",date:F.requestDate||"-",body:F.requestText||"-"}));O(i),sessionStorage.setItem("requests",JSON.stringify(i))}},[U,j,M]),o.useEffect(()=>{var i;q&&ne.error(((i=q==null?void 0:q.data)==null?void 0:i.message)||q.error,{autoClose:2e3})},[q]);const $=()=>{M()},H=o.useMemo(()=>[{accessorKey:"id",header:"شماره درخواست",size:20,Cell:({renderedCellValue:i})=>e.jsx("div",{children:N(i)})},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"ارسال کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:i})=>e.jsx("div",{children:N(Is(i))})},{accessorKey:"observeReq",header:"مشاهده درخواست",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:i})=>e.jsx(Ne,{title:N(i.original.requestNO),children:e.jsx(Bn,{to:`/retirement/request?requestID=${i.id}&Role=${P}&type=${i.original.type}`,children:e.jsx(oe,{color:"primary",sx:{padding:"0"},children:e.jsx(gn,{})})})})}],[P]),J=vs({...Ts,columns:H,data:b,muiTableBodyRowProps:({row:i})=>({onClick:()=>g(()=>({[i.id]:!0})),selected:l[i.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsx(Ce,{children:d?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ye,{size:20,value:100})}):e.jsx(Ne,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"info",onClick:$,children:e.jsx(As,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:i=>e.jsx(Ss,{...i,page:N(i.page),slots:{previous:Bs,next:_s,first:ks,last:Os}})},getRowId:i=>i.id,onRowSelectionChange:g,state:{rowSelection:l}});return e.jsx(e.Fragment,{children:E?e.jsx("div",{className:"skeleton-lg",children:e.jsx(Gs,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(Ps,{table:J})})}function bt(){const[l,g]=o.useState({}),[b,O]=o.useState([]),[v,f]=o.useState(null),[P,p]=o.useState(!1),U=ps(),E=new URLSearchParams(U.search).get("personID"),{data:d,isLoading:q,isSuccess:M,isFetching:$,error:H,refetch:J}=Qa({personID:E,payType:"M"}),Z=()=>{J()};o.useEffect(()=>{if(M){const n=d.itemList.map((m,T)=>({id:m.payID,payRowNum:T+1,payCreditAmount:m.payCreditAmount,payDebitAmount:m.payDebitAmount,payAmount:m.payAmount,payDate:m.payDate,currentYear:m.currentYear,currentMonth:m.currentMonth}));O(n)}},[M,J,d]),o.useEffect(()=>{var n;H&&ne.error(((n=H==null?void 0:H.data)==null?void 0:n.message)||H.error,{autoClose:2e3})},[H]);const i=()=>{p(!0)},F=o.useMemo(()=>[{accessorKey:"payRowNum",header:"ردیف",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:N(n)})},{accessorKey:"payCreditAmount",header:"مبلغ بستانکاری",size:20,Cell:({renderedCellValue:n})=>e.jsxs("div",{children:[Ws(N(n))," ","ریال"]})},{accessorKey:"payDebitAmount",header:"مبلغ بدهکاری",size:20,Cell:({renderedCellValue:n})=>e.jsxs("div",{children:[Ws(N(n))," ","ریال"]})},{accessorKey:"payAmount",header:"مبلغ کل",size:20,Cell:({renderedCellValue:n})=>e.jsxs("div",{children:[Ws(N(n))," ","ریال"]})},{accessorKey:"payDate",header:"تاریخ پرداخت",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:Is(n)})},{accessorKey:"currentYear",header:"سال مالی",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:N(n)})},{accessorKey:"currentMonth",header:"ماه مالی",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:N(n)})},{accessorKey:"downloadRetiredSlip",header:"مشاهده/چاپ",enableSorting:!1,enableColumnActions:!1,size:20,Cell:()=>e.jsx(Ne,{title:"دانلود و مشاهده فیش",children:e.jsx(oe,{color:"primary",sx:{padding:"0"},onClick:i,children:e.jsx(gn,{})})})}],[]),L=vs({...Ts,columns:F,data:b,renderTopToolbarCustomActions:()=>e.jsx(Ce,{children:$?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ye,{size:20,value:100})}):e.jsx(Ne,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"info",onClick:Z,children:e.jsx(As,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:n=>e.jsx(Ss,{...n,page:N(n.page),slots:{previous:Bs,next:_s,first:ks,last:Os}})},muiTableBodyRowProps:({row:n})=>({onClick:()=>g(()=>({[n.id]:!0})),selected:l[n.id],sx:{cursor:"pointer"}}),getRowId:n=>n.id,onRowSelectionChange:g,state:{rowSelection:l}});return o.useEffect(()=>{const n=Object.keys(L.getState().rowSelection)[0];f(n||null)},[L,l]),e.jsxs(e.Fragment,{children:[P&&v&&e.jsx(is,{closeModal:()=>p(!1),children:e.jsx(Ja,{payID:v})},v),q?e.jsx("div",{className:"skeleton-lg",children:e.jsx(Gs,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(Ps,{table:L})]})}const Hs=({name:l,label:g,disabled:b,format:O="jYYYY/jMM/jDD",rules:v,control:f,required:P=!1,errors:p,setValue:U})=>{var $;const j=o.useRef(null),[E,d]=o.useState(!1),q=H=>{d(H)},M=()=>{U(l,null)};return Rs([j],[d]),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:l,control:f,rules:v,render:({field:{onChange:H,value:J}})=>e.jsx(ce.InputDatePicker,{id:l,"aria-label":l,disabled:b,format:O,value:J,open:E,suffixIcon:J&&!b?e.jsx(oe,{color:"default",size:"small",onClick:M,children:e.jsx(Xs,{})}):e.jsx(pe,{color:"action"}),defaultValue:null,onOpenChange:q,onChange:Z=>{d(!1),H(Z)},pickerProps:{...j&&{ref:j}},style:{border:"none",cursor:"pointer"},wrapperStyle:{border:"1px solid var(--color-input-border)",width:"100%",height:"100%",paddingLeft:"20px",borderRadius:"4px",cursor:"pointer"}})}),e.jsxs("label",{htmlFor:l,className:"inputBox__form--readOnly-label",children:[P&&e.jsx("span",{children:"*"})," ",g]}),p&&e.jsx("span",{className:"error-form",children:($=p==null?void 0:p[l])==null?void 0:$.message})]})},fs=({label:l,size:g="small",color:b="primary",disabled:O,control:v,name:f,errors:P,rules:p})=>e.jsxs("div",{className:"checkboxContainer__item",children:[e.jsx(z,{name:f,control:v,rules:p,render:({field:{onChange:U,value:j}})=>e.jsx(_n,{id:f,checked:!!j,onChange:E=>U(E.target.checked),size:g,color:b,disabled:O,sx:{padding:.5}})}),e.jsx("label",{htmlFor:f,className:O?"checkboxContainer__label--disabled":"checkboxContainer__label",children:l})]}),fn=(l,g,b,O)=>{if(!l)return{};const v={...l};return Object.keys(v).forEach(f=>{var P;b.includes(f)?v[f]=v[f]===null?null:Qs(v[f]):g.includes(f)&&(v[f]=v[f]===null?null:(P=O[f])==null?void 0:P.find(p=>p.value===v[f]))}),v},yn=(l,g,b)=>{const O={...l};return b.forEach(v=>{if(l[v]){const f=new Date(l[v]);f.setMinutes(f.getMinutes()-f.getTimezoneOffset()),O[v]=f}else O[v]=null}),g.forEach(v=>{l[v]&&l[v].value!==void 0&&(O[v]=l[v].value)}),O},Ct=()=>{const[l,g]=cn(!1),[b]=Zs(),O=kn(),v=b.get("personID"),f=o.useMemo(()=>["personCountryID","personStateID","personCityID","housingTypeID","educationTypeID","maritalStatusID"],[]),P=o.useMemo(()=>["personDeathDate","personBirthDate"],[]),{control:p,handleSubmit:U,formState:{errors:j},setValue:E}=cs({defaultValues:{personCountryID:null}}),{data:d,isLoading:q,isFetching:M,isSuccess:$,refetch:H}=Ua(v),[J,{isLoading:Z}]=Ea(),{lookUpItems:i,lookUpItemsIsLoading:F}=Q({lookUpType:"Gender"}),L=o.useMemo(()=>Be(i,"lookUpID","lookUpName"),[i]),{lookUpItems:X,lookUpItemsIsLoading:n}=Q({lookUpType:"EducationType"}),m=o.useMemo(()=>Be(X,"lookUpID","lookUpName"),[X]),{lookUpItems:T,lookUpItemsIsLoading:A}=Q({lookUpType:"Country"}),se=o.useMemo(()=>Be(T,"lookUpID","lookUpName"),[T]),{lookUpItems:ee,lookUpItemsIsLoading:s}=Q({lookUpType:"State"}),W=o.useMemo(()=>Be(ee,"lookUpID","lookUpName"),[ee]),{lookUpItems:_,lookUpItemsIsLoading:c}=Q({lookUpType:"City"}),t=o.useMemo(()=>Be(_,"lookUpID","lookUpName"),[_]),{lookUpItems:r,lookUpItemsIsLoading:h}=Q({lookUpType:"HousingType"}),S=o.useMemo(()=>Be(r,"lookUpID","lookUpName"),[r]),{lookUpItems:a,lookUpItemsIsLoading:V}=Q({lookUpType:"MaritialStatus"}),le=o.useMemo(()=>Be(a,"lookUpID","lookUpName"),[a]),ue=async de=>{const ae=yn(de,f,P),ie=await J({...ae}).unwrap();H(),g(),dn.success(ie.message)};return o.useEffect(()=>{if($){const de=d==null?void 0:d.itemList[0];O(an((de==null?void 0:de.personDeathDate)!==null));const ae=fn(de,f,P,{genderID:L,educationTypeID:m,personCountryID:se,personStateID:W,personCityID:t,housingTypeID:S,maritalStatusID:le});Object.keys(ae).forEach(ie=>{ae[ie]===null?E(ie,""):E(ie,ae[ie])})}return()=>{O(an(null))}},[O,$,d==null?void 0:d.itemList,E,L,se,m,W,t,S,le,P,f]),e.jsx(e.Fragment,{children:q||M?e.jsx(Ce,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ye,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:U(ue),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(te,{name:"personFirstName",label:On,rules:fe,required:!0,control:p,editable:l,type:"text"}),e.jsx(te,{name:"personLastName",label:Pn,rules:fe,required:!0,control:p,editable:l,type:"text"}),e.jsx(te,{name:"personNationalCode",label:Mn,rules:{...Fn,...fe},required:!0,control:p,editable:l,type:"text"}),e.jsx(te,{name:"personCertificateNo",label:Ln,rules:{...Re,...fe},required:!0,control:p,editable:l,type:"text"}),e.jsx(te,{name:"personFatherName",label:Rn,rules:ys,required:!0,control:p,editable:l,type:"text"}),e.jsx(_e,{name:"genderID",control:p,label:Tn,required:!0,isClearable:!0,isDisabled:!l,options:L,isLoading:F,rules:fe,errors:j}),e.jsx(Hs,{name:"personBirthDate",label:An,control:p,disabled:!l,required:!0,errors:j,rules:fe,setValue:E}),e.jsx(te,{name:"personBirthPlace",label:Un,rules:ys,required:!1,control:p,editable:l,type:"text"}),e.jsx(te,{name:"personPreviousName",label:En,rules:ys,required:!1,control:p,editable:l,type:"text"}),e.jsxs("div",{className:l?"checkboxContainer col-span-3":"checkboxContainer--disabled col-span-3",children:[e.jsx("p",{className:"inputBox__form--readOnly-label",children:"وضعیت ایثارگری:"}),e.jsx(fs,{disabled:!l,control:p,label:qn,name:"personIsSacrificedFamily"}),e.jsx(fs,{disabled:!l,control:p,label:wn,name:"personIsWarrior"}),e.jsx(fs,{disabled:!l,control:p,label:$n,name:"personIsChildOfSacrificed"}),e.jsx(fs,{disabled:!l,control:p,label:zn,name:"personIsValiant"}),e.jsx(fs,{disabled:!l,control:p,label:Hn,name:"personIsSacrificed"}),e.jsx(fs,{disabled:!l,control:p,label:Yn,name:"personIsCaptive"})]}),e.jsx(te,{name:"retiredID",label:Gn,required:!1,control:p,editable:!1,type:"text"}),e.jsx(te,{name:"personPhone",label:Kn,required:!1,rules:Re,control:p,editable:l,type:"text"}),e.jsx(te,{name:"personCellPhone",label:Wn,required:!1,rules:Vn,control:p,editable:l,type:"text"}),e.jsx(te,{name:"backupNum",label:Qn,required:!1,rules:Re,control:p,editable:l,type:"text"}),e.jsx(te,{name:"backupName",label:Jn,required:!1,rules:ys,control:p,editable:l,type:"text"}),e.jsx(te,{name:"backupLname",label:Zn,required:!1,rules:ys,control:p,editable:l,type:"text"}),e.jsx(te,{name:"personEmail",label:Xn,required:!1,rules:ea,control:p,editable:l,type:"text"}),e.jsx(_e,{name:"educationTypeID",control:p,label:sa,required:!1,isClearable:!0,isDisabled:!l,options:m,isLoading:n}),e.jsx(_e,{name:"personCountryID",control:p,label:na,required:!1,isClearable:!0,isDisabled:!l,options:se,isLoading:A}),e.jsx(_e,{name:"personStateID",control:p,label:aa,required:!1,isClearable:!0,isDisabled:!l,options:W,isLoading:s}),e.jsx(_e,{name:"personCityID",control:p,label:ta,required:!1,isClearable:!0,isDisabled:!l,options:t,isLoading:c}),e.jsx(te,{name:"personRegion",label:oa,required:!1,control:p,editable:l,rules:Re,type:"text"}),e.jsx(te,{name:"personArea",label:la,required:!1,control:p,editable:l,rules:Re,type:"text"}),e.jsx(te,{name:"personPostalCode",label:ra,required:!1,control:p,editable:l,rules:ia,type:"text"}),e.jsx(_e,{name:"housingTypeID",control:p,label:ca,required:!1,isClearable:!0,isDisabled:!l,options:S,isLoading:h}),e.jsx(_e,{name:"maritalStatusID",control:p,label:pa,required:!1,isClearable:!0,isDisabled:!l,options:le,isLoading:V}),e.jsx(Hs,{name:"personDeathDate",label:ua,control:p,disabled:!l,required:!1,setValue:E}),e.jsx(tn,{name:"personAddress",label:da,required:!0,control:p,editable:l,containerClassNames:"col-span-3"}),e.jsx(tn,{name:"personDescription",label:ma,required:!0,control:p,editable:l,containerClassNames:"col-span-4 row-span-2"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(be,{dir:"ltr",endIcon:e.jsx(jn,{}),disabled:!l,variant:"contained",type:"submit",loading:Z,color:"success",children:e.jsx("span",{children:pn})}),e.jsx(be,{dir:"ltr",endIcon:e.jsx(Ls,{}),onClick:g,disabled:l,variant:"contained",color:"primary",children:e.jsx("span",{children:un})})]})]})})})},Dt=()=>[{accessorKey:"pensionaryStatusRowNum",header:ha,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"pensionaryStatusName",header:Vs,size:20},{accessorKey:"pensionaryStartdate",header:xa,size:20,Cell:({renderedCellValue:l})=>e.jsx("div",{children:Za(l)})},{accessorKey:"isActive",header:Vs,size:20,Cell:({renderedCellValue:l})=>e.jsx("div",{children:l===!0?"فعال":"غیرفعال"})}],vt=({data:l,isLoading:g,isFetching:b})=>{const O=Dt();return e.jsx(ga,{data:l,columns:O,scroll:!1,isLoading:g,isFetching:b,sorting:[{id:"isActive",desc:!0}],highlightActive:!0})},St=()=>{const[l,g]=o.useState([]),[b,O]=cn(!1),[v]=Zs(),f=v.get("personID"),{personDeathDate:P}=mn(S=>S.person),p=o.useMemo(()=>["retiredOrganizationID","employmentTypeID","pensionaryStatusID"],[]),U=o.useMemo(()=>["retirementDate","pensionaryStartdate"],[]),{control:j,handleSubmit:E,formState:{errors:d},setValue:q}=cs(),{data:M,isSuccess:$,isLoading:H,isFetching:J,refetch:Z}=qa(f),{data:i,isSuccess:F,isLoading:L,isFetching:X,refetch:n}=sn(f),[m,{isLoading:T}]=wa(),{organizations:A,organizationIsLoading:se}=za({}),{lookUpItems:ee,lookUpItemsIsLoading:s}=Q({lookUpType:"EmploymentType"}),{pensionaryStatus:W,pensionaryStatusIsLoading:_}=Ms({pensionaryStatusCategory:"R",pensionaryStatusIsDead:P}),c=o.useMemo(()=>Be(A,"organizationID","organizationName"),[A]),t=o.useMemo(()=>Be(ee,"lookUpID","lookUpName"),[ee]),r=o.useMemo(()=>Be(W,"pensionaryStatusID","pensionaryStatusName"),[W]);o.useEffect(()=>{if($){const S=M==null?void 0:M.itemList[0];if(S){const a={...S};Object.keys(a).forEach(V=>{V==="retirementDate"&&(a[V]=a[V]===null?null:Qs(a[V])),V==="pensionaryStartdate"&&(a[V]=a[V]===null?null:Qs(a[V])),q(V,a[V])})}}},[$,M==null?void 0:M.itemList,q]);const h=async S=>{const a=yn(S,p,U),V=await m({...a,retiredGroup:parseInt(S.retiredGroup),retiredJobDegreeCoef:parseInt(S.retiredJobDegreeCoef),retiredRealDuration:parseInt(S.retiredRealDuration),retiredGrantDuration:parseInt(S.retiredGrantDuration),personID:f}).unwrap();O(),Z(),n(),dn.success(V.message)};return o.useEffect(()=>{if($){const S=M==null?void 0:M.itemList[0],a=fn(S,p,U,{retiredOrganizationID:c,employmentTypeID:t,pensionaryStatusID:r});Object.keys(a).forEach(V=>{a[V]===null?q(V,""):q(V,a[V])})}},[$,M==null?void 0:M.itemList,c,t,r,q,p,U]),o.useEffect(()=>{if(F){const S=i==null?void 0:i.itemList.map((a,V)=>({id:a.pensionaryID,isActive:a.pensionaryIsActive,pensionaryStatusRowNum:V+1,pensionaryStatusName:a.pensionaryStatusName||"-",pensionaryStartdate:a.pensionaryStartdate||"-"}));g(S)}},[F,i==null?void 0:i.itemList]),e.jsx(e.Fragment,{children:H||J?e.jsx(Ce,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ye,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:E(h),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(te,{name:"retiredGroup",label:ja,control:j,required:!0,editable:b,rules:{...fe,...Re},type:"text"}),e.jsx(_e,{name:"retiredOrganizationID",control:j,label:Na,required:!0,isClearable:!0,isDisabled:!b,options:c,isLoading:se,rules:fe,errors:d}),e.jsx(te,{name:"retiredLastPosition",label:fa,control:j,required:!1,editable:b,rules:ys,type:"text"}),e.jsx(_e,{name:"employmentTypeID",control:j,label:ya,required:!0,isClearable:!0,isDisabled:!b,options:t,isLoading:s,rules:fe,errors:d}),e.jsx(Hs,{name:"retirementDate",label:Ia,control:j,disabled:!b,required:!1,errors:d,rules:fe,setValue:q}),e.jsx(_e,{name:"pensionaryStatusID",control:j,label:Vs,required:!0,isClearable:!0,isDisabled:!b,options:r,isLoading:_,rules:fe,errors:d}),e.jsx(Hs,{name:"pensionaryStartdate",label:ba,control:j,disabled:!b,required:!0,errors:d,rules:fe,setValue:q}),e.jsx(te,{name:"retiredJobDegreeCoef",label:Ca,control:j,required:!1,editable:b,rules:Re,type:"text"}),e.jsx(te,{name:"retiredGrantDuration",label:Da,control:j,required:!1,editable:b,rules:Re,type:"text"}),e.jsx(te,{name:"retiredRealDuration",label:va,control:j,required:!1,editable:b,rules:Re,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(be,{dir:"ltr",endIcon:e.jsx(jn,{}),disabled:!b,variant:"contained",type:"submit",loading:T,color:"success",children:e.jsx("span",{children:pn})}),e.jsx(be,{dir:"ltr",endIcon:e.jsx(Ls,{}),onClick:O,disabled:b,variant:"contained",color:"primary",children:e.jsx("span",{children:un})})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(vt,{data:l,isLoading:L,isFetching:X})]})})})},lo=()=>{const[l,g]=o.useState("1"),{personDeathDate:b}=mn(f=>f.person),O=(f,P)=>{g(P)};return e.jsxs("section",{className:"flex-col",children:[e.jsx(Wa,{title:Sa,back:!0}),e.jsxs("div",{"data-name":"retired-forms",children:[e.jsxs(Es,{children:[e.jsx(qs,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(ws,{}),children:Ba}),e.jsx($s,{children:e.jsx(Ct,{})})]}),e.jsxs(Es,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(qs,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(ws,{}),children:_a}),e.jsx($s,{children:e.jsx(St,{})})]}),e.jsxs(Es,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(qs,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(ws,{}),children:ka}),e.jsx($s,{children:e.jsx(st,{})})]}),e.jsxs(Es,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(qs,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(ws,{}),children:Oa}),e.jsx($s,{children:e.jsx(nt,{})})]})]}),e.jsx("div",{"data-name":"retired-grids",children:e.jsxs(Xa,{value:l,children:[e.jsx(Ce,{sx:{bgcolor:"background.paper",borderRadius:1},children:e.jsxs(et,{onChange:O,"aria-label":"tabs",variant:"fullWidth",children:[e.jsx(Us,{label:b?Pa:Ma,value:"1"}),e.jsx(Us,{label:Fa,value:"2"}),e.jsx(Us,{label:La,value:"3"}),e.jsx(Us,{label:Ra,value:"4"})]})}),e.jsx(zs,{value:"1",sx:{padding:"0"},children:b?e.jsx(yt,{}):e.jsx(ut,{})}),e.jsx(zs,{value:"2",sx:{padding:"0"},children:e.jsx($a,{})}),e.jsx(zs,{value:"3",sx:{padding:"0"},children:e.jsx(bt,{})}),e.jsx(zs,{value:"4",sx:{padding:"0"},children:e.jsx(It,{})})]})})]})};export{lo as default};
