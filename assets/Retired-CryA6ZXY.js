import{A as Z,r as t,j as e,D as ce,u as Ee,i as de,E as Te,F as Ne,H as fe,B as oe,C as ue,J as r,K as Ce,M as E,N as Ae,P as Le,Q as Re,S as Ue,U as j,V as Oe,W as J,X as ke,Y as Pe,Z as _e,_ as Fe,$ as qe,a0 as ve,a1 as Be,a2 as Me,a3 as Ge,a4 as we,a5 as He,a6 as Ve,a7 as Ke,a8 as ze,a9 as Qe,aa as Ye,ab as Je,ac as We,ad as $e,ae as Ze,af as Xe,ag as es,ah as ss,ai as as,aj as ts,ak as rs,al as ns,am as os,an as is,ao as ls,ap as cs,aq as ds,ar as us,v as W,as as pe,at as me,au as Ie,k as ge,av as ps,aw as ms,ax as Is,ay as he,az as xs,aA as Ds,aB as bs,aC as fs,aD as hs,aE as js,aF as gs,aG as Ss,aH as ys,aI as Es,aJ as F,aK as Ts,aL as Ns,aM as Cs,aN as As,aO as Ls,aP as Rs,aQ as Us,aR as Os,aS as ks,aT as X,aU as Ps,aV as _s,L as ee,aW as Fs,aX as qs,aY as vs,aZ as Bs,a_ as Ms,a$ as Gs,b0 as ws,b1 as Hs,b2 as Vs}from"./index-DF4pKFh6.js";import{u as Ks,a as zs,c as Qs,F as Ys}from"./createTree-CHXRRwiy.js";import{T as Js}from"./Title-IJ0y3w3i.js";import{c as S,S as y}from"./SelectInput-BA4ohxUD.js";import{p as Se,D as ne,a as xe}from"./convertFormData-DCnA8yyr.js";import{C as Y}from"./CustomCheckBox-CjTWu_gg.js";import{T as je}from"./TextArea-D92ej84n.js";import{D as De}from"./DoneOutlined-DEy52eEF.js";import{E as be}from"./EditOutlined-CtPrMeT7.js";import{u as O,a as Ws,b as $s}from"./useFetchLookUpData-DETsBiha.js";import{S as Zs}from"./StatusHistoryGrid-EW0qXkx8.js";import{u as Xs}from"./sharedApi-BOr3zEM5.js";import{u as ea}from"./useRouteMatch-Dme8zMjZ.js";import{A as se,a as ae,b as te,c as re}from"./ArrowDropDown-CcJ5vv92.js";import"./index-B0GArZ5p.js";import"./react-select-animated.esm-CtXug14q.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";import"./useCloseCalender-DAmngq46.js";import"./requestApi-lBVSXTjA.js";import"./fractionApi-CEn-DNVR.js";const sa=()=>{const[s]=Z(),[f,c]=t.useState([]),[h,R]=t.useState([]),m=s.get("personID"),{data:T,isLoading:a,isSuccess:I,refetch:u}=Ks(),{data:b,isLoading:n,isSuccess:x,refetch:d}=zs(m);t.useEffect(()=>{x&&R(b.itemList)},[x,b]),t.useEffect(()=>{if(I){const q=Qs(T.itemList);c(q)}},[I,T]);const g=t.useCallback(()=>{u(),d()},[u,d]);return e.jsx(Ys,{structure:f,files:h,isLoading:a||n,refetch:g,access:"files"})},aa=["personFirstName","personLastName","personNationalCode","personCertificateNo","personFatherName","genderID","personBirthDate","personBirthPlace","personPreviousNam","personIsSacrificedFamily","personIsWarrior","personIsChildOfSacrificed","personIsValiant","personIsSacrificed","personIsCaptive","retiredID","personPhone","personCellPhone","backupPhone","backupFirstName","backupLastName","personEmail","educationTypeID","personCountryID","personStateID","personCityID","personRegion","personArea","personPostalCode","housingTypeID","maritalStatusID","personDeathDate","personAddress","personDescription"],ta=["retiredGroup","retiredOrganizationID","retiredLastPosition","employmentTypeID","retirementDate","pensionaryStatusID","pensionaryStartdate","retiredJobDegreeCoef","retiredGrantDuration","retiredRealDuration"],ra=["bankID","bankBranchID","accountNo","ledgerCode","insuranceCoef","insuranceAmount"],na=()=>{const[s,f]=ce(!1),[c]=Z(),h=Ee(),R=c.get("personID"),m=t.useMemo(()=>["genderID","personCountryID","personStateID","personCityID","housingTypeID","educationTypeID","maritalStatusID"],[]),T=t.useMemo(()=>["personDeathDate","personBirthDate"],[]),{control:a,handleSubmit:I,formState:{errors:u},setValue:b}=de(),{data:n,isLoading:x,isFetching:d,isSuccess:g,refetch:q}=Te(R),[k,{isLoading:G}]=Ne(),{lookUpItems:N,lookUpItemsIsLoading:w}=O({lookUpType:"Gender"}),A=t.useMemo(()=>S(N,"lookUpID","lookUpName"),[N]),{lookUpItems:D,lookUpItemsIsLoading:L}=O({lookUpType:"EducationType"}),v=t.useMemo(()=>S(D,"lookUpID","lookUpName"),[D]),{lookUpItems:H,lookUpItemsIsLoading:V}=O({lookUpType:"Country"}),B=t.useMemo(()=>S(H,"lookUpID","lookUpName"),[H]),{lookUpItems:M,lookUpItemsIsLoading:K}=O({lookUpType:"State"}),P=t.useMemo(()=>S(M,"lookUpID","lookUpName"),[M]),{lookUpItems:$,lookUpItemsIsLoading:o}=O({lookUpType:"City"}),C=t.useMemo(()=>S($,"lookUpID","lookUpName"),[$]),{lookUpItems:_,lookUpItemsIsLoading:ie}=O({lookUpType:"HousingType"}),p=t.useMemo(()=>S(_,"lookUpID","lookUpName"),[_]),{lookUpItems:l,lookUpItemsIsLoading:i}=O({lookUpType:"MaritialStatus"}),le=t.useMemo(()=>S(l,"lookUpID","lookUpName"),[l]),ye=async z=>{const Q=xe(z,m,T),U=await k(Q).unwrap();q(),f(),Ie.success(U.message)};return t.useEffect(()=>{if(g){const z=n==null?void 0:n.itemList[0];h(fe((z==null?void 0:z.personDeathDate)!==null));const Q=Se(z,m,T,{genderID:A,educationTypeID:v,personCountryID:B,personStateID:P,personCityID:C,housingTypeID:p,maritalStatusID:le});Object.keys(Q).forEach(U=>{aa.includes(U)&&Q[U]===null?b(U,""):b(U,Q[U])})}return()=>{h(fe(null))}},[h,g,n==null?void 0:n.itemList,b,A,B,v,P,C,p,le,T,m]),e.jsx(e.Fragment,{children:x||d?e.jsx(oe,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ue,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:I(ye),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(r,{name:"personFirstName",label:Ce,rules:E,required:!0,control:a,editable:s,type:"text"}),e.jsx(r,{name:"personLastName",label:Ae,rules:E,required:!0,control:a,editable:s,type:"text"}),e.jsx(r,{name:"personNationalCode",label:Le,rules:{...Re,...E},required:!0,control:a,editable:s,type:"text"}),e.jsx(r,{name:"personCertificateNo",label:Ue,rules:{...j,...E},required:!0,control:a,editable:s,type:"text"}),e.jsx(r,{name:"personFatherName",label:Oe,rules:J,required:!0,control:a,editable:s,type:"text"}),e.jsx(y,{name:"genderID",control:a,label:ke,required:!0,isClearable:!0,isDisabled:!s,options:A,isLoading:w,rules:E,errors:u}),e.jsx(ne,{name:"personBirthDate",label:Pe,control:a,disabled:!s,required:!0,errors:u,rules:E,setValue:b}),e.jsx(r,{name:"personBirthPlace",label:_e,rules:J,required:!1,control:a,editable:s,type:"text"}),e.jsx(r,{name:"personPreviousName",label:Fe,rules:J,required:!1,control:a,editable:s,type:"text"}),e.jsxs("div",{className:s?"checkboxContainer col-span-3":"checkboxContainer--disabled col-span-3",children:[e.jsx("p",{className:"inputBox__form--readOnly-label",children:qe}),e.jsx(Y,{disabled:!s,control:a,label:ve,name:"personIsSacrificedFamily"}),e.jsx(Y,{disabled:!s,control:a,label:Be,name:"personIsWarrior"}),e.jsx(Y,{disabled:!s,control:a,label:Me,name:"personIsChildOfSacrificed"}),e.jsx(Y,{disabled:!s,control:a,label:Ge,name:"personIsValiant"}),e.jsx(Y,{disabled:!s,control:a,label:we,name:"personIsSacrificed"}),e.jsx(Y,{disabled:!s,control:a,label:He,name:"personIsCaptive"})]}),e.jsx(r,{name:"retiredID",label:Ve,required:!1,control:a,editable:!1,type:"text"}),e.jsx(r,{name:"personPhone",label:Ke,required:!1,rules:j,control:a,editable:s,type:"text"}),e.jsx(r,{name:"personCellPhone",label:ze,required:!1,rules:Qe,control:a,editable:s,type:"text"}),e.jsx(r,{name:"backupPhone",label:Ye,required:!1,rules:j,control:a,editable:s,type:"text"}),e.jsx(r,{name:"backupFirstName",label:Je,required:!1,rules:J,control:a,editable:s,type:"text"}),e.jsx(r,{name:"backupLastName",label:We,required:!1,rules:J,control:a,editable:s,type:"text"}),e.jsx(r,{name:"personEmail",label:$e,required:!1,rules:Ze,control:a,editable:s,type:"text"}),e.jsx(y,{name:"educationTypeID",control:a,label:Xe,required:!1,isClearable:!0,isDisabled:!s,options:v,isLoading:L}),e.jsx(y,{name:"personCountryID",control:a,label:es,required:!1,isClearable:!0,isDisabled:!s,options:B,isLoading:V}),e.jsx(y,{name:"personStateID",control:a,label:ss,required:!1,isClearable:!0,isDisabled:!s,options:P,isLoading:K}),e.jsx(y,{name:"personCityID",control:a,label:as,required:!1,isClearable:!0,isDisabled:!s,options:C,isLoading:o}),e.jsx(r,{name:"personRegion",label:ts,required:!1,control:a,editable:s,rules:j,type:"text"}),e.jsx(r,{name:"personArea",label:rs,required:!1,control:a,editable:s,rules:j,type:"text"}),e.jsx(r,{name:"personPostalCode",label:ns,required:!1,control:a,editable:s,rules:os,type:"text"}),e.jsx(y,{name:"housingTypeID",control:a,label:is,required:!1,isClearable:!0,isDisabled:!s,options:p,isLoading:ie}),e.jsx(y,{name:"maritalStatusID",control:a,label:ls,required:!1,isClearable:!0,isDisabled:!s,options:le,isLoading:i}),e.jsx(ne,{name:"personDeathDate",label:cs,control:a,disabled:!s,required:!1,setValue:b}),e.jsx(je,{name:"personAddress",label:ds,required:!0,control:a,editable:s,containerClassNames:"col-span-3"}),e.jsx(je,{name:"personDescription",label:us,required:!0,control:a,editable:s,containerClassNames:"col-span-4 row-span-2"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(W,{dir:"ltr",endIcon:e.jsx(De,{}),disabled:!s,variant:"contained",type:"submit",loading:G,color:"success",children:e.jsx("span",{children:pe})}),e.jsx(W,{dir:"ltr",endIcon:e.jsx(be,{}),onClick:f,disabled:s,variant:"contained",color:"primary",children:e.jsx("span",{children:me})})]})]})})})},oa=()=>{const[s,f]=t.useState([]),[c,h]=ce(!1),[R]=Z(),m=R.get("personID"),{personDeathDate:T}=ge(p=>p.person),a=t.useMemo(()=>["retiredOrganizationID","employmentTypeID","pensionaryStatusID"],[]),I=t.useMemo(()=>["retirementDate","pensionaryStartdate"],[]),{control:u,handleSubmit:b,formState:{errors:n},setValue:x}=de(),{data:d,isSuccess:g,isLoading:q,isFetching:k,refetch:G}=ps(m),{data:N,isSuccess:w,isLoading:A,isFetching:D,refetch:L}=ms(m),[v,{isLoading:H}]=Is(),{organizations:V,organizationIsLoading:B}=Ws({}),{lookUpItems:M,lookUpItemsIsLoading:K}=O({lookUpType:"EmploymentType"}),{pensionaryStatus:P,pensionaryStatusIsLoading:$}=$s({pensionaryStatusCategory:"R",pensionaryStatusIsDead:T}),o=t.useMemo(()=>S(V,"organizationID","organizationName"),[V]),C=t.useMemo(()=>S(M,"lookUpID","lookUpName"),[M]),_=t.useMemo(()=>S(P,"pensionaryStatusID","pensionaryStatusName"),[P]);t.useEffect(()=>{if(g){const p=d==null?void 0:d.itemList[0];if(p){const l={...p};Object.keys(l).forEach(i=>{i==="retirementDate"&&(l[i]=l[i]===null?null:he(l[i])),i==="pensionaryStartdate"&&(l[i]=l[i]===null?null:he(l[i])),x(i,l[i])})}}},[g,d==null?void 0:d.itemList,x]);const ie=async p=>{const l=xe(p,a,I),i=await v({...l,retiredGroup:parseInt(F(p.retiredGroup)),retiredJobDegreeCoef:parseInt(F(p.retiredJobDegreeCoef)),retiredRealDuration:parseInt(F(p.retiredRealDuration)),retiredGrantDuration:parseInt(F(p.retiredGrantDuration)),personID:m}).unwrap();h(),G(),L(),Ie.success(i.message)};return t.useEffect(()=>{if(g){const p=d==null?void 0:d.itemList[0],l=Se(p,a,I,{retiredOrganizationID:o,employmentTypeID:C,pensionaryStatusID:_});Object.keys(l).forEach(i=>{ta.includes(i)&&l[i]===null?x(i,""):x(i,l[i])})}},[g,d==null?void 0:d.itemList,o,C,_,x,a,I]),t.useEffect(()=>{if(w){const p=N==null?void 0:N.itemList.map((l,i)=>({id:l.pensionaryID,isActive:l.pensionaryIsActive,pensionaryStatusRowNum:i+1,pensionaryStatusName:l.pensionaryStatusName||"-",pensionaryStartdate:l.pensionaryStartdate||"-"}));f(p)}},[w,N==null?void 0:N.itemList]),e.jsx(e.Fragment,{children:q||k?e.jsx(oe,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ue,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:b(ie),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(r,{name:"retiredGroup",label:xs,control:u,required:!0,editable:c,rules:{...E,...j},type:"text"}),e.jsx(y,{name:"retiredOrganizationID",control:u,label:Ds,required:!0,isClearable:!0,isDisabled:!c,options:o,isLoading:B,rules:E,errors:n}),e.jsx(r,{name:"retiredLastPosition",label:bs,control:u,required:!1,editable:c,rules:J,type:"text"}),e.jsx(y,{name:"employmentTypeID",control:u,label:fs,required:!0,isClearable:!0,isDisabled:!c,options:C,isLoading:K,rules:E,errors:n}),e.jsx(ne,{name:"retirementDate",label:hs,control:u,disabled:!c,required:!1,errors:n,rules:E,setValue:x}),e.jsx(y,{name:"pensionaryStatusID",control:u,label:js,required:!0,isClearable:!0,isDisabled:!c,options:_,isLoading:$,rules:E,errors:n}),e.jsx(ne,{name:"pensionaryStartdate",label:gs,control:u,disabled:!c,required:!0,errors:n,rules:E,setValue:x}),e.jsx(r,{name:"retiredJobDegreeCoef",label:Ss,control:u,required:!1,editable:c,rules:j,type:"text"}),e.jsx(r,{name:"retiredGrantDuration",label:ys,control:u,required:!1,editable:c,rules:j,type:"text"}),e.jsx(r,{name:"retiredRealDuration",label:Es,control:u,required:!1,editable:c,rules:j,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(W,{dir:"ltr",endIcon:e.jsx(De,{}),disabled:!c,variant:"contained",type:"submit",loading:H,color:"success",children:e.jsx("span",{children:pe})}),e.jsx(W,{dir:"ltr",endIcon:e.jsx(be,{}),onClick:h,disabled:c,variant:"contained",color:"primary",children:e.jsx("span",{children:me})})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(Zs,{data:s,isLoading:A,isFetching:D})]})})})},ia=()=>{const[s,f]=ce(!1),[c,h]=t.useState([]),[R]=Z(),m=R.get("personID"),T=t.useMemo(()=>["bankID","bankBranchID"],[]),a=t.useMemo(()=>[],[]),{control:I,handleSubmit:u,formState:{errors:b},setValue:n,watch:x}=de(),d=x("bankID"),{lookUpItems:g,lookUpItemsIsLoading:q}=O({lookUpType:"Bank"}),k=t.useMemo(()=>S(g,"lookUpID","lookUpName"),[g]),[G,{isLoading:N,isFetching:w}]=Xs(),A=t.useMemo(()=>S(c,"lookUpID","lookUpName"),[c]),{data:D,isSuccess:L,isLoading:v,isFetching:H,refetch:V}=Ts(m),[B,{isLoading:M}]=Ns(),K=t.useCallback(async o=>{const C=await G({lookUpType:"BankBranch",lookUpParentID:o}).unwrap();h(C.itemList)},[G]),P=async o=>{const C=xe(o,T,a),_=await B({...C,accountNo:F(o.accountNo)||null,ledgerCode:parseInt(F(o.ledgerCode))||null,insuranceAmount:parseFloat(F(o.insuranceAmount))||null,insuranceCoef:parseFloat(F(o.insuranceCoef))||null,personID:m}).unwrap();V(),f(),Ie.success(_.message)};return t.useEffect(()=>{d?K(d.value):(n("bankBranchID",null),h([]))},[d,K,n]),t.useEffect(()=>{L&&({...D},Object.keys(D).forEach(o=>{ra.includes(o)&&D[o]===null?n(o,""):n(o,D[o])}))},[L,D,n]),t.useEffect(()=>{L&&k.length>0&&n("bankID",k.find(o=>o.value===D.bankID))},[L,D,n,k]),t.useEffect(()=>{L&&A.length>0&&n("bankBranchID",A.find(o=>o.value===D.bankBranchID))},[L,D,n,A]),e.jsx(e.Fragment,{children:v||H?e.jsx(oe,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ue,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:u(P),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(y,{name:"bankID",control:I,label:Cs,required:!1,isClearable:!0,isDisabled:!s,options:k,isLoading:q,errors:b}),e.jsx(y,{name:"bankBranchID",control:I,label:As,required:!1,isClearable:!0,isDisabled:!s,options:A,isLoading:N||w,errors:b}),e.jsx(r,{name:"accountNo",label:Ls,rules:j,required:!1,control:I,editable:s,type:"text"}),e.jsx(r,{name:"ledgerCode",label:Rs,rules:j,required:!1,control:I,editable:s,type:"text"}),e.jsx(r,{name:"insuranceCoef",label:Us,rules:j,required:!1,control:I,editable:s,type:"text"}),e.jsx(r,{name:"insuranceAmount",label:Os,rules:j,required:!1,control:I,editable:s,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(W,{dir:"ltr",endIcon:e.jsx(De,{}),disabled:!s,variant:"contained",type:"submit",loading:M,color:"success",children:e.jsx("span",{children:pe})}),e.jsx(W,{dir:"ltr",endIcon:e.jsx(be,{}),onClick:f,disabled:s,variant:"contained",color:"primary",children:e.jsx("span",{children:me})})]})]})})})},la=()=>{const[s]=Z(),f=ea(["/retirement/retired/statements","/retirement/retired/requests","/retirement/retired/slips","/retirement/retired"]),c=s.toString(),{personDeathDate:h}=ge(a=>a.person),R=f==null?void 0:f.pattern.path,m=a=>c?`${a}?${c}`:a;return e.jsxs("div",{children:[e.jsx(oe,{sx:{bgcolor:"background.paper",borderRadius:1},children:e.jsxs(ks,{value:R,children:[e.jsx(X,{label:h?Ps:_s,value:"/retirement/retired",to:m("/retirement/retired"),component:ee}),e.jsx(X,{label:Fs,value:"/retirement/retired/statements",to:m("/retirement/retired/statements"),component:ee}),e.jsx(X,{label:qs,value:"/retirement/retired/slips",to:m("/retirement/retired/slips"),component:ee}),e.jsx(X,{label:vs,value:"/retirement/retired/requests",to:m("/retirement/retired/requests"),component:ee})]})}),e.jsx(Bs,{})]})},Ua=()=>e.jsxs("section",{className:"flex-col mb-20",children:[e.jsx(Js,{title:Ms,back:!0}),e.jsxs("div",{"data-name":"retired-forms",children:[e.jsxs(se,{children:[e.jsx(ae,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(te,{}),children:Gs}),e.jsx(re,{children:e.jsx(na,{})})]}),e.jsxs(se,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(ae,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(te,{}),children:ws}),e.jsx(re,{children:e.jsx(oa,{})})]}),e.jsxs(se,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(ae,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(te,{}),children:Hs}),e.jsx(re,{children:e.jsx(ia,{})})]}),e.jsxs(se,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(ae,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(te,{}),children:Vs}),e.jsx(re,{children:e.jsx(sa,{})})]})]}),e.jsx(la,{})]});export{Ua as default};
