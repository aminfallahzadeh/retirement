import{r as l,i as S,cw as B,z as r,N as E,cx as F,o as L,D as w,j as e,S as I,U as h,V as D,a as A,w as M,A as b}from"./index-BmsaxOuK.js";import{S as k}from"./ArrowUpwardOutlined-DdBwA9uX.js";const z=["62A54585-F331-434A-9027-C9F3060F683A","6E7BA26E-A1DC-4A5E-9700-17820A36158D"];function G(){const[o,g]=l.useState(null),[c,y]=l.useState([]),[u,{isLoading:Q,isFetching:P}]=S(),[d,{isLoading:f,isFetching:C}]=B(),m=l.useCallback(async()=>{var a;try{const n=await u().unwrap();g(n==null?void 0:n.itemList[0].url)}catch(n){console.log(n);const t=n;r.error(((a=t.data)==null?void 0:a.message)||t.error,{autoClose:2e3})}},[u]),p=l.useCallback(async()=>{try{console.log("ROLE BEFORE REQUEST:",o);const a=await d(o).unwrap(),n=E(a.itemList,"requestTypeID","name");y(n)}catch(a){console.log(a)}},[d,o]);l.useEffect(()=>{m()},[m]),l.useEffect(()=>{o&&(console.log(o),p())},[o,p]);const[R,{isLoading:N}]=F(),T=L(),j=w(),[s,i]=l.useState({}),x=a=>{const{name:n,value:t}=a.target;i({...s,[n]:t})},_=(a,n)=>{const{name:t}=n;if(a){const{value:q}=a;i({...s,[t]:q||""})}else i({...s,[t]:null})},v=async()=>{var a;try{const n=s!=null&&s.nationalCode?b(s.nationalCode):"-1",t=await R({...s,requestFrom:1,nationalCode:n}).unwrap();T("/retirement/cartable"),r.success(t.message,{autoClose:2e3})}catch(n){console.log(n),r.error(((a=n==null?void 0:n.data)==null?void 0:a.message)||n.error,{autoClose:2e3})}};return e.jsxs("section",{className:"formContainer flex-col",children:[e.jsxs("form",{method:"POST",className:"grid grid--col-4 u-margin-top-md",noValidate:!0,children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(I,{closeMenuOnSelect:!0,components:j,options:c,onChange:_,value:c.find(a=>a.value===(s==null?void 0:s.requestTypeID)),name:"requestTypeID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نوع درخواست"]}),noOptionsMessage:h.noOptionsMessage,loadingMessage:h.loadingMessage,styles:D,isLoading:f||C}),e.jsxs("label",{className:s!=null&&s.requestTypeID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نوع درخواست"]})]}),!z.includes(s==null?void 0:s.requestTypeID)&&e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",name:"nationalCode",id:"nationalCode",onChange:x,className:"inputBox__form--input",value:A(s==null?void 0:s.nationalCode)??"",required:!0}),e.jsxs("label",{htmlFor:"nationalCode",className:"inputBox__form--label",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form col-span-4 row-span-3",children:[e.jsx("textarea",{type:"text",id:"requestText",name:"requestText",onChange:x,value:(s==null?void 0:s.requestText)||"",className:"inputBox__form--input",required:!0}),e.jsxs("label",{htmlFor:"requestText",className:"inputBox__form--label",children:[e.jsx("span",{children:"*"})," متن درخواست"]})]})]}),e.jsx("div",{style:{marginRight:"auto"},className:"flex-row",children:e.jsx(M,{dir:"ltr",endIcon:e.jsx(k,{}),variant:"contained",onClick:v,loading:N,color:"success",sx:{fontFamily:"sahel"},children:e.jsx("span",{children:"ارسال درخواست"})})})]})}function $(){return e.jsxs("section",{className:"flex-col",children:[e.jsx("div",{className:"title-primary--container flex-row flex-center",children:e.jsxs("h4",{className:"title-primary",children:[e.jsx("span",{className:"title-primary--underline"}),"ایجاد درخواست"]})}),e.jsx(G,{})]})}export{$ as default};
