import{c as q,j as e,r as l,a as b,b as R,T as y,L as j,I as f,u as I,s as x,B as D,C as v,d as F}from"./index-BSRVVr8n.js";import{u as P,a as N}from"./requestApi-BdwrSs1O.js";import{u as S,M as z,P as A,C as L,a as B,L as E,F as $,b as k}from"./index.esm-BxY0lyNJ.js";import{E as H}from"./VisibilityOutlined-YP-_yELv.js";import{u as M}from"./index.esm-CjA9BksF.js";import{c as O,S as K}from"./SelectInput-UFM3pX9P.js";import{R as V}from"./Refresh-DHTXiARq.js";import"./Save-BGOXVp9e.js";import"./index-BywiX4DN.js";import"./react-select-animated.esm-C8qvyk3o.js";const G=q(e.jsx("path",{d:"M14.17 5 19 9.83V19H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9.83c0-.53-.21-1.04-.59-1.41l-4.83-4.83c-.37-.38-.88-.59-1.41-.59M7 15h10v2H7zm0-4h10v2H7zm0-4h7v2H7z"}),"TextSnippetOutlined"),w=({columns:a,data:s,topBarActions:t,bottomBarActions:p,scroll:n,props:c,isLoading:u,isFetching:g})=>{const[d,h]=l.useState({}),i=S({columns:a,data:s,renderTopToolbarCustomActions:()=>t,renderBottomToolbarCustomActions:()=>p,muiLinearProgressProps:{color:"info",sx:{height:2}},muiCircularProgressProps:{color:"info"},muiTopToolbarProps:t?{sx:{overflow:"none"}}:void 0,muiTableHeadProps:t?{sx:{zIndex:0}}:void 0,muiTableBodyRowProps:({row:r})=>({onClick:()=>h(()=>({[r.id]:!0})),selected:d[r.id],sx:{cursor:"pointer"}}),localization:z,enableFullScreenToggle:!1,positionToolbarAlertBanner:"none",enableStickyHeader:!0,enableStickyFooter:!0,enableDensityToggle:!1,enableFilterMatchHighlighting:!1,muiTableBodyCellProps:{align:"center",sx:{fontFamily:"IranYekan",fontWeight:"300",borderRight:"1px solid #cfcfcf"}},muiTableHeadCellProps:{align:"center",sx:{borderRight:"1px solid #cfcfcf",fontFamily:"Vazir",fontWeight:"600"}},initialState:{density:"compact"},enablePagination:!n,enableBottomToolbar:!n,muiTableContainerProps:n?{sx:{height:"300px"}}:void 0,paginationDisplayMode:"pages",muiPaginationProps:n?void 0:{size:"small",shape:"rounded",rowsPerPageOptions:[5,10,20],renderItem:r=>e.jsx(A,{...r,slots:{previous:L,next:B,first:E,last:$}})},getRowId:r=>r.id,onRowSelectionChange:h,state:{rowSelection:d,isLoading:u,showProgressBars:g},...c});return e.jsx(k,{table:i})},Q=({role:a})=>[{accessorKey:"requestRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:s})=>e.jsx("div",{children:b(s)})},{accessorKey:"requestNO",header:"شماره درخواست",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:b(s)})},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"درخواست کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:R(s)})},{accessorKey:"senderInfo",header:"بررسی درخواست",enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(y,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s.original.requestTypeNameFa})," ",e.jsx("br",{}),e.jsx("span",{children:s.original.personName})]}),children:e.jsx(j,{to:s.original.requestTypeID==="62A54585-F331-434A-9027-C9F3060F683A"?`/retirement/group-slips?requestID=${s.original.id}`:s.original.requestTypeID==="EC1E7E50-9815-442F-9CCB-27F47AB05199"?`/retirement/group-slips?requestID=${s.original.id}&personID=${s.original.personID}`:s.original.requestTypeID==="6E7BA26E-A1DC-4A5E-9700-17820A36158D"?`/retirement/batch-statements?requestID=${s.original.id}`:`/retirement/retired?personID=${s.original.personID}&Role=${a==null?void 0:a.value}&requestID=${s.original.id}`,children:e.jsx("span",{children:e.jsx(f,{color:"success",sx:{padding:"0"},children:e.jsx(G,{color:"success"})})})})})},{accessorKey:"observe",header:"مشاهده درخواست",enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(y,{title:b(s.original.requestNO),children:e.jsx(j,{to:`/retirement/request?requestID=${s.id}&Role=${a==null?void 0:a.value}&type=${s.original.requestTypeID}`,children:e.jsx("span",{children:e.jsx(f,{sx:{padding:"0"},color:"info",children:e.jsx(H,{color:"info"})})})})})}],W=()=>{const[a,s]=l.useState([]),t=I(),{control:p,setValue:n}=M({}),[c,{isLoading:u,isFetching:g}]=P(),d=l.useCallback(async()=>{const i=await c().unwrap(),r=O(i==null?void 0:i.itemList,"url","itemName");s(r),t(x(r[0])),n("role",r[0])},[t,c,n]);l.useEffect(()=>{d()},[d]),l.useEffect(()=>()=>{t(x(null))},[t]);const h=i=>{t(i?x(i):x(null))};return e.jsx("div",{style:{width:"300px",height:"40px",margin:"10px auto"},children:e.jsx(K,{control:p,options:a,isLoading:u||g,onValueChange:h,name:"role",label:"نقش",required:!1})})},_=({isLoading:a,isFetching:s,handleRefresh:t})=>e.jsxs(D,{sx:{display:"flex",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[a||s?e.jsx(f,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(v,{size:20,value:100})}):e.jsx(y,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(f,{"aria-label":"refresh",color:"info",onClick:t,children:e.jsx(V,{fontSize:"small"})})})}),e.jsx(W,{})]}),Y=()=>{const[a,s]=l.useState([]),{role:t}=F(r=>r.role),[p,{isLoading:n,isFetching:c}]=N(),u=l.useCallback(async r=>{try{const m=await p({Role:r}).unwrap(),T=m==null?void 0:m.itemList.map((o,C)=>({id:o.requestID,requestRowNum:C+1,requestNO:o.requestNO||"-",requestTypeID:o.requestTypeID,personID:o.personID,requestTypeNameFa:o.requestTypeNameFa,personName:o.personFirstName+" "+o.personLastName||"-",date:o.requestDate,body:o.requestText}));s(T)}catch(m){console.log(m)}},[p]);l.useEffect(()=>{t?u(t==null?void 0:t.value):s([])},[t,u]);const d=_({isLoading:n,isFetching:c,handleRefresh:()=>{t&&u(t==null?void 0:t.value)}}),h=Q({role:t});return e.jsx(w,{columns:h,data:a,topBarActions:d,scroll:!1,isLoading:n,isFetching:c})};function ie(){return e.jsxs("section",{className:"flex-col",children:[e.jsx("div",{className:"title-primary--container flex-row flex-center",children:e.jsxs("h4",{className:"title-primary",children:[e.jsx("span",{className:"title-primary--underline"}),"کارتابل"]})}),e.jsx(Y,{})]})}export{ie as Cartable};
