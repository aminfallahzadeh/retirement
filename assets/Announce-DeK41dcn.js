import{R as S,dC as g,dD as j,j as e,T as y,dE as b,f as v,b3 as w,I as O,U as T,r,aF as A,b6 as F,G as L,h as k,Y as q,_ as h,t as z,aD as K,dF as P}from"./index-Bjjox_it.js";import{T as G}from"./Title-BBhp-6qg.js";import{D as _,a as B}from"./convertFormData-D4M5lXzZ.js";import{T as M}from"./TextArea-Bsv6sLWw.js";import{D as U}from"./DoneOutlined-BoLa_wwP.js";import{u as V,a as Q,b as W}from"./announceApi-Dhml4itD.js";import{D as Y}from"./DeleteOutline-j2YdfvyZ.js";import"./main-GpxRKVMe.js";const H=a=>[{accessorKey:"announceRowNo",header:S,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"announceTitle",header:g,size:20},{accessorKey:"announceDesc",header:j,size:20,Cell:({renderedCellValue:s,row:n})=>e.jsx(y,{title:e.jsx("p",{children:n.original.description}),children:e.jsx("p",{style:{width:"80ch",textOverflow:"ellipsis",overflow:"hidden"},children:s})}),muiTableBodyCellProps:{align:"right"}},{accessorKey:"announceRunDate",header:b,size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:v(s)})},{accessorKey:"deleteAnnounce",header:w,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:s})=>e.jsx(O,{color:"error",onClick:()=>a(s.original.id),sx:{padding:"0"},children:e.jsx(Y,{})})}],J=({triggerRefetch:a})=>{const[s,n]=T(!1),[c,m]=r.useState(null),[x,f]=r.useState([]),{data:l,isLoading:p,isFetching:D,isSuccess:i,refetch:t}=V({}),[u,{isLoading:C}]=Q(),N=o=>{m(o),n()},R=r.useCallback(async()=>{const o=await u({announceID:c,isDeleted:!0}).unwrap();n(),t(),A.success(o.message)},[u,c,t,n]),E=H(N);return r.useEffect(()=>{if(i){const o=l.itemList.map((d,I)=>({id:d.announceID,announceRowNo:I+1,announceTitle:d.title,announceDesc:d.description,announceRunDate:d.runDate}));f(o)}},[i,l]),r.useEffect(()=>{t()},[a,t]),e.jsxs(e.Fragment,{children:[e.jsx(F,{open:s,onClose:n,isLoading:C,handleRemove:R}),e.jsx(L,{data:x,columns:E,scroll:!1,isLoading:p,isFetching:D})]})},X=()=>{const[a,s]=T(!1),{control:n,handleSubmit:c,formState:{errors:m},setValue:x}=k(),[f,{isLoading:l}]=W(),p=async i=>{const t=B(i,[],["runDate"]),u=await f({...t,runDate:t.runDate,isDelete:!1}).unwrap();s(),A.success(u.message)};return e.jsxs("section",{className:"flex-col",children:[e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:c(p),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx(q,{name:"title",label:g,rules:h,required:!0,control:n,type:"text"}),e.jsx(_,{name:"runDate",label:b,control:n,required:!0,errors:m,rules:h,setValue:x}),e.jsx("div",{}),e.jsx(M,{name:"description",label:j,required:!0,rules:h,control:n,containerClassNames:"col-span-3 row-span-2"})]}),e.jsx("div",{className:"flex-row mr-auto",children:e.jsx(z,{dir:"ltr",endIcon:e.jsx(U,{}),variant:"contained",type:"submit",loading:l,color:"success",children:e.jsx("span",{children:K})})})]}),e.jsx(J,{triggerRefetch:a})]})},ce=()=>e.jsxs("section",{className:"flex-col u-margin-bottom-xl",children:[e.jsx(G,{title:P,back:!0}),e.jsx(X,{})]});export{ce as default};
