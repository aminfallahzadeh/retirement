import{z as Y,r,j as e,A as Ge,x as we,D as z,F as $e,T as P,L as re,I as R,E as Se,H as He,B as K,C as M,P as Ve,J as Qe,K as We,M as Ye,N as Je,Q as Ze,S as ge,U as ne,u as is,h as ye,V as ls,W as cs,X as Me,Y as b,Z as Ce,_ as F,$ as Ne,a0 as Te,a1 as ds,a2 as us,a3 as O,a4 as ps,a5 as ae,a6 as ms,a7 as Re,a8 as hs,a9 as xs,aa as fs,ab as Is,ac as bs,ad as Ds,ae as js,af as gs,ag as Ss,ah as ys,ai as Cs,aj as Ns,ak as Ts,al as Rs,am as Es,an as As,ao as Ls,ap as Ps,aq as ks,ar as Os,as as vs,at as Us,au as Fs,av as qs,aw as zs,ax as Ms,ay as _s,az as Bs,aA as Ks,aB as Gs,aC as ws,t as te,aD as Ee,aE as W,aF as le,i as Xe,aG as $s,aH as Hs,aI as Vs,aJ as _e,aK as Qs,aL as Ws,aM as Ys,aN as Js,aO as Zs,aP as Ae,aQ as Xs,aR as ea,aS as sa,aT as aa,aU as H,aV as ta,aW as ra,aX as na,aY as oa,aZ as ia,a_ as la,a$ as ca,b0 as da,R as Le,f as fe,b1 as es,b2 as ss,b3 as ie,b4 as as,b5 as Pe,b6 as ke,G as Oe,b7 as ua,b8 as ve,b9 as pa,ba as ma,bb as ha,bc as xa,bd as fa,O as Ia,be as Be,bf as ba,bg as Da,bh as ja,bi as ga,bj as Sa,bk as ya,bl as de,bm as Ca,bn as Na,bo as Ta,bp as Ra,bq as Ea}from"./index-BLUnRbnP.js";import{u as Aa,a as La,c as Pa,F as ka}from"./createTree-DJ1GZvkD.js";import{T as Oa}from"./Title-Bf582CR7.js";import{b as va}from"./requestApi-I57nflrb.js";import{S as ts}from"./index-B-J8NS7n.js";/* empty css                 */import{d as rs}from"./table-options-DUfywDkC.js";import{R as be}from"./Refresh-Bg9tv-0i.js";import{u as Ua,S as Fa}from"./SlipFormTemplate-UW0hcxu1.js";import{M as qa}from"./Modal-9byRYG4r.js";import{c as v,S as U}from"./SelectInput-BlCoqIYJ.js";import{p as ns,D as Ie,a as Ue}from"./convertFormData-Ct-h9ABp.js";import{C as se}from"./CustomCheckBox-DGIkocG8.js";import{T as Ke}from"./TextArea-lZ8v4UCv.js";import{D as Fe}from"./DoneOutlined-BJmbYIsy.js";import{E as ce}from"./EditOutlined-Bs5gzNSj.js";import{u as B,a as za,b as Ma}from"./useFetchLookUpData-XCzB5w1t.js";import{S as _a}from"./StatusHistoryGrid-Cp2CfnzP.js";import{u as Ba}from"./sharedApi-BsZa4CyX.js";import{u as Ka,a as Ga}from"./relatedApi-CWCVkmPz.js";import{D as qe}from"./DeleteOutline-Cw8JH0bo.js";import{A as ze}from"./Add-BWPMDa6d.js";import{u as wa,a as $a}from"./heirApi-BuAiEyDv.js";import{u as Ha}from"./statementApi-BPmw7zDc.js";import{A as ue,a as pe,b as me,c as he}from"./ArrowDropDown-Cmsa1th8.js";import{T as Va,a as Qa,b as xe}from"./TabPanel-DPFDG3Kg.js";import"./index-BrkVOUte.js";import"./module-BgA5exZB.js";import"./react-select-animated.esm-CKU__dhn.js";import"./excel-icon-Dq0N6FeV.js";import"./useCloseCalender-BtErBMpJ.js";const Wa=()=>{const[s]=Y(),[n,t]=r.useState([]),[m,N]=r.useState([]),h=s.get("personID"),{data:D,isLoading:a,isSuccess:x,refetch:p}=Aa(),{data:j,isLoading:l,isSuccess:u,refetch:d}=La(h);r.useEffect(()=>{u&&N(j.itemList)},[u,j]),r.useEffect(()=>{if(x){const f=Pa(D.itemList);t(f)}},[x,D]);const y=r.useCallback(()=>{p(),d()},[p,d]);return e.jsx(ka,{structure:n,files:m,isLoading:a||l,refetch:y,access:"files"})};function Ya(){const[s,n]=r.useState({}),[t,m]=r.useState([]),N=Ge(),h=new URLSearchParams(N.search),D=h.get("Role"),a=h.get("personID"),{data:x,isSuccess:p,isLoading:j,isFetching:l,error:u,refetch:d}=va({Role:D,personID:a});r.useEffect(()=>{if(d(),p){const i=x.itemList.map(T=>({id:T.requestID,type:T.requestTypeID,requestNO:T.requestNO||"-",personId:T.personID,requestTypeNameFa:T.requestTypeNameFa||"-",personName:T.personName||"-",date:T.requestDate||"-",body:T.requestText||"-"}));m(i),sessionStorage.setItem("requests",JSON.stringify(i))}},[x,p,d]),r.useEffect(()=>{var i;u&&we.error(((i=u==null?void 0:u.data)==null?void 0:i.message)||u.error,{autoClose:2e3})},[u]);const y=()=>{d()},f=r.useMemo(()=>[{accessorKey:"id",header:"شماره درخواست",size:20,Cell:({renderedCellValue:i})=>e.jsx("div",{children:z(i)})},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"ارسال کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:i})=>e.jsx("div",{children:z($e(i))})},{accessorKey:"observeReq",header:"مشاهده درخواست",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:i})=>e.jsx(P,{title:z(i.original.requestNO),children:e.jsx(re,{to:`/retirement/request?requestID=${i.id}&Role=${D}&type=${i.original.type}`,children:e.jsx(R,{color:"primary",sx:{padding:"0"},children:e.jsx(Se,{})})})})}],[D]),A=He({...rs,columns:f,data:t,muiTableBodyRowProps:({row:i})=>({onClick:()=>n(()=>({[i.id]:!0})),selected:s[i.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsx(K,{children:l?e.jsx(R,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(M,{size:20,value:100})}):e.jsx(P,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(R,{"aria-label":"refresh",color:"info",onClick:y,children:e.jsx(be,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:i=>e.jsx(Ve,{...i,page:z(i.page),slots:{previous:Qe,next:We,first:Ye,last:Je}})},getRowId:i=>i.id,onRowSelectionChange:n,state:{rowSelection:s}});return e.jsx(e.Fragment,{children:j?e.jsx("div",{className:"skeleton-lg",children:e.jsx(ts,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(Ze,{table:A})})}function Ja(){const[s,n]=r.useState({}),[t,m]=r.useState([]),[N,h]=r.useState(null),[D,a]=r.useState(!1),x=Ge(),j=new URLSearchParams(x.search).get("personID"),{data:l,isLoading:u,isSuccess:d,isFetching:y,error:f,refetch:A}=Ua({personID:j,payType:"M"}),k=()=>{A()};r.useEffect(()=>{if(d){const o=l.itemList.map((L,G)=>({id:L.payID,payRowNum:G+1,payCreditAmount:L.payCreditAmount,payDebitAmount:L.payDebitAmount,payAmount:L.payAmount,payDate:L.payDate,currentYear:L.currentYear,currentMonth:L.currentMonth}));m(o)}},[d,A,l]),r.useEffect(()=>{var o;f&&we.error(((o=f==null?void 0:f.data)==null?void 0:o.message)||f.error,{autoClose:2e3})},[f]);const i=()=>{a(!0)},T=r.useMemo(()=>[{accessorKey:"payRowNum",header:"ردیف",size:20,Cell:({renderedCellValue:o})=>e.jsx("div",{children:z(o)})},{accessorKey:"payCreditAmount",header:"مبلغ بستانکاری",size:20,Cell:({renderedCellValue:o})=>e.jsxs("div",{children:[ge(z(o))," ","ریال"]})},{accessorKey:"payDebitAmount",header:"مبلغ بدهکاری",size:20,Cell:({renderedCellValue:o})=>e.jsxs("div",{children:[ge(z(o))," ","ریال"]})},{accessorKey:"payAmount",header:"مبلغ کل",size:20,Cell:({renderedCellValue:o})=>e.jsxs("div",{children:[ge(z(o))," ","ریال"]})},{accessorKey:"payDate",header:"تاریخ پرداخت",size:20,Cell:({renderedCellValue:o})=>e.jsx("div",{children:$e(o)})},{accessorKey:"currentYear",header:"سال مالی",size:20,Cell:({renderedCellValue:o})=>e.jsx("div",{children:z(o)})},{accessorKey:"currentMonth",header:"ماه مالی",size:20,Cell:({renderedCellValue:o})=>e.jsx("div",{children:z(o)})},{accessorKey:"downloadRetiredSlip",header:"مشاهده/چاپ",enableSorting:!1,enableColumnActions:!1,size:20,Cell:()=>e.jsx(P,{title:"دانلود و مشاهده فیش",children:e.jsx(R,{color:"primary",sx:{padding:"0"},onClick:i,children:e.jsx(Se,{})})})}],[]),I=He({...rs,columns:T,data:t,renderTopToolbarCustomActions:()=>e.jsx(K,{children:y?e.jsx(R,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(M,{size:20,value:100})}):e.jsx(P,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(R,{"aria-label":"refresh",color:"info",onClick:k,children:e.jsx(be,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:o=>e.jsx(Ve,{...o,page:z(o.page),slots:{previous:Qe,next:We,first:Ye,last:Je}})},muiTableBodyRowProps:({row:o})=>({onClick:()=>n(()=>({[o.id]:!0})),selected:s[o.id],sx:{cursor:"pointer"}}),getRowId:o=>o.id,onRowSelectionChange:n,state:{rowSelection:s}});return r.useEffect(()=>{const o=Object.keys(I.getState().rowSelection)[0];h(o||null)},[I,s]),e.jsxs(e.Fragment,{children:[D&&N&&e.jsx(qa,{closeModal:()=>a(!1),children:e.jsx(Fa,{payID:N})},N),u?e.jsx("div",{className:"skeleton-lg",children:e.jsx(ts,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(Ze,{table:I})]})}const Za=["personFirstName","personLastName","personNationalCode","personCertificateNo","personFatherName","genderID","personBirthDate","personBirthPlace","personPreviousNam","personIsSacrificedFamily","personIsWarrior","personIsChildOfSacrificed","personIsValiant","personIsSacrificed","personIsCaptive","retiredID","personPhone","personCellPhone","backupPhone","backupFirstName","backupLastName","personEmail","educationTypeID","personCountryID","personStateID","personCityID","personRegion","personArea","personPostalCode","housingTypeID","maritalStatusID","personDeathDate","personAddress","personDescription"],Xa=["retiredGroup","retiredOrganizationID","retiredLastPosition","employmentTypeID","retirementDate","pensionaryStatusID","pensionaryStartdate","retiredJobDegreeCoef","retiredGrantDuration","retiredRealDuration"],et=["bankID","bankBranchID","accountNo","ledgerCode","insuranceCoef","insuranceAmount"],st=()=>{const[s,n]=ne(!1),[t]=Y(),m=is(),N=t.get("personID"),h=r.useMemo(()=>["genderID","personCountryID","personStateID","personCityID","housingTypeID","educationTypeID","maritalStatusID"],[]),D=r.useMemo(()=>["personDeathDate","personBirthDate"],[]),{control:a,handleSubmit:x,formState:{errors:p},setValue:j}=ye(),{data:l,isLoading:u,isFetching:d,isSuccess:y,refetch:f}=ls(N),[A,{isLoading:k}]=cs(),{lookUpItems:i,lookUpItemsIsLoading:T}=B({lookUpType:"Gender"}),I=r.useMemo(()=>v(i,"lookUpID","lookUpName"),[i]),{lookUpItems:c,lookUpItemsIsLoading:o}=B({lookUpType:"EducationType"}),L=r.useMemo(()=>v(c,"lookUpID","lookUpName"),[c]),{lookUpItems:G,lookUpItemsIsLoading:J}=B({lookUpType:"Country"}),V=r.useMemo(()=>v(G,"lookUpID","lookUpName"),[G]),{lookUpItems:Q,lookUpItemsIsLoading:Z}=B({lookUpType:"State"}),w=r.useMemo(()=>v(Q,"lookUpID","lookUpName"),[Q]),{lookUpItems:oe,lookUpItemsIsLoading:g}=B({lookUpType:"City"}),q=r.useMemo(()=>v(oe,"lookUpID","lookUpName"),[oe]),{lookUpItems:$,lookUpItemsIsLoading:De}=B({lookUpType:"HousingType"}),E=r.useMemo(()=>v($,"lookUpID","lookUpName"),[$]),{lookUpItems:C,lookUpItemsIsLoading:S}=B({lookUpType:"MaritialStatus"}),je=r.useMemo(()=>v(C,"lookUpID","lookUpName"),[C]),os=async X=>{const ee=Ue(X,h,D),_=await A(ee).unwrap();f(),n(),le.success(_.message)};return r.useEffect(()=>{if(y){const X=l==null?void 0:l.itemList[0];m(Me((X==null?void 0:X.personDeathDate)!==null));const ee=ns(X,h,D,{genderID:I,educationTypeID:L,personCountryID:V,personStateID:w,personCityID:q,housingTypeID:E,maritalStatusID:je});Object.keys(ee).forEach(_=>{Za.includes(_)&&ee[_]===null?j(_,""):j(_,ee[_])})}return()=>{m(Me(null))}},[m,y,l==null?void 0:l.itemList,j,I,V,L,w,q,E,je,D,h]),e.jsx(e.Fragment,{children:u||d?e.jsx(K,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(M,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:x(os),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(b,{name:"personFirstName",label:Ce,rules:F,required:!0,control:a,editable:s,type:"text"}),e.jsx(b,{name:"personLastName",label:Ne,rules:F,required:!0,control:a,editable:s,type:"text"}),e.jsx(b,{name:"personNationalCode",label:Te,rules:{...ds,...F},required:!0,control:a,editable:s,type:"text"}),e.jsx(b,{name:"personCertificateNo",label:us,rules:{...O,...F},required:!0,control:a,editable:s,type:"text"}),e.jsx(b,{name:"personFatherName",label:ps,rules:ae,required:!0,control:a,editable:s,type:"text"}),e.jsx(U,{name:"genderID",control:a,label:ms,required:!0,isClearable:!0,isDisabled:!s,options:I,isLoading:T,rules:F,errors:p}),e.jsx(Ie,{name:"personBirthDate",label:Re,control:a,disabled:!s,required:!0,errors:p,rules:F,setValue:j}),e.jsx(b,{name:"personBirthPlace",label:hs,rules:ae,required:!1,control:a,editable:s,type:"text"}),e.jsx(b,{name:"personPreviousName",label:xs,rules:ae,required:!1,control:a,editable:s,type:"text"}),e.jsxs("div",{className:s?"checkboxContainer col-span-3":"checkboxContainer--disabled col-span-3",children:[e.jsx("p",{className:"inputBox__form--readOnly-label",children:fs}),e.jsx(se,{disabled:!s,control:a,label:Is,name:"personIsSacrificedFamily"}),e.jsx(se,{disabled:!s,control:a,label:bs,name:"personIsWarrior"}),e.jsx(se,{disabled:!s,control:a,label:Ds,name:"personIsChildOfSacrificed"}),e.jsx(se,{disabled:!s,control:a,label:js,name:"personIsValiant"}),e.jsx(se,{disabled:!s,control:a,label:gs,name:"personIsSacrificed"}),e.jsx(se,{disabled:!s,control:a,label:Ss,name:"personIsCaptive"})]}),e.jsx(b,{name:"retiredID",label:ys,required:!1,control:a,editable:!1,type:"text"}),e.jsx(b,{name:"personPhone",label:Cs,required:!1,rules:O,control:a,editable:s,type:"text"}),e.jsx(b,{name:"personCellPhone",label:Ns,required:!1,rules:Ts,control:a,editable:s,type:"text"}),e.jsx(b,{name:"backupPhone",label:Rs,required:!1,rules:O,control:a,editable:s,type:"text"}),e.jsx(b,{name:"backupFirstName",label:Es,required:!1,rules:ae,control:a,editable:s,type:"text"}),e.jsx(b,{name:"backupLastName",label:As,required:!1,rules:ae,control:a,editable:s,type:"text"}),e.jsx(b,{name:"personEmail",label:Ls,required:!1,rules:Ps,control:a,editable:s,type:"text"}),e.jsx(U,{name:"educationTypeID",control:a,label:ks,required:!1,isClearable:!0,isDisabled:!s,options:L,isLoading:o}),e.jsx(U,{name:"personCountryID",control:a,label:Os,required:!1,isClearable:!0,isDisabled:!s,options:V,isLoading:J}),e.jsx(U,{name:"personStateID",control:a,label:vs,required:!1,isClearable:!0,isDisabled:!s,options:w,isLoading:Z}),e.jsx(U,{name:"personCityID",control:a,label:Us,required:!1,isClearable:!0,isDisabled:!s,options:q,isLoading:g}),e.jsx(b,{name:"personRegion",label:Fs,required:!1,control:a,editable:s,rules:O,type:"text"}),e.jsx(b,{name:"personArea",label:qs,required:!1,control:a,editable:s,rules:O,type:"text"}),e.jsx(b,{name:"personPostalCode",label:zs,required:!1,control:a,editable:s,rules:Ms,type:"text"}),e.jsx(U,{name:"housingTypeID",control:a,label:_s,required:!1,isClearable:!0,isDisabled:!s,options:E,isLoading:De}),e.jsx(U,{name:"maritalStatusID",control:a,label:Bs,required:!1,isClearable:!0,isDisabled:!s,options:je,isLoading:S}),e.jsx(Ie,{name:"personDeathDate",label:Ks,control:a,disabled:!s,required:!1,setValue:j}),e.jsx(Ke,{name:"personAddress",label:Gs,required:!0,control:a,editable:s,containerClassNames:"col-span-3"}),e.jsx(Ke,{name:"personDescription",label:ws,required:!0,control:a,editable:s,containerClassNames:"col-span-4 row-span-2"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(te,{dir:"ltr",endIcon:e.jsx(Fe,{}),disabled:!s,variant:"contained",type:"submit",loading:k,color:"success",children:e.jsx("span",{children:Ee})}),e.jsx(te,{dir:"ltr",endIcon:e.jsx(ce,{}),onClick:n,disabled:s,variant:"contained",color:"primary",children:e.jsx("span",{children:W})})]})]})})})},at=()=>{const[s,n]=r.useState([]),[t,m]=ne(!1),[N]=Y(),h=N.get("personID"),{personDeathDate:D}=Xe(E=>E.person),a=r.useMemo(()=>["retiredOrganizationID","employmentTypeID","pensionaryStatusID"],[]),x=r.useMemo(()=>["retirementDate","pensionaryStartdate"],[]),{control:p,handleSubmit:j,formState:{errors:l},setValue:u}=ye(),{data:d,isSuccess:y,isLoading:f,isFetching:A,refetch:k}=$s(h),{data:i,isSuccess:T,isLoading:I,isFetching:c,refetch:o}=Hs(h),[L,{isLoading:G}]=Vs(),{organizations:J,organizationIsLoading:V}=za({}),{lookUpItems:Q,lookUpItemsIsLoading:Z}=B({lookUpType:"EmploymentType"}),{pensionaryStatus:w,pensionaryStatusIsLoading:oe}=Ma({pensionaryStatusCategory:"R",pensionaryStatusIsDead:D}),g=r.useMemo(()=>v(J,"organizationID","organizationName"),[J]),q=r.useMemo(()=>v(Q,"lookUpID","lookUpName"),[Q]),$=r.useMemo(()=>v(w,"pensionaryStatusID","pensionaryStatusName"),[w]);r.useEffect(()=>{if(y){const E=d==null?void 0:d.itemList[0];if(E){const C={...E};Object.keys(C).forEach(S=>{S==="retirementDate"&&(C[S]=C[S]===null?null:_e(C[S])),S==="pensionaryStartdate"&&(C[S]=C[S]===null?null:_e(C[S])),u(S,C[S])})}}},[y,d==null?void 0:d.itemList,u]);const De=async E=>{const C=Ue(E,a,x),S=await L({...C,retiredGroup:parseInt(H(E.retiredGroup)),retiredJobDegreeCoef:parseInt(H(E.retiredJobDegreeCoef)),retiredRealDuration:parseInt(H(E.retiredRealDuration)),retiredGrantDuration:parseInt(H(E.retiredGrantDuration)),personID:h}).unwrap();m(),k(),o(),le.success(S.message)};return r.useEffect(()=>{if(y){const E=d==null?void 0:d.itemList[0],C=ns(E,a,x,{retiredOrganizationID:g,employmentTypeID:q,pensionaryStatusID:$});Object.keys(C).forEach(S=>{Xa.includes(S)&&C[S]===null?u(S,""):u(S,C[S])})}},[y,d==null?void 0:d.itemList,g,q,$,u,a,x]),r.useEffect(()=>{if(T){const E=i==null?void 0:i.itemList.map((C,S)=>({id:C.pensionaryID,isActive:C.pensionaryIsActive,pensionaryStatusRowNum:S+1,pensionaryStatusName:C.pensionaryStatusName||"-",pensionaryStartdate:C.pensionaryStartdate||"-"}));n(E)}},[T,i==null?void 0:i.itemList]),e.jsx(e.Fragment,{children:f||A?e.jsx(K,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(M,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:j(De),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(b,{name:"retiredGroup",label:Qs,control:p,required:!0,editable:t,rules:{...F,...O},type:"text"}),e.jsx(U,{name:"retiredOrganizationID",control:p,label:Ws,required:!0,isClearable:!0,isDisabled:!t,options:g,isLoading:V,rules:F,errors:l}),e.jsx(b,{name:"retiredLastPosition",label:Ys,control:p,required:!1,editable:t,rules:ae,type:"text"}),e.jsx(U,{name:"employmentTypeID",control:p,label:Js,required:!0,isClearable:!0,isDisabled:!t,options:q,isLoading:Z,rules:F,errors:l}),e.jsx(Ie,{name:"retirementDate",label:Zs,control:p,disabled:!t,required:!1,errors:l,rules:F,setValue:u}),e.jsx(U,{name:"pensionaryStatusID",control:p,label:Ae,required:!0,isClearable:!0,isDisabled:!t,options:$,isLoading:oe,rules:F,errors:l}),e.jsx(Ie,{name:"pensionaryStartdate",label:Xs,control:p,disabled:!t,required:!0,errors:l,rules:F,setValue:u}),e.jsx(b,{name:"retiredJobDegreeCoef",label:ea,control:p,required:!1,editable:t,rules:O,type:"text"}),e.jsx(b,{name:"retiredGrantDuration",label:sa,control:p,required:!1,editable:t,rules:O,type:"text"}),e.jsx(b,{name:"retiredRealDuration",label:aa,control:p,required:!1,editable:t,rules:O,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(te,{dir:"ltr",endIcon:e.jsx(Fe,{}),disabled:!t,variant:"contained",type:"submit",loading:G,color:"success",children:e.jsx("span",{children:Ee})}),e.jsx(te,{dir:"ltr",endIcon:e.jsx(ce,{}),onClick:m,disabled:t,variant:"contained",color:"primary",children:e.jsx("span",{children:W})})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(_a,{data:s,isLoading:I,isFetching:c})]})})})},tt=()=>{const[s,n]=ne(!1),[t,m]=r.useState([]),[N]=Y(),h=N.get("personID"),D=r.useMemo(()=>["bankID","bankBranchID"],[]),a=r.useMemo(()=>[],[]),{control:x,handleSubmit:p,formState:{errors:j},setValue:l,watch:u}=ye(),d=u("bankID"),{lookUpItems:y,lookUpItemsIsLoading:f}=B({lookUpType:"Bank"}),A=r.useMemo(()=>v(y,"lookUpID","lookUpName"),[y]),[k,{isLoading:i,isFetching:T}]=Ba(),I=r.useMemo(()=>v(t,"lookUpID","lookUpName"),[t]),{data:c,isSuccess:o,isLoading:L,isFetching:G,refetch:J}=ta(h),[V,{isLoading:Q}]=ra(),Z=r.useCallback(async g=>{const q=await k({lookUpType:"BankBranch",lookUpParentID:g}).unwrap();m(q.itemList)},[k]),w=async g=>{const q=Ue(g,D,a),$=await V({...q,accountNo:H(g.accountNo)||null,ledgerCode:parseInt(H(g.ledgerCode))||null,insuranceAmount:parseFloat(H(g.insuranceAmount))||null,insuranceCoef:parseFloat(H(g.insuranceCoef))||null,personID:h}).unwrap();J(),n(),le.success($.message)};return r.useEffect(()=>{d?Z(d.value):(l("bankBranchID",null),m([]))},[d,Z,l]),r.useEffect(()=>{o&&({...c},Object.keys(c).forEach(g=>{et.includes(g)&&c[g]===null?l(g,""):l(g,c[g])}))},[o,c,l]),r.useEffect(()=>{o&&A.length>0&&l("bankID",A.find(g=>g.value===c.bankID))},[o,c,l,A]),r.useEffect(()=>{o&&I.length>0&&l("bankBranchID",I.find(g=>g.value===c.bankBranchID))},[o,c,l,I]),e.jsx(e.Fragment,{children:L||G?e.jsx(K,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(M,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:p(w),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(U,{name:"bankID",control:x,label:na,required:!1,isClearable:!0,isDisabled:!s,options:A,isLoading:f,errors:j}),e.jsx(U,{name:"bankBranchID",control:x,label:oa,required:!1,isClearable:!0,isDisabled:!s,options:I,isLoading:i||T,errors:j}),e.jsx(b,{name:"accountNo",label:ia,rules:O,required:!1,control:x,editable:s,type:"text"}),e.jsx(b,{name:"ledgerCode",label:la,rules:O,required:!1,control:x,editable:s,type:"text"}),e.jsx(b,{name:"insuranceCoef",label:ca,rules:O,required:!1,control:x,editable:s,type:"text"}),e.jsx(b,{name:"insuranceAmount",label:da,rules:O,required:!1,control:x,editable:s,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(te,{dir:"ltr",endIcon:e.jsx(Fe,{}),disabled:!s,variant:"contained",type:"submit",loading:Q,color:"success",children:e.jsx("span",{children:Ee})}),e.jsx(te,{dir:"ltr",endIcon:e.jsx(ce,{}),onClick:n,disabled:s,variant:"contained",color:"primary",children:e.jsx("span",{children:W})})]})]})})})},rt=(s,n)=>[{accessorKey:"relatedRowNo",header:Le,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"personNationalCode",header:Te,size:20},{accessorKey:"personFirstName",header:Ce,size:20},{accessorKey:"personLastName",header:Ne,size:20},{accessorKey:"pensionaryIsUnderGauranteeText",header:Ae,size:20},{accessorKey:"personBirthDate",header:Re,size:20,Cell:({renderedCellValue:t})=>e.jsx("div",{children:fe(t)})},{accessorKey:"relationshipWithParentName",header:es,size:20},{accessorKey:"updateRelated",header:W,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:t})=>e.jsx(P,{title:`${W} "${t.original.personFirstName} ${t.original.personLastName}"`,children:e.jsx(re,{to:`${ss}?mode=update&id=${s}&personID=${t.original.id}`,children:e.jsx(ce,{color:"success"})})})},{accessorKey:"deleteRelated",header:ie,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:t})=>e.jsx(P,{title:`${ie} "${t.original.personFirstName} ${t.original.personLastName}"`,children:e.jsx(R,{color:"error",onClick:()=>n(t.original.pensionaryID),sx:{padding:"0"},children:e.jsx(qe,{})})})}],nt=(s,n,t,m)=>e.jsxs(K,{children:[n||s?e.jsx(R,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(M,{size:20,value:100})}):e.jsx(P,{title:as,children:e.jsx("span",{children:e.jsx(R,{"aria-label":"refresh",color:"info",onClick:t,children:e.jsx(be,{fontSize:"small"})})})}),n||s?e.jsx(R,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(M,{size:20,value:100})}):e.jsx(P,{title:Pe,children:e.jsx(re,{to:`${ss}?mode=create&id=${m}`,children:e.jsx(R,{"aria-label":"refresh",color:"success",children:e.jsx(ze,{fontSize:"small"})})})})]}),ot=()=>{const[s,n]=r.useState([]),[t,m]=ne(!1),[N,h]=r.useState(""),[D]=Y(),a=D.get("personID"),{data:x,isSuccess:p,isLoading:j,isFetching:l,refetch:u}=Ka(a),[d,{isLoading:y}]=Ga();r.useEffect(()=>{if(p){const I=x.itemList.map((c,o)=>({id:c.personID,relatedRowNo:o+1,pensionaryID:c.pensionaryID,personBirthDate:c.personBirthDate,personNationalCode:c.personNationalCode,personFirstName:c.personFirstName,personLastName:c.personLastName,pensionaryIsUnderGauranteeText:c.pensionaryIsUnderGauranteeText,relationshipWithParentName:c.relationshipWithParentName}));n(I)}},[p,x]);const f=async()=>{const I=await d({pensionaryID:N}).unwrap();m(),u(),le.success(I.message)},k=rt(a,I=>{h(I),m()}),i=nt(j,l,u,a);return e.jsxs(e.Fragment,{children:[e.jsx(ke,{open:t,onClose:m,isLoading:y,handleRemove:f}),e.jsx(Oe,{data:s,columns:k,scroll:!1,topBarActions:i,isLoading:j,isFetching:l})]})},it=(s,n)=>[{accessorKey:"heirRowNo",header:Le,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"heirNationalCode",header:Te,size:20},{accessorKey:"heirFirstName",header:Ce,size:20},{accessorKey:"heirLastName",header:Ne,size:20},{accessorKey:"heirPensionaryIsUnderGauranteeText",header:Ae,size:20},{accessorKey:"heirBirthDate",header:Re,size:20,Cell:({renderedCellValue:t})=>e.jsx("div",{children:fe(t)})},{accessorKey:"heirRelationshipWithParentName",header:es,size:20},{accessorKey:"heirParentPersonNationalCode",header:ua,size:20},{accessorKey:"updateHeir",header:W,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:t})=>e.jsx(P,{title:`${W} "${t.original.personFirstName} ${t.original.personLastName}"`,children:e.jsx(re,{to:`${ve}?mode=update&id=${s}&personID=${t.original.id}`,children:e.jsx(ce,{color:"success"})})})},{accessorKey:"deleteRelated",header:ie,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:t})=>e.jsx(P,{title:`${ie} "${t.original.personFirstName} ${t.original.personLastName}"`,children:e.jsx(R,{color:"error",onClick:()=>n(t.original.pensionaryID),sx:{padding:"0"},children:e.jsx(qe,{})})})}],lt=(s,n,t,m)=>e.jsxs(K,{children:[n||s?e.jsx(R,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(M,{size:20,value:100})}):e.jsx(P,{title:as,children:e.jsx("span",{children:e.jsx(R,{"aria-label":"refresh",color:"info",onClick:t,children:e.jsx(be,{fontSize:"small"})})})}),n||s?e.jsx(R,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(M,{size:20,value:100})}):e.jsx(P,{title:Pe,children:e.jsx(re,{to:`${ve}?mode=create&id=${m}`,children:e.jsx(R,{"aria-label":"refresh",color:"success",children:e.jsx(ze,{fontSize:"small"})})})})]}),ct=()=>{const[s,n]=r.useState(""),[t,m]=r.useState([]),[N,h]=ne(!1),[D]=Y(),a=D.get("personID"),{data:x,isLoading:p,isSuccess:j,isFetching:l,refetch:u}=wa(a),[d,{isLoading:y}]=$a();r.useEffect(()=>{if(j){const I=x.itemList.map((c,o)=>({id:c.personID,heirRowNo:o+1,pensionaryID:c.pensionaryID,heirNationalCode:c.personNationalCode,heirFirstName:c.personFirstName,heirLastName:c.personLastName,heirPensionaryIsUnderGauranteeText:c.pensionaryIsUnderGauranteeText,heirBirthDate:c.personBirthDate,heirRelationshipWithParentName:c.relationshipWithParentName,heirParentPersonNationalCode:c.parentPersonNationalCode}));m(I)}},[j,x]);const f=async()=>{const I=await d({pensionaryID:s}).unwrap();u(),h(),le.success(I.message)},k=it(a,I=>{n(I),h()}),i=lt(p,l,u,a);return e.jsxs(e.Fragment,{children:[e.jsx(ke,{open:N,onClose:h,isLoading:y,handleRemove:f}),e.jsx(Oe,{data:t,columns:k,scroll:!1,topBarActions:i,isLoading:p,isFetching:l})]})},dt=s=>[{accessorKey:"retirementStatementRowNo",size:20,header:Le,enableColumnActions:!1,enableSorting:!1},{accessorKey:"retirementStatementNo",size:20,header:pa},{accessorKey:"retirementStatementSerial",size:20,header:ma},{accessorKey:"retirementStatementTypeName",size:20,header:ha},{accessorKey:"retirementStatementIssueDate",header:xa,Cell:({renderedCellValue:n})=>e.jsx("div",{children:fe(n)})},{accessorKey:"retirementStatementRunDate",header:fa,Cell:({renderedCellValue:n})=>e.jsx("div",{children:fe(n)})},{accessorKey:"observeRetirementStatement",header:Ia,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:n})=>e.jsx(P,{title:`${Be} ${n.original.retirementStatementSerial}`,children:e.jsx(re,{to:`${ve}/retirement-statement?id=${n.original.id}`,children:e.jsx(Se,{color:"primary"})})})},{accessorKey:"deleteRetirementStatement",header:ie,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:n})=>e.jsx(P,{title:n.original.retirementStatementIssueConfirmDate?ba:`${Be} ${n.original.retirementStatementSerial}`,children:e.jsx("span",{children:e.jsx(R,{disabled:!!n.original.retirementStatementIssueConfirmDate,color:"error",onClick:()=>s(n.original.id),sx:{padding:"0"},children:e.jsx(qe,{})})})})}],ut=(s,n)=>e.jsx(K,{children:n||s?e.jsx(R,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(M,{size:20,value:100})}):e.jsx(P,{title:Pe,children:e.jsx(R,{"aria-label":"refresh",color:"success",children:e.jsx(ze,{fontSize:"small"})})})}),pt=()=>{const[s,n]=r.useState([]),[t,m]=ne(!1),[N]=Y(),h=N.get("personID"),{data:D,isSuccess:a,isLoading:x,isFetching:p}=Ha({personID:h});r.useEffect(()=>{if(a){const y=D.map((f,A)=>({id:f.retirementStatementID,retirementStatementRowNo:A+1,retirementStatementSerial:f.retirementStatementSerial,retirementStatementTypeName:f.retirementStatementTypeName,retirementStatementNo:f.retirementStatementNo||"-",retirementStatementIssueDate:f.retirementStatementIssueDate,retirementStatementRunDate:f.retirementStatementRunDate,retirementStatementIssueConfirmDate:f.retirementStatementIssueConfirmDate}));n(y)}},[a,D]);const l=dt(y=>{m()}),u=ut(x,p);return e.jsxs(e.Fragment,{children:[e.jsx(ke,{open:t,onClose:m}),e.jsx(Oe,{data:s,columns:l,scroll:!0,topBarActions:u,isLoading:x,isFetching:p,sorting:[{id:"retirementStatementIssueDate",desc:!0}]})]})},$t=()=>{const[s,n]=r.useState("1"),{personDeathDate:t}=Xe(h=>h.person),m=(h,D)=>{n(D)};return e.jsxs("section",{className:"flex-col mb-20",children:[e.jsx(Oa,{title:Da,back:!0}),e.jsxs("div",{"data-name":"retired-forms",children:[e.jsxs(ue,{children:[e.jsx(pe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(me,{}),children:ja}),e.jsx(he,{children:e.jsx(st,{})})]}),e.jsxs(ue,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(pe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(me,{}),children:ga}),e.jsx(he,{children:e.jsx(at,{})})]}),e.jsxs(ue,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(pe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(me,{}),children:Sa}),e.jsx(he,{children:e.jsx(tt,{})})]}),e.jsxs(ue,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(pe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(me,{}),children:ya}),e.jsx(he,{children:e.jsx(Wa,{})})]})]}),e.jsx("div",{"data-name":"retired-grids",children:e.jsxs(Va,{value:s,children:[e.jsx(K,{sx:{bgcolor:"background.paper",borderRadius:1},children:e.jsxs(Qa,{onChange:m,"aria-label":"tabs",variant:"fullWidth",children:[e.jsx(de,{label:t?Ca:Na,value:"1"}),e.jsx(de,{label:Ta,value:"2"}),e.jsx(de,{label:Ra,value:"3"}),e.jsx(de,{label:Ea,value:"4"})]})}),e.jsx(xe,{value:"1",sx:{padding:"0"},children:t?e.jsx(ct,{}):e.jsx(ot,{})}),e.jsx(xe,{value:"2",sx:{padding:"0"},children:e.jsx(e.Fragment,{children:e.jsx(pt,{})})}),e.jsx(xe,{value:"3",sx:{padding:"0"},children:e.jsx(Ja,{})}),e.jsx(xe,{value:"4",sx:{padding:"0"},children:e.jsx(Ya,{})})]})})]})};export{$t as default};
