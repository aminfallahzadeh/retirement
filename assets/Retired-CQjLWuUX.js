import{v as ke,r as a,j as e,w as hn,H as Ne,x as h,y as Pe,z as ns,B as pe,I as H,C as ce,T as ae,P as as,A as ts,D as rs,F as os,J as is,M as ls,d as Oe,K as Hs,N as ks,q as le,Q as W,n as he,S as zs,t as N,U as cs,V as xn,W as gn,X as jn,m as In,L as Os,E as $s,Y as Ps,Z as ps,u as Nn,_ as bn,$ as fn,a0 as Us,a1 as M,a2 as Gs,a3 as ie,a4 as Ks,a5 as Ys,a6 as Dn,a7 as yn,a8 as ne,a9 as Cn,aa as fe,ab as Sn,ac as Ws,ad as Bn,ae as vn,af as kn,ag as Pn,ah as On,ai as Ln,aj as Rn,ak as Fn,al as An,am as _n,an as Tn,ao as Mn,ap as Un,aq as En,ar as qn,as as wn,at as Hn,au as zn,av as $n,aw as Gn,ax as Kn,ay as Yn,az as Wn,aA as Vn,aB as Qn,aC as Jn,aD as Zn,aE as Xn,aF as ea,aG as sa,aH as na,aI as Ls,aJ as ve,aK as us,e as Vs,aL as aa,aM as ta,aN as Es,aO as ra,aP as oa,aQ as ia,aR as la,aS as ca,aT as Qs,aU as pa,aV as ua,aW as da,aX as ma,aY as je,aZ as ha,a_ as xa,a$ as ga,b0 as ja,b1 as Ia,b2 as Na,b3 as ba,b4 as fa,R as Da,a as ya,b5 as Ca,b6 as qs,b7 as Sa,b8 as Ba,b9 as va,G as ka,ba as Pa,bb as Oa,bc as La,bd as Ra,be as Fa,bf as We,bg as Aa,bh as _a,bi as Ta,bj as Ma,bk as Ua}from"./index-22iEO3lt.js";import{u as Ea,a as qa,c as wa,F as Ha}from"./createTree-BsbQSxgO.js";import{T as za}from"./Title-BLyN--kQ.js";import{R as $a}from"./RetiredStatementsGrid-DTBogwUv.js";/* empty css                 */import{M as es}from"./Modal-CMuFQNpv.js";import{u as Rs}from"./sharedApi-BOYCG75A.js";import{u as Js,a as $,b as Fs,c as Ga}from"./useFetchLookUpData-Cn_M0P4H.js";import{u as Zs,m as De,C as ye}from"./main-CAS2Gbdi.js";import{d as ds}from"./table-options-42Dqni_C.js";import{R as Le}from"./Refresh-BgEcj7at.js";import{i as Xs,S as V}from"./react-select-animated.esm-BLoX3LIO.js";import{o as Q,s as k,a as J}from"./reactSelect-BGq5yAQc.js";import{d as Ce,a as Se}from"./datePicker-XXmtGBIB.js";import{S as As}from"./index-DObdhRZm.js";import{E as Re}from"./EditOutlined--O1zPadF.js";import{D as en}from"./DeleteOutline-PVHX3dMr.js";import{A as sn}from"./Add-lesWckZY.js";import{b as Ka}from"./requestApi-VbUpJgqJ.js";import{u as Ya,S as Wa}from"./SlipFormTemplate-V1u1YMzB.js";import{c as re,S as oe}from"./SelectInput-DNBvsqo2.js";import{p as nn,D as ss,a as _s,S as Va,u as Qa,b as Ja}from"./relatedApi-DFwkXxdJ.js";import{C as be}from"./CustomCheckBox-C7fSXpMa.js";import{T as ws}from"./TextArea-DIRljnS5.js";import{D as Ts}from"./DoneOutlined-D1yVC61k.js";import{A as Ve,a as Qe,b as Je,c as Ze}from"./ArrowDropDown-BpCskMYG.js";import{T as Za,a as Xa,b as Xe}from"./TabPanel-fZlEgLbB.js";import"./index-LTKJOWzp.js";import"./statementApi-Bq1aAGei.js";import"./module-CxkydNP1.js";import"./excel-icon-Dq0N6FeV.js";const et=()=>{const[t]=ke(),[m,p]=a.useState([]),[S,U]=a.useState([]),f=t.get("personID"),{data:F,isLoading:i,isSuccess:v,refetch:u}=Ea(),{data:L,isLoading:j,isSuccess:B,refetch:b}=qa(f);a.useEffect(()=>{B&&U(L.itemList)},[B,L]),a.useEffect(()=>{if(v){const q=wa(F.itemList);p(q)}},[v,F]);const A=a.useCallback(()=>{u(),b()},[u,b]);return e.jsx(Ha,{structure:m,files:S,isLoading:i||j,refetch:A,access:"files"})},st=hn.injectEndpoints({endpoints:t=>({getHeirListByParentPersonID:t.query({query:m=>({url:`${Ne}/GetHeirListByParentPersonID?parentPersonID=${m}`})}),getHeir:t.query({query:m=>({url:`${Ne}/GetHeir?personID=${m}`})}),insertHeir:t.mutation({query:m=>({url:`${Ne}/InsertHeir`,method:"POST",body:m})}),updateHeir:t.mutation({query:m=>({url:`${Ne}/UpdateHeir`,method:"POST",body:m})}),updateHeirAccount:t.mutation({query:({token:m,data:p})=>({url:`${Ne}/UpdateHeirAccount`,method:"POST",body:p,headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`}})}),removeHeir:t.mutation({query:({pensionaryID:m})=>({url:`${Ne}/RemoveHeir?pensionaryID=${m}`,method:"POST"})})})}),{useGetHeirListByParentPersonIDQuery:nt,useLazyGetHeirListByParentPersonIDQuery:sr,useGetHeirQuery:at,useRemoveHeirMutation:tt,useUpdateHeirMutation:rt,useInsertHeirMutation:ot}=st;function it({statusHistoryTableData:t,isLoading:m,isFetching:p,handleRefresh:S}){const[U,f]=a.useState({pageIndex:0,pageSize:3}),F=a.useMemo(()=>[{accessorKey:"pensionaryStatusRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:u})=>e.jsx("div",{children:h(u)})},{accessorKey:"pensionaryStatusName",header:"وضعیت",size:20,Cell:({renderedCellValue:u})=>e.jsx("div",{children:h(u)})},{accessorKey:"pensionaryStartdate",header:"تاریخ شروع",size:20,Cell:({renderedCellValue:u})=>e.jsx("div",{children:Pe(u)})},{accessorKey:"isActive",header:"وضعیت",size:20,Cell:({renderedCellValue:u})=>e.jsx("div",{children:u===!0?"فعال":"غیرفعال"})}],[]),i=ns({...ds,columns:F,data:t,muiTopToolbarProps:{sx:{overflow:"none"}},muiTableBodyRowProps:({row:u})=>({sx:{color:u.original.isActive?"#087a30":"","& td":{color:u.original.isActive?"#087a30":""}}}),muiTableHeadProps:{sx:{zIndex:0}},renderTopToolbarCustomActions:()=>e.jsx(pe,{children:m||p?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"info",onClick:S,children:e.jsx(Le,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:u=>e.jsx(as,{...u,page:h(u.page),slots:{previous:ts,next:rs,first:os,last:is}})},initialState:{density:"compact",sorting:[{id:"isActive",desc:!0}]},onPaginationChange:f,state:{pagination:U}});return e.jsx(ls,{table:i})}function lt({setShowEditHeirModal:t,personID:m,refetch:p}){const S=a.useRef(null),U=a.useRef(null),f=a.useRef(null),[F,i]=a.useState([]),[v,u]=a.useState([]),[L,j]=a.useState(null),[B,b]=a.useState(!1);a.useState(null);const[A,q]=a.useState(null),[w,z]=a.useState(null),[r,y]=a.useState(!1),[x,C]=a.useState(!1),{handleSubmit:s,formState:{errors:o},control:T,register:P,watch:X,setValue:ee}=Oe(),n=X(),[se,{isLoading:G}]=rt(),I=Xs(),d=new URLSearchParams(location.search).get("personID"),[R,{isLoading:E,isFetching:_}]=Rs(),{data:O,isSuccess:xe,isLoading:Be,isFetching:Fe,refetch:te,error:Y}=Hs(m),{data:Z,isSuccess:Ae,isLoading:ms,isFetching:hs,error:ue,refetch:_e}=at(m);a.useEffect(()=>{if(te(),xe){const g=O==null?void 0:O.itemList.map((l,ge)=>({id:l.pensionaryID,isActive:l.pensionaryIsActive,pensionaryStatusRowNum:ge+1,pensionaryStatusName:l.pensionaryStatusName||"-",pensionaryStartdate:ks(l.pensionaryStartdate)||"-"}));u(g)}return()=>{u([])}},[te,xe,O]),a.useEffect(()=>{_e(),Ae&&Object.keys(Z).forEach(g=>{ee(g,Z[g])})},[Ae,Z,_e,ee]),a.useEffect(()=>{var g;ue&&ue.status!=="FETCH_ERROR"&&le.error(((g=ue==null?void 0:ue.data)==null?void 0:g.message)||ue.error,{autoClose:2e3})},[ue]),a.useEffect(()=>{var g;Y&&(console.log(Y),le.error(((g=Y==null?void 0:Y.data)==null?void 0:g.message)||Y.error,{autoClose:2e3}))},[Y]);const{relationships:xs,relationshipIsLoading:gs,relationshipIsFetching:js}=Js(),{lookUpItems:Is,lookUpItemsIsLoading:Ns,lookUpItemsIsFetching:bs}=$({lookUpType:"MaritialStatus"}),{lookUpItems:Te,lookUpItemsIsLoading:Me,lookUpItemsIsFetching:Ue}=$({lookUpType:"Country"}),{lookUpItems:Ee,lookUpItemsIsLoading:qe,lookUpItemsIsFetching:we}=$({lookUpType:"State"}),{lookUpItems:He,lookUpItemsIsLoading:ze,lookUpItemsIsFetching:$e}=$({lookUpType:"City"}),{pensionaryStatus:fs,pensionaryStatusIsLoading:Ds,pensionaryStatusIsFetching:ys}=Fs({pensionaryStatusCategory:"H"}),{lookUpItems:Cs,lookUpItemsIsLoading:Ss,lookUpItemsIsFetching:Bs}=$({lookUpType:"Bank"}),Ge=Q(xs,"relationshipID","relationshipName"),vs=Q(Is,"lookUpID","lookUpName"),D=Q(Te,"lookUpID","lookUpName"),c=Q(Ee,"lookUpID","lookUpName"),de=Q(He,"lookUpID","lookUpName"),me=Q(fs,"pensionaryStatusID","pensionaryStatusName"),Ke=Q(Cs,"lookUpID","lookUpName"),Ms=Q(F,"lookUpID","lookUpName"),Ye=a.useCallback(async g=>{try{const l=await R({lookUpType:"BankBranch",lookUpParentID:g}).unwrap();i(l.itemList)}catch(l){console.log(l)}},[R,i]);a.useEffect(()=>{n.bankID&&Ye(n.bankID)},[n.bankID,Ye]),a.useEffect(()=>{n.bankID&&Ye(n.bankID)},[n.bankID,Ye]);const tn=g=>{j(g),b(!1)},rn=g=>{z(g),y(!1)},on=g=>{q(g),C(!1)},ln=g=>{C(g)},cn=g=>{b(g)},pn=g=>{y(g)};a.useEffect(()=>{j(ks(n==null?void 0:n.personBirthDate))},[n==null?void 0:n.personBirthDate]),a.useEffect(()=>{z(ks(n==null?void 0:n.personBaseFinishDate))},[n==null?void 0:n.personBaseFinishDate]);const un=()=>{te()},dn=async()=>{var g;try{let l,ge,Ie;L?(l=new Date(L),l.setMinutes(l.getMinutes()-l.getTimezoneOffset())):l=null,A?(ge=new Date(A),ge.setMinutes(ge.getMinutes()-ge.getTimezoneOffset())):ge=null,w?(Ie=new Date(w),Ie.setMinutes(Ie.getMinutes()-Ie.getTimezoneOffset())):Ie=null;const mn=await se({...n,relationshipWithParentID:N(n==null?void 0:n.relationshipWithParentID),personNationalCode:N(n==null?void 0:n.personNationalCode),personCertificateNo:N(n==null?void 0:n.personCertificateNo),personBirthDate:l,maritalStatusID:N(n==null?void 0:n.maritalStatusID),personPhone:N(n==null?void 0:n.personPhone),personCellPhone:N(n==null?void 0:n.personCellPhone),personRegion:parseInt(N(n==null?void 0:n.personRegion))||null,personArea:parseInt(N(n==null?void 0:n.personArea))||null,personCountryID:N(n==null?void 0:n.personCountryID),personStateID:N(n==null?void 0:n.personStateID),personCityID:N(n==null?void 0:n.personCityID),personPostalCode:N(n==null?void 0:n.personPostalCode),pensionaryStatusID:N(n==null?void 0:n.pensionaryStatusID),personBaseFinishDate:Ie,bankID:N(n==null?void 0:n.bankID),bankBranchID:N(n==null?void 0:n.bankBranchID),accountNo:N(n==null?void 0:n.accountNo),insuranceCoef:parseFloat(N(n==null?void 0:n.insuranceCoef))||0,insuranceAmount:parseFloat(N(n==null?void 0:n.insuranceAmount))||0,ledgerCode:parseInt(N(n.ledgerCode))||0,parentPersonID:d,pensionaryStartDate:ge}).unwrap();t(!1),p(),le.success(mn.message,{autoClose:2e3})}catch(l){console.log(l),le.error(((g=l==null?void 0:l.data)==null?void 0:g.message)||l.error,{auroClose:2e3})}};return Zs([S,U,f],[b,y,C]),e.jsx(e.Fragment,{children:ms||hs?e.jsx(pe,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ce,{color:"primary"})}):e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:s(dn),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"relationshipWithParentID",control:T,rules:{required:!0},render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:Ge,onChange:l=>g(l?l.value:null),value:Ge.find(l=>l.value===(n==null?void 0:n.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:gs||js})}),e.jsxs("label",{className:n!=null&&n.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),o.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personFirstName&&e.jsx("span",{className:"error-form",children:o.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personFirstName)||"",name:"personFirstName",id:"personFirstName1",required:!0,...P("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName1",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personLastName&&e.jsx("span",{className:"error-form",children:o.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personLastName",value:(n==null?void 0:n.personLastName)||"",id:"personLastName1",required:!0,...P("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personNationalCode&&e.jsx("span",{className:"error-form",children:o.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personNationalCode)??"",name:"personNationalCode",id:"personNationalCode2",required:!0,...P("personNationalCode",{required:"کد ملی را وارد کنید",minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personCertificateNo&&e.jsx("span",{className:"error-form",children:o.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personCertificateNo)||"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,...P("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificatetNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personFatherName&&e.jsx("span",{className:"error-form",children:o.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,...P("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:L,onChange:tn,format:"jYYYY/jMM/jDD",onOpenChange:cn,suffixIcon:e.jsx(ye,{color:"action"}),open:B,style:Ce,wrapperStyle:Se,pickerProps:{ref:S}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personBirthPlace&&e.jsx("span",{className:"error-form",children:o.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personBirthPlace",value:(n==null?void 0:n.personBirthPlace)||"",id:"personBirthPlace1",required:!0,...P("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"maritalStatusID",control:T,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:vs,onChange:l=>g(l?l.value:null),value:vs.find(l=>l.value===(n==null?void 0:n.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:Ns||bs})}),e.jsx("label",{className:n!=null&&n.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personPhone&&e.jsx("span",{className:"error-form",children:o.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personPhone)||"",name:"personPhone",id:"personPhone11",required:!0,...P("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone11",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personCellPhone&&e.jsx("span",{className:"error-form",children:o.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personCellPhone)||"",name:"personCellPhone",id:"personCellPhone222",required:!0,...P("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone222",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personArea&&e.jsx("span",{className:"error-form",children:o.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personArea)||"",name:"personArea",id:"personArea1",required:!0,...P("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personRegion&&e.jsx("span",{className:"error-form",children:o.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personRegion",value:h(n==null?void 0:n.personRegion)||"",id:"personRegion1",required:!0,...P("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"personCountryID",control:T,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:D,onChange:l=>g(l?l.value:null),value:D.find(l=>l.value===(n==null?void 0:n.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:Me||Ue})}),e.jsx("label",{className:n!=null&&n.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"personStateID",control:T,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:c,onChange:l=>g(l?l.value:null),value:c.find(l=>l.value===(n==null?void 0:n.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:qe||we})}),e.jsx("label",{className:n!=null&&n.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"personCityID",control:T,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:de,onChange:l=>g(l?l.value:null),value:de.find(l=>l.value===(n==null?void 0:n.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:ze||$e})}),e.jsx("label",{className:n!=null&&n.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personPostalCode&&e.jsx("span",{className:"error-form",children:o.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personPostalCode)||"",name:"personPostalCode",id:"personPostalCode1",required:!0,...P("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.personSpecialDisease&&e.jsx("span",{className:"error-form",children:o.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personSpecialDisease)||"",name:"personSpecialDisease",id:"personSpecialDisease1",required:!0,...P("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[o.personAddress&&e.jsx("span",{className:"error-form",children:o.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personAddress)||"",name:"personAddress",id:"personAddress1",required:!0,...P("personAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[o.personDescription&&e.jsx("span",{className:"error-form",children:o.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personDescription)||"",name:"personDescription",id:"personDescription",required:!0,...P("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription",children:"توضیحات"})]})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات وظیفه بگیری "})}),e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"pensionaryStatusID",control:T,rules:{required:!0},render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:me,onChange:l=>g(l?l.value:null),value:me.find(l=>l.value===(n==null?void 0:n.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:Ds||ys})}),e.jsxs("label",{className:n!=null&&n.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),o.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:A,defaultValue:null,onChange:on,onOpenChange:ln,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(ye,{color:"action"}),open:x,style:Ce,wrapperStyle:Se,pickerProps:{ref:f}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:w,onChange:rn,format:"jYYYY/jMM/jDD",onOpenChange:pn,suffixIcon:e.jsx(ye,{color:"action"}),open:r,style:Ce,wrapperStyle:Se,pickerProps:{ref:U}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",disabled:!0,value:h(n==null?void 0:n.heirID)||"-",name:"heirID",id:"heirID",...P("heirID")}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"heirID",children:"شماره وظیفه بگیری"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",disabled:!0,value:h(Pe(n==null?void 0:n.pensionaryStartDate))||"-",name:"pensionaryStartDate",id:"pensionaryStartDate",...P("pensionaryStartDate")}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"pensionaryStartDate",children:"تاریخ وظیفه بگیری"})]})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(it,{statusHistoryTableData:v,isLoading:Be,isFetching:Fe,handleRefresh:un}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات بانکی وظیفه بگیر "})}),e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"bankID",control:T,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:Ke,onChange:l=>g(l?l.value:null),value:Ke.find(l=>l.value===(n==null?void 0:n.bankID)),id:"bankID",name:"bankID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"بانک"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:Ss||Bs})}),e.jsx("label",{htmlFor:"bankID",className:n!=null&&n.bankID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"بانک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"bankBranchID",control:T,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:Ms,onChange:l=>g(l?l.value:null),isDisabled:E||_||!n.bankID,value:Ms.find(l=>l.value===(n==null?void 0:n.bankBranchID))||null,id:"bankBranchID",name:"bankBranchID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شعبه"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:E||_})}),e.jsx("label",{htmlFor:"bankBranchID",className:n!=null&&n.bankBranchID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شعبه"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.accountNo&&e.jsx("span",{className:"error-form",children:o.accountNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.accountNo)||"",name:"accountNo",id:"accountNoHeir",required:!0,...P("accountNo",{pattern:{value:/^[۰-۹0-9]+$/,message:"شماره حساب باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"accountNoHeir",children:"شماره حساب"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.ledgerCode&&e.jsx("span",{className:"error-form",children:o.ledgerCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.ledgerCode)||"",name:"ledgerCode",id:"ledgerCodeHeir",required:!0,...P("ledgerCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"ردیف ورثه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"ledgerCodeHeir",children:"ردیف ورثه"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.insuranceCoef&&e.jsx("span",{className:"error-form",children:o.insuranceCoef.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.insuranceCoef)||"",name:"insuranceCoef",id:"insuranceCoefHeir",required:!0,...P("insuranceCoef",{pattern:{value:/^[۰-۹0-9]+([.,][۰-۹0-9]+)?$/,message:"از اعداد یا اعشار استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceCoefHeir",children:"ضریب بیمه"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.insuranceAmount&&e.jsx("span",{className:"error-form",children:o.insuranceAmount.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.insuranceAmount)||"",name:"insuranceAmount",id:"insuranceAmountHeir",required:!0,...P("insuranceAmount",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceAmountHeir",children:"بیمه تبعی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(he,{dir:"ltr",endIcon:e.jsx(zs,{}),onClick:s,type:"submit",loading:G,variant:"contained",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})})}function ct({setShowCreateHeirModal:t,refetch:m}){const p=a.useRef(null),S=a.useRef(null),U=a.useRef(null),[f,F]=a.useState(null),[i,v]=a.useState(!1),[u,L]=a.useState(null),[j,B]=a.useState(null),[b,A]=a.useState(!1),[q,w]=a.useState(!1),{handleSubmit:z,formState:{errors:r},control:y,register:x,watch:C}=Oe(),s=C(),[o,{isLoading:T}]=ot(),[P,X]=a.useState([]),ee=cs(),se=new URLSearchParams(ee.search).get("personID"),G=Xs(),[I,{isLoading:K,isFetching:d}]=Rs(),{relationships:R,relationshipIsLoading:E,relationshipIsFetching:_}=Js(),{lookUpItems:O,lookUpItemsIsLoading:xe,lookUpItemsIsFetching:Be}=$({lookUpType:"MaritialStatus"}),{lookUpItems:Fe,lookUpItemsIsLoading:te,lookUpItemsIsFetching:Y}=$({lookUpType:"Country"}),{lookUpItems:Z,lookUpItemsIsLoading:Ae,lookUpItemsIsFetching:ms}=$({lookUpType:"State"}),{lookUpItems:hs,lookUpItemsIsLoading:ue,lookUpItemsIsFetching:_e}=$({lookUpType:"City"}),{pensionaryStatus:xs,pensionaryStatusIsLoading:gs,pensionaryStatusIsFetching:js}=Fs({pensionaryStatusCategory:"H"}),{lookUpItems:Is,lookUpItemsIsLoading:Ns,lookUpItemsIsFetching:bs}=$({lookUpType:"Bank"}),Te=Q(R,"relationshipID","relationshipName"),Me=Q(O,"lookUpID","lookUpName"),Ue=Q(Fe,"lookUpID","lookUpName"),Ee=Q(xs,"pensionaryStatusID","pensionaryStatusName"),qe=Q(Z,"lookUpID","lookUpName"),we=Q(hs,"lookUpID","lookUpName"),He=Q(Is,"lookUpID","lookUpName"),ze=Q(P,"lookUpID","lookUpName"),$e=a.useCallback(async D=>{try{const c=await I({lookUpType:"BankBranch",lookUpParentID:N(D)}).unwrap();X(c.itemList)}catch(c){console.log(c)}},[I,X]);a.useEffect(()=>{s.bankID&&$e(s.bankID)},[s.bankID,$e]);const fs=D=>{F(D),v(!1)},Ds=D=>{B(D),A(!1)},ys=D=>{L(D),w(!1)},Cs=D=>{w(D)},Ss=D=>{v(D)},Bs=D=>{A(D)},Ge=async()=>{var D;try{let c,de,me;f?(c=new Date(f),c.setMinutes(c.getMinutes()-c.getTimezoneOffset())):c=null,u?(me=new Date(u),me.setMinutes(me.getMinutes()-me.getTimezoneOffset())):me=null,j?(de=new Date(j),de.setMinutes(de.getMinutes()-de.getTimezoneOffset())):de=null;const Ke=await o({...s,relationshipWithParentID:N(s==null?void 0:s.relationshipWithParentID),personNationalCode:N(s==null?void 0:s.personNationalCode),personCertificateNo:N(s==null?void 0:s.personCertificateNo),personBirthDate:c,maritalStatusID:N(s==null?void 0:s.maritalStatusID),personPhone:N(s==null?void 0:s.personPhone),personCellPhone:N(s==null?void 0:s.personCellPhone),personRegion:parseInt(N(s==null?void 0:s.personRegion))||null,personArea:parseInt(N(s==null?void 0:s.personArea))||null,personCountryID:N(s==null?void 0:s.personCountryID),personStateID:N(s==null?void 0:s.personStateID),personCityID:N(s==null?void 0:s.personCityID),personPostalCode:N(s==null?void 0:s.personPostalCode),pensionaryStatusID:N(s==null?void 0:s.pensionaryStatusID),personBaseFinishDate:de,bankID:N(s==null?void 0:s.bankID),bankBranchID:N(s==null?void 0:s.bankBranchID),accountNo:N(s==null?void 0:s.accountNo),insuranceCoef:parseFloat(N(s==null?void 0:s.insuranceCoef))||0,insuranceAmount:parseFloat(N(s==null?void 0:s.insuranceAmount))||0,ledgerCode:parseInt(N(s.ledgerCode))||0,parentPersonID:se,pensionaryStartDate:me}).unwrap();t(!1),m(),le.success(Ke.message,{autoClose:2e3})}catch(c){console.log(c),le.error(((D=c==null?void 0:c.data)==null?void 0:D.message)||c.error,{autoClose:2e3})}};return Zs([p,S],[v,A]),e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:z(Ge),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"relationshipWithParentID",control:y,rules:{required:!0},render:({field:{onChange:D}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:Te,onChange:c=>D(c?c.value:null),value:Te.find(c=>c.value===(s==null?void 0:s.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:E||_})}),e.jsxs("label",{className:s!=null&&s.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),r.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personFirstName&&e.jsx("span",{className:"error-form",children:r.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personFirstName",value:(s==null?void 0:s.personFirstName)||"",id:"personFirstName1",required:!0,...x("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName1",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personLastName&&e.jsx("span",{className:"error-form",children:r.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personLastName)||"",name:"personLastName",id:"personLastName1",required:!0,...x("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personNationalCode&&e.jsx("span",{className:"error-form",children:r.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personNationalCode",value:h(s==null?void 0:s.personNationalCode)||"",id:"personNationalCode2",required:!0,...x("personNationalCode",{required:"کد ملی را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personCertificateNo&&e.jsx("span",{className:"error-form",children:r.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personCertificateNo)||"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,...x("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificateNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personFatherName&&e.jsx("span",{className:"error-form",children:r.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,...x("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:f,onChange:fs,format:"jYYYY/jMM/jDD",onOpenChange:Ss,suffixIcon:e.jsx(ye,{color:"action"}),open:i,style:Ce,wrapperStyle:Se,pickerProps:{ref:p}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personBirthPlace&&e.jsx("span",{className:"error-form",children:r.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personBirthPlace)||"",name:"personBirthPlace",id:"personBirthPlace1",required:!0,...x("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"maritalStatusID",control:y,render:({field:{onChange:D}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:Me,onChange:c=>D(c?c.value:null),value:Me.find(c=>c.value===(s==null?void 0:s.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:xe||Be})}),e.jsx("label",{className:s!=null&&s.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personPhone&&e.jsx("span",{className:"error-form",children:r.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personPhone)||"",name:"personPhone",id:"personPhone11",required:!0,...x("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone11",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personCellPhone&&e.jsx("span",{className:"error-form",children:r.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone",value:h(s==null?void 0:s.personCellPhone)||"",id:"personCellPhone222",required:!0,...x("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone222",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personArea&&e.jsx("span",{className:"error-form",children:r.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personArea),name:"personArea",id:"personArea1",required:!0,...x("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personRegion&&e.jsx("span",{className:"error-form",children:r.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personRegion),name:"personRegion",id:"personRegion1",required:!0,...x("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"personCountryID",control:y,render:({field:{onChange:D}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:Ue,onChange:c=>D(c?c.value:null),value:Ue.find(c=>c.value===(s==null?void 0:s.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:te||Y})}),e.jsx("label",{className:s!=null&&s.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"personStateID",control:y,render:({field:{onChange:D}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:qe,onChange:c=>D(c?c.value:null),value:qe.find(c=>c.value===(s==null?void 0:s.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:Ae||ms})}),e.jsx("label",{className:s!=null&&s.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"personCityID",control:y,render:({field:{onChange:D}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:we,onChange:c=>D(c?c.value:null),value:we.find(c=>c.value===(s==null?void 0:s.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:ue||_e})}),e.jsx("label",{className:s!=null&&s.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personPostalCode&&e.jsx("span",{className:"error-form",children:r.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPostalCode",value:h(s==null?void 0:s.personPostalCode)||"",id:"personPostalCode1",required:!0,...x("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personSpecialDisease&&e.jsx("span",{className:"error-form",children:r.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personSpecialDisease",value:(s==null?void 0:s.personSpecialDisease)||"",id:"personSpecialDisease1",required:!0,...x("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[r.personAddress&&e.jsx("span",{className:"error-form",children:r.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personAddress)||"",name:"personAddress",id:"personAddress1",required:!0,...x("personAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[r.personDescription&&e.jsx("span",{className:"error-form",children:r.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personDescription)||"",name:"personDescription",id:"personDescription",required:!0,...x("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription",children:"توضیحات"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات وظیفه بگیری "})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"pensionaryStatusID",control:y,rules:{required:!0},render:({field:{onChange:D}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:Ee,onChange:c=>D(c?c.value:null),value:Ee.find(c=>c.value===(s==null?void 0:s.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:gs||js})}),e.jsxs("label",{className:s!=null&&s.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),r.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:u,defaultValue:null,onChange:ys,onOpenChange:Cs,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(ye,{color:"action"}),open:q,style:Ce,wrapperStyle:Se,pickerProps:{ref:U}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:j,onChange:Ds,format:"jYYYY/jMM/jDD",onOpenChange:Bs,suffixIcon:e.jsx(ye,{color:"action"}),open:b,style:Ce,wrapperStyle:Se,pickerProps:{ref:S}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ مبنای قطع سهم"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات بانکی وظیفه بگیر "})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"bankID",control:y,render:({field:{onChange:D}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:He,onChange:c=>D(c?c.value:null),value:He.find(c=>c.value===(s==null?void 0:s.bankID)),id:"bankID",name:"bankID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"بانک"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:Ns||bs})}),e.jsx("label",{htmlFor:"bankID",className:s!=null&&s.bankID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"بانک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(W,{name:"bankBranchID",control:y,render:({field:{onChange:D}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:ze,onChange:c=>D(c?c.value:null),isDisabled:K||d||!s.bankID,value:ze.find(c=>c.value===(s==null?void 0:s.bankBranchID))||null,id:"bankBranchID",name:"bankBranchID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شعبه"}),noOptionsMessage:k.noOptionsMessage,loadingMessage:k.loadingMessage,styles:J,isLoading:K||d})}),e.jsx("label",{htmlFor:"bankBranchID",className:s!=null&&s.bankBranchID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شعبه"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.accountNo&&e.jsx("span",{className:"error-form",children:r.accountNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.accountNo)||"",name:"accountNo",id:"accountNoHeir",required:!0,...x("accountNo",{pattern:{value:/^[۰-۹0-9]+$/,message:"شماره حساب باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"accountNoHeir",children:"شماره حساب"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.ledgerCode&&e.jsx("span",{className:"error-form",children:r.ledgerCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.ledgerCode)||"",name:"ledgerCode",id:"ledgerCodeHeir",required:!0,...x("ledgerCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"ردیف ورثه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"ledgerCodeHeir",children:"ردیف ورثه"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.insuranceCoef&&e.jsx("span",{className:"error-form",children:r.insuranceCoef.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"insuranceCoef",value:h(s==null?void 0:s.insuranceCoef)||"",id:"insuranceCoefHeir",required:!0,...x("insuranceCoef",{pattern:{value:/^[۰-۹0-9]+([.,][۰-۹0-9]+)?$/,message:"از اعداد یا اعشار استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceCoefHeir",children:"ضریب بیمه"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.insuranceAmount&&e.jsx("span",{className:"error-form",children:r.insuranceAmount.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.insuranceAmount)||"",name:"insuranceAmount",id:"insuranceAmountHeir",required:!0,...x("insuranceAmount",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceAmountHeir",children:"بیمه تبعی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(he,{dir:"ltr",endIcon:e.jsx(zs,{}),onClick:z,type:"submit",loading:T,variant:"contained",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})}function pt(){const[t,m]=a.useState({}),[p,S]=a.useState([]),[U,f]=a.useState(!1),[F,i]=a.useState(!1),[v,u]=a.useState(!1),[L,j]=a.useState(""),[B,b]=a.useState(""),A=cs(),w=new URLSearchParams(A.search).get("personID"),[z,{isLoading:r}]=tt(),{data:y,isLoading:x,isSuccess:C,isFetching:s,error:o,refetch:T}=nt(w);a.useEffect(()=>{if(T(),C){const d=y.itemList.map((R,E)=>({id:R.personID,heirRowNum:E+1,pensionaryID:R.pensionaryID,personNationalCode:R.personNationalCode,personFirstName:R.personFirstName,personLastName:R.personLastName,pensionaryIsUnderGauranteeText:R.pensionaryIsUnderGauranteeText,personBirthDate:R.personBirthDate,relationshipWithParentName:R.relationshipWithParentName,parentPersonNationalCode:R.parentPersonNationalCode}));S(d)}},[C,y,T]),a.useEffect(()=>{var d;o&&(console.log(o),le.error(((d=o==null?void 0:o.data)==null?void 0:d.message)||o.error,{autoClose:2e3}))},[o]);const P=()=>{T()},X=()=>{i(!0)},ee=()=>{f(!0)},n=()=>{u(!0)},se=async()=>{var d;try{const R=await z({pensionaryID:B}).unwrap();u(!1),T(),le.success(R.message,{autoClose:2e3})}catch(R){console.log(R),le.error(((d=R==null?void 0:R.data)==null?void 0:d.message)||R.error,{autoClose:2e3})}},G=a.useMemo(()=>[{accessorKey:"heirRowNum",header:"ردیف",size:20,enableColumnActions:!1,enableSorting:!1,Cell:({renderedCellValue:d})=>e.jsx("div",{children:h(d)})},{accessorKey:"personNationalCode",header:"کد ملی",size:20,Cell:({renderedCellValue:d})=>e.jsx("div",{children:h(d)})},{accessorKey:"personFirstName",header:"نام",size:20},{accessorKey:"personLastName",header:"نام خانوادگی",size:20},{accessorKey:"pensionaryIsUnderGauranteeText",header:"وضعیت",size:20},{accessorKey:"personBirthDate",header:"تاریخ تولد",size:20,Cell:({renderedCellValue:d})=>e.jsx("div",{children:h(Pe(d))})},{accessorKey:"relationshipWithParentName",size:20,header:"نسبت"},{accessorKey:"parentPersonNationalCode",header:"شماره پرونده",size:20,Cell:({renderedCellValue:d})=>e.jsx("div",{children:h(d)})},{accessorKey:"editHeirAction",header:"ویرایش",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:d})=>e.jsx(ae,{title:`ویرایش "${d.original.personFirstName} ${d.original.personLastName}"`,children:e.jsx(H,{color:"success",onClick:ee,sx:{padding:"0"},children:e.jsx(Re,{})})})},{accessorKey:"deleteHeirAction",header:"حذف",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:d})=>e.jsx(ae,{title:`حذف "${d.original.personFirstName} ${d.original.personLastName}"`,children:e.jsx(H,{color:"error",onClick:n,sx:{padding:"0"},children:e.jsx(en,{})})})}],[]),I=ns({...ds,columns:G,data:p,muiTableBodyRowProps:({row:d})=>({onClick:()=>m(()=>({[d.id]:!0})),selected:t[d.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsxs(pe,{children:[s?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"info",onClick:P,children:e.jsx(Le,{fontSize:"small"})})})}),s?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:e.jsx("span",{style:{fontFamily:"sahel",fontSize:"0.8rem"},children:"ایجاد موظف"}),children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"success",onClick:X,children:e.jsx(sn,{fontSize:"small"})})})})]}),muiPaginationProps:{shape:"rounded",showRowsPerPage:!1,size:"small",renderItem:d=>e.jsx(as,{...d,page:h(d.page),slots:{previous:ts,next:rs,first:os,last:is}})},getRowId:d=>d.id,onRowSelectionChange:m,state:{rowSelection:t}});return a.useEffect(()=>{const d=Object.keys(I.getState().rowSelection)[0];if(d){const R=xn(p,d);j(d),b(R==null?void 0:R.pensionaryID)}},[I,t,p]),e.jsx(e.Fragment,{children:x||s?e.jsx("div",{className:"skeleton-lg",children:e.jsx(As,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsxs(e.Fragment,{children:[U&&L?e.jsx(es,{title:"ویرایش اطلاعات موظف",closeModal:()=>f(!1),children:e.jsx(lt,{setShowEditHeirModal:f,personID:L,refetch:T})}):v?e.jsxs(es,{title:"حذف موظف",closeModal:()=>u(!1),children:[e.jsx("p",{className:"paragraph-primary",children:"آیا از حذف این موظف اطمینان دارید؟"}),e.jsxs("div",{className:"flex-row flex-center",children:[e.jsx(he,{dir:"ltr",endIcon:e.jsx(gn,{}),onClick:se,loading:r,variant:"contained",color:"success",children:e.jsx("span",{children:"بله"})}),e.jsx(jn,{dir:"ltr",endIcon:e.jsx(In,{}),onClick:()=>u(!1),variant:"contained",color:"error",children:e.jsx("span",{children:"خیر"})})]})]}):F?e.jsx(es,{title:"ایجاد موظف",closeModal:()=>i(!1),children:e.jsx(ct,{setShowCreateHeirModal:i,refetch:T})}):null,e.jsx(ls,{table:I})]})})}function ut(){const[t,m]=a.useState({}),[p,S]=a.useState([]),U=cs(),f=new URLSearchParams(U.search),F=f.get("Role"),i=f.get("personID"),{data:v,isSuccess:u,isLoading:L,isFetching:j,error:B,refetch:b}=Ka({Role:F,personID:i});a.useEffect(()=>{if(b(),u){const r=v.itemList.map(y=>({id:y.requestID,type:y.requestTypeID,requestNO:y.requestNO||"-",personId:y.personID,requestTypeNameFa:y.requestTypeNameFa||"-",personName:y.personName||"-",date:y.requestDate||"-",body:y.requestText||"-"}));S(r),sessionStorage.setItem("requests",JSON.stringify(r))}},[v,u,b]),a.useEffect(()=>{var r;B&&le.error(((r=B==null?void 0:B.data)==null?void 0:r.message)||B.error,{autoClose:2e3})},[B]);const A=()=>{b()},q=a.useMemo(()=>[{accessorKey:"id",header:"شماره درخواست",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:h(r)})},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"ارسال کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:h(Pe(r))})},{accessorKey:"observeReq",header:"مشاهده درخواست",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:r})=>e.jsx(ae,{title:h(r.original.requestNO),children:e.jsx(Os,{to:`/retirement/request?requestID=${r.id}&Role=${F}&type=${r.original.type}`,children:e.jsx(H,{color:"primary",sx:{padding:"0"},children:e.jsx($s,{})})})})}],[F]),w=ns({...ds,columns:q,data:p,muiTableBodyRowProps:({row:r})=>({onClick:()=>m(()=>({[r.id]:!0})),selected:t[r.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsx(pe,{children:j?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"info",onClick:A,children:e.jsx(Le,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:r=>e.jsx(as,{...r,page:h(r.page),slots:{previous:ts,next:rs,first:os,last:is}})},getRowId:r=>r.id,onRowSelectionChange:m,state:{rowSelection:t}});return e.jsx(e.Fragment,{children:L?e.jsx("div",{className:"skeleton-lg",children:e.jsx(As,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(ls,{table:w})})}function dt(){const[t,m]=a.useState({}),[p,S]=a.useState([]),[U,f]=a.useState(null),[F,i]=a.useState(!1),v=cs(),L=new URLSearchParams(v.search).get("personID"),{data:j,isLoading:B,isSuccess:b,isFetching:A,error:q,refetch:w}=Ya({personID:L,payType:"M"}),z=()=>{w()};a.useEffect(()=>{if(b){const s=j.itemList.map((o,T)=>({id:o.payID,payRowNum:T+1,payCreditAmount:o.payCreditAmount,payDebitAmount:o.payDebitAmount,payAmount:o.payAmount,payDate:o.payDate,currentYear:o.currentYear,currentMonth:o.currentMonth}));S(s)}},[b,w,j]),a.useEffect(()=>{var s;q&&le.error(((s=q==null?void 0:q.data)==null?void 0:s.message)||q.error,{autoClose:2e3})},[q]);const r=()=>{i(!0)},y=a.useMemo(()=>[{accessorKey:"payRowNum",header:"ردیف",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:h(s)})},{accessorKey:"payCreditAmount",header:"مبلغ بستانکاری",size:20,Cell:({renderedCellValue:s})=>e.jsxs("div",{children:[Ps(h(s))," ","ریال"]})},{accessorKey:"payDebitAmount",header:"مبلغ بدهکاری",size:20,Cell:({renderedCellValue:s})=>e.jsxs("div",{children:[Ps(h(s))," ","ریال"]})},{accessorKey:"payAmount",header:"مبلغ کل",size:20,Cell:({renderedCellValue:s})=>e.jsxs("div",{children:[Ps(h(s))," ","ریال"]})},{accessorKey:"payDate",header:"تاریخ پرداخت",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:Pe(s)})},{accessorKey:"currentYear",header:"سال مالی",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:h(s)})},{accessorKey:"currentMonth",header:"ماه مالی",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:h(s)})},{accessorKey:"downloadRetiredSlip",header:"مشاهده/چاپ",enableSorting:!1,enableColumnActions:!1,size:20,Cell:()=>e.jsx(ae,{title:"دانلود و مشاهده فیش",children:e.jsx(H,{color:"primary",sx:{padding:"0"},onClick:r,children:e.jsx($s,{})})})}],[]),x=ns({...ds,columns:y,data:p,renderTopToolbarCustomActions:()=>e.jsx(pe,{children:A?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"info",onClick:z,children:e.jsx(Le,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:s=>e.jsx(as,{...s,page:h(s.page),slots:{previous:ts,next:rs,first:os,last:is}})},muiTableBodyRowProps:({row:s})=>({onClick:()=>m(()=>({[s.id]:!0})),selected:t[s.id],sx:{cursor:"pointer"}}),getRowId:s=>s.id,onRowSelectionChange:m,state:{rowSelection:t}});return a.useEffect(()=>{const s=Object.keys(x.getState().rowSelection)[0];f(s||null)},[x,t]),e.jsxs(e.Fragment,{children:[F&&U&&e.jsx(es,{closeModal:()=>i(!1),children:e.jsx(Wa,{payID:U})},U),B?e.jsx("div",{className:"skeleton-lg",children:e.jsx(As,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(ls,{table:x})]})}const mt=["personFirstName","personLastName","personNationalCode","personCertificateNo","personFatherName","genderID","personBirthDate","personBirthPlace","personPreviousNam","personIsSacrificedFamily","personIsWarrior","personIsChildOfSacrificed","personIsValiant","personIsSacrificed","personIsCaptive","retiredID","personPhone","personCellPhone","backupPhone","backupFirstName","backupLastName","personEmail","educationTypeID","personCountryID","personStateID","personCityID","personRegion","personArea","personPostalCode","housingTypeID","maritalStatusID","personDeathDate","personAddress","personDescription"],ht=["retiredGroup","retiredOrganizationID","retiredLastPosition","employmentTypeID","retirementDate","pensionaryStatusID","pensionaryStartdate","retiredJobDegreeCoef","retiredGrantDuration","retiredRealDuration"],xt=["bankID","bankBranchID","accountNo","ledgerCode","insuranceCoef","insuranceAmount"],gt=()=>{const[t,m]=ps(!1),[p]=ke(),S=Nn(),U=p.get("personID"),f=a.useMemo(()=>["genderID","personCountryID","personStateID","personCityID","housingTypeID","educationTypeID","maritalStatusID"],[]),F=a.useMemo(()=>["personDeathDate","personBirthDate"],[]),{control:i,handleSubmit:v,formState:{errors:u},setValue:L}=Oe(),{data:j,isLoading:B,isFetching:b,isSuccess:A,refetch:q}=bn(U),[w,{isLoading:z}]=fn(),{lookUpItems:r,lookUpItemsIsLoading:y}=$({lookUpType:"Gender"}),x=a.useMemo(()=>re(r,"lookUpID","lookUpName"),[r]),{lookUpItems:C,lookUpItemsIsLoading:s}=$({lookUpType:"EducationType"}),o=a.useMemo(()=>re(C,"lookUpID","lookUpName"),[C]),{lookUpItems:T,lookUpItemsIsLoading:P}=$({lookUpType:"Country"}),X=a.useMemo(()=>re(T,"lookUpID","lookUpName"),[T]),{lookUpItems:ee,lookUpItemsIsLoading:n}=$({lookUpType:"State"}),se=a.useMemo(()=>re(ee,"lookUpID","lookUpName"),[ee]),{lookUpItems:G,lookUpItemsIsLoading:I}=$({lookUpType:"City"}),K=a.useMemo(()=>re(G,"lookUpID","lookUpName"),[G]),{lookUpItems:d,lookUpItemsIsLoading:R}=$({lookUpType:"HousingType"}),E=a.useMemo(()=>re(d,"lookUpID","lookUpName"),[d]),{lookUpItems:_,lookUpItemsIsLoading:O}=$({lookUpType:"MaritialStatus"}),xe=a.useMemo(()=>re(_,"lookUpID","lookUpName"),[_]),Be=async te=>{const Y=_s(te,f,F),Z=await w(Y).unwrap();q(),m(),us.success(Z.message)};return a.useEffect(()=>{if(A){const te=j==null?void 0:j.itemList[0];S(Us((te==null?void 0:te.personDeathDate)!==null));const Y=nn(te,f,F,{genderID:x,educationTypeID:o,personCountryID:X,personStateID:se,personCityID:K,housingTypeID:E,maritalStatusID:xe});Object.keys(Y).forEach(Z=>{mt.includes(Z)&&Y[Z]===null?L(Z,""):L(Z,Y[Z])})}return()=>{S(Us(null))}},[S,A,j==null?void 0:j.itemList,L,x,X,o,se,K,E,xe,F,f]),e.jsx(e.Fragment,{children:B||b?e.jsx(pe,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ce,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:v(Be),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(M,{name:"personFirstName",label:Gs,rules:ie,required:!0,control:i,editable:t,type:"text"}),e.jsx(M,{name:"personLastName",label:Ks,rules:ie,required:!0,control:i,editable:t,type:"text"}),e.jsx(M,{name:"personNationalCode",label:Ys,rules:{...Dn,...ie},required:!0,control:i,editable:t,type:"text"}),e.jsx(M,{name:"personCertificateNo",label:yn,rules:{...ne,...ie},required:!0,control:i,editable:t,type:"text"}),e.jsx(M,{name:"personFatherName",label:Cn,rules:fe,required:!0,control:i,editable:t,type:"text"}),e.jsx(oe,{name:"genderID",control:i,label:Sn,required:!0,isClearable:!0,isDisabled:!t,options:x,isLoading:y,rules:ie,errors:u}),e.jsx(ss,{name:"personBirthDate",label:Ws,control:i,disabled:!t,required:!0,errors:u,rules:ie,setValue:L}),e.jsx(M,{name:"personBirthPlace",label:Bn,rules:fe,required:!1,control:i,editable:t,type:"text"}),e.jsx(M,{name:"personPreviousName",label:vn,rules:fe,required:!1,control:i,editable:t,type:"text"}),e.jsxs("div",{className:t?"checkboxContainer col-span-3":"checkboxContainer--disabled col-span-3",children:[e.jsx("p",{className:"inputBox__form--readOnly-label",children:kn}),e.jsx(be,{disabled:!t,control:i,label:Pn,name:"personIsSacrificedFamily"}),e.jsx(be,{disabled:!t,control:i,label:On,name:"personIsWarrior"}),e.jsx(be,{disabled:!t,control:i,label:Ln,name:"personIsChildOfSacrificed"}),e.jsx(be,{disabled:!t,control:i,label:Rn,name:"personIsValiant"}),e.jsx(be,{disabled:!t,control:i,label:Fn,name:"personIsSacrificed"}),e.jsx(be,{disabled:!t,control:i,label:An,name:"personIsCaptive"})]}),e.jsx(M,{name:"retiredID",label:_n,required:!1,control:i,editable:!1,type:"text"}),e.jsx(M,{name:"personPhone",label:Tn,required:!1,rules:ne,control:i,editable:t,type:"text"}),e.jsx(M,{name:"personCellPhone",label:Mn,required:!1,rules:Un,control:i,editable:t,type:"text"}),e.jsx(M,{name:"backupPhone",label:En,required:!1,rules:ne,control:i,editable:t,type:"text"}),e.jsx(M,{name:"backupFirstName",label:qn,required:!1,rules:fe,control:i,editable:t,type:"text"}),e.jsx(M,{name:"backupLastName",label:wn,required:!1,rules:fe,control:i,editable:t,type:"text"}),e.jsx(M,{name:"personEmail",label:Hn,required:!1,rules:zn,control:i,editable:t,type:"text"}),e.jsx(oe,{name:"educationTypeID",control:i,label:$n,required:!1,isClearable:!0,isDisabled:!t,options:o,isLoading:s}),e.jsx(oe,{name:"personCountryID",control:i,label:Gn,required:!1,isClearable:!0,isDisabled:!t,options:X,isLoading:P}),e.jsx(oe,{name:"personStateID",control:i,label:Kn,required:!1,isClearable:!0,isDisabled:!t,options:se,isLoading:n}),e.jsx(oe,{name:"personCityID",control:i,label:Yn,required:!1,isClearable:!0,isDisabled:!t,options:K,isLoading:I}),e.jsx(M,{name:"personRegion",label:Wn,required:!1,control:i,editable:t,rules:ne,type:"text"}),e.jsx(M,{name:"personArea",label:Vn,required:!1,control:i,editable:t,rules:ne,type:"text"}),e.jsx(M,{name:"personPostalCode",label:Qn,required:!1,control:i,editable:t,rules:Jn,type:"text"}),e.jsx(oe,{name:"housingTypeID",control:i,label:Zn,required:!1,isClearable:!0,isDisabled:!t,options:E,isLoading:R}),e.jsx(oe,{name:"maritalStatusID",control:i,label:Xn,required:!1,isClearable:!0,isDisabled:!t,options:xe,isLoading:O}),e.jsx(ss,{name:"personDeathDate",label:ea,control:i,disabled:!t,required:!1,setValue:L}),e.jsx(ws,{name:"personAddress",label:sa,required:!0,control:i,editable:t,containerClassNames:"col-span-3"}),e.jsx(ws,{name:"personDescription",label:na,required:!0,control:i,editable:t,containerClassNames:"col-span-4 row-span-2"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(he,{dir:"ltr",endIcon:e.jsx(Ts,{}),disabled:!t,variant:"contained",type:"submit",loading:z,color:"success",children:e.jsx("span",{children:Ls})}),e.jsx(he,{dir:"ltr",endIcon:e.jsx(Re,{}),onClick:m,disabled:t,variant:"contained",color:"primary",children:e.jsx("span",{children:ve})})]})]})})})},jt=()=>{const[t,m]=a.useState([]),[p,S]=ps(!1),[U]=ke(),f=U.get("personID"),{personDeathDate:F}=Vs(E=>E.person),i=a.useMemo(()=>["retiredOrganizationID","employmentTypeID","pensionaryStatusID"],[]),v=a.useMemo(()=>["retirementDate","pensionaryStartdate"],[]),{control:u,handleSubmit:L,formState:{errors:j},setValue:B}=Oe(),{data:b,isSuccess:A,isLoading:q,isFetching:w,refetch:z}=aa(f),{data:r,isSuccess:y,isLoading:x,isFetching:C,refetch:s}=Hs(f),[o,{isLoading:T}]=ta(),{organizations:P,organizationIsLoading:X}=Ga({}),{lookUpItems:ee,lookUpItemsIsLoading:n}=$({lookUpType:"EmploymentType"}),{pensionaryStatus:se,pensionaryStatusIsLoading:G}=Fs({pensionaryStatusCategory:"R",pensionaryStatusIsDead:F}),I=a.useMemo(()=>re(P,"organizationID","organizationName"),[P]),K=a.useMemo(()=>re(ee,"lookUpID","lookUpName"),[ee]),d=a.useMemo(()=>re(se,"pensionaryStatusID","pensionaryStatusName"),[se]);a.useEffect(()=>{if(A){const E=b==null?void 0:b.itemList[0];if(E){const _={...E};Object.keys(_).forEach(O=>{O==="retirementDate"&&(_[O]=_[O]===null?null:Es(_[O])),O==="pensionaryStartdate"&&(_[O]=_[O]===null?null:Es(_[O])),B(O,_[O])})}}},[A,b==null?void 0:b.itemList,B]);const R=async E=>{const _=_s(E,i,v),O=await o({..._,retiredGroup:parseInt(je(E.retiredGroup)),retiredJobDegreeCoef:parseInt(je(E.retiredJobDegreeCoef)),retiredRealDuration:parseInt(je(E.retiredRealDuration)),retiredGrantDuration:parseInt(je(E.retiredGrantDuration)),personID:f}).unwrap();S(),z(),s(),us.success(O.message)};return a.useEffect(()=>{if(A){const E=b==null?void 0:b.itemList[0],_=nn(E,i,v,{retiredOrganizationID:I,employmentTypeID:K,pensionaryStatusID:d});Object.keys(_).forEach(O=>{ht.includes(O)&&_[O]===null?B(O,""):B(O,_[O])})}},[A,b==null?void 0:b.itemList,I,K,d,B,i,v]),a.useEffect(()=>{if(y){const E=r==null?void 0:r.itemList.map((_,O)=>({id:_.pensionaryID,isActive:_.pensionaryIsActive,pensionaryStatusRowNum:O+1,pensionaryStatusName:_.pensionaryStatusName||"-",pensionaryStartdate:_.pensionaryStartdate||"-"}));m(E)}},[y,r==null?void 0:r.itemList]),e.jsx(e.Fragment,{children:q||w?e.jsx(pe,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ce,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:L(R),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(M,{name:"retiredGroup",label:ra,control:u,required:!0,editable:p,rules:{...ie,...ne},type:"text"}),e.jsx(oe,{name:"retiredOrganizationID",control:u,label:oa,required:!0,isClearable:!0,isDisabled:!p,options:I,isLoading:X,rules:ie,errors:j}),e.jsx(M,{name:"retiredLastPosition",label:ia,control:u,required:!1,editable:p,rules:fe,type:"text"}),e.jsx(oe,{name:"employmentTypeID",control:u,label:la,required:!0,isClearable:!0,isDisabled:!p,options:K,isLoading:n,rules:ie,errors:j}),e.jsx(ss,{name:"retirementDate",label:ca,control:u,disabled:!p,required:!1,errors:j,rules:ie,setValue:B}),e.jsx(oe,{name:"pensionaryStatusID",control:u,label:Qs,required:!0,isClearable:!0,isDisabled:!p,options:d,isLoading:G,rules:ie,errors:j}),e.jsx(ss,{name:"pensionaryStartdate",label:pa,control:u,disabled:!p,required:!0,errors:j,rules:ie,setValue:B}),e.jsx(M,{name:"retiredJobDegreeCoef",label:ua,control:u,required:!1,editable:p,rules:ne,type:"text"}),e.jsx(M,{name:"retiredGrantDuration",label:da,control:u,required:!1,editable:p,rules:ne,type:"text"}),e.jsx(M,{name:"retiredRealDuration",label:ma,control:u,required:!1,editable:p,rules:ne,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(he,{dir:"ltr",endIcon:e.jsx(Ts,{}),disabled:!p,variant:"contained",type:"submit",loading:T,color:"success",children:e.jsx("span",{children:Ls})}),e.jsx(he,{dir:"ltr",endIcon:e.jsx(Re,{}),onClick:S,disabled:p,variant:"contained",color:"primary",children:e.jsx("span",{children:ve})})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(Va,{data:t,isLoading:x,isFetching:C})]})})})},It=()=>{const[t,m]=ps(!1),[p,S]=a.useState([]),[U]=ke(),f=U.get("personID"),F=a.useMemo(()=>["bankID","bankBranchID"],[]),i=a.useMemo(()=>[],[]),{control:v,handleSubmit:u,formState:{errors:L},setValue:j,watch:B}=Oe(),b=B("bankID"),{lookUpItems:A,lookUpItemsIsLoading:q}=$({lookUpType:"Bank"}),w=a.useMemo(()=>re(A,"lookUpID","lookUpName"),[A]),[z,{isLoading:r,isFetching:y}]=Rs(),x=a.useMemo(()=>re(p,"lookUpID","lookUpName"),[p]),{data:C,isSuccess:s,isLoading:o,isFetching:T,refetch:P}=ha(f),[X,{isLoading:ee}]=xa(),n=a.useCallback(async I=>{const K=await z({lookUpType:"BankBranch",lookUpParentID:I}).unwrap();S(K.itemList)},[z]),se=async I=>{const K=_s(I,F,i),d=await X({...K,accountNo:je(I.accountNo)||null,ledgerCode:parseInt(je(I.ledgerCode))||null,insuranceAmount:parseFloat(je(I.insuranceAmount))||null,insuranceCoef:parseFloat(je(I.insuranceCoef))||null,personID:f}).unwrap();P(),m(),us.success(d.message)};return a.useEffect(()=>{b?n(b.value):(j("bankBranchID",null),S([]))},[b,n,j]),a.useEffect(()=>{s&&({...C},Object.keys(C).forEach(I=>{xt.includes(I)&&C[I]===null?j(I,""):j(I,C[I])}))},[s,C,j]),a.useEffect(()=>{s&&w.length>0&&j("bankID",w.find(I=>I.value===C.bankID))},[s,C,j,w]),a.useEffect(()=>{s&&x.length>0&&j("bankBranchID",x.find(I=>I.value===C.bankBranchID))},[s,C,j,x]),e.jsx(e.Fragment,{children:o||T?e.jsx(pe,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ce,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:u(se),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(oe,{name:"bankID",control:v,label:ga,required:!1,isClearable:!0,isDisabled:!t,options:w,isLoading:q,errors:L}),e.jsx(oe,{name:"bankBranchID",control:v,label:ja,required:!1,isClearable:!0,isDisabled:!t,options:x,isLoading:r||y,errors:L}),e.jsx(M,{name:"accountNo",label:Ia,rules:ne,required:!1,control:v,editable:t,type:"text"}),e.jsx(M,{name:"ledgerCode",label:Na,rules:ne,required:!1,control:v,editable:t,type:"text"}),e.jsx(M,{name:"insuranceCoef",label:ba,rules:ne,required:!1,control:v,editable:t,type:"text"}),e.jsx(M,{name:"insuranceAmount",label:fa,rules:ne,required:!1,control:v,editable:t,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(he,{dir:"ltr",endIcon:e.jsx(Ts,{}),disabled:!t,variant:"contained",type:"submit",loading:ee,color:"success",children:e.jsx("span",{children:Ls})}),e.jsx(he,{dir:"ltr",endIcon:e.jsx(Re,{}),onClick:m,disabled:t,variant:"contained",color:"primary",children:e.jsx("span",{children:ve})})]})]})})})},Nt="/retirement/",an=Nt+"retired/related",bt=(t,m)=>[{accessorKey:"relatedRowNo",header:Da,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"personNationalCode",header:Ys,size:20},{accessorKey:"personFirstName",header:Gs,size:20},{accessorKey:"personLastName",header:Ks,size:20},{accessorKey:"pensionaryIsUnderGauranteeText",header:Qs,size:20},{accessorKey:"personBirthDate",header:Ws,size:20,Cell:({renderedCellValue:p})=>e.jsx("div",{children:ya(p)})},{accessorKey:"relationshipWithParentName",header:Ca,size:20},{accessorKey:"updateRelated",header:ve,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:p})=>e.jsx(ae,{title:`${ve} "${p.original.personFirstName} ${p.original.personLastName}"`,children:e.jsx(Os,{to:`${an}?mode=update&id=${t}&personID=${p.original.id}`,children:e.jsx(H,{color:"success",sx:{padding:"0"},children:e.jsx(Re,{})})})})},{accessorKey:"deleteRelated",header:qs,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:p})=>e.jsx(ae,{title:`${qs} "${p.original.personFirstName} ${p.original.personLastName}"`,children:e.jsx(H,{color:"error",onClick:()=>m(p.original.pensionaryID),sx:{padding:"0"},children:e.jsx(en,{})})})}],ft=(t,m,p,S)=>e.jsxs(pe,{children:[m||t?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:Sa,children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"info",onClick:p,children:e.jsx(Le,{fontSize:"small"})})})}),m||t?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:Ba,children:e.jsx(Os,{to:`${an}?mode=create&id=${S}`,children:e.jsx(H,{"aria-label":"refresh",color:"success",children:e.jsx(sn,{fontSize:"small"})})})})]}),Dt=()=>{const[t,m]=a.useState([]),[p,S]=ps(!1),[U,f]=a.useState(""),[F]=ke(),i=F.get("personID"),{data:v,isSuccess:u,isLoading:L,isFetching:j,refetch:B}=Qa(i),[b,{isLoading:A}]=Ja();a.useEffect(()=>{if(u){const x=v.itemList.map((C,s)=>({id:C.personID,relatedRowNo:s+1,pensionaryID:C.pensionaryID,personBirthDate:C.personBirthDate,personNationalCode:C.personNationalCode,personFirstName:C.personFirstName,personLastName:C.personLastName,pensionaryIsUnderGauranteeText:C.pensionaryIsUnderGauranteeText,relationshipWithParentName:C.relationshipWithParentName}));m(x)}},[u,v]);const q=async()=>{const x=await b({pensionaryID:U}).unwrap();S(),B(),us.success(x.message)},z=bt(i,x=>{f(x),S()}),r=ft(L,j,B,i);return e.jsxs(e.Fragment,{children:[e.jsx(va,{open:p,onClose:S,isLoading:A,handleRemove:q}),e.jsx(ka,{data:t,columns:z,scroll:!1,topBarActions:r,isLoading:L,isFetching:j})]})},nr=()=>{const[t,m]=a.useState("1"),{personDeathDate:p}=Vs(f=>f.person),S=(f,F)=>{m(F)};return e.jsxs("section",{className:"flex-col mb-20",children:[e.jsx(za,{title:Pa,back:!0}),e.jsxs("div",{"data-name":"retired-forms",children:[e.jsxs(Ve,{children:[e.jsx(Qe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(Je,{}),children:Oa}),e.jsx(Ze,{children:e.jsx(gt,{})})]}),e.jsxs(Ve,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(Qe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(Je,{}),children:La}),e.jsx(Ze,{children:e.jsx(jt,{})})]}),e.jsxs(Ve,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(Qe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(Je,{}),children:Ra}),e.jsx(Ze,{children:e.jsx(It,{})})]}),e.jsxs(Ve,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(Qe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(Je,{}),children:Fa}),e.jsx(Ze,{children:e.jsx(et,{})})]})]}),e.jsx("div",{"data-name":"retired-grids",children:e.jsxs(Za,{value:t,children:[e.jsx(pe,{sx:{bgcolor:"background.paper",borderRadius:1},children:e.jsxs(Xa,{onChange:S,"aria-label":"tabs",variant:"fullWidth",children:[e.jsx(We,{label:p?Aa:_a,value:"1"}),e.jsx(We,{label:Ta,value:"2"}),e.jsx(We,{label:Ma,value:"3"}),e.jsx(We,{label:Ua,value:"4"})]})}),e.jsx(Xe,{value:"1",sx:{padding:"0"},children:p?e.jsx(pt,{}):e.jsx(Dt,{})}),e.jsx(Xe,{value:"2",sx:{padding:"0"},children:e.jsx($a,{})}),e.jsx(Xe,{value:"3",sx:{padding:"0"},children:e.jsx(dt,{})}),e.jsx(Xe,{value:"4",sx:{padding:"0"},children:e.jsx(ut,{})})]})})]})};export{nr as default};
