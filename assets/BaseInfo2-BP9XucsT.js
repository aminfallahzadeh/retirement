import{cP as O,j as e,I as B,v as F,ag as P,cQ as h,r as u,h as $,w as E,W as G,ce as V}from"./index-BmsaxOuK.js";import{I as z}from"./Input-BUr2Opxg.js";import{S}from"./SelectInput-DkEJPeEE.js";const Q=({name:o,label:i,required:l,rules:n,control:m,value:r="",editable:p=!0,colSpan:x="",rowSpan:y=""})=>{const{field:a,fieldState:s}=O({control:m,defaultValue:r,name:o,rules:n}),c=()=>{a.onChange("")};return e.jsxs("div",{className:`inputBox__form ${x}  ${y}`,children:[(s==null?void 0:s.error)&&e.jsx("span",{className:"error-form",children:s==null?void 0:s.error.message}),e.jsx("textarea",{disabled:!p,value:a.value,onChange:a.onChange,id:o,name:o,className:"inputBox__form--input",required:!0}),e.jsxs("label",{htmlFor:o,className:"inputBox__form--label",children:[l&&e.jsx("span",{children:"*"})," ",i]}),a.value&&p?e.jsx("div",{className:"inputBox__form--icon",children:e.jsx(B,{color:"default",size:"small",onClick:c,children:e.jsx(F,{fontSize:"small"})})}):null]})},A=P.injectEndpoints({endpoints:o=>({getLookup:o.query({query:({lookupType:i,lookupName:l})=>{let n=`${h}/GetLookup?LookupType=${i}`;return l&&(n+=`&lookUpName=${l}`),{url:n}}}),getLookupDistinct:o.query({query:()=>({url:`${h}/GetLookupDistinct`})}),insertLookup:o.mutation({query:i=>({url:`${h}/InsertLookup`,method:"POST",body:i})})})}),{useLazyGetLookupQuery:R,useGetLookupDistinctQuery:_,useInsertLookupMutation:K}=A,b=(o,i,l)=>o.map(n=>({value:n[i],label:n[l]})),M=()=>{var v,N;const[o,i]=u.useState([]),[l,n]=u.useState([]),{handleSubmit:m,control:r,formState:{errors:p},watch:x,reset:y,setValue:a}=$({defaultValues:{title:"",type:null,parent:null,description:""}}),s=x(),{data:c,isLoading:k,isSuccess:L}=_(),[j,{isLoading:q,isFetching:C}]=R(),[T,{isLoading:w}]=K(),f=u.useCallback(async()=>{var d;const t=await j({lookupType:(d=s==null?void 0:s.type)==null?void 0:d.value}).unwrap(),g=b(t.itemList,"lookUpID","lookUpName");n(g),console.log(t)},[j,(v=s==null?void 0:s.type)==null?void 0:v.value]),D=async t=>{var I,U;const g={lookUpID:"string",lookUpType:(I=t.type)==null?void 0:I.label,lookUpTypeName:t.title,lookUpName:"string",lookUpParentID:((U=t.parent)==null?void 0:U.value)||"",lookUpDescription:t.description,lookUpParentIDName:"string",isDeleted:!1},d=await T(g).unwrap();V.success(d.message),y()};return u.useEffect(()=>{if(L){const t=b(c.itemList,"lookUpType","lookUpTypeName");i(t)}},[c==null?void 0:c.itemList,L]),u.useEffect(()=>{var t;(t=s==null?void 0:s.type)!=null&&t.value?f():(a("parent",null),n([]))},[(N=s==null?void 0:s.type)==null?void 0:N.value,f,a]),e.jsx("section",{className:"flex-col formContainer",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:m(D),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsx(z,{name:"title",label:"عنوان",control:r,required:!0,rules:{required:{value:!0,message:"این فیلد اجباری است"}}}),e.jsx(S,{name:"type",label:"نوع",options:o,control:r,required:!0,isClearable:!0,isLoading:k,errors:p,rules:{required:{value:!0,message:"این فیلد اجباری است"}}}),e.jsx(S,{name:"parent",label:"از مجموعه",options:l,isLoading:q||C,control:r,required:!1,isClearable:!0}),e.jsx(Q,{name:"description",label:"شرح",control:r,required:!0,colSpan:"col-span-2",rowSpan:"row-span-2"})]}),e.jsx("div",{className:"flex mr-auto",children:e.jsx(E,{dir:"ltr",endIcon:e.jsx(G,{}),loading:w,variant:"contained",type:"submit",color:"success",sx:{fontFamily:"sahel"},children:e.jsx("span",{children:"ذخیره"})})})]})})},Y=()=>e.jsxs("section",{className:"flex-col",children:[e.jsx("div",{className:"title-primary--container flex-row flex-center",children:e.jsxs("h4",{className:"title-primary",children:[e.jsx("span",{className:"title-primary--underline"}),"اطلاعات پایه ۲"]})}),e.jsx(M,{})]});export{Y as default};
