import{v as ke,r as a,j as e,w as hn,H as Ne,x as h,y as Pe,z as ns,B as pe,I as H,C as ce,T as ae,P as as,A as ts,D as rs,F as os,J as is,M as ls,d as Oe,K as Hs,N as ks,q as le,Q as K,n as he,S as zs,t as b,U as cs,V as xn,W as gn,X as jn,m as In,L as Os,E as $s,Y as Ps,Z as Nn,_ as ps,u as bn,$ as fn,a0 as Dn,a1 as Us,a2 as U,a3 as Gs,a4 as ie,a5 as Ks,a6 as Ys,a7 as yn,a8 as Cn,a9 as ne,aa as Sn,ab as fe,ac as Bn,ad as Ws,ae as vn,af as kn,ag as Pn,ah as On,ai as Ln,aj as Rn,ak as Fn,al as _n,am as An,an as Tn,ao as Mn,ap as Un,aq as En,ar as qn,as as wn,at as Hn,au as zn,av as $n,aw as Gn,ax as Kn,ay as Yn,az as Wn,aA as Vn,aB as Qn,aC as Jn,aD as Zn,aE as Xn,aF as ea,aG as sa,aH as na,aI as aa,aJ as Ls,aK as ve,aL as us,e as Vs,aM as ta,aN as ra,aO as Es,aP as oa,aQ as ia,aR as la,aS as ca,aT as pa,aU as Qs,aV as ua,aW as da,aX as ma,aY as ha,aZ as je,a_ as xa,a$ as ga,b0 as ja,b1 as Ia,b2 as Na,b3 as ba,b4 as fa,b5 as Da,R as ya,a as Ca,b6 as Sa,b7 as qs,b8 as Ba,b9 as va,ba as ka,G as Pa,bb as Oa,bc as La,bd as Ra,be as Fa,bf as _a,bg as We,bh as Aa,bi as Ta,bj as Ma,bk as Ua,bl as Ea}from"./index-Bdmgwo8-.js";import{u as qa,a as wa,c as Ha,F as za}from"./createTree-Da3HfzDI.js";import{T as $a}from"./Title-C6bx-ZN-.js";import{R as Ga}from"./RetiredStatementsGrid-C0XruOh4.js";/* empty css                 */import{M as es}from"./Modal-SS3hhxDS.js";import{u as Rs}from"./sharedApi-B9V2ZfHv.js";import{u as Js,a as $,b as Fs,c as Ka}from"./useFetchLookUpData-DU48ceiQ.js";import{u as Zs,m as De,C as ye}from"./main-CunPaocp.js";import{d as ds}from"./table-options-Bq8W0G3q.js";import{R as Le}from"./Refresh-CpBhaw0r.js";import{i as Xs,S as V}from"./react-select-animated.esm-Cpt3pN8B.js";import{o as Q,s as P,a as J}from"./reactSelect-BGq5yAQc.js";import{d as Ce,a as Se}from"./datePicker-XXmtGBIB.js";import{S as _s}from"./index-jndnA_6R.js";import{E as Re}from"./EditOutlined-DVbmXoDX.js";import{D as en}from"./DeleteOutline-D3falEzO.js";import{A as sn}from"./Add-CwCP22e9.js";import{b as Ya}from"./requestApi-sian_Zjm.js";import{u as Wa,S as Va}from"./SlipFormTemplate-t-MWa-p8.js";import{c as re,S as oe}from"./SelectInput-Dczpiq9q.js";import{p as nn,D as ss,a as As,S as Qa,u as Ja,b as Za}from"./relatedApi-lyEpqQzs.js";import{T as ws}from"./TextArea-CuFzLH5N.js";import{D as Ts}from"./DoneOutlined-DrjUdpYW.js";import{A as Ve,a as Qe,b as Je,c as Ze}from"./ArrowDropDown-CGNNRzvR.js";import{T as Xa,a as et,b as Xe}from"./TabPanel-CqHXGJg5.js";import"./index-BLAqbUlm.js";import"./statementApi-DPl8Xe2h.js";import"./module-DWAiAH7i.js";import"./excel-icon-Dq0N6FeV.js";const st=()=>{const[t]=ke(),[d,p]=a.useState([]),[D,T]=a.useState([]),N=t.get("personID"),{data:F,isLoading:o,isSuccess:C,refetch:u}=qa(),{data:k,isLoading:j,isSuccess:v,refetch:f}=wa(N);a.useEffect(()=>{v&&T(k.itemList)},[v,k]),a.useEffect(()=>{if(C){const q=Ha(F.itemList);p(q)}},[C,F]);const _=a.useCallback(()=>{u(),f()},[u,f]);return e.jsx(za,{structure:d,files:D,isLoading:o||j,refetch:_,access:"files"})},nt=hn.injectEndpoints({endpoints:t=>({getHeirListByParentPersonID:t.query({query:d=>({url:`${Ne}/GetHeirListByParentPersonID?parentPersonID=${d}`})}),getHeir:t.query({query:d=>({url:`${Ne}/GetHeir?personID=${d}`})}),insertHeir:t.mutation({query:d=>({url:`${Ne}/InsertHeir`,method:"POST",body:d})}),updateHeir:t.mutation({query:d=>({url:`${Ne}/UpdateHeir`,method:"POST",body:d})}),updateHeirAccount:t.mutation({query:({token:d,data:p})=>({url:`${Ne}/UpdateHeirAccount`,method:"POST",body:p,headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`}})}),removeHeir:t.mutation({query:({pensionaryID:d})=>({url:`${Ne}/RemoveHeir?pensionaryID=${d}`,method:"POST"})})})}),{useGetHeirListByParentPersonIDQuery:at,useLazyGetHeirListByParentPersonIDQuery:sr,useGetHeirQuery:tt,useRemoveHeirMutation:rt,useUpdateHeirMutation:ot,useInsertHeirMutation:it}=nt;function lt({statusHistoryTableData:t,isLoading:d,isFetching:p,handleRefresh:D}){const[T,N]=a.useState({pageIndex:0,pageSize:3}),F=a.useMemo(()=>[{accessorKey:"pensionaryStatusRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:u})=>e.jsx("div",{children:h(u)})},{accessorKey:"pensionaryStatusName",header:"وضعیت",size:20,Cell:({renderedCellValue:u})=>e.jsx("div",{children:h(u)})},{accessorKey:"pensionaryStartdate",header:"تاریخ شروع",size:20,Cell:({renderedCellValue:u})=>e.jsx("div",{children:Pe(u)})},{accessorKey:"isActive",header:"وضعیت",size:20,Cell:({renderedCellValue:u})=>e.jsx("div",{children:u===!0?"فعال":"غیرفعال"})}],[]),o=ns({...ds,columns:F,data:t,muiTopToolbarProps:{sx:{overflow:"none"}},muiTableBodyRowProps:({row:u})=>({sx:{color:u.original.isActive?"#087a30":"","& td":{color:u.original.isActive?"#087a30":""}}}),muiTableHeadProps:{sx:{zIndex:0}},renderTopToolbarCustomActions:()=>e.jsx(pe,{children:d||p?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"info",onClick:D,children:e.jsx(Le,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:u=>e.jsx(as,{...u,page:h(u.page),slots:{previous:ts,next:rs,first:os,last:is}})},initialState:{density:"compact",sorting:[{id:"isActive",desc:!0}]},onPaginationChange:N,state:{pagination:T}});return e.jsx(ls,{table:o})}function ct({setShowEditHeirModal:t,personID:d,refetch:p}){const D=a.useRef(null),T=a.useRef(null),N=a.useRef(null),[F,o]=a.useState([]),[C,u]=a.useState([]),[k,j]=a.useState(null),[v,f]=a.useState(!1);a.useState(null);const[_,q]=a.useState(null),[w,z]=a.useState(null),[r,S]=a.useState(!1),[x,B]=a.useState(!1),{handleSubmit:s,formState:{errors:i},control:M,register:O,watch:X,setValue:ee}=Oe(),n=X(),[se,{isLoading:G}]=ot(),I=Xs(),m=new URLSearchParams(location.search).get("personID"),[R,{isLoading:E,isFetching:A}]=Rs(),{data:L,isSuccess:xe,isLoading:Be,isFetching:Fe,refetch:te,error:W}=Hs(d),{data:Z,isSuccess:_e,isLoading:ms,isFetching:hs,error:ue,refetch:Ae}=tt(d);a.useEffect(()=>{if(te(),xe){const g=L==null?void 0:L.itemList.map((l,ge)=>({id:l.pensionaryID,isActive:l.pensionaryIsActive,pensionaryStatusRowNum:ge+1,pensionaryStatusName:l.pensionaryStatusName||"-",pensionaryStartdate:ks(l.pensionaryStartdate)||"-"}));u(g)}return()=>{u([])}},[te,xe,L]),a.useEffect(()=>{Ae(),_e&&Object.keys(Z).forEach(g=>{ee(g,Z[g])})},[_e,Z,Ae,ee]),a.useEffect(()=>{var g;ue&&ue.status!=="FETCH_ERROR"&&le.error(((g=ue==null?void 0:ue.data)==null?void 0:g.message)||ue.error,{autoClose:2e3})},[ue]),a.useEffect(()=>{var g;W&&(console.log(W),le.error(((g=W==null?void 0:W.data)==null?void 0:g.message)||W.error,{autoClose:2e3}))},[W]);const{relationships:xs,relationshipIsLoading:gs,relationshipIsFetching:js}=Js(),{lookUpItems:Is,lookUpItemsIsLoading:Ns,lookUpItemsIsFetching:bs}=$({lookUpType:"MaritialStatus"}),{lookUpItems:Te,lookUpItemsIsLoading:Me,lookUpItemsIsFetching:Ue}=$({lookUpType:"Country"}),{lookUpItems:Ee,lookUpItemsIsLoading:qe,lookUpItemsIsFetching:we}=$({lookUpType:"State"}),{lookUpItems:He,lookUpItemsIsLoading:ze,lookUpItemsIsFetching:$e}=$({lookUpType:"City"}),{pensionaryStatus:fs,pensionaryStatusIsLoading:Ds,pensionaryStatusIsFetching:ys}=Fs({pensionaryStatusCategory:"H"}),{lookUpItems:Cs,lookUpItemsIsLoading:Ss,lookUpItemsIsFetching:Bs}=$({lookUpType:"Bank"}),Ge=Q(xs,"relationshipID","relationshipName"),vs=Q(Is,"lookUpID","lookUpName"),y=Q(Te,"lookUpID","lookUpName"),c=Q(Ee,"lookUpID","lookUpName"),de=Q(He,"lookUpID","lookUpName"),me=Q(fs,"pensionaryStatusID","pensionaryStatusName"),Ke=Q(Cs,"lookUpID","lookUpName"),Ms=Q(F,"lookUpID","lookUpName"),Ye=a.useCallback(async g=>{try{const l=await R({lookUpType:"BankBranch",lookUpParentID:g}).unwrap();o(l.itemList)}catch(l){console.log(l)}},[R,o]);a.useEffect(()=>{n.bankID&&Ye(n.bankID)},[n.bankID,Ye]),a.useEffect(()=>{n.bankID&&Ye(n.bankID)},[n.bankID,Ye]);const tn=g=>{j(g),f(!1)},rn=g=>{z(g),S(!1)},on=g=>{q(g),B(!1)},ln=g=>{B(g)},cn=g=>{f(g)},pn=g=>{S(g)};a.useEffect(()=>{j(ks(n==null?void 0:n.personBirthDate))},[n==null?void 0:n.personBirthDate]),a.useEffect(()=>{z(ks(n==null?void 0:n.personBaseFinishDate))},[n==null?void 0:n.personBaseFinishDate]);const un=()=>{te()},dn=async()=>{var g;try{let l,ge,Ie;k?(l=new Date(k),l.setMinutes(l.getMinutes()-l.getTimezoneOffset())):l=null,_?(ge=new Date(_),ge.setMinutes(ge.getMinutes()-ge.getTimezoneOffset())):ge=null,w?(Ie=new Date(w),Ie.setMinutes(Ie.getMinutes()-Ie.getTimezoneOffset())):Ie=null;const mn=await se({...n,relationshipWithParentID:b(n==null?void 0:n.relationshipWithParentID),personNationalCode:b(n==null?void 0:n.personNationalCode),personCertificateNo:b(n==null?void 0:n.personCertificateNo),personBirthDate:l,maritalStatusID:b(n==null?void 0:n.maritalStatusID),personPhone:b(n==null?void 0:n.personPhone),personCellPhone:b(n==null?void 0:n.personCellPhone),personRegion:parseInt(b(n==null?void 0:n.personRegion))||null,personArea:parseInt(b(n==null?void 0:n.personArea))||null,personCountryID:b(n==null?void 0:n.personCountryID),personStateID:b(n==null?void 0:n.personStateID),personCityID:b(n==null?void 0:n.personCityID),personPostalCode:b(n==null?void 0:n.personPostalCode),pensionaryStatusID:b(n==null?void 0:n.pensionaryStatusID),personBaseFinishDate:Ie,bankID:b(n==null?void 0:n.bankID),bankBranchID:b(n==null?void 0:n.bankBranchID),accountNo:b(n==null?void 0:n.accountNo),insuranceCoef:parseFloat(b(n==null?void 0:n.insuranceCoef))||0,insuranceAmount:parseFloat(b(n==null?void 0:n.insuranceAmount))||0,ledgerCode:parseInt(b(n.ledgerCode))||0,parentPersonID:m,pensionaryStartDate:ge}).unwrap();t(!1),p(),le.success(mn.message,{autoClose:2e3})}catch(l){console.log(l),le.error(((g=l==null?void 0:l.data)==null?void 0:g.message)||l.error,{auroClose:2e3})}};return Zs([D,T,N],[f,S,B]),e.jsx(e.Fragment,{children:ms||hs?e.jsx(pe,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ce,{color:"primary"})}):e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:s(dn),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"relationshipWithParentID",control:M,rules:{required:!0},render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:Ge,onChange:l=>g(l?l.value:null),value:Ge.find(l=>l.value===(n==null?void 0:n.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:gs||js})}),e.jsxs("label",{className:n!=null&&n.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),i.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personFirstName&&e.jsx("span",{className:"error-form",children:i.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personFirstName)||"",name:"personFirstName",id:"personFirstName1",required:!0,...O("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName1",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personLastName&&e.jsx("span",{className:"error-form",children:i.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personLastName",value:(n==null?void 0:n.personLastName)||"",id:"personLastName1",required:!0,...O("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personNationalCode&&e.jsx("span",{className:"error-form",children:i.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personNationalCode)??"",name:"personNationalCode",id:"personNationalCode2",required:!0,...O("personNationalCode",{required:"کد ملی را وارد کنید",minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personCertificateNo&&e.jsx("span",{className:"error-form",children:i.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personCertificateNo)||"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,...O("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificatetNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personFatherName&&e.jsx("span",{className:"error-form",children:i.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,...O("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:k,onChange:tn,format:"jYYYY/jMM/jDD",onOpenChange:cn,suffixIcon:e.jsx(ye,{color:"action"}),open:v,style:Ce,wrapperStyle:Se,pickerProps:{ref:D}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personBirthPlace&&e.jsx("span",{className:"error-form",children:i.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personBirthPlace",value:(n==null?void 0:n.personBirthPlace)||"",id:"personBirthPlace1",required:!0,...O("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"maritalStatusID",control:M,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:vs,onChange:l=>g(l?l.value:null),value:vs.find(l=>l.value===(n==null?void 0:n.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:Ns||bs})}),e.jsx("label",{className:n!=null&&n.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personPhone&&e.jsx("span",{className:"error-form",children:i.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personPhone)||"",name:"personPhone",id:"personPhone11",required:!0,...O("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone11",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personCellPhone&&e.jsx("span",{className:"error-form",children:i.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personCellPhone)||"",name:"personCellPhone",id:"personCellPhone222",required:!0,...O("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone222",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personArea&&e.jsx("span",{className:"error-form",children:i.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personArea)||"",name:"personArea",id:"personArea1",required:!0,...O("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personRegion&&e.jsx("span",{className:"error-form",children:i.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personRegion",value:h(n==null?void 0:n.personRegion)||"",id:"personRegion1",required:!0,...O("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"personCountryID",control:M,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:y,onChange:l=>g(l?l.value:null),value:y.find(l=>l.value===(n==null?void 0:n.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:Me||Ue})}),e.jsx("label",{className:n!=null&&n.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"personStateID",control:M,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:c,onChange:l=>g(l?l.value:null),value:c.find(l=>l.value===(n==null?void 0:n.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:qe||we})}),e.jsx("label",{className:n!=null&&n.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"personCityID",control:M,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:de,onChange:l=>g(l?l.value:null),value:de.find(l=>l.value===(n==null?void 0:n.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:ze||$e})}),e.jsx("label",{className:n!=null&&n.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personPostalCode&&e.jsx("span",{className:"error-form",children:i.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personPostalCode)||"",name:"personPostalCode",id:"personPostalCode1",required:!0,...O("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personSpecialDisease&&e.jsx("span",{className:"error-form",children:i.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personSpecialDisease)||"",name:"personSpecialDisease",id:"personSpecialDisease1",required:!0,...O("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[i.personAddress&&e.jsx("span",{className:"error-form",children:i.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personAddress)||"",name:"personAddress",id:"personAddress1",required:!0,...O("personAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[i.personDescription&&e.jsx("span",{className:"error-form",children:i.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.personDescription)||"",name:"personDescription",id:"personDescription",required:!0,...O("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription",children:"توضیحات"})]})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات وظیفه بگیری "})}),e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"pensionaryStatusID",control:M,rules:{required:!0},render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:me,onChange:l=>g(l?l.value:null),value:me.find(l=>l.value===(n==null?void 0:n.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:Ds||ys})}),e.jsxs("label",{className:n!=null&&n.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),i.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:_,defaultValue:null,onChange:on,onOpenChange:ln,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(ye,{color:"action"}),open:x,style:Ce,wrapperStyle:Se,pickerProps:{ref:N}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:w,onChange:rn,format:"jYYYY/jMM/jDD",onOpenChange:pn,suffixIcon:e.jsx(ye,{color:"action"}),open:r,style:Ce,wrapperStyle:Se,pickerProps:{ref:T}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",disabled:!0,value:h(n==null?void 0:n.heirID)||"-",name:"heirID",id:"heirID",...O("heirID")}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"heirID",children:"شماره وظیفه بگیری"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",disabled:!0,value:h(Pe(n==null?void 0:n.pensionaryStartDate))||"-",name:"pensionaryStartDate",id:"pensionaryStartDate",...O("pensionaryStartDate")}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"pensionaryStartDate",children:"تاریخ وظیفه بگیری"})]})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(lt,{statusHistoryTableData:C,isLoading:Be,isFetching:Fe,handleRefresh:un}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات بانکی وظیفه بگیر "})}),e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"bankID",control:M,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:Ke,onChange:l=>g(l?l.value:null),value:Ke.find(l=>l.value===(n==null?void 0:n.bankID)),id:"bankID",name:"bankID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"بانک"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:Ss||Bs})}),e.jsx("label",{htmlFor:"bankID",className:n!=null&&n.bankID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"بانک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"bankBranchID",control:M,render:({field:{onChange:g}})=>e.jsx(V,{closeMenuOnSelect:!0,components:I,options:Ms,onChange:l=>g(l?l.value:null),isDisabled:E||A||!n.bankID,value:Ms.find(l=>l.value===(n==null?void 0:n.bankBranchID))||null,id:"bankBranchID",name:"bankBranchID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شعبه"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:E||A})}),e.jsx("label",{htmlFor:"bankBranchID",className:n!=null&&n.bankBranchID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شعبه"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.accountNo&&e.jsx("span",{className:"error-form",children:i.accountNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.accountNo)||"",name:"accountNo",id:"accountNoHeir",required:!0,...O("accountNo",{pattern:{value:/^[۰-۹0-9]+$/,message:"شماره حساب باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"accountNoHeir",children:"شماره حساب"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.ledgerCode&&e.jsx("span",{className:"error-form",children:i.ledgerCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.ledgerCode)||"",name:"ledgerCode",id:"ledgerCodeHeir",required:!0,...O("ledgerCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"ردیف ورثه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"ledgerCodeHeir",children:"ردیف ورثه"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.insuranceCoef&&e.jsx("span",{className:"error-form",children:i.insuranceCoef.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.insuranceCoef)||"",name:"insuranceCoef",id:"insuranceCoefHeir",required:!0,...O("insuranceCoef",{pattern:{value:/^[۰-۹0-9]+([.,][۰-۹0-9]+)?$/,message:"از اعداد یا اعشار استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceCoefHeir",children:"ضریب بیمه"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.insuranceAmount&&e.jsx("span",{className:"error-form",children:i.insuranceAmount.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(n==null?void 0:n.insuranceAmount)||"",name:"insuranceAmount",id:"insuranceAmountHeir",required:!0,...O("insuranceAmount",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceAmountHeir",children:"بیمه تبعی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(he,{dir:"ltr",endIcon:e.jsx(zs,{}),onClick:s,type:"submit",loading:G,variant:"contained",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})})}function pt({setShowCreateHeirModal:t,refetch:d}){const p=a.useRef(null),D=a.useRef(null),T=a.useRef(null),[N,F]=a.useState(null),[o,C]=a.useState(!1),[u,k]=a.useState(null),[j,v]=a.useState(null),[f,_]=a.useState(!1),[q,w]=a.useState(!1),{handleSubmit:z,formState:{errors:r},control:S,register:x,watch:B}=Oe(),s=B(),[i,{isLoading:M}]=it(),[O,X]=a.useState([]),ee=cs(),se=new URLSearchParams(ee.search).get("personID"),G=Xs(),[I,{isLoading:Y,isFetching:m}]=Rs(),{relationships:R,relationshipIsLoading:E,relationshipIsFetching:A}=Js(),{lookUpItems:L,lookUpItemsIsLoading:xe,lookUpItemsIsFetching:Be}=$({lookUpType:"MaritialStatus"}),{lookUpItems:Fe,lookUpItemsIsLoading:te,lookUpItemsIsFetching:W}=$({lookUpType:"Country"}),{lookUpItems:Z,lookUpItemsIsLoading:_e,lookUpItemsIsFetching:ms}=$({lookUpType:"State"}),{lookUpItems:hs,lookUpItemsIsLoading:ue,lookUpItemsIsFetching:Ae}=$({lookUpType:"City"}),{pensionaryStatus:xs,pensionaryStatusIsLoading:gs,pensionaryStatusIsFetching:js}=Fs({pensionaryStatusCategory:"H"}),{lookUpItems:Is,lookUpItemsIsLoading:Ns,lookUpItemsIsFetching:bs}=$({lookUpType:"Bank"}),Te=Q(R,"relationshipID","relationshipName"),Me=Q(L,"lookUpID","lookUpName"),Ue=Q(Fe,"lookUpID","lookUpName"),Ee=Q(xs,"pensionaryStatusID","pensionaryStatusName"),qe=Q(Z,"lookUpID","lookUpName"),we=Q(hs,"lookUpID","lookUpName"),He=Q(Is,"lookUpID","lookUpName"),ze=Q(O,"lookUpID","lookUpName"),$e=a.useCallback(async y=>{try{const c=await I({lookUpType:"BankBranch",lookUpParentID:b(y)}).unwrap();X(c.itemList)}catch(c){console.log(c)}},[I,X]);a.useEffect(()=>{s.bankID&&$e(s.bankID)},[s.bankID,$e]);const fs=y=>{F(y),C(!1)},Ds=y=>{v(y),_(!1)},ys=y=>{k(y),w(!1)},Cs=y=>{w(y)},Ss=y=>{C(y)},Bs=y=>{_(y)},Ge=async()=>{var y;try{let c,de,me;N?(c=new Date(N),c.setMinutes(c.getMinutes()-c.getTimezoneOffset())):c=null,u?(me=new Date(u),me.setMinutes(me.getMinutes()-me.getTimezoneOffset())):me=null,j?(de=new Date(j),de.setMinutes(de.getMinutes()-de.getTimezoneOffset())):de=null;const Ke=await i({...s,relationshipWithParentID:b(s==null?void 0:s.relationshipWithParentID),personNationalCode:b(s==null?void 0:s.personNationalCode),personCertificateNo:b(s==null?void 0:s.personCertificateNo),personBirthDate:c,maritalStatusID:b(s==null?void 0:s.maritalStatusID),personPhone:b(s==null?void 0:s.personPhone),personCellPhone:b(s==null?void 0:s.personCellPhone),personRegion:parseInt(b(s==null?void 0:s.personRegion))||null,personArea:parseInt(b(s==null?void 0:s.personArea))||null,personCountryID:b(s==null?void 0:s.personCountryID),personStateID:b(s==null?void 0:s.personStateID),personCityID:b(s==null?void 0:s.personCityID),personPostalCode:b(s==null?void 0:s.personPostalCode),pensionaryStatusID:b(s==null?void 0:s.pensionaryStatusID),personBaseFinishDate:de,bankID:b(s==null?void 0:s.bankID),bankBranchID:b(s==null?void 0:s.bankBranchID),accountNo:b(s==null?void 0:s.accountNo),insuranceCoef:parseFloat(b(s==null?void 0:s.insuranceCoef))||0,insuranceAmount:parseFloat(b(s==null?void 0:s.insuranceAmount))||0,ledgerCode:parseInt(b(s.ledgerCode))||0,parentPersonID:se,pensionaryStartDate:me}).unwrap();t(!1),d(),le.success(Ke.message,{autoClose:2e3})}catch(c){console.log(c),le.error(((y=c==null?void 0:c.data)==null?void 0:y.message)||c.error,{autoClose:2e3})}};return Zs([p,D],[C,_]),e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:z(Ge),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"relationshipWithParentID",control:S,rules:{required:!0},render:({field:{onChange:y}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:Te,onChange:c=>y(c?c.value:null),value:Te.find(c=>c.value===(s==null?void 0:s.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:E||A})}),e.jsxs("label",{className:s!=null&&s.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),r.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personFirstName&&e.jsx("span",{className:"error-form",children:r.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personFirstName",value:(s==null?void 0:s.personFirstName)||"",id:"personFirstName1",required:!0,...x("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName1",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personLastName&&e.jsx("span",{className:"error-form",children:r.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personLastName)||"",name:"personLastName",id:"personLastName1",required:!0,...x("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personNationalCode&&e.jsx("span",{className:"error-form",children:r.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personNationalCode",value:h(s==null?void 0:s.personNationalCode)||"",id:"personNationalCode2",required:!0,...x("personNationalCode",{required:"کد ملی را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personCertificateNo&&e.jsx("span",{className:"error-form",children:r.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personCertificateNo)||"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,...x("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificateNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personFatherName&&e.jsx("span",{className:"error-form",children:r.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,...x("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:N,onChange:fs,format:"jYYYY/jMM/jDD",onOpenChange:Ss,suffixIcon:e.jsx(ye,{color:"action"}),open:o,style:Ce,wrapperStyle:Se,pickerProps:{ref:p}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personBirthPlace&&e.jsx("span",{className:"error-form",children:r.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personBirthPlace)||"",name:"personBirthPlace",id:"personBirthPlace1",required:!0,...x("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"maritalStatusID",control:S,render:({field:{onChange:y}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:Me,onChange:c=>y(c?c.value:null),value:Me.find(c=>c.value===(s==null?void 0:s.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:xe||Be})}),e.jsx("label",{className:s!=null&&s.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personPhone&&e.jsx("span",{className:"error-form",children:r.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personPhone)||"",name:"personPhone",id:"personPhone11",required:!0,...x("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone11",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personCellPhone&&e.jsx("span",{className:"error-form",children:r.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone",value:h(s==null?void 0:s.personCellPhone)||"",id:"personCellPhone222",required:!0,...x("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone222",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personArea&&e.jsx("span",{className:"error-form",children:r.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personArea),name:"personArea",id:"personArea1",required:!0,...x("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personRegion&&e.jsx("span",{className:"error-form",children:r.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personRegion),name:"personRegion",id:"personRegion1",required:!0,...x("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"personCountryID",control:S,render:({field:{onChange:y}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:Ue,onChange:c=>y(c?c.value:null),value:Ue.find(c=>c.value===(s==null?void 0:s.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:te||W})}),e.jsx("label",{className:s!=null&&s.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"personStateID",control:S,render:({field:{onChange:y}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:qe,onChange:c=>y(c?c.value:null),value:qe.find(c=>c.value===(s==null?void 0:s.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:_e||ms})}),e.jsx("label",{className:s!=null&&s.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"personCityID",control:S,render:({field:{onChange:y}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:we,onChange:c=>y(c?c.value:null),value:we.find(c=>c.value===(s==null?void 0:s.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:ue||Ae})}),e.jsx("label",{className:s!=null&&s.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personPostalCode&&e.jsx("span",{className:"error-form",children:r.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPostalCode",value:h(s==null?void 0:s.personPostalCode)||"",id:"personPostalCode1",required:!0,...x("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.personSpecialDisease&&e.jsx("span",{className:"error-form",children:r.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personSpecialDisease",value:(s==null?void 0:s.personSpecialDisease)||"",id:"personSpecialDisease1",required:!0,...x("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[r.personAddress&&e.jsx("span",{className:"error-form",children:r.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personAddress)||"",name:"personAddress",id:"personAddress1",required:!0,...x("personAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[r.personDescription&&e.jsx("span",{className:"error-form",children:r.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.personDescription)||"",name:"personDescription",id:"personDescription",required:!0,...x("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription",children:"توضیحات"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات وظیفه بگیری "})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"pensionaryStatusID",control:S,rules:{required:!0},render:({field:{onChange:y}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:Ee,onChange:c=>y(c?c.value:null),value:Ee.find(c=>c.value===(s==null?void 0:s.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:gs||js})}),e.jsxs("label",{className:s!=null&&s.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),r.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:u,defaultValue:null,onChange:ys,onOpenChange:Cs,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(ye,{color:"action"}),open:q,style:Ce,wrapperStyle:Se,pickerProps:{ref:T}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(De.InputDatePicker,{value:j,onChange:Ds,format:"jYYYY/jMM/jDD",onOpenChange:Bs,suffixIcon:e.jsx(ye,{color:"action"}),open:f,style:Ce,wrapperStyle:Se,pickerProps:{ref:D}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ مبنای قطع سهم"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات بانکی وظیفه بگیر "})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"bankID",control:S,render:({field:{onChange:y}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:He,onChange:c=>y(c?c.value:null),value:He.find(c=>c.value===(s==null?void 0:s.bankID)),id:"bankID",name:"bankID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"بانک"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:Ns||bs})}),e.jsx("label",{htmlFor:"bankID",className:s!=null&&s.bankID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"بانک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"bankBranchID",control:S,render:({field:{onChange:y}})=>e.jsx(V,{closeMenuOnSelect:!0,components:G,options:ze,onChange:c=>y(c?c.value:null),isDisabled:Y||m||!s.bankID,value:ze.find(c=>c.value===(s==null?void 0:s.bankBranchID))||null,id:"bankBranchID",name:"bankBranchID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شعبه"}),noOptionsMessage:P.noOptionsMessage,loadingMessage:P.loadingMessage,styles:J,isLoading:Y||m})}),e.jsx("label",{htmlFor:"bankBranchID",className:s!=null&&s.bankBranchID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شعبه"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.accountNo&&e.jsx("span",{className:"error-form",children:r.accountNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.accountNo)||"",name:"accountNo",id:"accountNoHeir",required:!0,...x("accountNo",{pattern:{value:/^[۰-۹0-9]+$/,message:"شماره حساب باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"accountNoHeir",children:"شماره حساب"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.ledgerCode&&e.jsx("span",{className:"error-form",children:r.ledgerCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:h(s==null?void 0:s.ledgerCode)||"",name:"ledgerCode",id:"ledgerCodeHeir",required:!0,...x("ledgerCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"ردیف ورثه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"ledgerCodeHeir",children:"ردیف ورثه"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.insuranceCoef&&e.jsx("span",{className:"error-form",children:r.insuranceCoef.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"insuranceCoef",value:h(s==null?void 0:s.insuranceCoef)||"",id:"insuranceCoefHeir",required:!0,...x("insuranceCoef",{pattern:{value:/^[۰-۹0-9]+([.,][۰-۹0-9]+)?$/,message:"از اعداد یا اعشار استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceCoefHeir",children:"ضریب بیمه"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.insuranceAmount&&e.jsx("span",{className:"error-form",children:r.insuranceAmount.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.insuranceAmount)||"",name:"insuranceAmount",id:"insuranceAmountHeir",required:!0,...x("insuranceAmount",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceAmountHeir",children:"بیمه تبعی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(he,{dir:"ltr",endIcon:e.jsx(zs,{}),onClick:z,type:"submit",loading:M,variant:"contained",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})}function ut(){const[t,d]=a.useState({}),[p,D]=a.useState([]),[T,N]=a.useState(!1),[F,o]=a.useState(!1),[C,u]=a.useState(!1),[k,j]=a.useState(""),[v,f]=a.useState(""),_=cs(),w=new URLSearchParams(_.search).get("personID"),[z,{isLoading:r}]=rt(),{data:S,isLoading:x,isSuccess:B,isFetching:s,error:i,refetch:M}=at(w);a.useEffect(()=>{if(M(),B){const m=S.itemList.map((R,E)=>({id:R.personID,heirRowNum:E+1,pensionaryID:R.pensionaryID,personNationalCode:R.personNationalCode,personFirstName:R.personFirstName,personLastName:R.personLastName,pensionaryIsUnderGauranteeText:R.pensionaryIsUnderGauranteeText,personBirthDate:R.personBirthDate,relationshipWithParentName:R.relationshipWithParentName,parentPersonNationalCode:R.parentPersonNationalCode}));D(m)}},[B,S,M]),a.useEffect(()=>{var m;i&&(console.log(i),le.error(((m=i==null?void 0:i.data)==null?void 0:m.message)||i.error,{autoClose:2e3}))},[i]);const O=()=>{M()},X=()=>{o(!0)},ee=()=>{N(!0)},n=()=>{u(!0)},se=async()=>{var m;try{const R=await z({pensionaryID:v}).unwrap();u(!1),M(),le.success(R.message,{autoClose:2e3})}catch(R){console.log(R),le.error(((m=R==null?void 0:R.data)==null?void 0:m.message)||R.error,{autoClose:2e3})}},G=a.useMemo(()=>[{accessorKey:"heirRowNum",header:"ردیف",size:20,enableColumnActions:!1,enableSorting:!1,Cell:({renderedCellValue:m})=>e.jsx("div",{children:h(m)})},{accessorKey:"personNationalCode",header:"کد ملی",size:20,Cell:({renderedCellValue:m})=>e.jsx("div",{children:h(m)})},{accessorKey:"personFirstName",header:"نام",size:20},{accessorKey:"personLastName",header:"نام خانوادگی",size:20},{accessorKey:"pensionaryIsUnderGauranteeText",header:"وضعیت",size:20},{accessorKey:"personBirthDate",header:"تاریخ تولد",size:20,Cell:({renderedCellValue:m})=>e.jsx("div",{children:h(Pe(m))})},{accessorKey:"relationshipWithParentName",size:20,header:"نسبت"},{accessorKey:"parentPersonNationalCode",header:"شماره پرونده",size:20,Cell:({renderedCellValue:m})=>e.jsx("div",{children:h(m)})},{accessorKey:"editHeirAction",header:"ویرایش",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:m})=>e.jsx(ae,{title:`ویرایش "${m.original.personFirstName} ${m.original.personLastName}"`,children:e.jsx(H,{color:"success",onClick:ee,sx:{padding:"0"},children:e.jsx(Re,{})})})},{accessorKey:"deleteHeirAction",header:"حذف",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:m})=>e.jsx(ae,{title:`حذف "${m.original.personFirstName} ${m.original.personLastName}"`,children:e.jsx(H,{color:"error",onClick:n,sx:{padding:"0"},children:e.jsx(en,{})})})}],[]),I=ns({...ds,columns:G,data:p,muiTableBodyRowProps:({row:m})=>({onClick:()=>d(()=>({[m.id]:!0})),selected:t[m.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsxs(pe,{children:[s?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"info",onClick:O,children:e.jsx(Le,{fontSize:"small"})})})}),s?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:e.jsx("span",{style:{fontFamily:"sahel",fontSize:"0.8rem"},children:"ایجاد موظف"}),children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"success",onClick:X,children:e.jsx(sn,{fontSize:"small"})})})})]}),muiPaginationProps:{shape:"rounded",showRowsPerPage:!1,size:"small",renderItem:m=>e.jsx(as,{...m,page:h(m.page),slots:{previous:ts,next:rs,first:os,last:is}})},getRowId:m=>m.id,onRowSelectionChange:d,state:{rowSelection:t}});return a.useEffect(()=>{const m=Object.keys(I.getState().rowSelection)[0];if(m){const R=xn(p,m);j(m),f(R==null?void 0:R.pensionaryID)}},[I,t,p]),e.jsx(e.Fragment,{children:x||s?e.jsx("div",{className:"skeleton-lg",children:e.jsx(_s,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsxs(e.Fragment,{children:[T&&k?e.jsx(es,{title:"ویرایش اطلاعات موظف",closeModal:()=>N(!1),children:e.jsx(ct,{setShowEditHeirModal:N,personID:k,refetch:M})}):C?e.jsxs(es,{title:"حذف موظف",closeModal:()=>u(!1),children:[e.jsx("p",{className:"paragraph-primary",children:"آیا از حذف این موظف اطمینان دارید؟"}),e.jsxs("div",{className:"flex-row flex-center",children:[e.jsx(he,{dir:"ltr",endIcon:e.jsx(gn,{}),onClick:se,loading:r,variant:"contained",color:"success",children:e.jsx("span",{children:"بله"})}),e.jsx(jn,{dir:"ltr",endIcon:e.jsx(In,{}),onClick:()=>u(!1),variant:"contained",color:"error",children:e.jsx("span",{children:"خیر"})})]})]}):F?e.jsx(es,{title:"ایجاد موظف",closeModal:()=>o(!1),children:e.jsx(pt,{setShowCreateHeirModal:o,refetch:M})}):null,e.jsx(ls,{table:I})]})})}function dt(){const[t,d]=a.useState({}),[p,D]=a.useState([]),T=cs(),N=new URLSearchParams(T.search),F=N.get("Role"),o=N.get("personID"),{data:C,isSuccess:u,isLoading:k,isFetching:j,error:v,refetch:f}=Ya({Role:F,personID:o});a.useEffect(()=>{if(f(),u){const r=C.itemList.map(S=>({id:S.requestID,type:S.requestTypeID,requestNO:S.requestNO||"-",personId:S.personID,requestTypeNameFa:S.requestTypeNameFa||"-",personName:S.personName||"-",date:S.requestDate||"-",body:S.requestText||"-"}));D(r),sessionStorage.setItem("requests",JSON.stringify(r))}},[C,u,f]),a.useEffect(()=>{var r;v&&le.error(((r=v==null?void 0:v.data)==null?void 0:r.message)||v.error,{autoClose:2e3})},[v]);const _=()=>{f()},q=a.useMemo(()=>[{accessorKey:"id",header:"شماره درخواست",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:h(r)})},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"ارسال کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:h(Pe(r))})},{accessorKey:"observeReq",header:"مشاهده درخواست",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:r})=>e.jsx(ae,{title:h(r.original.requestNO),children:e.jsx(Os,{to:`/retirement/request?requestID=${r.id}&Role=${F}&type=${r.original.type}`,children:e.jsx(H,{color:"primary",sx:{padding:"0"},children:e.jsx($s,{})})})})}],[F]),w=ns({...ds,columns:q,data:p,muiTableBodyRowProps:({row:r})=>({onClick:()=>d(()=>({[r.id]:!0})),selected:t[r.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsx(pe,{children:j?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"info",onClick:_,children:e.jsx(Le,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:r=>e.jsx(as,{...r,page:h(r.page),slots:{previous:ts,next:rs,first:os,last:is}})},getRowId:r=>r.id,onRowSelectionChange:d,state:{rowSelection:t}});return e.jsx(e.Fragment,{children:k?e.jsx("div",{className:"skeleton-lg",children:e.jsx(_s,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(ls,{table:w})})}function mt(){const[t,d]=a.useState({}),[p,D]=a.useState([]),[T,N]=a.useState(null),[F,o]=a.useState(!1),C=cs(),k=new URLSearchParams(C.search).get("personID"),{data:j,isLoading:v,isSuccess:f,isFetching:_,error:q,refetch:w}=Wa({personID:k,payType:"M"}),z=()=>{w()};a.useEffect(()=>{if(f){const s=j.itemList.map((i,M)=>({id:i.payID,payRowNum:M+1,payCreditAmount:i.payCreditAmount,payDebitAmount:i.payDebitAmount,payAmount:i.payAmount,payDate:i.payDate,currentYear:i.currentYear,currentMonth:i.currentMonth}));D(s)}},[f,w,j]),a.useEffect(()=>{var s;q&&le.error(((s=q==null?void 0:q.data)==null?void 0:s.message)||q.error,{autoClose:2e3})},[q]);const r=()=>{o(!0)},S=a.useMemo(()=>[{accessorKey:"payRowNum",header:"ردیف",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:h(s)})},{accessorKey:"payCreditAmount",header:"مبلغ بستانکاری",size:20,Cell:({renderedCellValue:s})=>e.jsxs("div",{children:[Ps(h(s))," ","ریال"]})},{accessorKey:"payDebitAmount",header:"مبلغ بدهکاری",size:20,Cell:({renderedCellValue:s})=>e.jsxs("div",{children:[Ps(h(s))," ","ریال"]})},{accessorKey:"payAmount",header:"مبلغ کل",size:20,Cell:({renderedCellValue:s})=>e.jsxs("div",{children:[Ps(h(s))," ","ریال"]})},{accessorKey:"payDate",header:"تاریخ پرداخت",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:Pe(s)})},{accessorKey:"currentYear",header:"سال مالی",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:h(s)})},{accessorKey:"currentMonth",header:"ماه مالی",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:h(s)})},{accessorKey:"downloadRetiredSlip",header:"مشاهده/چاپ",enableSorting:!1,enableColumnActions:!1,size:20,Cell:()=>e.jsx(ae,{title:"دانلود و مشاهده فیش",children:e.jsx(H,{color:"primary",sx:{padding:"0"},onClick:r,children:e.jsx($s,{})})})}],[]),x=ns({...ds,columns:S,data:p,renderTopToolbarCustomActions:()=>e.jsx(pe,{children:_?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"info",onClick:z,children:e.jsx(Le,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:s=>e.jsx(as,{...s,page:h(s.page),slots:{previous:ts,next:rs,first:os,last:is}})},muiTableBodyRowProps:({row:s})=>({onClick:()=>d(()=>({[s.id]:!0})),selected:t[s.id],sx:{cursor:"pointer"}}),getRowId:s=>s.id,onRowSelectionChange:d,state:{rowSelection:t}});return a.useEffect(()=>{const s=Object.keys(x.getState().rowSelection)[0];N(s||null)},[x,t]),e.jsxs(e.Fragment,{children:[F&&T&&e.jsx(es,{closeModal:()=>o(!1),children:e.jsx(Va,{payID:T})},T),v?e.jsx("div",{className:"skeleton-lg",children:e.jsx(_s,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(ls,{table:x})]})}const be=({label:t,size:d="small",color:p="primary",disabled:D,control:T,name:N,errors:F,rules:o})=>e.jsxs("div",{className:"checkboxContainer__item",children:[e.jsx(K,{name:N,control:T,rules:o,render:({field:{onChange:C,value:u}})=>e.jsx(Nn,{id:N,checked:!!u,onChange:k=>C(k.target.checked),size:d,color:p,disabled:D,sx:{padding:.5}})}),e.jsx("label",{htmlFor:N,className:D?"checkboxContainer__label--disabled":"checkboxContainer__label",children:t})]}),ht=["personFirstName","personLastName","personNationalCode","personCertificateNo","personFatherName","genderID","personBirthDate","personBirthPlace","personPreviousNam","personIsSacrificedFamily","personIsWarrior","personIsChildOfSacrificed","personIsValiant","personIsSacrificed","personIsCaptive","retiredID","personPhone","personCellPhone","backupPhone","backupFirstName","backupLastName","personEmail","educationTypeID","personCountryID","personStateID","personCityID","personRegion","personArea","personPostalCode","housingTypeID","maritalStatusID","personDeathDate","personAddress","personDescription"],xt=["retiredGroup","retiredOrganizationID","retiredLastPosition","employmentTypeID","retirementDate","pensionaryStatusID","pensionaryStartdate","retiredJobDegreeCoef","retiredGrantDuration","retiredRealDuration"],gt=["bankID","bankBranchID","accountNo","ledgerCode","insuranceCoef","insuranceAmount"],jt=()=>{const[t,d]=ps(!1),[p]=ke(),D=bn(),T=p.get("personID"),N=a.useMemo(()=>["genderID","personCountryID","personStateID","personCityID","housingTypeID","educationTypeID","maritalStatusID"],[]),F=a.useMemo(()=>["personDeathDate","personBirthDate"],[]),{control:o,handleSubmit:C,formState:{errors:u},setValue:k}=Oe(),{data:j,isLoading:v,isFetching:f,isSuccess:_,refetch:q}=fn(T),[w,{isLoading:z}]=Dn(),{lookUpItems:r,lookUpItemsIsLoading:S}=$({lookUpType:"Gender"}),x=a.useMemo(()=>re(r,"lookUpID","lookUpName"),[r]),{lookUpItems:B,lookUpItemsIsLoading:s}=$({lookUpType:"EducationType"}),i=a.useMemo(()=>re(B,"lookUpID","lookUpName"),[B]),{lookUpItems:M,lookUpItemsIsLoading:O}=$({lookUpType:"Country"}),X=a.useMemo(()=>re(M,"lookUpID","lookUpName"),[M]),{lookUpItems:ee,lookUpItemsIsLoading:n}=$({lookUpType:"State"}),se=a.useMemo(()=>re(ee,"lookUpID","lookUpName"),[ee]),{lookUpItems:G,lookUpItemsIsLoading:I}=$({lookUpType:"City"}),Y=a.useMemo(()=>re(G,"lookUpID","lookUpName"),[G]),{lookUpItems:m,lookUpItemsIsLoading:R}=$({lookUpType:"HousingType"}),E=a.useMemo(()=>re(m,"lookUpID","lookUpName"),[m]),{lookUpItems:A,lookUpItemsIsLoading:L}=$({lookUpType:"MaritialStatus"}),xe=a.useMemo(()=>re(A,"lookUpID","lookUpName"),[A]),Be=async te=>{const W=As(te,N,F),Z=await w(W).unwrap();q(),d(),us.success(Z.message)};return a.useEffect(()=>{if(_){const te=j==null?void 0:j.itemList[0];D(Us((te==null?void 0:te.personDeathDate)!==null));const W=nn(te,N,F,{genderID:x,educationTypeID:i,personCountryID:X,personStateID:se,personCityID:Y,housingTypeID:E,maritalStatusID:xe});Object.keys(W).forEach(Z=>{ht.includes(Z)&&W[Z]===null?k(Z,""):k(Z,W[Z])})}return()=>{D(Us(null))}},[D,_,j==null?void 0:j.itemList,k,x,X,i,se,Y,E,xe,F,N]),e.jsx(e.Fragment,{children:v||f?e.jsx(pe,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ce,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:C(Be),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(U,{name:"personFirstName",label:Gs,rules:ie,required:!0,control:o,editable:t,type:"text"}),e.jsx(U,{name:"personLastName",label:Ks,rules:ie,required:!0,control:o,editable:t,type:"text"}),e.jsx(U,{name:"personNationalCode",label:Ys,rules:{...yn,...ie},required:!0,control:o,editable:t,type:"text"}),e.jsx(U,{name:"personCertificateNo",label:Cn,rules:{...ne,...ie},required:!0,control:o,editable:t,type:"text"}),e.jsx(U,{name:"personFatherName",label:Sn,rules:fe,required:!0,control:o,editable:t,type:"text"}),e.jsx(oe,{name:"genderID",control:o,label:Bn,required:!0,isClearable:!0,isDisabled:!t,options:x,isLoading:S,rules:ie,errors:u}),e.jsx(ss,{name:"personBirthDate",label:Ws,control:o,disabled:!t,required:!0,errors:u,rules:ie,setValue:k}),e.jsx(U,{name:"personBirthPlace",label:vn,rules:fe,required:!1,control:o,editable:t,type:"text"}),e.jsx(U,{name:"personPreviousName",label:kn,rules:fe,required:!1,control:o,editable:t,type:"text"}),e.jsxs("div",{className:t?"checkboxContainer col-span-3":"checkboxContainer--disabled col-span-3",children:[e.jsx("p",{className:"inputBox__form--readOnly-label",children:Pn}),e.jsx(be,{disabled:!t,control:o,label:On,name:"personIsSacrificedFamily"}),e.jsx(be,{disabled:!t,control:o,label:Ln,name:"personIsWarrior"}),e.jsx(be,{disabled:!t,control:o,label:Rn,name:"personIsChildOfSacrificed"}),e.jsx(be,{disabled:!t,control:o,label:Fn,name:"personIsValiant"}),e.jsx(be,{disabled:!t,control:o,label:_n,name:"personIsSacrificed"}),e.jsx(be,{disabled:!t,control:o,label:An,name:"personIsCaptive"})]}),e.jsx(U,{name:"retiredID",label:Tn,required:!1,control:o,editable:!1,type:"text"}),e.jsx(U,{name:"personPhone",label:Mn,required:!1,rules:ne,control:o,editable:t,type:"text"}),e.jsx(U,{name:"personCellPhone",label:Un,required:!1,rules:En,control:o,editable:t,type:"text"}),e.jsx(U,{name:"backupPhone",label:qn,required:!1,rules:ne,control:o,editable:t,type:"text"}),e.jsx(U,{name:"backupFirstName",label:wn,required:!1,rules:fe,control:o,editable:t,type:"text"}),e.jsx(U,{name:"backupLastName",label:Hn,required:!1,rules:fe,control:o,editable:t,type:"text"}),e.jsx(U,{name:"personEmail",label:zn,required:!1,rules:$n,control:o,editable:t,type:"text"}),e.jsx(oe,{name:"educationTypeID",control:o,label:Gn,required:!1,isClearable:!0,isDisabled:!t,options:i,isLoading:s}),e.jsx(oe,{name:"personCountryID",control:o,label:Kn,required:!1,isClearable:!0,isDisabled:!t,options:X,isLoading:O}),e.jsx(oe,{name:"personStateID",control:o,label:Yn,required:!1,isClearable:!0,isDisabled:!t,options:se,isLoading:n}),e.jsx(oe,{name:"personCityID",control:o,label:Wn,required:!1,isClearable:!0,isDisabled:!t,options:Y,isLoading:I}),e.jsx(U,{name:"personRegion",label:Vn,required:!1,control:o,editable:t,rules:ne,type:"text"}),e.jsx(U,{name:"personArea",label:Qn,required:!1,control:o,editable:t,rules:ne,type:"text"}),e.jsx(U,{name:"personPostalCode",label:Jn,required:!1,control:o,editable:t,rules:Zn,type:"text"}),e.jsx(oe,{name:"housingTypeID",control:o,label:Xn,required:!1,isClearable:!0,isDisabled:!t,options:E,isLoading:R}),e.jsx(oe,{name:"maritalStatusID",control:o,label:ea,required:!1,isClearable:!0,isDisabled:!t,options:xe,isLoading:L}),e.jsx(ss,{name:"personDeathDate",label:sa,control:o,disabled:!t,required:!1,setValue:k}),e.jsx(ws,{name:"personAddress",label:na,required:!0,control:o,editable:t,containerClassNames:"col-span-3"}),e.jsx(ws,{name:"personDescription",label:aa,required:!0,control:o,editable:t,containerClassNames:"col-span-4 row-span-2"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(he,{dir:"ltr",endIcon:e.jsx(Ts,{}),disabled:!t,variant:"contained",type:"submit",loading:z,color:"success",children:e.jsx("span",{children:Ls})}),e.jsx(he,{dir:"ltr",endIcon:e.jsx(Re,{}),onClick:d,disabled:t,variant:"contained",color:"primary",children:e.jsx("span",{children:ve})})]})]})})})},It=()=>{const[t,d]=a.useState([]),[p,D]=ps(!1),[T]=ke(),N=T.get("personID"),{personDeathDate:F}=Vs(E=>E.person),o=a.useMemo(()=>["retiredOrganizationID","employmentTypeID","pensionaryStatusID"],[]),C=a.useMemo(()=>["retirementDate","pensionaryStartdate"],[]),{control:u,handleSubmit:k,formState:{errors:j},setValue:v}=Oe(),{data:f,isSuccess:_,isLoading:q,isFetching:w,refetch:z}=ta(N),{data:r,isSuccess:S,isLoading:x,isFetching:B,refetch:s}=Hs(N),[i,{isLoading:M}]=ra(),{organizations:O,organizationIsLoading:X}=Ka({}),{lookUpItems:ee,lookUpItemsIsLoading:n}=$({lookUpType:"EmploymentType"}),{pensionaryStatus:se,pensionaryStatusIsLoading:G}=Fs({pensionaryStatusCategory:"R",pensionaryStatusIsDead:F}),I=a.useMemo(()=>re(O,"organizationID","organizationName"),[O]),Y=a.useMemo(()=>re(ee,"lookUpID","lookUpName"),[ee]),m=a.useMemo(()=>re(se,"pensionaryStatusID","pensionaryStatusName"),[se]);a.useEffect(()=>{if(_){const E=f==null?void 0:f.itemList[0];if(E){const A={...E};Object.keys(A).forEach(L=>{L==="retirementDate"&&(A[L]=A[L]===null?null:Es(A[L])),L==="pensionaryStartdate"&&(A[L]=A[L]===null?null:Es(A[L])),v(L,A[L])})}}},[_,f==null?void 0:f.itemList,v]);const R=async E=>{const A=As(E,o,C),L=await i({...A,retiredGroup:parseInt(je(E.retiredGroup)),retiredJobDegreeCoef:parseInt(je(E.retiredJobDegreeCoef)),retiredRealDuration:parseInt(je(E.retiredRealDuration)),retiredGrantDuration:parseInt(je(E.retiredGrantDuration)),personID:N}).unwrap();D(),z(),s(),us.success(L.message)};return a.useEffect(()=>{if(_){const E=f==null?void 0:f.itemList[0],A=nn(E,o,C,{retiredOrganizationID:I,employmentTypeID:Y,pensionaryStatusID:m});Object.keys(A).forEach(L=>{xt.includes(L)&&A[L]===null?v(L,""):v(L,A[L])})}},[_,f==null?void 0:f.itemList,I,Y,m,v,o,C]),a.useEffect(()=>{if(S){const E=r==null?void 0:r.itemList.map((A,L)=>({id:A.pensionaryID,isActive:A.pensionaryIsActive,pensionaryStatusRowNum:L+1,pensionaryStatusName:A.pensionaryStatusName||"-",pensionaryStartdate:A.pensionaryStartdate||"-"}));d(E)}},[S,r==null?void 0:r.itemList]),e.jsx(e.Fragment,{children:q||w?e.jsx(pe,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ce,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:k(R),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(U,{name:"retiredGroup",label:oa,control:u,required:!0,editable:p,rules:{...ie,...ne},type:"text"}),e.jsx(oe,{name:"retiredOrganizationID",control:u,label:ia,required:!0,isClearable:!0,isDisabled:!p,options:I,isLoading:X,rules:ie,errors:j}),e.jsx(U,{name:"retiredLastPosition",label:la,control:u,required:!1,editable:p,rules:fe,type:"text"}),e.jsx(oe,{name:"employmentTypeID",control:u,label:ca,required:!0,isClearable:!0,isDisabled:!p,options:Y,isLoading:n,rules:ie,errors:j}),e.jsx(ss,{name:"retirementDate",label:pa,control:u,disabled:!p,required:!1,errors:j,rules:ie,setValue:v}),e.jsx(oe,{name:"pensionaryStatusID",control:u,label:Qs,required:!0,isClearable:!0,isDisabled:!p,options:m,isLoading:G,rules:ie,errors:j}),e.jsx(ss,{name:"pensionaryStartdate",label:ua,control:u,disabled:!p,required:!0,errors:j,rules:ie,setValue:v}),e.jsx(U,{name:"retiredJobDegreeCoef",label:da,control:u,required:!1,editable:p,rules:ne,type:"text"}),e.jsx(U,{name:"retiredGrantDuration",label:ma,control:u,required:!1,editable:p,rules:ne,type:"text"}),e.jsx(U,{name:"retiredRealDuration",label:ha,control:u,required:!1,editable:p,rules:ne,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(he,{dir:"ltr",endIcon:e.jsx(Ts,{}),disabled:!p,variant:"contained",type:"submit",loading:M,color:"success",children:e.jsx("span",{children:Ls})}),e.jsx(he,{dir:"ltr",endIcon:e.jsx(Re,{}),onClick:D,disabled:p,variant:"contained",color:"primary",children:e.jsx("span",{children:ve})})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(Qa,{data:t,isLoading:x,isFetching:B})]})})})},Nt=()=>{const[t,d]=ps(!1),[p,D]=a.useState([]),[T]=ke(),N=T.get("personID"),F=a.useMemo(()=>["bankID","bankBranchID"],[]),o=a.useMemo(()=>[],[]),{control:C,handleSubmit:u,formState:{errors:k},setValue:j,watch:v}=Oe(),f=v("bankID"),{lookUpItems:_,lookUpItemsIsLoading:q}=$({lookUpType:"Bank"}),w=a.useMemo(()=>re(_,"lookUpID","lookUpName"),[_]),[z,{isLoading:r,isFetching:S}]=Rs(),x=a.useMemo(()=>re(p,"lookUpID","lookUpName"),[p]),{data:B,isSuccess:s,isLoading:i,isFetching:M,refetch:O}=xa(N),[X,{isLoading:ee}]=ga(),n=a.useCallback(async I=>{const Y=await z({lookUpType:"BankBranch",lookUpParentID:I}).unwrap();D(Y.itemList)},[z]),se=async I=>{const Y=As(I,F,o),m=await X({...Y,accountNo:je(I.accountNo)||null,ledgerCode:parseInt(je(I.ledgerCode))||null,insuranceAmount:parseFloat(je(I.insuranceAmount))||null,insuranceCoef:parseFloat(je(I.insuranceCoef))||null,personID:N}).unwrap();O(),d(),us.success(m.message)};return a.useEffect(()=>{f?n(f.value):(j("bankBranchID",null),D([]))},[f,n,j]),a.useEffect(()=>{s&&({...B},Object.keys(B).forEach(I=>{gt.includes(I)&&B[I]===null?j(I,""):j(I,B[I])}))},[s,B,j]),a.useEffect(()=>{s&&w.length>0&&j("bankID",w.find(I=>I.value===B.bankID))},[s,B,j,w]),a.useEffect(()=>{s&&x.length>0&&j("bankBranchID",x.find(I=>I.value===B.bankBranchID))},[s,B,j,x]),e.jsx(e.Fragment,{children:i||M?e.jsx(pe,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ce,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:u(se),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(oe,{name:"bankID",control:C,label:ja,required:!1,isClearable:!0,isDisabled:!t,options:w,isLoading:q,errors:k}),e.jsx(oe,{name:"bankBranchID",control:C,label:Ia,required:!1,isClearable:!0,isDisabled:!t,options:x,isLoading:r||S,errors:k}),e.jsx(U,{name:"accountNo",label:Na,rules:ne,required:!1,control:C,editable:t,type:"text"}),e.jsx(U,{name:"ledgerCode",label:ba,rules:ne,required:!1,control:C,editable:t,type:"text"}),e.jsx(U,{name:"insuranceCoef",label:fa,rules:ne,required:!1,control:C,editable:t,type:"text"}),e.jsx(U,{name:"insuranceAmount",label:Da,rules:ne,required:!1,control:C,editable:t,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(he,{dir:"ltr",endIcon:e.jsx(Ts,{}),disabled:!t,variant:"contained",type:"submit",loading:ee,color:"success",children:e.jsx("span",{children:Ls})}),e.jsx(he,{dir:"ltr",endIcon:e.jsx(Re,{}),onClick:d,disabled:t,variant:"contained",color:"primary",children:e.jsx("span",{children:ve})})]})]})})})},bt="/retirement/",an=bt+"retired/related",ft=(t,d)=>[{accessorKey:"relatedRowNo",header:ya,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"personNationalCode",header:Ys,size:20},{accessorKey:"personFirstName",header:Gs,size:20},{accessorKey:"personLastName",header:Ks,size:20},{accessorKey:"pensionaryIsUnderGauranteeText",header:Qs,size:20},{accessorKey:"personBirthDate",header:Ws,size:20,Cell:({renderedCellValue:p})=>e.jsx("div",{children:Ca(p)})},{accessorKey:"relationshipWithParentName",header:Sa,size:20},{accessorKey:"updateRelated",header:ve,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:p})=>e.jsx(ae,{title:`${ve} "${p.original.personFirstName} ${p.original.personLastName}"`,children:e.jsx(Os,{to:`${an}?mode=update&id=${t}&personID=${p.original.id}`,children:e.jsx(H,{color:"success",sx:{padding:"0"},children:e.jsx(Re,{})})})})},{accessorKey:"deleteRelated",header:qs,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:p})=>e.jsx(ae,{title:`${qs} "${p.original.personFirstName} ${p.original.personLastName}"`,children:e.jsx(H,{color:"error",onClick:()=>d(p.original.pensionaryID),sx:{padding:"0"},children:e.jsx(en,{})})})}],Dt=(t,d,p,D)=>e.jsxs(pe,{children:[d||t?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:Ba,children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh",color:"info",onClick:p,children:e.jsx(Le,{fontSize:"small"})})})}),d||t?e.jsx(H,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ce,{size:20,value:100})}):e.jsx(ae,{title:va,children:e.jsx(Os,{to:`${an}?mode=create&id=${D}`,children:e.jsx(H,{"aria-label":"refresh",color:"success",children:e.jsx(sn,{fontSize:"small"})})})})]}),yt=()=>{const[t,d]=a.useState([]),[p,D]=ps(!1),[T,N]=a.useState(""),[F]=ke(),o=F.get("personID"),{data:C,isSuccess:u,isLoading:k,isFetching:j,refetch:v}=Ja(o),[f,{isLoading:_}]=Za();a.useEffect(()=>{if(u){const x=C.itemList.map((B,s)=>({id:B.personID,relatedRowNo:s+1,pensionaryID:B.pensionaryID,personBirthDate:B.personBirthDate,personNationalCode:B.personNationalCode,personFirstName:B.personFirstName,personLastName:B.personLastName,pensionaryIsUnderGauranteeText:B.pensionaryIsUnderGauranteeText,relationshipWithParentName:B.relationshipWithParentName}));d(x)}},[u,C]);const q=async()=>{const x=await f({pensionaryID:T}).unwrap();D(),v(),us.success(x.message)},z=ft(o,x=>{N(x),D()}),r=Dt(k,j,v,o);return e.jsxs(e.Fragment,{children:[e.jsx(ka,{open:p,onClose:D,isLoading:_,handleRemove:q}),e.jsx(Pa,{data:t,columns:z,scroll:!1,topBarActions:r,isLoading:k,isFetching:j})]})},nr=()=>{const[t,d]=a.useState("1"),{personDeathDate:p}=Vs(N=>N.person),D=(N,F)=>{d(F)};return e.jsxs("section",{className:"flex-col mb-20",children:[e.jsx($a,{title:Oa,back:!0}),e.jsxs("div",{"data-name":"retired-forms",children:[e.jsxs(Ve,{children:[e.jsx(Qe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(Je,{}),children:La}),e.jsx(Ze,{children:e.jsx(jt,{})})]}),e.jsxs(Ve,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(Qe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(Je,{}),children:Ra}),e.jsx(Ze,{children:e.jsx(It,{})})]}),e.jsxs(Ve,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(Qe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(Je,{}),children:Fa}),e.jsx(Ze,{children:e.jsx(Nt,{})})]}),e.jsxs(Ve,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(Qe,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(Je,{}),children:_a}),e.jsx(Ze,{children:e.jsx(st,{})})]})]}),e.jsx("div",{"data-name":"retired-grids",children:e.jsxs(Xa,{value:t,children:[e.jsx(pe,{sx:{bgcolor:"background.paper",borderRadius:1},children:e.jsxs(et,{onChange:D,"aria-label":"tabs",variant:"fullWidth",children:[e.jsx(We,{label:p?Aa:Ta,value:"1"}),e.jsx(We,{label:Ma,value:"2"}),e.jsx(We,{label:Ua,value:"3"}),e.jsx(We,{label:Ea,value:"4"})]})}),e.jsx(Xe,{value:"1",sx:{padding:"0"},children:p?e.jsx(ut,{}):e.jsx(yt,{})}),e.jsx(Xe,{value:"2",sx:{padding:"0"},children:e.jsx(Ga,{})}),e.jsx(Xe,{value:"3",sx:{padding:"0"},children:e.jsx(mt,{})}),e.jsx(Xe,{value:"4",sx:{padding:"0"},children:e.jsx(dt,{})})]})})]})};export{nr as default};
