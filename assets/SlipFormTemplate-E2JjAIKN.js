import{ag as f,bv as c,r as d,j as e,an as M,B as T,k as q,a as r,ar as m,bw as A,X as L,bx as F,by as k}from"./index-BmsaxOuK.js";const w=f.injectEndpoints({endpoints:i=>({existPaySlip:i.query({query:({payType:t,currentYear:s,currentMonth:n})=>({url:`${c}/ExistPaySlip?payType=${t}&currentYear=${s}&currentMonth=${n}`})}),getPayList:i.query({query:({personID:t,currentYear:s,currentMonth:n,payType:h})=>{let l=`${c}/GetPayList?payType=${h}`;return t&&(l+=`&personID=${t}`),s&&(l+=`&currentYear=${s}`),n&&(l+=`&currentMonth=${n}`),{url:l}}}),getPay:i.query({query:({payID:t})=>({url:`${c}/GetPay?payID=${t}`})}),issuePay:i.mutation({query:({currentYear:t,currentMonth:s,requestID:n,payDate:h})=>({url:`${c}/IssuePayForMunicipality?currentYear=${t}&currentMonth=${s}&requestID=${n}&payDate=${h}`,method:"POST"})}),insertPay:i.mutation({query:({payDate:t,currentYear:s,currentMonth:n,requestID:h,personID:l})=>({url:`${c}/InsertSinglePayForMunicipality?payDate=${t}&currentYear=${s}&currentMonth=${n}&requestID=${h}&personID=${l}`,method:"POST"})}),removePayItem:i.mutation({query:({payItemID:t})=>({url:`${c}/RemovePayItem?payItemID=${t}`,method:"POST"})}),insertPayItem:i.mutation({query:t=>({url:`${c}/InsertPayItem`,method:"POST",body:t})}),insertPayExcel:i.mutation({query:({data:t,type:s})=>{let n;switch(s){case"C":n=`${c}/GetFinancialItemListFromExcel`;break;case"E":n=`${c}/GetFicheListFromExcel`;break;default:throw new Error(`Unsupported type: ${s}`)}return{url:n,method:"POST",body:t}}})})}),{useLazyExistPaySlipQuery:Y,useLazyGetPayListQuery:O,useGetPayListQuery:C,useGetPayQuery:B,useIssuePayMutation:Q,useInsertPayMutation:z,useRemovePayItemMutation:U,useInsertPayItemMutation:W,useInsertPayExcelMutation:X}=w;function H({payID:i}){const t=d.useRef(),[s,n]=d.useState(null),[h,l]=d.useState([]),[v,j]=d.useState([]),[$,I]=d.useState(0),[P,S]=d.useState(0),{data:u,isLoading:b,isFetching:N,isSuccess:g,error:p}=B({payID:i});return d.useEffect(()=>{if(g&&n(u),u!=null&&u.payItemList){const a=u.payItemList.filter(x=>x.payItemAmount<0),o=u.payItemList.filter(x=>x.payItemAmount>=0),_=a.reduce((x,y)=>x+y.payItemAmount,0),E=o.reduce((x,y)=>x+y.payItemAmount,0);l(a),j(o),I(_),S(E)}return()=>{n(null),l([]),j([]),I(0),S(0)}},[g,u,i,$,P]),d.useEffect(()=>{p&&console.log(p)},[p]),e.jsx(e.Fragment,{children:b||N||s===null?e.jsx(M,{title:"در حال بارگذاری...",children:e.jsx(T,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(q,{color:"primary"})})}):e.jsxs("div",{className:"slip-container",children:[e.jsxs("div",{className:"slip-container",ref:t,children:[e.jsxs("div",{className:"slip-container__logo",children:[e.jsx("img",{src:"./images/logo-slip.png",className:"slip-container__logo--img"}),e.jsx("p",{className:"slip-container__logo--sub",children:"سازمان بازنشستگی شهرداری تهران"})]}),e.jsxs("div",{className:"slip-container__header",children:[e.jsx("h5",{children:"بسمه تعالی"}),e.jsx("h5",{children:"فیش حقوقی"})]}),e.jsx("table",{className:"slip-container__info-table form-table",children:e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:`نام : ${s==null?void 0:s.personFirstName}`}),e.jsx("th",{colSpan:2,children:`نام خانوادگی : ${s==null?void 0:s.personLastName}`}),e.jsx("th",{children:`دوره : ${r(s==null?void 0:s.currentYear)}/${r(s==null?void 0:s.currentMonth)}`})]}),e.jsxs("tr",{children:[e.jsx("th",{children:`نوع استخدام : ${s==null?void 0:s.personEmploymentTypeName}`}),e.jsx("th",{children:`بانک : ${s==null?void 0:s.personBankName}`}),e.jsx("th",{children:`شعبه : ${s==null?void 0:s.personBankBranchName}`}),e.jsx("th",{children:`شماره حساب : ${r(s==null?void 0:s.personAccount)}`})]})]})}),e.jsxs("div",{className:"slip-container__items-table-container",children:[e.jsxs("table",{className:"form-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{width:"100",children:"ردیف"}),e.jsx("th",{children:"حقوق مزایا"}),e.jsx("th",{children:"مبلغ به ریال"})]})}),e.jsx("tbody",{className:"form-table__body",dir:"ltr",children:v.map((a,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:r(o+1)}),e.jsx("td",{children:a.payItemTypeName}),e.jsx("td",{children:r(m(a.payItemAmount))})]},o))})]}),e.jsxs("table",{className:"form-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{width:"100",children:"ردیف"}),e.jsx("th",{children:"کسور"}),e.jsx("th",{children:"مبلغ به ریال"}),e.jsx("th",{children:"مانده"}),e.jsx("th",{children:"اصل وام"})]})}),e.jsx("tbody",{className:"form-table__body",dir:"ltr",children:h.map((a,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:r(o+1)}),e.jsx("td",{children:a.payItemTypeName}),e.jsx("td",{children:r(m(Math.abs(a.payItemAmount)))}),e.jsx("td",{children:r(a.remainedAmount)||"-"}),e.jsx("td",{children:r(a.financialItemAmount)||"-"})]},o))})]})]}),e.jsx("div",{className:"slip-container__total-table-container",children:e.jsx("table",{className:"total-table form-table",children:e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"جمع حقوق و مزایا :"}),e.jsx("th",{children:e.jsx("span",{dir:"rtl",children:`${r(m(P))} ریال`})}),e.jsx("th",{children:"جمع کسور :"}),e.jsx("th",{dir:"ltr",children:e.jsx("span",{dir:"rtl",children:`${r(m(Math.abs($)))} ریال`})})]}),e.jsxs("tr",{children:[e.jsx("th",{colSpan:2,children:"مبلغ قابل پرداخت :"}),e.jsx("th",{colSpan:2,children:e.jsx("span",{dir:"rtl",children:`${r(m(s==null?void 0:s.payAmount))} ریال`})})]})]})})}),e.jsxs("div",{className:"slip-container__footer",children:[e.jsx("h5",{children:"مبلغ قابل پرداخت به حروف : "}),e.jsx("p",{style:{fontSize:"12px"},children:`${A(s==null?void 0:s.payAmount)} ریال`})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(L,{dir:"ltr",endIcon:e.jsx(F,{}),onClick:()=>k(t,{filename:"فیش حقوقی.pdf"}),variant:"contained",color:"primary",sx:{fontFamily:"IranYekan"},children:e.jsx("span",{children:"دانلود فیش"})})})]})})}export{H as S,X as a,Y as b,O as c,Q as d,z as e,W as f,B as g,U as h,C as u};
