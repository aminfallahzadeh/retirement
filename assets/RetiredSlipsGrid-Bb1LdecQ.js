import{r as a,bN as M,y as I,j as s,bo as t,bQ as c,bO as z,T as x,I as d,h as A,b8 as K,bb as L,B as k,C as B,bn as E,bp as F,bq as N,br as O,bs as Y}from"./index-DF4pKFh6.js";import{h as G,S as Q}from"./SlipFormTemplate-BulmCwMz.js";import{S as q}from"./index-DIPzbFa-.js";/* empty css                 */import{d as U}from"./table-options-DAFCvKg_.js";import{M as H}from"./Modal-emwLopZE.js";import{R as J}from"./Refresh-DKFM6g1E.js";import"./logo-slip-B2cUiv2a.js";import"./excel-icon-Dq0N6FeV.js";import"./module-CFZLQ92h.js";import"./typeof-QjJsDpFa.js";function ne(){const[i,p]=a.useState({}),[b,j]=a.useState([]),[n,u]=a.useState(null),[S,h]=a.useState(!1),C=M(),g=new URLSearchParams(C.search).get("personID"),{data:m,isLoading:R,isSuccess:f,isFetching:P,error:r,refetch:y}=G({personID:g,payType:"M"}),v=()=>{y()};a.useEffect(()=>{if(f){const e=m.itemList.map((o,D)=>({id:o.payID,payRowNum:D+1,payCreditAmount:o.payCreditAmount,payDebitAmount:o.payDebitAmount,payAmount:o.payAmount,payDate:o.payDate,currentYear:o.currentYear,currentMonth:o.currentMonth}));j(e)}},[f,y,m]),a.useEffect(()=>{var e;r&&I.error(((e=r==null?void 0:r.data)==null?void 0:e.message)||r.error,{autoClose:2e3})},[r]);const T=()=>{h(!0)},w=a.useMemo(()=>[{accessorKey:"payRowNum",header:"ردیف",size:20,Cell:({renderedCellValue:e})=>s.jsx("div",{children:t(e)})},{accessorKey:"payCreditAmount",header:"مبلغ بستانکاری",size:20,Cell:({renderedCellValue:e})=>s.jsxs("div",{children:[c(t(e))," ","ریال"]})},{accessorKey:"payDebitAmount",header:"مبلغ بدهکاری",size:20,Cell:({renderedCellValue:e})=>s.jsxs("div",{children:[c(t(e))," ","ریال"]})},{accessorKey:"payAmount",header:"مبلغ کل",size:20,Cell:({renderedCellValue:e})=>s.jsxs("div",{children:[c(t(e))," ","ریال"]})},{accessorKey:"payDate",header:"تاریخ پرداخت",size:20,Cell:({renderedCellValue:e})=>s.jsx("div",{children:z(e)})},{accessorKey:"currentYear",header:"سال مالی",size:20,Cell:({renderedCellValue:e})=>s.jsx("div",{children:t(e)})},{accessorKey:"currentMonth",header:"ماه مالی",size:20,Cell:({renderedCellValue:e})=>s.jsx("div",{children:t(e)})},{accessorKey:"downloadRetiredSlip",header:"مشاهده/چاپ",enableSorting:!1,enableColumnActions:!1,size:20,Cell:()=>s.jsx(x,{title:"دانلود و مشاهده فیش",children:s.jsx(d,{color:"primary",sx:{padding:"0"},onClick:T,children:s.jsx(A,{})})})}],[]),l=K({...U,columns:w,data:b,renderTopToolbarCustomActions:()=>s.jsx(k,{children:P?s.jsx(d,{"aria-label":"refresh",color:"info",disabled:!0,children:s.jsx(B,{size:20,value:100})}):s.jsx(x,{title:"بروز رسانی",children:s.jsx("span",{children:s.jsx(d,{"aria-label":"refresh",color:"info",onClick:v,children:s.jsx(J,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:e=>s.jsx(E,{...e,page:t(e.page),slots:{previous:F,next:N,first:O,last:Y}})},muiTableBodyRowProps:({row:e})=>({onClick:()=>p(()=>({[e.id]:!0})),selected:i[e.id],sx:{cursor:"pointer"}}),getRowId:e=>e.id,onRowSelectionChange:p,state:{rowSelection:i}});return a.useEffect(()=>{const e=Object.keys(l.getState().rowSelection)[0];u(e||null)},[l,i]),s.jsxs(s.Fragment,{children:[S&&n&&s.jsx(H,{closeModal:()=>h(!1),children:s.jsx(Q,{payID:n})},n),R?s.jsx("div",{className:"skeleton-lg",children:s.jsx(q,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):s.jsx(L,{table:l})]})}export{ne as default};
