import{r as n,z as le,m as Ie,h as xe,j as e,ee as he,M as m,J as a,K as ye,W as d,N as De,P as be,Q as fe,S as Se,U as r,V as ke,Y as je,Z as ge,ao as Ne,a7 as Ce,a8 as Ue,aj as Le,ak as Be,ag as qe,ah as Ee,ai as Ae,al as Te,am as Oe,ek as Pe,aq as Re,ar as _e,es as Fe,et as He,aF as Me,eu as ts,ev as ns,aM as ve,aN as we,aO as Ke,ew as Ge,aQ as Ve,ex as We,t as Qe,as as ze,au as Ye,aw as os,B as rs,C as is,dI as ls,ey as ps,ez as us,ep as cs,eA as ms,eB as ds}from"./index-Celh3WKK.js";import{T as Is}from"./Title-rRmkHYNa.js";import{D as Je}from"./DoneOutlined-Cqufw11X.js";import{i as Ze,u as I,b as Xe}from"./useFetchLookUpData-BHo34bB1.js";import{u as $e}from"./sharedApi-BEUsMYnm.js";import{D as f,a as es,p as xs}from"./convertFormData-D0Jx3Fpj.js";import{T as Y}from"./TextArea-BbsNBbbo.js";import{c as i,S as l}from"./SelectInput-Dxr5j-Nb.js";import{u as hs,a as ys,b as Ds}from"./heirApi-DSkJH6Ff.js";import{S as bs}from"./StatusHistoryGrid-CmBxgJX8.js";import"./requestApi-DHvqSv-E.js";import"./personnelApi-HVZrioSW.js";import"./fractionApi-Cdv0Qe0s.js";import"./useCloseCalender-D2ftvR4e.js";import"./react-select-animated.esm-7mhEMB7w.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";const fs=()=>{const[S,y]=n.useState([]),[E]=le(),A=Ie(),T=E.get("id"),J=["personBirthDate","pensionaryStartDate","personBaseFinishDate"],Z=["relationshipWithParentID","maritalStatusID","personCountryID","personStateID","personCityID","pensionaryStatusID","bankID","bankBranchID"],{control:t,handleSubmit:s,formState:{errors:g},setValue:x,watch:o}=xe(),N=o("bankID"),[C,{isLoading:D}]=hs(),[h,{isLoading:X,isFetching:$}]=$e(),{relationships:O,relationshipIsLoading:P}=Ze(),R=n.useMemo(()=>i(O,"relationshipID","relationshipName"),[O]),{lookUpItems:_,lookUpItemsIsLoading:ee}=I({lookUpType:"MaritialStatus"}),se=n.useMemo(()=>i(_,"lookUpID","lookUpName"),[_]),{lookUpItems:U,lookUpItemsIsLoading:ae}=I({lookUpType:"Country"}),te=n.useMemo(()=>i(U,"lookUpID","lookUpName"),[U]),{lookUpItems:F,lookUpItemsIsLoading:ne}=I({lookUpType:"State"}),H=n.useMemo(()=>i(F,"lookUpID","lookUpName"),[F]),{lookUpItems:M,lookUpItemsIsLoading:L}=I({lookUpType:"City"}),v=n.useMemo(()=>i(M,"lookUpID","lookUpName"),[M]),{pensionaryStatus:w,pensionaryStatusIsLoading:B}=Xe({pensionaryStatusCategory:"H",pensionaryStatusIsDead:null}),K=n.useMemo(()=>i(w,"pensionaryStatusID","pensionaryStatusName"),[w]),{lookUpItems:G,lookUpItemsIsLoading:q}=I({lookUpType:"Bank"}),V=n.useMemo(()=>i(G,"lookUpID","lookUpName"),[G]),oe=n.useMemo(()=>i(S,"lookUpID","lookUpName"),[S]),k=n.useCallback(async b=>{const j=await h({lookUpType:"BankBranch",lookUpParentID:b}).unwrap();y(j.itemList)},[h]);n.useEffect(()=>{N?k(N.value):(x("bankBranchID",null),y([]))},[N,k,x]);const W=async b=>{const j=es(b,Z,J),re=await C({...j,parentPersonID:T}).unwrap();Ye.success(re.message),A(-1)};return e.jsx("section",{className:"flex-col mb-20",children:e.jsxs("form",{method:"POST",className:"flex-col formContainer",onSubmit:s(W),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(l,{name:"relationshipWithParentID",control:t,label:he,required:!0,isClearable:!0,options:R,isLoading:P,rules:m,errors:g}),e.jsx(a,{name:"personFirstName",label:ye,rules:{...m,...d},required:!0,control:t,type:"text"}),e.jsx(a,{name:"personLastName",label:De,rules:{...m,...d},required:!0,control:t,type:"text"}),e.jsx(a,{name:"personNationalCode",label:be,rules:{...m,...fe},required:!0,control:t,type:"text"}),e.jsx(a,{name:"personCertificateNo",label:Se,rules:{...m,...r},required:!0,control:t,type:"text"}),e.jsx(a,{name:"personFatherName",label:ke,rules:d,required:!1,control:t,type:"text"}),e.jsx(f,{name:"personBirthDate",label:je,control:t,required:!1,setValue:x}),e.jsx(a,{name:"personBirthPlace",label:ge,rules:d,required:!1,control:t,type:"text"}),e.jsx(l,{name:"maritalStatusID",control:t,label:Ne,required:!1,isClearable:!0,options:se,isLoading:ee}),e.jsx(a,{name:"personPhone",label:Ce,rules:r,required:!1,control:t,type:"text"}),e.jsx(a,{name:"personCellPhone",label:Ue,rules:r,required:!1,control:t,type:"text"}),e.jsx(a,{name:"personRegion",label:Le,rules:r,required:!1,control:t,type:"text"}),e.jsx(a,{name:"personArea",label:Be,rules:r,required:!1,control:t,type:"text"}),e.jsx(l,{name:"personCountryID",control:t,label:qe,required:!1,isClearable:!0,options:te,isLoading:ae}),e.jsx(l,{name:"personStateID",control:t,label:Ee,required:!1,isClearable:!0,options:H,isLoading:ne}),e.jsx(l,{name:"personCityID",control:t,label:Ae,required:!1,isClearable:!0,options:v,isLoading:L}),e.jsx(a,{name:"personPostalCode",label:Te,rules:Oe,required:!1,control:t,type:"text"}),e.jsx(a,{name:"personSpecialDisease",label:Pe,rules:d,required:!1,control:t,type:"text"}),e.jsx(Y,{name:"personAddress",label:Re,control:t,containerClassNames:"col-span-4"}),e.jsx(Y,{name:"personDescription",label:_e,control:t,containerClassNames:"col-span-4 row-span-2"})]}),e.jsx("div",{className:"Modal__header flex justify-center items-center",children:e.jsx("h4",{className:"title-secondary",children:Fe})}),e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(l,{name:"pensionaryStatusID",control:t,label:He,required:!1,isClearable:!0,options:K,isLoading:B}),e.jsx(f,{name:"pensionaryStartDate",label:Me,control:t,required:!1,setValue:x}),e.jsx(f,{name:"personBaseFinishDate",label:ts,control:t,required:!1,setValue:x})]}),e.jsx("div",{className:"Modal__header flex justify-center items-center",children:e.jsx("h4",{className:"title-secondary",children:ns})}),e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(l,{name:"bankID",control:t,label:ve,required:!1,isClearable:!0,options:V,isLoading:q,errors:g}),e.jsx(l,{name:"bankBranchID",control:t,label:we,required:!1,isClearable:!0,options:oe,isLoading:X||$,errors:g}),e.jsx(a,{name:"accountNo",label:Ke,rules:r,required:!1,control:t,type:"text"}),e.jsx(a,{name:"ledgerCode",label:Ge,rules:r,required:!1,control:t,type:"text"}),e.jsx(a,{name:"insuranceCoef",label:Ve,rules:r,required:!1,control:t,type:"text"}),e.jsx(a,{name:"insuranceAmount",label:We,required:!1,control:t,type:"text"})]}),e.jsx("div",{className:"flex-row mr-auto",children:e.jsx(Qe,{dir:"ltr",endIcon:e.jsx(Je,{}),variant:"contained",type:"submit",loading:D,color:"success",children:e.jsx("span",{children:ze})})})]})})},Ss=["relationshipWithParentID","personFirstName","personLastName","personNationalCode","personCertificateNo","personFatherName","personBirthDate","personBirthPlace","maritalStatusID","personPhone","personCellPhone","personRegion","personArea","personCountryID","personStateID","personCityID","personPostalCode","personSpecialDisease","personAddress","personDescription","pensionaryStatusID","pensionaryStartDate","personBaseFinishDate","heirID","pensionaryStartDate","bankID","bankBranchID","accountNo","ledgerCode","insuranceCoef","insuranceAmount"],me=["personBirthDate","pensionaryStartDate","personBaseFinishDate"],de=["relationshipWithParentID","maritalStatusID","personRegion","personCountryID","personStateID","personCityID","pensionaryStatusID","bankID","bankBranchID"],ks=()=>{const[S,y]=n.useState([]),[E,A]=n.useState([]),[T]=le(),J=Ie(),Z=T.get("id"),t=T.get("personID"),{control:s,handleSubmit:g,formState:{errors:x},setValue:o,watch:N}=xe(),C=N("bankID"),{data:D,isSuccess:h,isLoading:X,isFetching:$,refetch:O}=ys(t),{data:P,isSuccess:R,isLoading:_,isFetching:ee,refetch:se}=os(t),[U,{isLoading:ae,isFetching:te}]=$e(),[F,{isLoading:ne}]=Ds(),{relationships:H,relationshipIsLoading:M}=Ze(),L=n.useMemo(()=>i(H,"relationshipID","relationshipName"),[H]),{lookUpItems:v,lookUpItemsIsLoading:w}=I({lookUpType:"MaritialStatus"}),B=n.useMemo(()=>i(v,"lookUpID","lookUpName"),[v]),{lookUpItems:K,lookUpItemsIsLoading:G}=I({lookUpType:"Country"}),q=n.useMemo(()=>i(K,"lookUpID","lookUpName"),[K]),{lookUpItems:V,lookUpItemsIsLoading:oe}=I({lookUpType:"State"}),k=n.useMemo(()=>i(V,"lookUpID","lookUpName"),[V]),{lookUpItems:W,lookUpItemsIsLoading:pe}=I({lookUpType:"City"}),b=n.useMemo(()=>i(W,"lookUpID","lookUpName"),[W]),{pensionaryStatus:j,pensionaryStatusIsLoading:re}=Xe({pensionaryStatusCategory:"H",pensionaryStatusIsDead:null}),ie=n.useMemo(()=>i(j,"pensionaryStatusID","pensionaryStatusName"),[j]),{lookUpItems:ue,lookUpItemsIsLoading:ss}=I({lookUpType:"Bank"}),Q=n.useMemo(()=>i(ue,"lookUpID","lookUpName"),[ue]),z=n.useMemo(()=>i(E,"lookUpID","lookUpName"),[E]),ce=n.useCallback(async p=>{const u=await U({lookUpType:"BankBranch",lookUpParentID:p}).unwrap();A(u.itemList)},[U]);n.useEffect(()=>{C?ce(C.value):(o("bankBranchID",null),A([]))},[C,ce,o]);const as=async p=>{const u=es(p,de,me),c=await F({...u,parentPersonID:Z}).unwrap();Ye.success(c.message),O(),se(),J(-1)};return n.useEffect(()=>{if(R){const p=P.itemList.map((u,c)=>({id:u.pensionaryID,pensionaryStatusRowNum:c+1,isActive:u.pensionaryIsActive,pensionaryStatusName:u.pensionaryStatusName||"-",pensionaryStartdate:u.pensionaryStartdate||"-"}));y(p)}},[R,P]),n.useEffect(()=>{if(h){const p={...D};delete p.bankID,delete p.bankBranchID;const u=xs(p,de,me,{relationshipWithParentID:L,pensionaryStatusID:ie,maritalStatusID:B,personCountryID:q,personStateID:k,personCityID:b});Object.keys(u).forEach(c=>{Ss.includes(c)&&u[c]===null?o(c,""):o(c,u[c])})}},[h,D,o,L,ie,B,q,k,b]),n.useEffect(()=>{h&&Q.length>0&&o("bankID",Q.find(p=>p.value===D.bankID))},[h,D,o,Q]),n.useEffect(()=>{h&&z.length>0&&o("bankBranchID",z.find(p=>p.value===D.bankBranchID))},[h,D,o,z]),e.jsx(e.Fragment,{children:X||$?e.jsx(rs,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(is,{color:"primary"})}):e.jsx("section",{className:"flex-col mb-20",children:e.jsxs("form",{method:"POST",className:"flex-col formContainer",onSubmit:g(as),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(l,{name:"relationshipWithParentID",control:s,label:he,required:!0,isClearable:!0,options:L,isLoading:M,rules:m,errors:x}),e.jsx(a,{name:"personFirstName",label:ye,rules:{...m,...d},required:!0,control:s,type:"text"}),e.jsx(a,{name:"personLastName",label:De,rules:{...m,...d},required:!0,control:s,type:"text"}),e.jsx(a,{name:"personNationalCode",label:be,rules:{...m,...fe},required:!0,control:s,type:"text"}),e.jsx(a,{name:"personCertificateNo",label:Se,rules:{...m,...r},required:!0,control:s,type:"text"}),e.jsx(a,{name:"personFatherName",label:ke,rules:d,required:!1,control:s,type:"text"}),e.jsx(f,{name:"personBirthDate",label:je,control:s,required:!1,setValue:o}),e.jsx(a,{name:"personBirthPlace",label:ge,rules:d,required:!1,control:s,type:"text"}),e.jsx(l,{name:"maritalStatusID",control:s,label:Ne,required:!1,isClearable:!0,options:B,isLoading:w}),e.jsx(a,{name:"personPhone",label:Ce,rules:r,required:!1,control:s,type:"text"}),e.jsx(a,{name:"personCellPhone",label:Ue,rules:r,required:!1,control:s,type:"text"}),e.jsx(a,{name:"personRegion",label:Le,rules:r,required:!1,control:s,type:"text"}),e.jsx(a,{name:"personArea",label:Be,rules:r,required:!1,control:s,type:"text"}),e.jsx(l,{name:"personCountryID",control:s,label:qe,required:!1,isClearable:!0,options:q,isLoading:G}),e.jsx(l,{name:"personStateID",control:s,label:Ee,required:!1,isClearable:!0,options:k,isLoading:oe}),e.jsx(l,{name:"personCityID",control:s,label:Ae,required:!1,isClearable:!0,options:b,isLoading:pe}),e.jsx(a,{name:"personPostalCode",label:Te,rules:Oe,required:!1,control:s,type:"text"}),e.jsx(a,{name:"personSpecialDisease",label:Pe,rules:d,required:!1,control:s,type:"text"}),e.jsx(Y,{name:"personAddress",label:Re,control:s,containerClassNames:"col-span-4"}),e.jsx(Y,{name:"personDescription",label:_e,control:s,containerClassNames:"col-span-4 row-span-2"})]}),e.jsx("div",{className:"Modal__header flex justify-center items-center",children:e.jsx("h4",{className:"title-secondary",children:Fe})}),e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(l,{name:"pensionaryStatusID",control:s,label:He,required:!1,isClearable:!0,options:ie,isLoading:re}),e.jsx(f,{name:"pensionaryStartDate",label:Me,control:s,required:!1,setValue:o}),e.jsx(f,{name:"personBaseFinishDate",label:ls,control:s,required:!1,setValue:o}),e.jsx(a,{name:"heirID",label:ps,required:!1,editable:!1,control:s,type:"text"}),e.jsx(f,{name:"pensionaryStartDate",label:us,control:s,disabled:!0,required:!1,setValue:o})]}),e.jsx("div",{className:"Modal__header flex justify-center items-center",children:e.jsx("h4",{className:"title-secondary",children:cs})}),e.jsx(bs,{data:S,isLoading:_,isFetching:ee}),e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(l,{name:"bankID",control:s,label:ve,required:!1,isClearable:!0,options:Q,isLoading:ss,errors:x}),e.jsx(l,{name:"bankBranchID",control:s,label:we,required:!1,isClearable:!0,options:z,isLoading:ae||te,errors:x}),e.jsx(a,{name:"accountNo",label:Ke,rules:r,required:!1,control:s,type:"text"}),e.jsx(a,{name:"ledgerCode",label:Ge,rules:r,required:!1,control:s,type:"text"}),e.jsx(a,{name:"insuranceCoef",label:Ve,rules:r,required:!1,control:s,type:"text"}),e.jsx(a,{name:"insuranceAmount",label:We,required:!1,control:s,type:"text"})]}),e.jsx("div",{className:"flex-row mr-auto",children:e.jsx(Qe,{dir:"ltr",endIcon:e.jsx(Je,{}),variant:"contained",type:"submit",loading:ne,color:"success",children:e.jsx("span",{children:ze})})})]})})})},vs=()=>{const[S]=le(),y=S.get("mode");return e.jsxs("section",{className:"flex-col",children:[e.jsx(Is,{title:y==="update"?ms:ds,back:!0}),y==="create"?e.jsx(fs,{}):y==="update"?e.jsx(ks,{}):null]})};export{vs as default};
