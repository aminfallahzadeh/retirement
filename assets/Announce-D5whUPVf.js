import{R as S,dG as g,dH as j,j as e,T as y,dI as A,f as v,dJ as w,I as L,A as T,r,au as b,dK as O,G as F,h as K,J as k,M as h,t as q,as as z,dL as G}from"./index-Celh3WKK.js";import{T as P}from"./Title-rRmkHYNa.js";import{D as M,a as B}from"./convertFormData-D0Jx3Fpj.js";import{T as V}from"./TextArea-BbsNBbbo.js";import{D as _}from"./DoneOutlined-Cqufw11X.js";import{u as J,a as U,b as H}from"./announceApi-Cy88l7PS.js";import{D as Q}from"./DeleteOutline-BzsYrv9z.js";import"./useCloseCalender-D2ftvR4e.js";const W=t=>[{accessorKey:"announceRowNo",header:S,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"announceTitle",header:g,size:20},{accessorKey:"announceDesc",header:j,size:20,Cell:({renderedCellValue:n,row:s})=>e.jsx(y,{title:e.jsx("p",{children:s.original.description}),children:e.jsx("p",{style:{width:"80ch",textOverflow:"ellipsis",overflow:"hidden"},children:n})}),muiTableBodyCellProps:{align:"right"}},{accessorKey:"announceRunDate",header:A,size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:v(n)})},{accessorKey:"deleteAnnounce",header:w,enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:n})=>e.jsx(L,{color:"error",onClick:()=>t(n.original.id),sx:{padding:"0"},children:e.jsx(Q,{})})}],X=({triggerRefetch:t})=>{const[n,s]=T(!1),[c,m]=r.useState(null),[x,f]=r.useState([]),{data:l,isLoading:p,isFetching:D,isSuccess:i,refetch:a}=J({}),[u,{isLoading:N}]=U(),C=o=>{m(o),s()},I=r.useCallback(async()=>{const o=await u({announceID:c,isDeleted:!0}).unwrap();s(),a(),b.success(o.message)},[u,c,a,s]),R=W(C);return r.useEffect(()=>{if(i){const o=l.itemList.map((d,E)=>({id:d.announceID,announceRowNo:E+1,announceTitle:d.title,announceDesc:d.description,announceRunDate:d.runDate}));f(o)}},[i,l]),r.useEffect(()=>{a()},[t,a]),e.jsxs(e.Fragment,{children:[e.jsx(O,{open:n,onClose:s,isLoading:N,handleRemove:I}),e.jsx(F,{data:x,columns:R,scroll:!1,isLoading:p,isFetching:D})]})},Y=()=>{const[t,n]=T(!1),{control:s,handleSubmit:c,formState:{errors:m},setValue:x}=K(),[f,{isLoading:l}]=H(),p=async i=>{const a=B(i,[],["runDate"]),u=await f({...a,runDate:a.runDate,isDelete:!1}).unwrap();n(),b.success(u.message)};return e.jsxs("section",{className:"flex-col",children:[e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:c(p),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx(k,{name:"title",label:g,rules:h,required:!0,control:s,type:"text"}),e.jsx(M,{name:"runDate",label:A,control:s,required:!0,errors:m,rules:h,setValue:x}),e.jsx("div",{}),e.jsx(V,{name:"description",label:j,required:!0,rules:h,control:s,containerClassNames:"col-span-3 row-span-2"})]}),e.jsx("div",{className:"flex-row mr-auto",children:e.jsx(q,{dir:"ltr",endIcon:e.jsx(_,{}),variant:"contained",type:"submit",loading:l,color:"success",children:e.jsx("span",{children:z})})})]}),e.jsx(X,{triggerRefetch:t})]})},ce=()=>e.jsxs("section",{className:"flex-col u-margin-bottom-xl",children:[e.jsx(P,{title:G,back:!0}),e.jsx(Y,{})]});export{ce as default};
