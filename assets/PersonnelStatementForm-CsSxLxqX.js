import{e as Y,r as x,b5 as Z,j as e,o as c,i as k,m as L,l as D,y as B,J as P,v as pe,b6 as w,b7 as se,b8 as de,b9 as xe,T as R,I as q,B as ne,C as te,af as le,D as he,p as ye,h as Ie,ba as ge}from"./index-W68cpnsO.js";import{u as oe,C as K}from"./index.esm-CWoQLPon.js";import{a as fe}from"./reportApi-D5s9u6kc.js";import{i as re,S as O}from"./react-select-animated.esm-naAhUG9w.js";import{f as ie}from"./useFetchLookUpData-CorzoPIw.js";import{o as ce,s as T,a as $}from"./reactSelect-BGq5yAQc.js";import{l as je,C as me,S as Ne}from"./index-DRM-yeOy.js";/* empty css                 */import{u as E,P as G,C as V,a as Q,L as H,F as J,M as W}from"./index.esm-Ck86Uiz9.js";import{d as U}from"./table-options-K8gSTB4P.js";import{M as z}from"./Modal-CfynDF2i.js";import{E as ue}from"./VisibilityOutlined-DSjVU1GN.js";import{b as be}from"./sharedApi-B-UaQTyz.js";import{D as ve}from"./DeleteOutline-DPb9FXgd.js";import{A as Ce}from"./Add-BvJZyp3n.js";import{u as _e}from"./personApi-CLidky5_.js";import{S as De}from"./SearchOutlined-BxeYRJ7L.js";const Ue=[{value:"1",label:"گروهی"},{value:"2",label:"انفرادی"}],Xe=[{value:"M",label:"شهرداری"},{value:"C",label:"کشوری"},{value:"E",label:"مزایا"}],Ze=[{value:"1403",label:"۱۴۰۳"},{value:"1402",label:"۱۴۰۲"},{value:"1401",label:"۱۴۰۱"},{value:"1400",label:"۱۴۰۰"},{value:"1399",label:"۱۳۹۹"},{value:"1398",label:"۱۳۹۸"},{value:"1397",label:"۱۳۹۷"},{value:"1396",label:"۱۳۹۶"},{value:"1395",label:"۱۳۹۵"},{value:"1394",label:"۱۳۹۴"},{value:"1393",label:"۱۳۹۳"},{value:"1392",label:"۱۳۹۲"},{value:"1391",label:"۱۳۰۱"},{value:"1390",label:"۱۳۹۰"}],ee=[{value:"1",label:"فروردین"},{value:"2",label:"اردیبهشت"},{value:"3",label:"خرداد"},{value:"4",label:"تیر"},{value:"5",label:"مرداد"},{value:"6",label:"شهریور"},{value:"7",label:"مهر"},{value:"8",label:"آبان"},{value:"9",label:"آذر"},{value:"10",label:"دی"},{value:"11",label:"بهمن"},{value:"12",label:"اسفند"}],ae=[{value:"1",label:"بازنشسته"},{value:"0",label:"وظیفه بگیر"},{value:"-1",label:"هر دو"}];function ea(){const u=re(),a=Y(),[o,{isLoading:n,isFetching:j}]=fe(),{handleSubmit:I,formState:{errors:r},control:t,watch:d,register:N}=oe(),s=d(),g=async()=>{var y;try{const m=await o({CurrentYear:L(s.currentYear),CurrentMonth:L(s.currentMonth),PayItemTypeID:s.payItemID,pensionaryIsRetired:s.pensionaryIsRetired}).unwrap();if(m.itemList.length===0){D.error("نتیجه ای یافت نشد",{autoClose:2e3});return}const M=m.itemList.map((b,A)=>({id:b.personnelID,compareRowNum:c(A+1),payNationalCode:c(b.personNationalCode)||"-",payPersonID:c(b.personnelID)||"-",payFirstName:b.personFirstName||"-",payLastName:b.personLastName||"-",payCurrentMonth:B(c(b.currentpayItemAmount))||"-",payLastMonth:B(c(b.prepayItemAmount))||"-",payDiff:B(c(b.diffpay))||"-",payStatus:b.pensionaryStatusName||"-"}));a(Z(M))}catch(m){console.log(m),D.error(((y=m==null?void 0:m.data)==null?void 0:y.message)||m.error,{autoClose:2e3})}},{payItemTypes:f,payItemTypesIsLoading:_,payItemTypesIsFetching:F}=ie(),p=ce(f,"payItemTypeID","payItemTypeName");return x.useEffect(()=>()=>{a(Z([]))},[a]),e.jsx("section",{className:"formContainer flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",noValidate:!0,onSubmit:I(g),children:[e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[r.currentYear&&e.jsx("span",{className:"error-form",children:r.currentYear.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"currentYear",value:c(s==null?void 0:s.currentYear)||"",id:"currentYear",required:!0,...N("currentYear",{required:"سال جاری اجباری است",minLength:{value:4,message:"ماه باید چهار رقمی باشد"},maxLength:{value:4,message:"ماه باید چهار رقمی باشد"},pattern:{value:/^[۰-۹0-9]+$/,message:"از اعداد استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"currentYear",children:[e.jsx("span",{children:"*"})," سال جاری"]})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"currentMonth",control:t,rules:{required:!0},render:({field:{onChange:y}})=>e.jsx(O,{closeMenuOnSelect:!0,components:u,options:ee,onChange:m=>y(m?m.value:null),value:ee.find(m=>m.value===(s==null?void 0:s.currentMonth)),isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," ماه جاری"]}),noOptionsMessage:T.noOptionsMessage,loadingMessage:T.loadingMessage,styles:$})}),e.jsxs("label",{className:s!=null&&s.currentMonth?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," ماه جاری"]}),r.currentMonth&&e.jsx("span",{className:"error-form",children:"ماه اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"payItemID",control:t,rules:{required:!0},render:({field:{onChange:y}})=>e.jsx(O,{closeMenuOnSelect:!0,components:u,options:p,onChange:m=>y(m?m.value:null),value:p.find(m=>m.value===(s==null?void 0:s.payItemID)),isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," آیتم حقوق"]}),noOptionsMessage:T.noOptionsMessage,loadingMessage:T.loadingMessage,styles:$,isLoading:_||F})}),e.jsxs("label",{className:s!=null&&s.payItemID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," آیتم حقوق"]}),r.payItemID&&e.jsx("span",{className:"error-form",children:" آیتم حقوق اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(K,{name:"pensionaryIsRetired",control:t,rules:{required:!0},render:({field:{onChange:y}})=>e.jsx(O,{closeMenuOnSelect:!0,components:u,options:ae,onChange:m=>y(m?m.value:null),value:ae.find(m=>m.value===(s==null?void 0:s.pensionaryIsRetired)),isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نوع بازنشسته"]}),noOptionsMessage:T.noOptionsMessage,loadingMessage:T.loadingMessage,styles:$})}),e.jsxs("label",{className:s!=null&&s.pensionaryIsRetired?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نوع بازنشسته"]}),r.pensionaryIsRetired&&e.jsx("span",{className:"error-form",children:" نوع بازنشسته اجباری است"})]})]}),e.jsx("div",{style:{marginRight:"auto"},className:"flex-row",children:e.jsx(k,{dir:"ltr",type:"submit",endIcon:e.jsx(je,{}),loading:n||j,onClick:I,variant:"contained",color:"success",sx:{fontFamily:"IranYekan"},children:e.jsx("span",{children:"جست و جو"})})})]})})}function aa(){const[u,a]=x.useState({}),{payCompareTableData:o}=P(r=>r.payCompareData),n=x.useMemo(()=>[{accessorKey:"compareRowNum",header:"ردیف",enableSorting:!1,enableColumnActions:!1,size:20},{accessorKey:"payNationalCode",header:"شماره ملی",size:20},{accessorKey:"payPersonID",header:"شماره کارمندی",size:20},{accessorKey:"payFirstName",header:"نام",size:20},{accessorKey:"payLastName",header:"نام خانوادگی",size:20},{accessorKey:"payCurrentMonth",header:"ماه جاری",size:20},{accessorKey:"payLastMonth",header:"ماه قیل",size:20},{accessorKey:"payDiff",header:"تفاوت",size:20},{accessorKey:"payStatus",header:"وضعیت",size:20}],[]),j=E({...U,columns:n,data:o,muiTableBodyRowProps:({row:r})=>({onClick:()=>a(()=>({[r.id]:!0})),selected:u[r.id],sx:{cursor:"pointer"}}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:r=>e.jsx(G,{...r,page:c(r.page),slots:{previous:V,next:Q,first:H,last:J}})},getRowId:r=>r.id,onRowSelectionChange:a,state:{rowSelection:u}});return e.jsx(W,{table:j})}const Fe=pe.injectEndpoints({endpoints:u=>({getFinancialItems:u.query({query:a=>({url:`${w}/GetFinancialItems?personID=${a}`})}),getFinancialItem:u.query({query:a=>({url:`${w}/GetFinancialItem?FinancialItemID=${a}`})}),insertFinancialItem:u.mutation({query:a=>({url:`${w}/InsertFinancialItem`,method:"POST",body:a})}),removeFinancialItem:u.mutation({query:a=>({url:`${w}/RemoveFinancialItem?ID=${a}`,method:"POST"})})})}),{useLazyGetFinancialItemsQuery:Se,useLazyGetFinancialItemQuery:sa,useGetFinancialItemQuery:Te,useInsertFinancialItemMutation:Be,useRemoveFinancialItemMutation:Me}=Fe;function X(){const u=Y(),[a,{isLoading:o,isFetching:n}]=Se();return{getFinancialItems:async I=>{try{const t=(await a(I).unwrap()).itemList.map((d,N)=>({id:d.financialItemID,personID:d.personID,financialItemRowNum:N+1,payItemTypeID:d.payItemTypeID||"-",payItemTypeName:d.payItemTypeName||"-",payItemAmount:d.financialItemAmount||"-"}));u(se(t)),u(de(I)),u(xe(!0))}catch(r){console.log(r)}},isLoading:o,isFetching:n}}function na(){const[u,a]=x.useState({}),{personTableData:o}=P(s=>s.personData),n=Y(),{getFinancialItems:j,isLoading:I,isFetching:r}=X();x.useEffect(()=>()=>{n(se([]))},[n]);const t=x.useMemo(()=>[{accessorKey:"personRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:s})=>e.jsx("span",{children:c(s)})},{accessorKey:"personFirstName",header:"نام",size:20},{accessorKey:"personLastName",header:"نام خانوادگی",size:20},{accessorKey:"personNationalCode",header:"کد ملی",size:20,Cell:({renderedCellValue:s})=>e.jsx("span",{children:c(s)})},{accessorKey:"personnelID",header:"شماره کارمندی",size:20,Cell:({renderedCellValue:s})=>e.jsx("span",{children:c(s)})},{accessorKey:"observeStaff",header:"مشاهده",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:s})=>e.jsx(R,{title:"مشاهده آیتمها",children:e.jsx(q,{color:"primary",sx:{padding:"0"},onClick:()=>j(s.original.id),children:e.jsx(ue,{})})})}],[j]),d=E({...U,columns:t,data:o,muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:s=>e.jsx(G,{...s,page:c(s.page),slots:{previous:V,next:Q,first:H,last:J}})},muiTableBodyRowProps:({row:s})=>({onClick:()=>a(()=>({[s.id]:!0})),selected:u[s.id],sx:{cursor:"pointer"}}),getRowId:s=>s.id,onRowSelectionChange:a,state:{rowSelection:u}});return e.jsxs(e.Fragment,{children:[I||r?e.jsxs(z,{title:"در حال بارگیری",children:[e.jsx("p",{className:"paragraph-primary",style:{textAlign:"center"},children:"لطفا منتظر بمانید..."}),e.jsx(ne,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(te,{color:"primary"})})]}):null,e.jsx(W,{table:d})]})}function Pe({id:u}){const{handleSubmit:a,formState:{errors:o},register:n,watch:j,setValue:I}=oe(),r=p=>{console.log(p)},t=j(),{data:d,isLoading:N,isFetching:s,isSuccess:g,error:f}=Te(u);x.useEffect(()=>{if(g){const p=d==null?void 0:d.itemList[0];Object.keys(p).forEach(v=>{I(v,p[v]),(p.instalementAmount||p.instalementAmount)&&I("isInstallment",!0)})}},[g,d==null?void 0:d.itemList,I]),x.useEffect(()=>{var p;f&&f.status!=="FETCH_ERROR"&&D.error(((p=f==null?void 0:f.data)==null?void 0:p.message)||f.error,{autoClose:2e3})},[f]);const _=p=>{let v=L(le(p.target.value));I(p.target.name,v)};return e.jsx(e.Fragment,{children:N||s?e.jsx(ne,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(te,{color:"primary"})}):e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsx("form",{method:"POST",className:"flex-col",onSubmit:a(r),noValidate:!0,children:e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[o.payItemTypeID&&e.jsx("span",{className:"error-form",children:o.payItemTypeID.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:c(t==null?void 0:t.payItemTypeID)||"",name:"payItemTypeID",id:"payItemTypeID",required:!0,disabled:!0,...n("payItemTypeID",{required:"شناسه آیتم اجباری است",pattern:{value:/^[۰-۹0-9]+$/,message:"شناسه فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"payItemTypeID",children:"شناسه آیتم"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.payItemTypeName&&e.jsx("span",{className:"error-form",children:o.payItemTypeName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.payItemTypeName)||"",name:"payItemTypeName",id:"payItemTypeName",required:!0,disabled:!0,...n("payItemTypeName",{required:"شرح آیتم اجباری است",pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف و اعداد فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"payItemTypeName",children:"شرح آیتم"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.financialItemAmount&&e.jsx("span",{className:"error-form",children:o.financialItemAmount.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",disabled:!0,value:B(c(t.financialItemAmount))||"",name:"financialItemAmount",id:"financialItemAmount",required:!0,...n("financialItemAmount",{onChange:_,required:"مبلغ اجباری است",pattern:{value:/^[۰-۹0-9]+$/,message:"مبلغ فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"financialItemAmount",children:"مبلغ کل"})]}),e.jsx("h4",{className:"title-quaternary",style:{justifySelf:"start",alignSelf:"center"},children:"تاریخ شروع محاسبه فیش :"}),e.jsxs("div",{className:"inputBox__form",children:[o.executeYear&&e.jsx("span",{className:"error-form",children:o.executeYear.message}),e.jsx("input",{type:"text",disabled:!0,className:"inputBox__form--input",value:c(t==null?void 0:t.executeYear)||"",name:"executeYear",id:"executeYear",required:!0,...n("executeYear",{required:"سال اجباری است",minLength:{value:4,message:"سال باید ۴ رقمی باشد"},maxLength:{value:4,message:"سال باید ۴ رقمی باشد"},pattern:{value:/^[۰-۹0-9]+$/,message:"سال شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"executeYear",children:"سال"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.executeYear&&e.jsx("span",{className:"error-form",children:o.executeYear.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:c(t==null?void 0:t.executeMonth)||"",name:"executeMonth",id:"executeMonth",required:!0,disabled:!0,...n("executeMonth",{required:"ماه اجباری است",minLength:{value:2,message:"ماه باید ۲ رقمی باشد"},maxLength:{value:2,message:"ماه باید ۲ رقمی باشد"},pattern:{value:/^[۰-۹0-9]+$/,message:"ماه شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"executeYear",children:"ماه"})]}),e.jsxs("div",{className:"checkboxContainer__item",style:{justifySelf:"start",alignSelf:"center"},children:[e.jsx(me,{size:"small",color:"success",checked:!!(t!=null&&t.isInstallment),name:"isInstallment",id:"isInstallment",disabled:!0,sx:{padding:.5},...n("isInstallment")}),e.jsx("label",{htmlFor:"isInstallment",className:"checkboxContainer__label",children:"قسطی"})]}),t.isInstallment&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"inputBox__form",children:[o.instalementCount&&e.jsx("span",{className:"error-form",children:o.instalementCount.message}),e.jsx("input",{type:"text",disabled:!0,className:"inputBox__form--input",value:c(t==null?void 0:t.instalementCount)||"",name:"instalementCount",id:"instalementCount",required:!0,...n("instalementCount",{required:"تعداد قسط اجباری است",pattern:{value:/^[۰-۹0-9]+$/,message:"تعداد قسط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"instalementCount",children:"تعداد قسط"})]}),e.jsxs("div",{className:"inputBox__form",children:[o.instalementAmount&&e.jsx("span",{className:"error-form",children:o.instalementAmount.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:c(t==null?void 0:t.instalementAmount)||"",name:"instalementAmount",id:"instalementAmount",required:!0,disabled:!0,...n("instalementAmount",{required:"مبلغ قسط اجباری است",pattern:{value:/^[۰-۹0-9]+$/,message:"مبلغ قسط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"instalementAmount",children:"مبلغ قسط"})]})]})]})})})})}function Le({setIsInsertItemModalOpen:u}){const[a,o]=x.useState({}),[n,j]=x.useState(""),I=re(),r=P(i=>i.financialData.payPersonID),{getFinancialItems:t}=X(),[d,{isLoading:N}]=Be();x.useEffect(()=>{console.log(a)},[a]);const{payItemTypes:s,payItemTypesIsLoading:g,payItemTypesIsFetching:f}=ie(),_=ce(s,"payItemTypeID","payItemTypeName"),F=async()=>{var i;try{const{isInstallment:h,...C}=a,l=await d({...C,financialItemID:null,expireData:null,payItemTypeName:null,personID:r}).unwrap();console.log(l),u(!1),D.success(l.message,{autoClose:2e3}),t(r)}catch(h){console.log(h),D.error(((i=h==null?void 0:h.data)==null?void 0:i.message)||h.error,{autoClose:2e3})}},p=i=>{const{name:h,value:C}=i.target;o({...a,[h]:L(le(C))})},v=(i,h)=>{const{name:C}=h;if(i){const{value:l}=i;o({...a,[C]:l})}else o({...a,[C]:null})},[y,{isLoading:m}]=be(),M=x.useCallback(async i=>{try{const h=await y(i).unwrap();j(h.itemList[0].payItemTypeName),console.log(h)}catch(h){console.log(h)}},[y]);x.useEffect(()=>{a.payItemTypeID?M(a.payItemTypeID):j("")},[a.payItemTypeID,M]);const b=i=>{const{name:h,checked:C}=i.target;o({...a,[h]:C})};return x.useEffect(()=>{if(a.instalementCount&&a.financialItemAmount){const i=parseInt(a.instalementCount),h=parseFloat(a.financialItemAmount);if(i>0){const C=h/i;o(l=>({...l,instalementAmount:C.toFixed()}))}}else(a.instalementCount===""||a.financialItemAmount==="")&&o(i=>({...i,instalementAmount:""}))},[a.instalementCount,a.financialItemAmount]),e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(O,{closeMenuOnSelect:!0,components:I,options:_,onChange:v,value:_.find(i=>i.value===(a==null?void 0:a.payItemTypeID)),name:"payItemTypeID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," شرح آیتم"]}),noOptionsMessage:T.noOptionsMessage,loadingMessage:T.loadingMessage,styles:{container:i=>({...i,position:"relative",height:"100%"}),control:i=>({...i,fontFamily:"IranYekan",cursor:"pointer",fontSize:"12px",height:"100%",maxWidth:"100%",maxHeight:"100%",overflow:"auto",textOverflow:"ellipsis",position:"relative"}),menu:i=>({...i,fontFamily:"IranYekan",zIndex:"5",height:"200px"}),option:i=>({...i,cursor:"pointer"}),menuList:i=>({...i,fontFamily:"IranYekan",zIndex:"5",height:"200px"})},isLoading:g||f}),e.jsxs("label",{className:a!=null&&a.payItemTypeID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," شرح آیتم"]})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",value:c(a.payItemTypeID)||"",name:"payItemTypeName",id:"payItemTypeName",disabled:!0,onChange:p,required:!0}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"payItemTypeName",children:[e.jsx("span",{children:"*"})," شناسه آیتم"]})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",onChange:p,value:c(B(a.financialItemAmount))||"",name:"financialItemAmount",id:"financialItemAmount",required:!0}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"financialItemAmount",children:[e.jsx("span",{children:"*"})," مبلغ کل"]})]}),e.jsx("h4",{className:"title-quaternary",style:{justifySelf:"start",alignSelf:"center"},children:"تاریخ شروع محاسبه فیش :"}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",value:c(a==null?void 0:a.executeYear)||"",name:"executeYear",id:"executeYear",required:!0,onChange:p}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"executeYear",children:[e.jsx("span",{children:"*"})," سال"]})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",value:c(a==null?void 0:a.executeMonth)||"",name:"executeMonth",id:"executeMonth",onChange:p,required:!0}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"executeYear",children:[e.jsx("span",{children:"*"})," ماه"]})]}),e.jsxs("div",{className:"checkboxContainer__item",style:{justifySelf:"start",alignSelf:"center"},children:[e.jsx(me,{size:"small",color:"success",checked:!!(a!=null&&a.isInstallment),onChange:b,name:"isInstallment",id:"isInstallment",sx:{padding:.5}}),e.jsx("label",{htmlFor:"isInstallment",className:"checkboxContainer__label",children:"قسطی"})]}),a.isInstallment&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",value:c(a==null?void 0:a.instalementCount)||"",name:"instalementCount",id:"instalementCount",required:!0,onChange:p}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"instalementCount",children:[e.jsx("span",{children:"*"})," تعداد قسط"]})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",onChange:p,value:B(c(a==null?void 0:a.instalementAmount))||"",name:"instalementAmount",id:"instalementAmount",required:!0,disabled:!0}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"instalementAmount",children:[e.jsx("span",{children:"*"})," مبلغ قسط"]})]})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(k,{dir:"ltr",endIcon:e.jsx(Ne,{}),variant:"contained",onClick:F,type:"submit",loading:N,color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})}function ta(){const[u,a]=x.useState({}),[o,n]=x.useState(!1),[j,I]=x.useState(null),[r,t]=x.useState(!1),[d,N]=x.useState(!1),[s,g]=x.useState(null),{canAddNewItem:f}=P(l=>l.financialData),{financialTableData:_}=P(l=>l.financialData),F=P(l=>l.financialData.payPersonID),[p,{isLoading:v}]=Me(),{getFinancialItems:y}=X(),m=l=>{I(l),n(!0)},M=()=>{t(!0)},b=l=>{g(l),N(!0)},A=async()=>{var l;try{const S=await p(s).unwrap();console.log(S),y(F),N(!1),D.success(S.message,{autoClose:2e3})}catch(S){console.log(S),D.error(((l=S==null?void 0:S.data)==null?void 0:l.message)||S.error,{autoClose:2e3})}},i=x.useMemo(()=>[{accessorKey:"financialItemRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:l})=>e.jsx("span",{children:c(l)})},{accessorKey:"payItemTypeID",header:"شناسه آیتم",size:20,Cell:({renderedCellValue:l})=>e.jsx("span",{children:c(l)})},{accessorKey:"payItemTypeName",header:"نام آیتم",size:20},{accessorKey:"payItemAmount",header:"مبلغ",size:20,Cell:({renderedCellValue:l})=>e.jsx("span",{children:B(c(l))})},{accessorKey:"editPayItem",header:"مشاهده",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:l})=>e.jsx(R,{title:`مشاهده "${l.original.payItemTypeName}"`,children:e.jsx(q,{color:"primary",sx:{padding:"0"},onClick:()=>m(l.original.id),children:e.jsx(ue,{})})})},{accessorKey:"removePayItem",header:"حذف",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:l})=>e.jsx(R,{title:`حذف "${l.original.payItemTypeName}"`,children:e.jsx(q,{color:"error",sx:{padding:"0"},onClick:()=>b(l.original.id),children:e.jsx(ve,{})})})}],[]),h=E({...U,columns:i,data:_,muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:l=>e.jsx(G,{...l,page:c(l.page),slots:{previous:V,next:Q,first:H,last:J}})},renderTopToolbarCustomActions:()=>e.jsx(R,{title:"افزودن آیتم",children:e.jsx("span",{children:e.jsx(q,{"aria-label":"refresh",color:"success",onClick:M,disabled:!f,children:e.jsx(Ce,{fontSize:"small"})})})}),muiTableBodyRowProps:({row:l})=>({onClick:()=>a(()=>({[l.id]:!0})),selected:u[l.id],sx:{cursor:"pointer"}}),getRowId:l=>l.id,onRowSelectionChange:a,state:{rowSelection:u}});return e.jsxs(e.Fragment,{children:[o&&e.jsx(z,{title:"مشاهده آیتم",closeModal:()=>n(!1),children:e.jsx(Pe,{id:j})}),r&&e.jsx(z,{title:"افزودن آیتم",closeModal:()=>t(!1),children:e.jsx(Le,{setIsInsertItemModalOpen:t})}),d&&e.jsxs(z,{title:"حذف آیتم",closeModal:()=>N(!1),children:[e.jsx("p",{className:"paragraph-primary",children:"آیا از حذف این آیتم اطمینان دارید؟"}),e.jsxs("div",{className:"flex-row flex-center",children:[e.jsx(k,{dir:"ltr",endIcon:e.jsx(he,{}),onClick:A,loading:v,variant:"contained",color:"success",children:e.jsx("span",{children:"بله"})}),e.jsx(ye,{dir:"ltr",endIcon:e.jsx(Ie,{}),onClick:()=>N(!1),variant:"contained",color:"error",children:e.jsx("span",{children:"خیر"})})]})]}),e.jsx(W,{table:h})]})}function la(){const[u,{isLoading:a,isFetching:o}]=_e(),[n,j]=x.useState(null),I=Y(),r=s=>{const{name:g,value:f}=s.target;j({...n,[g]:f})},t=!n||!n.personFirstName&&!n.personLastName&&!n.personNationalCode&&!n.personnelID,d=async()=>{var s;try{const g=(n==null?void 0:n.personnelID)||"",f=(n==null?void 0:n.personFirstName)||"",_=(n==null?void 0:n.personLastName)||"",F=(n==null?void 0:n.personNationalCode)||"",p=await u({personnelID:L(g),personFirstName:f,personLastName:_,personNationalCode:L(F)}).unwrap();if(p.itemList.length===0){D.error("نتیجه ای یافت نشد",{autoClose:2e3});return}const v=p.itemList.map((y,m)=>({id:y.personID,personRowNum:m+1,personDeathDate:y.personDeathDate,personnelID:y.personnelID,personNationalCode:y.personNationalCode,personFirstName:y.personFirstName,personLastName:y.personLastName}));I(ge(v))}catch(g){console.log(g),D.error(((s=g==null?void 0:g.data)==null?void 0:s.message)||g.error,{autoClose:2e3})}};return e.jsxs("section",{className:"formContainer flex-col",children:[e.jsxs("form",{method:"POST",className:"grid grid--col-4",noValidate:!0,children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",id:"personNationalCode",className:"inputBox__form--input",value:c(n==null?void 0:n.personNationalCode),name:"personNationalCode",onChange:r,required:!0}),e.jsx("label",{htmlFor:"personNationalCode",className:"inputBox__form--label",children:"کد ملی"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",id:"personnelID",className:"inputBox__form--input",value:c(n==null?void 0:n.personnelID),name:"personnelID",onChange:r,required:!0}),e.jsx("label",{htmlFor:"personnelID",className:"inputBox__form--label",children:"شماره کارمندی"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",id:"personFirstName",className:"inputBox__form--input",name:"personFirstName",onChange:r,required:!0}),e.jsx("label",{htmlFor:"personFirstName",className:"inputBox__form--label",children:"نام"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",id:"personLastName",className:"inputBox__form--input",name:"personLastName",onChange:r,required:!0}),e.jsx("label",{htmlFor:"personLastName",className:"inputBox__form--label",children:"نام خانوادگی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},className:"flex-row",children:e.jsx(k,{dir:"ltr",endIcon:e.jsx(De,{}),disabled:t,variant:"contained",color:"primary",loading:a||o,onClick:d,children:e.jsx("span",{children:"جست و جو"})})})]})}export{ea as C,la as P,ee as a,na as b,Ze as c,ta as d,aa as e,Ue as i,Xe as p};
