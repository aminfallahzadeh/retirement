import{aa as I,r as l,e as R,J as y,K as T,M as C,l as d,j as e,ab as v,ac as B,d as w,ad as G,S as M,i as _,T as k,I as D,F}from"./index-W68cpnsO.js";import{S as L}from"./index-DZeFJUBr.js";/* empty css                 */import{u as E,M as P,g as q}from"./index.esm-Ck86Uiz9.js";import{f as K}from"./index-_9BQuZMG.js";import{d as O}from"./table-options-K8gSTB4P.js";import{u as z}from"./index.esm-CWoQLPon.js";import{S as H}from"./index-DRM-yeOy.js";function J({setAddedItems:r}){const m=I(),[n,u]=l.useState({}),i=R(),{itemsTableData:g}=y(t=>t.itemsData),{data:p,isLoading:j,isFetching:b,isSuccess:x,refetch:N,error:s}=T();l.useEffect(()=>{if(N(),x){const t=p.itemList.map(o=>({id:o.id,name:o.itemName}));i(C(t))}return()=>{i(C([]))}},[p,x,i,N]),l.useEffect(()=>{var t;s&&(console.log(s),d.error(((t=s==null?void 0:s.data)==null?void 0:t.message)||s.error,{autoClose:2e3}))},[s]);const h=l.useMemo(()=>[{accessorKey:"name",header:"نام دسترسی",size:20}],[]),c=E({...O,columns:h,data:g,enableRowSelection:!0,enablePagination:!1,enableBottomToolbar:!1,muiTableContainerProps:{sx:{height:"400px"}},muiTableBodyRowProps:({row:t,staticRowIndex:o,table:f})=>({onClick:S=>q({row:t,staticRowIndex:o,table:f})(S),sx:{cursor:"pointer"}}),getRowId:t=>t.id,onRowSelectionChange:u,state:{rowSelection:n}});return l.useEffect(()=>{const t=c.getSelectedRowModel().rows;r(t.map(o=>o.original))},[c,n,r]),e.jsx(e.Fragment,{children:j||b?e.jsx("div",{className:"skeleton-lg",children:e.jsx(L,{count:7,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(v,{theme:B({...m,direction:"rtl"},K),children:e.jsx("div",{style:{direction:"rtl"},className:"u-margin-bottom-md",children:e.jsx(P,{table:c})})})})}function Q({addedItems:r}){const m=w(),{register:n,handleSubmit:u,formState:{errors:i}}=z(),[g,{isLoading:p}]=G(),[j,{isLoading:b}]=M(),x=async s=>{var h,c;if(r.length===0)d.warning("!هیچ دسترسی انتخاب نشده است",{autoClose:2e3});else try{const a=await g(s).unwrap();try{const t=a.itemList[0].id,o=r.map(S=>({id:"",itemID:S.id,itemName:"",groupID:t})),f=await j(o).unwrap();console.log(f),d.success(f.message,{autoClose:2e3}),m("/retirement/groups")}catch(t){console.log(t),d.error(((h=t==null?void 0:t.data)==null?void 0:h.message)||t.error,{autoClose:2e3})}}catch(a){console.log(a),d.error(((c=a==null?void 0:a.data)==null?void 0:c.message)||a.error,{autoClose:2e3})}};return e.jsx("section",{className:"formContainer flex-col",children:e.jsxs("form",{method:"POST",className:"flex-row",noValidate:!0,onSubmit:u(x),children:[e.jsxs("div",{className:"inputBox__form",children:[i.groupName&&e.jsx("span",{className:"error-form",children:i.groupName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input inputBox__form--input-height-40",required:!0,...n("groupName",{required:"نام گروه را وارد کنید"}),id:"groupNameCreate"}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"groupNameCreate",children:[e.jsx("span",{children:"*"})," نام گروه"]})]}),e.jsx(_,{dir:"ltr",endIcon:e.jsx(H,{}),loading:p||b,onClick:u,variant:"contained",type:"submit",color:"success",children:e.jsx("span",{children:"ذخیره"})})]})})}function ee(){const[r,m]=l.useState([]),n=w();return e.jsxs("section",{className:"flex-col",children:[e.jsxs("div",{className:"title-primary--container flex-row flex-center",children:[e.jsxs("h4",{className:"title-primary",children:["ایجاد گروه جدید",e.jsx("span",{className:"title-primary--underline"})]}),e.jsx("div",{style:{marginRight:"auto"},className:"back-button",children:e.jsx(k,{title:"بازگشت",children:e.jsx("span",{children:e.jsx(D,{color:"primary",onClick:()=>n(-1),children:e.jsx(F,{})})})})})]}),e.jsxs("div",{className:"flex-col flex-center",children:[e.jsx("div",{children:e.jsx(Q,{addedItems:r})}),e.jsx("div",{style:{width:"500px"},children:e.jsx(J,{setAddedItems:m})})]})]})}export{ee as default};
