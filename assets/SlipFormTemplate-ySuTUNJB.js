import{w as E,aj as c,r as d,j as e,B as M,C as T,a as r,z as p,ak as q,p as A}from"./index-BSRVVr8n.js";import{D as L,$ as F}from"./module-VPD-lIuN.js";import{M as k}from"./Modal-CHpckkD-.js";const w=E.injectEndpoints({endpoints:i=>({existPaySlip:i.query({query:({payType:t,currentYear:s,currentMonth:n})=>({url:`${c}/ExistPaySlip?payType=${t}&currentYear=${s}&currentMonth=${n}`})}),getPayList:i.query({query:({personID:t,currentYear:s,currentMonth:n,payType:h})=>{let l=`${c}/GetPayList?payType=${h}`;return t&&(l+=`&personID=${t}`),s&&(l+=`&currentYear=${s}`),n&&(l+=`&currentMonth=${n}`),{url:l}}}),getPay:i.query({query:({payID:t})=>({url:`${c}/GetPay?payID=${t}`})}),issuePay:i.mutation({query:({currentYear:t,currentMonth:s,requestID:n,payDate:h})=>({url:`${c}/IssuePayForMunicipality?currentYear=${t}&currentMonth=${s}&requestID=${n}&payDate=${h}`,method:"POST"})}),insertPay:i.mutation({query:({payDate:t,currentYear:s,currentMonth:n,requestID:h,personID:l})=>({url:`${c}/InsertSinglePayForMunicipality?payDate=${t}&currentYear=${s}&currentMonth=${n}&requestID=${h}&personID=${l}`,method:"POST"})}),removePayItem:i.mutation({query:({payItemID:t})=>({url:`${c}/RemovePayItem?payItemID=${t}`,method:"POST"})}),insertPayItem:i.mutation({query:t=>({url:`${c}/InsertPayItem`,method:"POST",body:t})}),insertPayExcel:i.mutation({query:({data:t,type:s})=>{let n;switch(s){case"C":n=`${c}/GetFinancialItemListFromExcel`;break;case"E":n=`${c}/GetFicheListFromExcel`;break;default:throw new Error(`Unsupported type: ${s}`)}return{url:n,method:"POST",body:t}}})})}),{useLazyExistPaySlipQuery:O,useLazyGetPayListQuery:z,useGetPayListQuery:Q,useGetPayQuery:B,useIssuePayMutation:U,useInsertPayMutation:W,useRemovePayItemMutation:H,useInsertPayItemMutation:J,useInsertPayExcelMutation:K}=w;function V({payID:i}){const t=d.useRef(),[s,n]=d.useState(null),[h,l]=d.useState([]),[v,j]=d.useState([]),[$,I]=d.useState(0),[P,S]=d.useState(0),{data:u,isLoading:N,isFetching:b,isSuccess:g,error:x}=B({payID:i});return d.useEffect(()=>{if(g&&n(u),u!=null&&u.payItemList){const a=u.payItemList.filter(m=>m.payItemAmount<0),o=u.payItemList.filter(m=>m.payItemAmount>=0),_=a.reduce((m,y)=>m+y.payItemAmount,0),f=o.reduce((m,y)=>m+y.payItemAmount,0);l(a),j(o),I(_),S(f)}return()=>{n(null),l([]),j([]),I(0),S(0)}},[g,u,i,$,P]),d.useEffect(()=>{x&&console.log(x)},[x]),e.jsx(e.Fragment,{children:N||b||s===null?e.jsx(k,{title:"در حال بارگذاری...",children:e.jsx(M,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(T,{color:"primary"})})}):e.jsxs("div",{className:"slip-container",children:[e.jsxs("div",{className:"slip-container",ref:t,children:[e.jsxs("div",{className:"slip-container__logo",children:[e.jsx("img",{src:"./images/logo-slip.png",className:"slip-container__logo--img"}),e.jsx("p",{className:"slip-container__logo--sub",children:"سازمان بازنشستگی شهرداری تهران"})]}),e.jsxs("div",{className:"slip-container__header",children:[e.jsx("h5",{children:"بسمه تعالی"}),e.jsx("h5",{children:"فیش حقوقی"})]}),e.jsx("table",{className:"slip-container__info-table form-table",children:e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:`نام : ${s==null?void 0:s.personFirstName}`}),e.jsx("th",{colSpan:2,children:`نام خانوادگی : ${s==null?void 0:s.personLastName}`}),e.jsx("th",{children:`دوره : ${r(s==null?void 0:s.currentYear)}/${r(s==null?void 0:s.currentMonth)}`})]}),e.jsxs("tr",{children:[e.jsx("th",{children:`نوع استخدام : ${s==null?void 0:s.personEmploymentTypeName}`}),e.jsx("th",{children:`بانک : ${s==null?void 0:s.personBankName}`}),e.jsx("th",{children:`شعبه : ${s==null?void 0:s.personBankBranchName}`}),e.jsx("th",{children:`شماره حساب : ${r(s==null?void 0:s.personAccount)}`})]})]})}),e.jsxs("div",{className:"slip-container__items-table-container",children:[e.jsxs("table",{className:"form-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{width:"100",children:"ردیف"}),e.jsx("th",{children:"حقوق مزایا"}),e.jsx("th",{children:"مبلغ به ریال"})]})}),e.jsx("tbody",{className:"form-table__body",dir:"ltr",children:v.map((a,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:r(o+1)}),e.jsx("td",{children:a.payItemTypeName}),e.jsx("td",{children:r(p(a.payItemAmount))})]},o))})]}),e.jsxs("table",{className:"form-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{width:"100",children:"ردیف"}),e.jsx("th",{children:"کسور"}),e.jsx("th",{children:"مبلغ به ریال"}),e.jsx("th",{children:"مانده"}),e.jsx("th",{children:"اصل وام"})]})}),e.jsx("tbody",{className:"form-table__body",dir:"ltr",children:h.map((a,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:r(o+1)}),e.jsx("td",{children:a.payItemTypeName}),e.jsx("td",{children:r(p(Math.abs(a.payItemAmount)))}),e.jsx("td",{children:r(a.remainedAmount)||"-"}),e.jsx("td",{children:r(a.financialItemAmount)||"-"})]},o))})]})]}),e.jsx("div",{className:"slip-container__total-table-container",children:e.jsx("table",{className:"total-table form-table",children:e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"جمع حقوق و مزایا :"}),e.jsx("th",{children:e.jsx("span",{dir:"rtl",children:`${r(p(P))} ریال`})}),e.jsx("th",{children:"جمع کسور :"}),e.jsx("th",{dir:"ltr",children:e.jsx("span",{dir:"rtl",children:`${r(p(Math.abs($)))} ریال`})})]}),e.jsxs("tr",{children:[e.jsx("th",{colSpan:2,children:"مبلغ قابل پرداخت :"}),e.jsx("th",{colSpan:2,children:e.jsx("span",{dir:"rtl",children:`${r(p(s==null?void 0:s.payAmount))} ریال`})})]})]})})}),e.jsxs("div",{className:"slip-container__footer",children:[e.jsx("h5",{children:"مبلغ قابل پرداخت به حروف : "}),e.jsx("p",{style:{fontSize:"12px"},children:`${q(s==null?void 0:s.payAmount)} ریال`})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(A,{dir:"ltr",endIcon:e.jsx(L,{}),onClick:()=>F(t,{filename:"فیش حقوقی.pdf"}),variant:"contained",color:"primary",sx:{fontFamily:"IranYekan"},children:e.jsx("span",{children:"دانلود فیش"})})})]})})}export{V as S,K as a,O as b,z as c,U as d,W as e,J as f,B as g,H as h,Q as u};
