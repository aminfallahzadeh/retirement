import{bK as y,r as m,bq as S,x,bc as R,j as e,bL as q,bM as T,bf as F,bN as I,m as B,h as A,bQ as k,bF as U,bt as v,t as E,b8 as M,y as d,I as G,bP as L}from"./index-BXRanfZW.js";import{S as P}from"./index-UgjYOVm9.js";/* empty css                 */import{f as D}from"./index-_9BQuZMG.js";import{d as z}from"./table-options-81KlQLdp.js";function V({setAddedGroups:c}){const u=y(),[t,p]=m.useState({}),[h,r]=m.useState([]),{data:f,isLoading:g,isSuccess:j,error:i,refetch:b}=S();m.useEffect(()=>{if(b(),j){const l=f.itemList.map(s=>({id:s.id,name:s.groupName}));r(l)}},[f,j,b]),m.useEffect(()=>{var l;i&&(console.log(i),x.error(((l=i==null?void 0:i.data)==null?void 0:l.message)||i.error,{autoClose:2e3}))},[i]);const a=m.useMemo(()=>[{accessorKey:"name",header:"نام نقش",size:20}],[]),o=R({...z,columns:a,data:h,enableRowSelection:!0,enablePagination:!1,enableBottomToolbar:!1,muiTableContainerProps:{sx:{height:"250px"}},muiTableBodyRowProps:({row:l,staticRowIndex:s,table:n})=>({onClick:_=>I({row:l,staticRowIndex:s,table:n})(_),sx:{cursor:"pointer"}}),getRowId:l=>l.id,onRowSelectionChange:p,state:{rowSelection:t}});return m.useEffect(()=>{const l=o.getSelectedRowModel().rows;c(l.map(s=>s.original))},[o,t,c]),e.jsx(e.Fragment,{children:g?e.jsx("div",{className:"skeleton-lg",children:e.jsx(P,{count:7,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(q,{theme:T({...u,direction:"rtl"},D),children:e.jsx("div",{style:{direction:"rtl"},children:e.jsx(F,{table:o})})})})}function Z({addedGroups:c}){const u=B(),{register:t,handleSubmit:p,setValue:h,formState:{errors:r}}=A(),[f,{isLoading:g}]=k(),[j,{isLoading:i}]=U(),b=async a=>{var o,N,l;if(c.length===0)try{const s=await f({...a,mobile:d(a.mobiel),tel:d(a.tel),password:d(a.password),isActive:a.isActive==="true",sex:a.sex==="true"}).unwrap();x.success(s.message,{autoClose:2e3}),u("/retirement/users")}catch(s){console.log(s),x.error(((o=s==null?void 0:s.data)==null?void 0:o.message)||s.error,{autoClose:2e3})}else try{const s=await f({...a,mobile:d(a.mobiel),tel:d(a.tel),password:d(a.password),isActive:a.isActive==="true",sex:a.sex==="true"}).unwrap();try{const n=s.itemList[0].userID,_=c.map(C=>({id:"",userID:n,groupID:C.id,groupName:""})),w=await j(_).unwrap();x.success(w.message,{autoClose:2e3}),u("/retirement/users")}catch(n){console.log(n),x.error(((N=n==null?void 0:n.data)==null?void 0:N.message)||n.error,{autoClose:2e3})}}catch(s){console.log(s),x.error(((l=s==null?void 0:s.data)==null?void 0:l.message)||s.error,{autoClose:2e3})}};return e.jsx("section",{className:"formContainer",children:e.jsxs("form",{method:"POST",className:"flex-col",noValidate:!0,autoComplete:"off",onSubmit:p(b),children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[r.username&&e.jsx("span",{className:"error-form",children:r.username.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",required:!0,autoComplete:"off",...t("username",{required:"نام کاربری را وارد کنید"}),id:"usrName"}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"usrName",children:[e.jsx("span",{children:"*"})," نام کاربری"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.password&&e.jsx("span",{className:"error-form",children:r.password.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",required:!0,autoComplete:"off",...t("password",{required:"رمز عبور را وارد کنید",onChange:a=>{let o=v(a.target.value);h("password",o)}}),id:"pssw"}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"pssw",children:[e.jsx("span",{children:"*"})," رمز عبور"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.isActive&&e.jsx("span",{className:"error-form",children:r.isActive.message}),e.jsxs("select",{className:"inputBox__form--input",id:"isActive",...t("isActive",{required:"وضعیت را انتخاب کنید"}),required:!0,defaultValue:"",children:[e.jsx("option",{disabled:!0,value:"",children:"انتخاب"}),e.jsx("option",{value:"true",children:"فعال"}),e.jsx("option",{value:"false",children:"غیر فعال"})]}),e.jsxs("label",{className:"inputBox__form--combo-label",htmlFor:"isActive",children:[e.jsx("span",{children:"*"})," وضعیت"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.firstName&&e.jsx("span",{className:"error-form",children:r.firstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",...t("firstName",{required:"نام را وارد کنید"}),required:!0,id:"nam"}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"nam",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.lastName&&e.jsx("span",{className:"error-form",children:r.lastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",required:!0,...t("lastName",{required:"نام خانوادگی را وارد کنید"}),id:"namekh"}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"namekh",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.email&&e.jsx("span",{className:"error-form",children:r.email.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",...t("email",{pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"ایمیل معتبر نیست"}}),required:!0,id:"postE"}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"postE",children:"پست الکترونیک"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.sex&&e.jsx("span",{className:"error-form",children:r.sex.message}),e.jsxs("select",{className:"inputBox__form--input",id:"sex",required:!0,defaultValue:"",...t("sex",{required:"جنسیت را انتخاب کنید"}),children:[e.jsx("option",{value:"",disabled:!0,children:"انتخاب"}),e.jsx("option",{value:"true",children:"مرد"}),e.jsx("option",{value:"false",children:"زن"})]}),e.jsxs("label",{className:"inputBox__form--combo-label",htmlFor:"sex",children:[e.jsx("span",{children:"*"})," جنسیت"]})]}),e.jsxs("div",{className:"inputBox__form",children:[r.tel&&e.jsx("span",{className:"error-form",children:r.tel.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",...t("tel",{pattern:{value:/^[0-9\u06F0-\u06F9]+$/,message:"تلفن ثابت معتبر نیست"},onChange:a=>{let o=v(a.target.value);h("tel",o)}}),required:!0,id:"Tell"}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"Tell",children:"پست الکترونیک"})]}),e.jsxs("div",{className:"inputBox__form",children:[r.mobile&&e.jsx("span",{className:"error-form",children:r.mobile.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",required:!0,id:"Cell",...t("mobile",{required:"تلفن همراه را وارد کنید",onChange:a=>{let o=v(a.target.value);h("mobile",o)}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"Cell",children:[e.jsx("span",{children:"*"})," تلفن همراه"]})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(E,{dir:"ltr",endIcon:e.jsx(M,{}),loading:g||i,onClick:p,variant:"contained",type:"submit",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})}function J(){const[c,u]=m.useState([]),t=B();return e.jsxs("section",{className:"flex-col",children:[e.jsxs("div",{className:"title-primary--container flex-row flex-center",children:[e.jsxs("h4",{className:"title-primary",children:[e.jsx("span",{className:"title-primary--underline"})," ایجاد کاربر جدید"]}),e.jsx("div",{style:{marginRight:"auto"},className:"back-button",children:e.jsx(G,{color:"primary",onClick:()=>t(-1),children:e.jsx(L,{})})})]}),e.jsxs("div",{className:"flex-row flex-center",style:{alignItems:"flex-start"},children:[e.jsx(Z,{addedGroups:c}),e.jsx("div",{style:{width:"500px"},children:e.jsx(V,{setAddedGroups:u})})]})]})}export{J as default};
