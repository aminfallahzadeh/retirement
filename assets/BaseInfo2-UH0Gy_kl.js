import{j as e,I as F,i as $,y as E,b0 as h,r as u,k as P,aN as G}from"./index-DSED7iL5.js";import{a as V,u as z}from"./index.esm-DqZpPg4P.js";import{I as A}from"./Input-C-thf8iV.js";import{S as q}from"./SelectInput-CmZ-lV3g.js";import{S as Q}from"./Save-DiCw1evn.js";import"./react-select-animated.esm-CV2p-T-N.js";const R=({name:t,label:i,required:l,rules:n,control:m,value:a="",editable:p=!0,colSpan:x="",rowSpan:y=""})=>{const{field:r,fieldState:s}=V({control:m,defaultValue:a,name:t,rules:n}),c=()=>{r.onChange("")};return e.jsxs("div",{className:`inputBox__form ${x}  ${y}`,children:[(s==null?void 0:s.error)&&e.jsx("span",{className:"error-form",children:s==null?void 0:s.error.message}),e.jsx("textarea",{disabled:!p,value:r.value,onChange:r.onChange,id:t,name:t,className:"inputBox__form--input",required:!0}),e.jsxs("label",{htmlFor:t,className:"inputBox__form--label",children:[l&&e.jsx("span",{children:"*"})," ",i]}),r.value&&p?e.jsx("div",{className:"inputBox__form--icon",children:e.jsx(F,{color:"default",size:"small",onClick:c,children:e.jsx($,{fontSize:"small"})})}):null]})},_=E.injectEndpoints({endpoints:t=>({getLookup:t.query({query:({lookupType:i,lookupName:l})=>{let n=`${h}/GetLookup?LookupType=${i}`;return l&&(n+=`&lookUpName=${l}`),{url:n}}}),getLookupDistinct:t.query({query:()=>({url:`${h}/GetLookupDistinct`})}),insertLookup:t.mutation({query:i=>({url:`${h}/InsertLookup`,method:"POST",body:i})})})}),{useLazyGetLookupQuery:K,useGetLookupDistinctQuery:M,useInsertLookupMutation:H}=_,C=(t,i,l)=>t.map(n=>({value:n[i],label:n[l]})),J=()=>{var v,N;const[t,i]=u.useState([]),[l,n]=u.useState([]),{handleSubmit:m,control:a,formState:{errors:p},watch:x,reset:y,setValue:r}=z({defaultValues:{title:"",type:null,parent:null,description:""}}),s=x(),{data:c,isLoading:L,isSuccess:g}=M(),[j,{isLoading:T,isFetching:O}]=K(),[w,{isLoading:B}]=H(),f=u.useCallback(async()=>{var d;const o=await j({lookupType:(d=s==null?void 0:s.type)==null?void 0:d.value}).unwrap(),k=C(o.itemList,"lookUpID","lookUpName");n(k),console.log(o)},[j,(v=s==null?void 0:s.type)==null?void 0:v.value]),D=async o=>{var I,U,b,S;const k={lookUpID:"string",lookUpType:(I=o.type)==null?void 0:I.value,lookUpTypeName:(U=o.type)==null?void 0:U.label,lookUpName:o.title,lookUpParentID:((b=o.parent)==null?void 0:b.value)||"",lookUpDescription:o.description,lookUpParentIDName:((S=o.parent)==null?void 0:S.label)||"",isDeleted:!1},d=await w(k).unwrap();G.success(d.message),y()};return u.useEffect(()=>{if(g){const o=C(c.itemList,"lookUpType","lookUpTypeName");i(o)}},[c==null?void 0:c.itemList,g]),u.useEffect(()=>{var o;(o=s==null?void 0:s.type)!=null&&o.value?f():(r("parent",null),n([]))},[(N=s==null?void 0:s.type)==null?void 0:N.value,f,r]),e.jsx("section",{className:"flex-col formContainer",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:m(D),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsx(A,{name:"title",label:"عنوان",control:a,required:!0,rules:{required:{value:!0,message:"این فیلد اجباری است"}}}),e.jsx(q,{name:"type",label:"نوع",options:t,control:a,required:!0,isClearable:!0,isLoading:L,errors:p,rules:{required:{value:!0,message:"این فیلد اجباری است"}}}),e.jsx(q,{name:"parent",label:"از مجموعه",options:l,isLoading:T||O,control:a,required:!1,isClearable:!0}),e.jsx(R,{name:"description",label:"شرح",control:a,required:!0,colSpan:"col-span-2",rowSpan:"row-span-2"})]}),e.jsx("div",{className:"flex mr-auto",children:e.jsx(P,{dir:"ltr",endIcon:e.jsx(Q,{}),loading:B,variant:"contained",type:"submit",color:"success",sx:{fontFamily:"sahel"},children:e.jsx("span",{children:"ذخیره"})})})]})})},te=()=>e.jsxs("section",{className:"flex-col",children:[e.jsx("div",{className:"title-primary--container flex-row flex-center",children:e.jsxs("h4",{className:"title-primary",children:[e.jsx("span",{className:"title-primary--underline"}),"اطلاعات پایه ۲"]})}),e.jsx(J,{})]});export{te as default};
