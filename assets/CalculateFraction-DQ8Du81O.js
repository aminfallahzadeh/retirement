import{c as V,j as e,R as Y,em as K,en as k,eo as B,a as A,ep as H,r as a,G as Q,u as F,h as Z,d as v,eq as W,aZ as J,a2 as r,a6 as X,a4 as l,a7 as $,a3 as ee,a5 as te,dL as se,er as ae,es as ne,n as R,et as w,eu as re,e as oe,ev as le,ew as ie,ex as ce,ey as D,ez as L,eA as O,eB as ue}from"./index-D5O08BPJ.js";import{o as de,p as me,c as pe,q as fe}from"./useFetchLookUpData-vUaeW5m0.js";import{c as I,S as E}from"./SelectInput-BOpzHpZS.js";import"./sharedApi-CaE9KaRJ.js";import"./requestApi-DEYOrvZu.js";import"./react-select-animated.esm-oIOjkK6l.js";const z=V(e.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),xe=()=>[{accessorKey:"personnelStatementRowNo",header:Y,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"personnelStatementSerial",header:K,size:20},{accessorKey:"personnelStatementNumber",header:k,size:20},{accessorKey:"insertTime",header:B,size:20,Cell:({renderedCellValue:t})=>e.jsx("div",{children:A(t)})},{accessorKey:"personnelStatementRunDate",header:H,size:20,Cell:({renderedCellValue:t})=>e.jsx("div",{children:A(t)})}],Se=a.memo(({personID:t,handleRowSelect:c})=>{const[m,i]=a.useState([]),[S,{isLoading:n,isFetching:o}]=de(),N=xe(),p=a.useCallback(async()=>{const f=(await S({personID:t}).unwrap()).itemList.map((s,d)=>({id:s.personnelStatementSerial,personnelStatementRowNo:d+1,personnelStatementSerial:s.personnelStatementSerial,personnelStatementNumber:s.personnelStatementID,insertTime:s.insertTime,personnelStatementRunDate:s.personnelStatementRunDate}));i(f)},[S,t]);return a.useEffect(()=>{t?p():i([])},[t,p]),e.jsx(Q,{data:m,columns:N,isLoading:n,isFetching:o,scroll:!1,onRowSelect:c})}),he=()=>{const[t,c]=a.useState(null),[m,i]=a.useState(null),S=F(),n=Z(),{control:o,handleSubmit:N,formState:{errors:p},trigger:j,watch:f,setValue:s}=v(),d=f("personNationalCode"),[u,{isLoading:g,isFetching:y}]=W(),{personnelStatementOffTypes:b,personnelStatementOffTypesIsLoading:q}=me(),{organizations:T,organizationIsLoading:_}=pe({}),M=a.useMemo(()=>I(b,"personnelStatementOffTypeID","personnelStatementOffTypeName"),[b]),P=a.useMemo(()=>I(T,"organizationID","organizationName"),[T]),U=a.useCallback(h=>{i(h)},[]),G=h=>{S(re({...h,serial:m})),n("/retirement/fraction/calculate/2")},C=a.useCallback(async()=>{const x=(await u({personNationalCode:J(d)}).unwrap()).itemList[0];x&&(s("personFirstName",x.personFirstName),s("personLastName",x.personLastName),s("personnelID",x.personnelID),c(x.personID))},[d,u,s]);return a.useEffect(()=>{d?(async()=>{await j("personNationalCode")?C():(s("personFirstName",""),s("personLastName",""),s("personnelID",""),c(null),i(null))})():(s("personFirstName",""),s("personLastName",""),s("personnelID",""),c(null),i(null))},[j,C,d,s]),e.jsx(e.Fragment,{children:e.jsx("section",{className:"flex-col",children:e.jsxs("form",{id:"authorize-form",method:"POST",className:"flex-col formContainer",onSubmit:N(G),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(r,{name:"personNationalCode",label:X,rules:{...l,...$},required:!0,control:o,type:"text"}),e.jsx(r,{name:"personFirstName",label:ee,required:!1,editable:!1,control:o,isLoading:g||y,type:"text"}),e.jsx(r,{name:"personLastName",label:te,required:!1,editable:!1,control:o,isLoading:g||y,type:"text"}),e.jsx(r,{name:"personnelID",label:se,required:!1,editable:!1,control:o,isLoading:g||y,type:"text"}),e.jsx(E,{name:"statementType",control:o,label:ae,required:!0,isClearable:!0,options:M,isLoading:q,rules:l,errors:p}),e.jsx(E,{name:"organizationID",control:o,label:ne,required:!0,isClearable:!0,options:P,isLoading:_,rules:l,errors:p})]}),e.jsx(Se,{personID:t,handleRowSelect:U}),e.jsx("div",{className:"flex-row ml-auto",children:e.jsx(R,{dir:"ltr",disabled:!m,endIcon:e.jsx(z,{}),variant:"contained",type:"submit",color:"success",children:e.jsx("span",{children:w})})})]})})})},Ne=()=>{const{control:t,handleSubmit:c,formState:{errors:m},trigger:i,setValue:S}=v(),{fractionData:n}=oe(u=>u.fraction);F();const[o,{isLoading:N,isFetching:p,isSuccess:j}]=fe(),f=a.useCallback(async()=>{const u=await o({personNationalCode:n.personNationalCode,personnelStatementOffTypeID:n.statementType.value,organizationID:n.organizationID.value,numberOfInstallments:0,personnelStatementSerialNO:parseInt(n.serial),periods:null,save:!1}).unwrap();console.log("CALCULATION",u)},[o,n]),s=async u=>{console.log(u)};return a.useEffect(()=>{n&&f()},[n,f]),a.useEffect(()=>{console.log(n)},[n]),e.jsx("section",{className:"flex-col",children:e.jsxs("form",{id:"authorize-form",method:"POST",className:"flex-col formContainer",onSubmit:c(s),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(r,{name:"includedAmount",label:le,rules:l,required:!0,control:t,type:"text"}),e.jsx(r,{name:"transferredAmount",label:ie,rules:l,required:!0,control:t,type:"text"})]}),e.jsx("div",{className:"Modal__header flex justify-center items-center",children:e.jsx("h4",{className:"title-secondary",children:ce})}),e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("h1",{children:"تاریخ از :"})}),e.jsx(r,{name:"startYear",label:D,rules:l,required:!0,control:t,type:"text"}),e.jsx(r,{name:"startMonth",label:L,rules:l,required:!0,control:t,type:"text"}),e.jsx(r,{name:"startDay",label:O,rules:l,required:!0,control:t,type:"text"}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("h1",{children:"تاریخ تا :"})}),e.jsx(r,{name:"endYear",label:D,rules:l,required:!0,control:t,type:"text"}),e.jsx(r,{name:"endMonth",label:L,rules:l,required:!0,control:t,type:"text"}),e.jsx(r,{name:"endDay",label:O,rules:l,required:!0,control:t,type:"text"})]}),e.jsx("div",{className:"flex-row ml-auto",children:e.jsx(R,{dir:"ltr",endIcon:e.jsx(z,{}),variant:"contained",type:"submit",color:"success",children:e.jsx("span",{children:w})})})]})})},Ae=()=>{const{step:t}=ue();return(i=>{switch(i){case"1":return e.jsx(he,{});case"2":return e.jsx(Ne,{});default:return null}})(t)};export{Ae as default};
