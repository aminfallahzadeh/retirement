import{v as E,ai as l,r as d,j as e,B as L,C as M,o as i,y as p,aj as q,p as A,ak as g}from"./index-CRgz4MxH.js";import{s as F,D as Y,$ as k}from"./module-DLOxzZ7f.js";import{e as B}from"./excel-icon-Dq0N6FeV.js";import{a as G}from"./numberConverter-DebZ6KrJ.js";const w=E.injectEndpoints({endpoints:n=>({existPaySlip:n.query({query:({payType:t,currentYear:s,currentMonth:r})=>({url:`${l}/ExistPaySlip?payType=${t}&currentYear=${s}&currentMonth=${r}`})}),getPayList:n.query({query:({personID:t,currentYear:s,currentMonth:r,payType:h})=>{let c=`${l}/GetPayList?payType=${h}`;return t&&(c+=`&personID=${t}`),s&&(c+=`&currentYear=${s}`),r&&(c+=`&currentMonth=${r}`),{url:c}}}),getPay:n.query({query:({payID:t})=>({url:`${l}/GetPay?payID=${t}`})}),issuePay:n.mutation({query:({currentYear:t,currentMonth:s,requestID:r,payDate:h})=>({url:`${l}/IssuePayForMunicipality?currentYear=${t}&currentMonth=${s}&requestID=${r}&payDate=${h}`,method:"POST"})}),insertPay:n.mutation({query:({payDate:t,currentYear:s,currentMonth:r,requestID:h,personID:c})=>({url:`${l}/InsertSinglePayForMunicipality?payDate=${t}&currentYear=${s}&currentMonth=${r}&requestID=${h}&personID=${c}`,method:"POST"})}),removePayItem:n.mutation({query:({payItemID:t})=>({url:`${l}/RemovePayItem?payItemID=${t}`,method:"POST"})}),insertPayItem:n.mutation({query:t=>({url:`${l}/InsertPayItem`,method:"POST",body:t})}),insertPayExcel:n.mutation({query:({data:t,type:s})=>{let r;switch(s){case"C":r=`${l}/GetFinancialItemListFromExcel`;break;case"E":r=`${l}/GetFicheListFromExcel`;break;default:throw new Error(`Unsupported type: ${s}`)}return{url:r,method:"POST",body:t}}})})}),{useLazyExistPaySlipQuery:H,useLazyGetPayListQuery:J,useGetPayListQuery:K,useGetPayQuery:R,useIssuePayMutation:V,useInsertPayMutation:X,useRemovePayItemMutation:Z,useInsertPayItemMutation:D,useInsertPayExcelMutation:ee}=w,C={slipLogo:F,excelImage:B};function se({payID:n}){const t=d.useRef(),[s,r]=d.useState(null),[h,c]=d.useState([]),[N,j]=d.useState([]),[$,I]=d.useState(0),[P,v]=d.useState(0),{data:u,isLoading:b,isFetching:_,isSuccess:S,error:x}=R({payID:n});return d.useEffect(()=>{if(S&&r(u),u!=null&&u.payItemList){const a=u.payItemList.filter(m=>m.payItemAmount<0),o=u.payItemList.filter(m=>m.payItemAmount>=0),f=a.reduce((m,y)=>m+y.payItemAmount,0),T=o.reduce((m,y)=>m+y.payItemAmount,0);c(a),j(o),I(f),v(T)}return()=>{r(null),c([]),j([]),I(0),v(0)}},[S,u,n,$,P]),d.useEffect(()=>{x&&console.log(x)},[x]),e.jsx(e.Fragment,{children:b||_||s===null?e.jsx(L,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(M,{color:"primary"})}):e.jsxs("div",{className:"slip-container",children:[e.jsxs("div",{className:"slip-container",ref:t,children:[e.jsxs("div",{className:"slip-container__logo",children:[e.jsx("img",{src:C.slipLogo,className:"slip-container__logo--img"}),e.jsx("p",{className:"slip-container__logo--sub",children:"سازمان بازنشستگی شهرداری تهران"})]}),e.jsxs("div",{className:"slip-container__header",children:[e.jsx("h5",{children:"بسمه تعالی"}),e.jsx("h5",{children:"فیش حقوقی"})]}),e.jsx("table",{className:"slip-container__info-table form-table",children:e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:`نام : ${s==null?void 0:s.personFirstName}`}),e.jsx("th",{colSpan:2,children:`نام خانوادگی : ${s==null?void 0:s.personLastName}`}),e.jsx("th",{children:`دوره : ${i(s==null?void 0:s.currentYear)}/${i(s==null?void 0:s.currentMonth)}`})]}),e.jsxs("tr",{children:[e.jsx("th",{children:`نوع استخدام : ${s==null?void 0:s.personEmploymentTypeName}`}),e.jsx("th",{children:`بانک : ${s==null?void 0:s.personBankName}`}),e.jsx("th",{children:`شعبه : ${s==null?void 0:s.personBankBranchName}`}),e.jsx("th",{children:`شماره حساب : ${i(s==null?void 0:s.personAccount)}`})]})]})}),e.jsxs("div",{className:"slip-container__items-table-container",children:[e.jsxs("table",{className:"form-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{width:"100",children:"ردیف"}),e.jsx("th",{children:"حقوق مزایا"}),e.jsx("th",{children:"مبلغ به ریال"})]})}),e.jsx("tbody",{className:"form-table__body",dir:"ltr",children:N.map((a,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:i(o+1)}),e.jsx("td",{children:a.payItemTypeName}),e.jsx("td",{children:i(p(a.payItemAmount))})]},o))})]}),e.jsxs("table",{className:"form-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{width:"100",children:"ردیف"}),e.jsx("th",{children:"کسور"}),e.jsx("th",{children:"مبلغ به ریال"}),e.jsx("th",{children:"مانده"}),e.jsx("th",{children:"اصل وام"})]})}),e.jsx("tbody",{className:"form-table__body",dir:"ltr",children:h.map((a,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:i(o+1)}),e.jsx("td",{children:a.payItemTypeName}),e.jsx("td",{children:i(p(Math.abs(a.payItemAmount)))}),e.jsx("td",{children:i(a.remainedAmount)||"-"}),e.jsx("td",{children:i(a.financialItemAmount)||"-"})]},o))})]})]}),e.jsx("div",{className:"slip-container__total-table-container",children:e.jsx("table",{className:"total-table form-table",children:e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"جمع حقوق و مزایا :"}),e.jsx("th",{children:e.jsx("span",{dir:"rtl",children:`${i(p(P))} ریال`})}),e.jsx("th",{children:"جمع کسور :"}),e.jsx("th",{dir:"ltr",children:e.jsx("span",{dir:"rtl",children:`${i(p(Math.abs($)))} ریال`})})]}),e.jsxs("tr",{children:[e.jsx("th",{colSpan:2,children:"مبلغ قابل پرداخت :"}),e.jsx("th",{colSpan:2,children:e.jsx("span",{dir:"rtl",children:`${i(p(s==null?void 0:s.payAmount))} ریال`})})]})]})})}),e.jsxs("div",{className:"slip-container__footer",children:[e.jsx("h5",{children:"مبلغ قابل پرداخت به حروف : "}),e.jsx("p",{style:{fontSize:"12px"},children:`${q(s==null?void 0:s.payAmount)} ریال`})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(A,{dir:"ltr",endIcon:e.jsx(Y,{}),onClick:()=>k(t,{filename:"فیش حقوقی.pdf"}),variant:"contained",color:"primary",sx:{fontFamily:"IranYekan"},children:e.jsx("span",{children:"دانلود فیش"})})})]})})}const te=n=>n?g(n):null,ne=n=>{if(n){const t=g(n).format("jYYYY/jMM/jDD");return G(t)}return"-"};export{se as S,ne as a,D as b,te as c,R as d,Z as e,H as f,J as g,V as h,X as i,ee as j,C as k,K as u};
