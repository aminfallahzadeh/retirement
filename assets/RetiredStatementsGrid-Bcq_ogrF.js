import{q as ae,am as v,r as c,m as ee,w as ie,j as e,n as a,h as J,l as K,k as R,a as le,B as te,C as V,v as f,y as $,o as H,ae as ce,T as Y,I as M,D as X,f as oe}from"./index-DXLU_PyE.js";import{f as de,g as me,h as he,i as ue,j as xe,k as pe}from"./statementApi-4iOLLoOg.js";/* empty css                 */import{u as je,P as Se,C as ge,a as ye,L as De,F as fe,M as Re}from"./index.esm-C4cCMZs-.js";import{M as W}from"./Modal-DP9lNDeG.js";import{u as Ce,C as be}from"./index.esm-BbqTopL3.js";import{e as Ne}from"./useFetchLookUpData-C51w7ezg.js";import{u as ve,m as we,C as $e,d as Ae,a as Pe}from"./datePicker-IZhCDFXK.js";import{i as Ie,S as _e}from"./react-select-animated.esm-DpIcM5qF.js";import{o as Te,s as Z}from"./reactSelect-BGq5yAQc.js";import{S as se,C as k}from"./index-BEKQ4JXP.js";import{s as Fe,D as ne,$ as Me}from"./module-BQPyyoq0.js";import{S as ke}from"./index-DlQt11va.js";import{d as Le}from"./table-options-CzF4bt5B.js";import{D as Oe}from"./DeleteOutline-DxuTOm2Q.js";import{R as Be}from"./Refresh-CMDgE-rc.js";import{A as Ge}from"./Add-WyPxsGLi.js";import{W as ze}from"./InfoOutlined-C0x8mg_6.js";const qe=ae.injectEndpoints({endpoints:p=>({getRetiredPerson:p.query({query:o=>({url:`${v}/GetRetiredPerson?personID=${o}`})}),updateRetiredPerson:p.mutation({query:o=>({url:`${v}/UpdateRetiredPerson`,method:"POST",body:o})}),getRetiredPensionary:p.query({query:o=>({url:`${v}/GetRetiredPensionary?personID=${o}`})}),getRetiredAccount:p.query({query:o=>({url:`${v}/GetRetiredAccount?personID=${o}`})}),updateRetiredPensionary:p.mutation({query:o=>({url:`${v}/UpdateRetiredPensionary`,method:"POST",body:o})}),updateRetiredAccount:p.mutation({query:o=>({url:`${v}/UpdateRetiredAccount`,method:"POST",body:o})}),getRetired:p.query({query:o=>({url:`${v}/GetRetired?personID=${o}`})}),getAllPensionaries:p.query({query:o=>({url:`${v}/GetAllPensionaries?personID=${o}`})})})}),{useGetRetiredPersonQuery:mt,useUpdateRetiredPersonMutation:ht,useGetRetiredPensionaryQuery:ut,useGetRetiredAccountQuery:xt,useUpdateRetiredPensionaryMutation:pt,useUpdateRetiredAccountMutation:jt,useGetRetiredQuery:Ee,useLazyGetRetiredQuery:St,useGetAllPensionariesQuery:gt}=qe,Ue=["100","11","14","16","36","37","38","39","69","5","57","6","65","96","97","98"];function Qe({setShowGenerateStatementModal:p,setStatMessage:o,setShowStatModal:C}){const t=c.useRef(null),[D,n]=c.useState(null),[A,g]=c.useState(!1),{handleSubmit:w,formState:{errors:x},control:P,register:b,watch:L}=Ce(),i=L(),O=ee(),B=Ie(),h=new URLSearchParams(O.search),I=h.get("personID"),G=h.get("requestID"),[z,{isLoading:_}]=de(),{data:S,isSuccess:N,error:q}=me(I),{statementTypes:T,statementTypesIsFetching:y,statementTypesIsLoading:j}=Ne(),F=Te(T,"retirementStatementTypeID","retirementStatementTypeName"),E=u=>{g(u)},U=u=>{n(u),g(!1)};c.useEffect(()=>{N&&n(ie(S))},[N,S]);const s=async()=>{var u;try{const r=new Date(D);r.setMinutes(r.getMinutes()-r.getTimezoneOffset());const Q=await z({...i,retirementStatementRunDate:r,personID:I,requestID:G,newAmount:K(i==null?void 0:i.newAmount)||0,newSup:K(i==null?void 0:i.newSup)||0}).unwrap();p(!1),R.success(Q.message,{autoClose:2e3}),Q.error&&Q.error.length>0&&(o(a(Q.error)),C(!0))}catch(r){console.log(r),R.error(((u=r==null?void 0:r.data)==null?void 0:u.message)||r.error,{autoClose:2e3})}};return ve([t],[g]),e.jsx("section",{className:"formContainer-transparent flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:w(s),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-2",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(we.InputDatePicker,{value:D,format:"jYYYY/jMM/jDD",onChange:U,onOpenChange:E,suffixIcon:e.jsx($e,{color:"action"}),open:A,style:Ae,wrapperStyle:Pe,pickerProps:{ref:t}}),e.jsxs("div",{className:"inputBox__form--readOnly-label",children:[e.jsx("span",{children:"*"})," تاریخ اجرا"]})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(be,{name:"retirementStatementTypeID",control:P,rules:{required:!0},render:({field:{onChange:u}})=>e.jsx(_e,{closeMenuOnSelect:!0,components:B,options:F,onChange:r=>u(r?r.value:null),value:F.find(r=>r.value===(i==null?void 0:i.retirementStatementTypeID)),name:"retirementStatementTypeID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نوع حکم"]}),noOptionsMessage:Z.noOptionsMessage,loadingMessage:Z.loadingMessage,styles:{container:r=>({...r,position:"relative",height:"100%"}),control:r=>({...r,fontFamily:"IranYekan",cursor:"pointer",fontSize:"12px",height:"100%",maxWidth:"100%",maxHeight:"100%",overflow:"auto",textOverflow:"ellipsis",position:"relative"}),menu:r=>({...r,fontFamily:"IranYekan",zIndex:"5",height:"200px"}),option:r=>({...r,cursor:"pointer"}),menuList:r=>({...r,fontFamily:"IranYekan",zIndex:"5",height:"200px"})},isLoading:y||j})}),e.jsxs("label",{className:i!=null&&i.retirementStatementTypeID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نوع حکم"]}),x.retirementStatementTypeID&&e.jsx("span",{className:"error-form",children:"نوع حکم اجباری است"})]}),Ue.includes(i==null?void 0:i.retirementStatementTypeID)&&e.jsxs(e.Fragment,{children:[" ",e.jsxs("div",{className:"inputBox__form",children:[x.newAmount&&e.jsx("span",{className:"error-form",children:x.newAmount.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"newAmount",value:a(i==null?void 0:i.newAmount)||"",id:"newAmount",...b("newAmount",{pattern:{value:/^[۰-۹0-9]+$/,message:"از اعداد استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"newAmount",children:"میزان افزایش حقوق مبنا"})]}),e.jsxs("div",{className:"inputBox__form",children:[x.newSup&&e.jsx("span",{className:"error-form",children:x.newSup.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"newSup",value:a(i==null?void 0:i.newSup)||"",id:"newSup",...b("newSup",{pattern:{value:/^[۰-۹0-9]+$/,message:"از اعداد استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"newSup",children:"میزان افزایش حقوق تکمیلی"})]})]}),e.jsxs("div",{className:"inputBox__form col-span-2 row-span-2",children:[x.retirementStatementDesc&&e.jsx("span",{className:"error-form",children:x.retirementStatementDesc.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",value:a(i==null?void 0:i.retirementStatementDesc),name:"retirementStatementDesc",id:"retirementStatementDesc",required:!0,...b("retirementStatementDesc",{pattern:{value:/^[آ-ی\s۰-۹.,;!؟@#$%^&*×،()_+=-]+$/,message:"از حروف و اعداد فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"retirementStatementDesc",children:"شرح حکم"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(J,{dir:"ltr",endIcon:e.jsx(se,{}),onClick:w,type:"submit",loading:_,variant:"contained",disabled:!D,color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})}function We({statementID:p,setShowStatementModal:o}){const C=c.useRef(),[t,D]=c.useState(null),[n,A]=c.useState(null),[g,w]=c.useState(null),[x,P]=c.useState([]),L=new URLSearchParams(location.search).get("personID"),{personDeathDate:i}=le(s=>s.person),[O,{isLoading:B}]=he(),{data:h,isSuccess:I,isLoading:G,isFetching:z,refetch:_,error:S}=ue({RetirementStatementID:p}),{data:N,isSuccess:q,isLoading:T,isFetching:y,error:j}=Ee(L);c.useEffect(()=>{var s;if(_(),I){A(h),w(h==null?void 0:h.documentSignature);const u=((s=h==null?void 0:h.retirementStatementAmountList)==null?void 0:s.filter(r=>["1001","1002","2001","2002"].includes(r.retirementStatementItemID))).map(r=>({retirementStatementItemID:r.retirementStatementItemID,retirementStatementItemAmount:r.retirementStatementItemAmount}));P(u)}},[I,h,_]),c.useEffect(()=>{q&&D(N.itemList[0])},[q,N]),c.useEffect(()=>{console.log(x)},[x]),c.useEffect(()=>{var s;S&&(console.log(S),R.error(((s=S==null?void 0:S.data)==null?void 0:s.message)||S.error,{autoClose:2e3}))},[S]),c.useEffect(()=>{var s;j&&(console.log(j),R.error(((s=j==null?void 0:j.data)==null?void 0:s.message)||j.error,{autoClose:2e3}))},[j]);const F=(s,m)=>{P(u=>u.map(r=>r.retirementStatementItemID===m?{...r,retirementStatementItemAmount:Number(K(ce(s.target.value)))}:r))},E=async()=>{var s;try{const m=await O({retirementStatementID:p,data:x}).unwrap();R.success(m.message,{autoClose:2e3}),o(!1)}catch(m){R.error(((s=m==null?void 0:m.data)==null?void 0:s.message)||m.error,{autoClose:2e3})}};return c.useEffect(()=>{console.log("THIS IS THE SIGNATURE",g)},[g]),e.jsx(e.Fragment,{children:G||z||T||y||t===null||n===null?e.jsx(W,{title:"در حال بارگذاری...",children:e.jsx(te,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(V,{color:"primary"})})}):e.jsxs("div",{className:"slip-container",children:[e.jsxs("div",{className:"slip-container",ref:C,children:[e.jsxs("div",{className:"slip-container__logo",children:[e.jsx("img",{src:Fe,className:"slip-container__logo--img"}),e.jsx("p",{className:"slip-container__logo--sub",children:"سازمان بازنشستگی شهرداری تهران"})]}),e.jsxs("div",{className:"slip-container__qr",children:[e.jsx("div",{className:"slip-container__qr--box",children:"QR CODE"}),e.jsxs("p",{className:"slip-container__qr--serial",children:["سریال حکم :"," ",e.jsx("span",{children:a(n==null?void 0:n.retirementStatementSerial)})]})]}),e.jsxs("div",{className:"slip-container__header",children:[e.jsx("h5",{children:"بسمه تعالی"}),e.jsx("h5",{children:"حکم بازنشستگی"})]}),e.jsx("table",{className:"slip-container__person-info-table form-table",children:e.jsxs("thead",{children:[e.jsx("tr",{children:e.jsx("th",{colSpan:4,children:"مشخصات فردی"})}),e.jsxs("tr",{children:[e.jsx("th",{children:`کد ملی : ${a(t==null?void 0:t.personNationalCode)||"-"}`}),e.jsx("th",{children:`نام : ${(t==null?void 0:t.personFirstName)||"-"}`}),e.jsx("th",{children:`نام خانوادگی : ${(t==null?void 0:t.personLastName)||"-"}`}),e.jsx("th",{children:`شماره بازنشستگی : ${a(t==null?void 0:t.retiredID)||"-"}`})]}),e.jsxs("tr",{children:[e.jsx("th",{children:`شماره شناسنامه : ${a(t==null?void 0:t.personCertificateNo)||"-"}`}),e.jsx("th",{children:`نام پدر : ${(t==null?void 0:t.personFatherName)||"-"}`}),e.jsx("th",{children:`تاریخ تولد : ${f(t==null?void 0:t.personBirthDate)||"-"}`}),e.jsx("th",{children:`محل تولد : ${(t==null?void 0:t.personBirthPlace)||"-"}`})]}),e.jsxs("tr",{children:[e.jsx("th",{children:`جنسیت : ${(t==null?void 0:t.genderName)||"-"}`}),e.jsx("th",{children:`تعداد فرزندان : ${a(n==null?void 0:n.retirementStatementChildrenCount)??"-"}`}),e.jsx("th",{children:`تعداد افراد تحت تکفل : ${a(n==null?void 0:n.retirementStatementChildrenCount)??"-"}`}),e.jsx("th",{children:`کد درمانی : ${a(t==null?void 0:t.insuranceCode)||"-"}`})]}),e.jsxs("tr",{children:[e.jsx("th",{children:`وضعیت تاهل : ${(t==null?void 0:t.maritalStatusName)||"-"}`}),e.jsx("th",{colSpan:3,children:`کد پستی : ${a(t==null?void 0:t.personPostalCode)||"-"}`})]}),e.jsx("tr",{children:e.jsx("th",{colSpan:4,children:e.jsxs("div",{className:"slip-container__person-info-table--checkbox",children:[e.jsx("span",{children:"وضعیت ایثارگری :"}),e.jsxs("div",{children:[e.jsx(k,{size:"small",color:"success",checked:t==null?void 0:t.personIsSacrificedFamily,name:"personIsSacrificedFamily",id:"personIsSacrificedFamily",sx:{padding:.5}}),e.jsx("label",{htmlFor:"personIsSacrificedFamily",children:"خانواده شهید"})]}),e.jsxs("div",{children:[e.jsx(k,{size:"small",color:"success",checked:t==null?void 0:t.personIsValiant,name:"personIsValiant",id:"personIsValiant",sx:{padding:.5}}),e.jsx("label",{htmlFor:"personIsValiant",children:"جانباز"})]}),e.jsxs("div",{children:[e.jsx(k,{size:"small",color:"success",checked:t==null?void 0:t.personIsCaptive,name:"personIsCaptive",id:"personIsCaptive",sx:{padding:.5}}),e.jsx("label",{htmlFor:"personIsCaptive",children:"آزاده"})]}),e.jsxs("div",{children:[e.jsx(k,{size:"small",color:"success",checked:t==null?void 0:t.personIsWarrior,name:"personIsWarrior",id:"personIsWarrior",sx:{padding:.5}}),e.jsx("label",{htmlFor:"personIsWarrior",children:"رزمنده"})]}),e.jsxs("div",{children:[e.jsx(k,{size:"small",color:"success",checked:t==null?void 0:t.personIsSacrificed,name:"personIsSacrificed",id:"personIsSacrificed",sx:{padding:.5}}),e.jsx("label",{htmlFor:"personIsSacrificed",children:"شهید"})]}),e.jsxs("div",{children:[e.jsx(k,{size:"small",color:"success",checked:t==null?void 0:t.personIsChildOfSacrificed,name:"personIsChildOfSacrificed",id:"personIsChildOfSacrificed",sx:{padding:.5}}),e.jsx("label",{htmlFor:"personIsChildOfSacrificed",children:"فرزند شهید"})]})]})})})]})}),e.jsx("table",{className:"slip-container__personnel-info-table form-table",children:e.jsxs("thead",{children:[e.jsx("tr",{children:e.jsx("th",{colSpan:3,children:"مشخصات پرسنلی"})}),e.jsxs("tr",{children:[e.jsx("th",{children:`تاریخ بازنشستگی : ${f(t==null?void 0:t.retirementDate)||"-"}`}),e.jsx("th",{children:`آخرین پست سازمانی : ${(t==null?void 0:t.retiredLastPosition)||"-"}`}),e.jsxs("th",{children:["آخرین محل خدمت :",e.jsx("br",{}),`${(t==null?void 0:t.retiredOrganizationName)||"-"}`]})]}),e.jsxs("tr",{children:[e.jsxs("th",{children:["سنوات خدمت واقعی : ",e.jsx("br",{}),`روز : ${a(t==null?void 0:t.retiredRealDurationDAY)||"-"}`,"   ",`ماه : ${a(t==null?void 0:t.retiredRealDurationMONTH)||"-"}`,"   ",`سال : ${a(t==null?void 0:t.retiredRealDurationYEAR)||"-"}`]}),e.jsx("th",{children:`سنوات ارفاقی : ${a(t==null?void 0:t.retiredGrantDuration)||"-"}`}),e.jsx("th",{children:"سنوات بازنشسنگی : -"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:`گروه : ${a(n==null?void 0:n.retiredGroup)||"-"}`}),e.jsx("th",{children:`مرتبه : ${a(t==null?void 0:t.retiredJobDegree)||"-"}`}),e.jsx("th",{children:`مدرک تحصیلی : ${(t==null?void 0:t.educationTypeName)||"-"}`})]}),e.jsxs("tr",{children:[e.jsx("th",{children:`نوع حکم : ${(n==null?void 0:n.retirementStatementTypeName)||"-"}`}),e.jsx("th",{children:"عنوان شغل : -"}),e.jsx("th",{children:`تاریخ فوت : ${f(t==null?void 0:t.personDeathDate)||"-"}`})]})]})}),i?e.jsxs("table",{className:"slip-container__related-table form-table",children:[e.jsxs("thead",{children:[e.jsx("tr",{children:e.jsx("th",{colSpan:11,children:"مشخصات افراد تحت تکفل"})}),e.jsxs("tr",{children:[e.jsx("th",{children:"ردیف"}),e.jsx("th",{children:"کد ملی"}),e.jsx("th",{children:"نام"}),e.jsx("th",{children:"نام خانوادگی"}),e.jsx("th",{children:"نام پدر"}),e.jsx("th",{children:"نسبت"}),e.jsx("th",{children:"تاریخ تولد"}),e.jsx("th",{children:"حقوق وظیفه"}),e.jsx("th",{children:"بازنشستگی تکمیلی"}),e.jsx("th",{children:"حق تاهل"}),e.jsx("th",{children:"حق اولاد"})]})]}),e.jsx("tbody",{children:n==null?void 0:n.retirementStatementRelatedList.map((s,m)=>e.jsxs("tr",{children:[e.jsx("td",{children:a(m+1)}),e.jsx("td",{children:a(s.personNationalCode)||"-"}),e.jsx("td",{children:s.personFirstName||"-"}),e.jsx("td",{children:s.personLastName||"-"}),e.jsx("td",{children:s.personFatherName||"-"}),e.jsx("td",{children:s.relationshipWithParentName||"-"}),e.jsx("td",{children:f(s.personBirthDate)}),e.jsx("td",{children:a($(s.heirRight))||"-"}),e.jsx("td",{children:a($(s.supplementaryRight))||"-"}),e.jsxs("td",{children:[" ",a($(s.maritalRight))||"-"]}),e.jsx("td",{children:a($(s.childRight))||"-"})]},s.retirementStatementRelatedID))})]}):e.jsxs("table",{className:"slip-container__related-table form-table",children:[e.jsxs("thead",{children:[e.jsx("tr",{children:e.jsx("th",{colSpan:7,children:"مشخصات افراد تحت تکفل"})}),e.jsxs("tr",{children:[e.jsx("th",{width:"100",children:"ردیف"}),e.jsx("th",{children:"کد ملی"}),e.jsx("th",{children:"نام"}),e.jsx("th",{children:"نام خانوادگی"}),e.jsx("th",{children:"نام پدر"}),e.jsx("th",{children:"نسبت"}),e.jsx("th",{children:"تاریخ تولد"})]})]}),e.jsx("tbody",{children:n==null?void 0:n.retirementStatementRelatedList.map((s,m)=>e.jsxs("tr",{children:[e.jsx("td",{children:a(m+1)}),e.jsx("td",{children:a(s.personNationalCode)||"-"}),e.jsx("td",{children:s.personFirstName||"-"}),e.jsx("td",{children:s.personLastName||"-"}),e.jsx("td",{children:s.personFatherName||"-"}),e.jsx("td",{children:s.relationshipWithParentName||"-"}),e.jsx("td",{children:f(s.personBirthDate)})]},s.retirementStatementRelatedID))})]}),e.jsxs("div",{className:"slip-container__statement-items-table-container",children:[e.jsxs("table",{className:"slip-container__statement-items-desc-table form-table",children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{children:"شرح حکم :"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{style:{verticalAlign:"top"},children:a(n==null?void 0:n.retirementStatementDesc)||"-"})})})]}),e.jsxs("table",{className:"slip-container__statement-items-desc-table form-table",children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{colSpan:2,children:"آیتم های حکم :"})})}),e.jsx("tbody",{children:n==null?void 0:n.retirementStatementAmountList.map(s=>{var m;return e.jsxs("tr",{style:{textAlign:"center"},children:[e.jsx("td",{children:s.retirementStatementItemName}),s.retirementStatementItemID==="1001"||s.retirementStatementItemID==="1002"||s.retirementStatementItemID==="2001"||s.retirementStatementItemID==="2002"?e.jsx("td",{children:e.jsx("input",{type:"text",disabled:h==null?void 0:h.retirementStatementIssueConfirmDate,value:a($(((m=x.find(u=>u.retirementStatementItemID===s.retirementStatementItemID))==null?void 0:m.retirementStatementItemAmount)||"")),style:{textAlign:"center",border:"none",outline:"none",width:"100%"},onChange:u=>F(u,s.retirementStatementItemID)})}):e.jsx("td",{children:a($(s.retirementStatementItemAmount))})]},s.retirementStatementItemID)})}),e.jsx("tfoot",{children:e.jsx("tr",{children:e.jsxs("td",{colSpan:2,children:[" ","جمع کل به ریال : ","      ",a($(n==null?void 0:n.sumRetirementStatementAmount))??"-"]})})})]})]}),e.jsxs("table",{className:"slip-container__statement-footer-table form-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:`ناریخ اجرا : ${f(n==null?void 0:n.retirementStatementRunDate)||"-"}`}),e.jsx("th",{children:`تاریخ صدور : ${f(n==null?void 0:n.retirementStatementIssueDate)||"-"}`}),e.jsx("th",{children:`شماره صدور : ${a(n==null?void 0:n.retirementStatementNo)||"-"}`})]})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsxs("th",{colSpan:3,style:{textAlign:"left",padding:"20px"},children:[e.jsx("img",{src:g,alt:"امضا",className:"w-[120px] mr-auto"}),"عضو هیات مدیره و مدیرعامل"]})})})]}),e.jsxs("div",{className:"slip-container__ending",children:[e.jsx("span",{children:"- - - - - - - - - - - - - - - - - - - - - - - - - - - -"}),e.jsx("p",{children:"۱. فرزندان اناث بعد از سن ۲۰ سالگی میبایست هر سال با در دست داشتن اصل شناسنامه خود به اداره بازنشستگی مراجعه نمایند."}),e.jsx("p",{children:"۲. فرزندان ذکور بعد از سن ۲۰ سالگی و تا پایان ۲۵ سالگی در صورت اشتغال به تحصیل میبایست در هر ترم گواهی دانشجویی معتبر ارائه نمایند."}),e.jsx("p",{children:"۳. تک وظیفه بگیران لازم است هر سال یکبار با در دست داشتن اصل شناسنامه خود به اداره بازنشستگی مراجعه نمایند."})]})]}),e.jsxs("div",{style:{marginRight:"auto"},className:"flex-row",children:[e.jsx(H,{dir:"ltr",endIcon:e.jsx(ne,{}),onClick:()=>Me(C,{filename:"حکم کارمندی.pdf"}),variant:"contained",color:"primary",sx:{fontFamily:"IranYekan"},children:e.jsx("span",{children:"چاپ حکم"})}),e.jsx(J,{dir:"ltr",endIcon:e.jsx(se,{}),variant:"contained",onClick:E,loading:B,color:"success",children:e.jsx("span",{children:"ذخیره"})})]})]})})}function yt(){const[p,o]=c.useState([]),[C,t]=c.useState(null),[D,n]=c.useState({}),[A,g]=c.useState(!1),[w,x]=c.useState(!1),[P,b]=c.useState(!1),[L,i]=c.useState(!1),[O,B]=c.useState(""),h=ee(),G=new URLSearchParams(h.search).get("personID"),[z,{isLoading:_}]=xe(),{data:S,isSuccess:N,isLoading:q,isFetching:T,error:y,refetch:j}=pe({personID:G});c.useEffect(()=>{if(j(),N){const d=S.map((l,re)=>({id:l.retirementStatementID,statementRowNum:re+1,retirementStatementSerial:l.retirementStatementSerial,retirementStatementTypeName:l.retirementStatementTypeName,retirementStatementNo:l.retirementStatementNo||"-",retirementStatementIssueDate:l.retirementStatementIssueDate,retirementStatementRunDate:l.retirementStatementRunDate,retirementStatementIssueConfirmDate:l.retirementStatementIssueConfirmDate}));o(d)}},[N,j,S,A,w]),c.useEffect(()=>{var d;y&&(console.log(y),R.error(((d=y==null?void 0:y.data)==null?void 0:d.message)||y.error,{autoClose:2e3}))},[y]);const F=()=>{j()},E=()=>{g(!0)},U=c.useCallback(()=>{x(!0)},[]),s=()=>{b(!0)},m=async()=>{var d;try{const l=await z({rsID:C}).unwrap();j(),x(!1),R.success(l.message,{autoClose:2e3})}catch(l){console.log(l),R.error(((d=l==null?void 0:l.data)==null?void 0:d.message)||l.error,{autoClose:2e3})}},u=c.useMemo(()=>{const d=[{accessorKey:"statementRowNum",size:20,header:"دریف",enableColumnActions:!1,enableSorting:!1,Cell:({renderedCellValue:l})=>e.jsx("div",{children:a(l)})},{accessorKey:"retirementStatementNo",size:20,header:"شماره حکم",Cell:({renderedCellValue:l})=>e.jsx("div",{children:a(l)})},{accessorKey:"retirementStatementSerial",size:20,header:"سریال حکم",Cell:({renderedCellValue:l})=>e.jsx("div",{children:a(l)})},{accessorKey:"retirementStatementTypeName",header:"نوع حکم"},{accessorKey:"retirementStatementIssueDate",header:"تاریخ صدور",Cell:({renderedCellValue:l})=>e.jsx("div",{children:a(f(l))})},{accessorKey:"retirementStatementRunDate",header:"تاریخ اجرا",Cell:({renderedCellValue:l})=>e.jsx("div",{children:a(f(l))})},{accessorKey:"downloadRetiredStatement",header:"مشاهده/چاپ",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:l})=>e.jsx(Y,{title:`سریال ${a(l.original.retirementStatementSerial)}`,children:e.jsx(M,{color:"primary",onClick:s,sx:{padding:"0"},children:e.jsx(ne,{})})})}];return h.pathname!=="/retirement/personnel-statements/info"&&d.push({accessorKey:"removeStatement",header:"حذف حکم",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:l})=>e.jsx(Y,{title:l.original.retirementStatementIssueConfirmDate?"حکم تایید شده":"حذف حکم",children:e.jsx("span",{children:e.jsx(M,{color:"error",disabled:!!l.original.retirementStatementIssueConfirmDate,onClick:U,sx:{padding:"0"},children:e.jsx(Oe,{})})})})}),d},[U,h.pathname]),r=je({...Le,columns:u,data:p,muiTableBodyRowProps:({row:d})=>({onClick:()=>n(()=>({[d.id]:!0})),selected:D[d.id],sx:{cursor:"pointer"}}),initialState:{density:"compact",showGlobalFilter:!0,sorting:[{id:"retirementStatementIssueDate",desc:!0}]},enablePagination:!1,enableBottomToolbar:!1,muiTableContainerProps:{sx:{height:"300px"}},renderTopToolbarCustomActions:()=>e.jsxs(te,{children:[T?e.jsx(M,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(V,{size:20,value:100})}):e.jsx(Y,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(M,{"aria-label":"refresh",color:"info",onClick:F,children:e.jsx(Be,{fontSize:"small"})})})}),T?e.jsx(M,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(V,{size:20,value:100,color:"success"})}):e.jsx(Y,{title:"صدور حکم",children:e.jsx("span",{children:e.jsx(M,{"aria-label":"refresh",color:"success",onClick:E,children:e.jsx(Ge,{fontSize:"small"})})})})]}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:d=>e.jsx(Se,{...d,page:a(d.page),slots:{previous:ge,next:ye,first:De,last:fe}})},getRowId:d=>d.id,onRowSelectionChange:n,state:{rowSelection:D}});return c.useEffect(()=>{const d=Object.keys(r.getState().rowSelection)[0];d&&t(d)},[r,D,p]),e.jsx(e.Fragment,{children:q?e.jsx("div",{className:"skeleton-lg",children:e.jsx(ke,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsxs(e.Fragment,{children:[w?e.jsxs(W,{title:"حذف حکم",closeModal:()=>x(!1),children:[e.jsx("p",{className:"paragraph-primary",children:"آیا از حذف این حکم اطمینان دارید؟"}),e.jsxs("div",{className:"flex-row flex-center",children:[e.jsx(J,{dir:"ltr",endIcon:e.jsx(X,{}),variant:"contained",onClick:m,loading:_,color:"success",children:e.jsx("span",{children:"بله"})}),e.jsx(H,{dir:"ltr",endIcon:e.jsx(oe,{}),onClick:()=>x(!1),variant:"contained",color:"error",children:e.jsx("span",{children:"خیر"})})]})]}):A?e.jsx(W,{title:"ایجاد حکم بازنشسته",closeModal:()=>g(!1),children:e.jsx(Qe,{setShowGenerateStatementModal:g,setShowStatModal:i,setStatMessage:B})}):P&&C?e.jsx(W,{closeModal:()=>b(!1),children:e.jsx(We,{statementID:C,setShowStatementModal:b})}):L?e.jsxs(W,{children:[e.jsxs("div",{className:"paragraph-primary",style:{width:"60ch",textAlign:"center",display:"flex",justifyContent:"center"},children:[e.jsx(ze,{color:"info",fontSize:"large"}),e.jsx("span",{style:{marginRight:"5px"},children:O})]}),e.jsx("div",{className:"flex-row flex-center",children:e.jsx(H,{dir:"ltr",endIcon:e.jsx(X,{}),onClick:()=>i(!1),variant:"contained",color:"success",children:e.jsx("span",{children:"تایید"})})})]}):null,e.jsx(Re,{table:r})]})})}export{yt as R,xt as a,gt as b,mt as c,ht as d,ut as e,pt as f,jt as u};
