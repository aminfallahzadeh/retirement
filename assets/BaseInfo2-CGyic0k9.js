import{di as G,dX as d,r as l,h as F,j as s,K as B,N as y,v as A,bu as Q,ax as V,k as z,dY as K}from"./index-Dnu3KgnM.js";import{c as q,S as P}from"./SelectInput-C1TMMrlV.js";import{T as R}from"./TextArea-DZGNPll0.js";import"./react-select-animated.esm-BG-Q0fZg.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";const M=G.injectEndpoints({endpoints:o=>({getLookup:o.query({query:({lookupType:n,lookupName:i})=>{let r=`${d}/GetLookup?LookupType=${n}`;return i&&(r+=`&lookUpName=${i}`),{url:r}}}),getLookupDistinct:o.query({query:()=>({url:`${d}/GetLookupDistinct`})}),insertLookup:o.mutation({query:n=>({url:`${d}/InsertLookup`,method:"POST",body:n})}),getLookupParent:o.query({query:n=>({url:`${d}/GetLookupParent?lookupType=${n}`})})})}),{useLazyGetLookupQuery:ne,useGetLookupDistinctQuery:X,useInsertLookupMutation:Y,useLazyGetLookupParentQuery:H}=M,J=()=>{var S,N;const[o,n]=l.useState([]),[i,r]=l.useState([]),{handleSubmit:T,control:u,formState:{errors:k},watch:f,reset:v,setValue:m,unregister:g}=F({defaultValues:{title:"",type:null,parent:null,description:""}}),e=f(),{data:p,isLoading:O,isSuccess:x}=X(),[h,{isLoading:D,isFetching:E}]=H(),[$,{isLoading:w}]=Y(),j=l.useCallback(async()=>{var c,a;const t=await h((c=e==null?void 0:e.type)==null?void 0:c.value).unwrap(),L=q(t.itemList,"id","lookUpName");t.itemList.length===0&&((a=e==null?void 0:e.type)!=null&&a.value)&&g("parent"),r(L)},[h,(S=e==null?void 0:e.type)==null?void 0:S.value,g]),C=async t=>{var a,b,I,U;const L={lookUpID:"string",lookUpType:(a=t.type)==null?void 0:a.value,lookUpTypeName:(b=t.type)==null?void 0:b.label,lookUpName:t.title,lookUpParentID:((I=t.parent)==null?void 0:I.value)||"",lookUpDescription:t.description,lookUpParentIDName:((U=t.parent)==null?void 0:U.label)||"",isDeleted:!1},c=await $(L).unwrap();V.success(c.message),v()};return l.useEffect(()=>{if(x){const t=q(p.itemList,"lookUpType","lookUpTypeName");n(t)}},[p==null?void 0:p.itemList,x]),l.useEffect(()=>{var t;(t=e==null?void 0:e.type)!=null&&t.value?j():(m("parent",null),r([]))},[(N=e==null?void 0:e.type)==null?void 0:N.value,j,m]),s.jsx("section",{className:"flex-col formContainer",children:s.jsxs("form",{method:"POST",className:"flex-col",onSubmit:T(C),noValidate:!0,children:[s.jsxs("div",{className:"grid grid--col-3",children:[s.jsx(B,{name:"title",label:"عنوان",control:u,required:!0,rules:y}),s.jsx(P,{name:"type",label:"نوع",options:o,control:u,rules:y,required:!0,isClearable:!0,isLoading:O,errors:k}),i&&i.length>0&&s.jsx(P,{name:"parent",label:"از مجموعه",rules:y,options:i,isLoading:D||E,control:u,required:!0,isClearable:!0,errors:k}),s.jsx(R,{name:"description",label:"شرح",control:u,required:!0,rules:y,containerClassNames:"col-span-3 row-span-2"})]}),s.jsx("div",{className:"flex mr-auto",children:s.jsx(A,{dir:"ltr",endIcon:s.jsx(Q,{}),loading:w,variant:"contained",type:"submit",color:"success",children:s.jsx("span",{children:"ذخیره"})})})]})})},ie=()=>s.jsxs("section",{className:"flex-col",children:[s.jsx(z,{title:K,back:!0}),s.jsx(J,{})]});export{ie as default};
