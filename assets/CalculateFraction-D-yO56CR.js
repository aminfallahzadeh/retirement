import{c as G,j as e,R as K,em as V,en as k,eo as B,ep as H,a as A,eq as Q,r as a,G as Z,u as F,h as W,d as v,er as J,aZ as X,a2 as r,a6 as $,a4 as l,a7 as ee,a3 as te,a5 as se,dL as ae,es as ne,et as re,n as R,eu as w,ev as oe,e as le,ew as ie,ex as ce,ey as ue,ez as D,eA as L,eB as E,eC as de}from"./index-Bdmgwo8-.js";import{o as me,p as pe,c as fe,q as xe}from"./useFetchLookUpData-DU48ceiQ.js";import{c as O,S as I}from"./SelectInput-Dczpiq9q.js";import"./sharedApi-B9V2ZfHv.js";import"./requestApi-sian_Zjm.js";import"./react-select-animated.esm-Cpt3pN8B.js";const z=G(e.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),Se=()=>[{accessorKey:"personnelStatementRowNo",header:K,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"personnelStatementSerial",header:V,size:20},{accessorKey:"orderType",header:k,size:20},{accessorKey:"personnelStatementNumber",header:B,size:20},{accessorKey:"insertTime",header:H,size:20,Cell:({renderedCellValue:t})=>e.jsx("div",{children:A(t)})},{accessorKey:"personnelStatementRunDate",header:Q,size:20,Cell:({renderedCellValue:t})=>e.jsx("div",{children:A(t)})}],he=a.memo(({personID:t,handleRowSelect:c})=>{const[m,i]=a.useState([]),[S,{isLoading:n,isFetching:o}]=me(),N=Se(),p=a.useCallback(async()=>{const f=(await S({personID:t}).unwrap()).itemList.map((s,d)=>({id:s.personnelStatementSerial,personnelStatementRowNo:d+1,personnelStatementSerial:s.personnelStatementSerial,orderType:s.orderType,personnelStatementNumber:s.personnelStatementID,insertTime:s.insertTime,personnelStatementRunDate:s.personnelStatementRunDate}));i(f)},[S,t]);return a.useEffect(()=>{t?p():i([])},[t,p]),e.jsx(Z,{data:m,columns:N,isLoading:n,isFetching:o,scroll:!1,onRowSelect:c})}),Ne=()=>{const[t,c]=a.useState(null),[m,i]=a.useState(null),S=F(),n=W(),{control:o,handleSubmit:N,formState:{errors:p},trigger:j,watch:f,setValue:s}=v(),d=f("personNationalCode"),[u,{isLoading:y,isFetching:T}]=J(),{personnelStatementOffTypes:g,personnelStatementOffTypesIsLoading:_}=pe(),{organizations:b,organizationIsLoading:q}=fe({}),M=a.useMemo(()=>O(g,"personnelStatementOffTypeID","personnelStatementOffTypeName"),[g]),P=a.useMemo(()=>O(b,"organizationID","organizationName"),[b]),U=a.useCallback(h=>{i(h)},[]),Y=h=>{S(oe({...h,serial:m})),n("/retirement/fraction/calculate/2")},C=a.useCallback(async()=>{const x=(await u({personNationalCode:X(d)}).unwrap()).itemList[0];x&&(s("personFirstName",x.personFirstName),s("personLastName",x.personLastName),s("personnelID",x.personnelID),c(x.personID))},[d,u,s]);return a.useEffect(()=>{d?(async()=>{await j("personNationalCode")?C():(s("personFirstName",""),s("personLastName",""),s("personnelID",""),c(null),i(null))})():(s("personFirstName",""),s("personLastName",""),s("personnelID",""),c(null),i(null))},[j,C,d,s]),e.jsx(e.Fragment,{children:e.jsx("section",{className:"flex-col",children:e.jsxs("form",{id:"authorize-form",method:"POST",className:"flex-col formContainer",onSubmit:N(Y),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(r,{name:"personNationalCode",label:$,rules:{...l,...ee},required:!0,control:o,type:"text"}),e.jsx(r,{name:"personFirstName",label:te,required:!1,editable:!1,control:o,isLoading:y||T,type:"text"}),e.jsx(r,{name:"personLastName",label:se,required:!1,editable:!1,control:o,isLoading:y||T,type:"text"}),e.jsx(r,{name:"personnelID",label:ae,required:!1,editable:!1,control:o,isLoading:y||T,type:"text"}),e.jsx(I,{name:"statementType",control:o,label:ne,required:!0,isClearable:!0,options:M,isLoading:_,rules:l,errors:p}),e.jsx(I,{name:"organizationID",control:o,label:re,required:!0,isClearable:!0,options:P,isLoading:q,rules:l,errors:p})]}),e.jsx(he,{personID:t,handleRowSelect:U}),e.jsx("div",{className:"flex-row ml-auto",children:e.jsx(R,{dir:"ltr",disabled:!m,endIcon:e.jsx(z,{}),variant:"contained",type:"submit",color:"success",children:e.jsx("span",{children:w})})})]})})})},je=()=>{const{control:t,handleSubmit:c,formState:{errors:m},trigger:i,setValue:S}=v(),{fractionData:n}=le(u=>u.fraction);F();const[o,{isLoading:N,isFetching:p,isSuccess:j}]=xe(),f=a.useCallback(async()=>{const u=await o({personNationalCode:n.personNationalCode,personnelStatementOffTypeID:n.statementType.value,organizationID:n.organizationID.value,numberOfInstallments:0,personnelStatementSerialNO:parseInt(n.serial),periods:null,save:!1}).unwrap();console.log("CALCULATION",u)},[o,n]),s=async u=>{console.log(u)};return a.useEffect(()=>{n&&f()},[n,f]),a.useEffect(()=>{console.log(n)},[n]),e.jsx("section",{className:"flex-col",children:e.jsxs("form",{id:"authorize-form",method:"POST",className:"flex-col formContainer",onSubmit:c(s),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(r,{name:"includedAmount",label:ie,rules:l,required:!0,control:t,type:"text"}),e.jsx(r,{name:"transferredAmount",label:ce,rules:l,required:!0,control:t,type:"text"})]}),e.jsx("div",{className:"Modal__header flex justify-center items-center",children:e.jsx("h4",{className:"title-secondary",children:ue})}),e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("h1",{children:"تاریخ از :"})}),e.jsx(r,{name:"startYear",label:D,rules:l,required:!0,control:t,type:"text"}),e.jsx(r,{name:"startMonth",label:L,rules:l,required:!0,control:t,type:"text"}),e.jsx(r,{name:"startDay",label:E,rules:l,required:!0,control:t,type:"text"}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("h1",{children:"تاریخ تا :"})}),e.jsx(r,{name:"endYear",label:D,rules:l,required:!0,control:t,type:"text"}),e.jsx(r,{name:"endMonth",label:L,rules:l,required:!0,control:t,type:"text"}),e.jsx(r,{name:"endDay",label:E,rules:l,required:!0,control:t,type:"text"})]}),e.jsx("div",{className:"flex-row ml-auto",children:e.jsx(R,{dir:"ltr",endIcon:e.jsx(z,{}),variant:"contained",type:"submit",color:"success",children:e.jsx("span",{children:w})})})]})})},De=()=>{const{step:t}=de();return(i=>{switch(i){case"1":return e.jsx(Ne,{});case"2":return e.jsx(je,{});default:return null}})(t)};export{De as default};
