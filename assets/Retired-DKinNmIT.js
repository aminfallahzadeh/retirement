import{v as Hs,r as o,j as e,w as dn,x as Ds,d as ps,y as Is,z,A as f,n as De,S as Ys,t as d,q as le,D as bs,F as vs,B as Be,I as oe,C as ve,T as ye,P as Ss,H as Bs,J as _s,K as ks,M as Ps,N as Os,Q as Xs,U as Te,V as mn,W as hn,X as xn,m as en,Y as Ns,L as Bn,E as gn,Z as Qs,_ as _n,$ as Js,a0 as sn,u as kn,a1 as Pn,a2 as On,a3 as pn,a4 as X,a5 as Mn,a6 as Ce,a7 as Fn,a8 as Ln,a9 as Rn,aa as Tn,ab as fe,ac as An,ad as ys,ae as En,af as Un,ag as qn,ah as wn,ai as $n,aj as zn,ak as Hn,al as Yn,am as Kn,an as Gn,ao as Wn,ap as Vn,aq as Qn,ar as Jn,as as Zn,at as Xn,au as ea,av as sa,aw as na,ax as aa,ay as ta,az as oa,aA as la,aB as ra,aC as ia,aD as ca,aE as pa,aF as ua,aG as da,aH as ma,aI as ha,aJ as xa,aK as ga,aL as nn,aM as an,aN as me,aO as tn,R as ja,aP as Zs,aQ as Na,a as fa,G as ya,e as jn,aR as Ia,aS as ba,aT as Ca,aU as Da,aV as va,aW as Sa,aX as Ba,aY as _a,aZ as ka,a_ as Pa,a$ as Oa,b0 as Ma,b1 as Fa,b2 as La,b3 as Ra,b4 as Ta,b5 as Aa,b6 as Ea,b7 as Ua,b8 as qa,b9 as wa,ba as $a,bb as za,bc as Ha,bd as As,be as Ya,bf as Ka,bg as Ga,bh as Wa,bi as Va}from"./index-DJK9IeUF.js";import{u as Qa,a as Ja,c as Za,F as Xa}from"./createTree-CcHoGTA0.js";import{T as et}from"./Title-CRhYWHj_.js";/* empty css                 */import{M as cs}from"./Modal-t-ukfsq1.js";import{u as Ks,a as Ms,b as J,o as W,s as j,c as V,d as st}from"./reactSelect-BYLVe-bJ.js";import{u as Fs,m as pe,C as ue,d as xe,a as he}from"./datePicker-BNbUM7SM.js";import{i as Gs,S as Q}from"./react-select-animated.esm-BvZj5eF1.js";import{d as Ls}from"./table-options-Ci-UR94l.js";import{R as Rs}from"./Refresh-DDBBxFuN.js";import{S as Ws}from"./index-BMwDjv4D.js";import{E as Ts}from"./EditOutlined-BHbxU6IM.js";import{D as Nn}from"./DeleteOutline-7y_q0vRl.js";import{A as fn}from"./Add-DvNqVgKc.js";import{R as nt}from"./RetiredStatementsGrid-B9uDYwbd.js";import{u as on}from"./sharedApi-JGaVM8VT.js";import{b as at}from"./requestApi-HUB0tuMW.js";import{u as tt,S as ot}from"./SlipFormTemplate-JD1nbEK9.js";import{c as Ie,S as be}from"./SelectInput-B6aD3pdf.js";import{T as un}from"./TextArea-LbFmkN5a.js";import{D as ln}from"./DoneOutlined-B9L-7HaQ.js";import{A as Es,a as Us,b as qs,c as ws}from"./ArrowDropDown-Cs07E8eo.js";import{T as lt,a as rt,b as $s}from"./TabPanel-8xWApq02.js";import"./index-DFQ--eb2.js";import"./InfoOutlined-ChAl06oK.js";import"./statementApi-kaHuQzFr.js";import"./module-qOXTKfHs.js";import"./excel-icon-Dq0N6FeV.js";const it=()=>{const[l]=Hs(),[m,y]=o.useState([]),[B,C]=o.useState([]),x=l.get("personID"),{data:R,isLoading:p,isSuccess:L,refetch:h}=Qa(),{data:A,isLoading:S,isSuccess:E,refetch:P}=Ja(x);o.useEffect(()=>{E&&C(A.itemList)},[E,A]),o.useEffect(()=>{if(L){const $=Za(R.itemList);y($)}},[L,R]);const w=o.useCallback(()=>{h(),P()},[h,P]);return e.jsx(Xa,{structure:m,files:B,isLoading:p||S,refetch:w,access:"files"})},ct=dn.injectEndpoints({endpoints:l=>({getRelatedListByParentPersonID:l.query({query:m=>({url:`${Ds}/GetRelatedListByParentPersonID?parentPersonID=${m}`})}),getRelated:l.query({query:m=>({url:`${Ds}/GetRelated?personID=${m}`})}),insertRelated:l.mutation({query:m=>({url:`${Ds}/InsertRelated`,method:"POST",body:m})}),updateRelated:l.mutation({query:m=>({url:`${Ds}/UpdateRelated`,method:"POST",body:m})}),removeRelated:l.mutation({query:({pensionaryID:m})=>({url:`${Ds}/RemoveRelated?pensionaryID=${m}`,method:"POST"})})})}),{useGetRelatedListByParentPersonIDQuery:pt,useGetRelatedQuery:ut,useInsertRelatedMutation:dt,useUpdateRelatedMutation:mt,useRemoveRelatedMutation:ht}=ct;function xt({setShowCreateRelatedModal:l,refetch:m}){const y=o.useRef(null),B=o.useRef(null),C=o.useRef(null),x=o.useRef(null),R=o.useRef(null),[p,L]=o.useState(null),[h,A]=o.useState(null),[S,E]=o.useState(null),[P,w]=o.useState(null),[$,H]=o.useState(null),[ee,c]=o.useState(!1),[F,O]=o.useState(!1),[Y,n]=o.useState(!1),[u,T]=o.useState(!1),[U,ae]=o.useState(!1),{handleSubmit:ne,formState:{errors:s},control:Z,register:_,watch:i}=ps(),t=i(),[r,{isLoading:D}]=dt(),K=Is(),G=new URLSearchParams(K.search).get("personID"),re=Gs(),{relationships:de,relationshipIsLoading:as,relationshipIsFetching:se}=Ks(),{pensionaryStatus:te,pensionaryStatusIsLoading:ce,pensionaryStatusIsFetching:Ae}=Ms({pensionaryStatusCategory:"L"}),{lookUpItems:ts,lookUpItemsIsLoading:Oe,lookUpItemsIsFetching:ie}=J({lookUpType:"MaritialStatus"}),{lookUpItems:_e,lookUpItemsIsLoading:Ee,lookUpItemsIsFetching:os}=J({lookUpType:"EducationType"}),{lookUpItems:ls,lookUpItemsIsLoading:Ue,lookUpItemsIsFetching:ge}=J({lookUpType:"UniversityType"}),{lookUpItems:rs,lookUpItemsIsLoading:qe,lookUpItemsIsFetching:we}=J({lookUpType:"Country"}),{lookUpItems:$e,lookUpItemsIsLoading:ze,lookUpItemsIsFetching:He}=J({lookUpType:"State"}),{lookUpItems:Ye,lookUpItemsIsLoading:Ke,lookUpItemsIsFetching:Ge}=J({lookUpType:"City"}),Me=W(de,"relationshipID","relationshipName"),We=W(te,"pensionaryStatusID","pensionaryStatusName"),Ve=W(ts,"lookUpID","lookUpName"),Qe=W(_e,"lookUpID","lookUpName"),Je=W(ls,"lookUpID","lookUpName"),Ze=W(rs,"lookUpID","lookUpName"),Xe=W($e,"lookUpID","lookUpName"),Fe=W(Ye,"lookUpID","lookUpName"),is=M=>{L(M),O(!1)},q=M=>{A(M),n(!1)},N=M=>{E(M),T(!1)},je=M=>{w(M),ae(!1)},Ne=M=>{H(M),c(!1)},es=M=>{O(M)},us=M=>{n(M)},Le=M=>{c(M)},ds=M=>{T(M)},ms=M=>{ae(M)},hs=async()=>{var M;try{let I,Se,ke,Re,v;p?(I=new Date(p),I.setMinutes(I.getMinutes()-I.getTimezoneOffset())):I=null,$?(v=new Date($),v.setMinutes(v.getMinutes()-v.getTimezoneOffset())):v=null,h?(Se=new Date(h),Se.setMinutes(Se.getMinutes()-Se.getTimezoneOffset())):Se=null,S?(ke=new Date(S),ke.setMinutes(ke.getMinutes()-ke.getTimezoneOffset())):ke=null,P?(Re=new Date(P),Re.setMinutes(Re.getMinutes()-Re.getTimezoneOffset())):Re=null;const g=await r({...t,parentPersonID:G,relationshipWithParentID:d(t.relationshipWithParentID),personCertificateNo:d(t.personCertificateNo),personNationalCode:d(t.personNationalCode),pensionaryStatusID:d(t.pensionaryStatusID),maritalStatusID:d(t.maritalStatusID),educationTypeID:d(t.educationTypeID),universityID:d(t.universityID),personPhone:d(t.personPhone),personCellPhone:d(t.personCellPhone),personCellPhone2:d(t.personCellPhone2),personRegion:parseInt(d(t.personRegion))||null,personArea:parseInt(d(t.personArea))||null,personCountryID:d(t.personCountryID),personCityID:d(t.personCityID),personStateID:d(t.personStateID),personPostalCode:d(t.personPostalCode),backupPhone:d(t.backupPhone),backupCellphone:d(t.backupCellphone),personBirthDate:I,personMaritalDate:Se,selfEmployeeStartDate:ke,selfEmployeeEndDate:Re,pensionaryStartDate:v}).unwrap();l(!1),m(),le.success(g.message,{autoClose:2e3})}catch(I){console.log(I),le.error(((M=I==null?void 0:I.data)==null?void 0:M.message)||I.error,{autoClose:2e3})}};return Fs([y,B,C,x,R],[O,n,T,ae,c]),e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:ne(hs),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"relationshipWithParentID",control:Z,rules:{required:!0},render:({field:{onChange:M}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:re,options:Me,onChange:I=>M(I?I.value:null),value:Me.find(I=>I.value===(t==null?void 0:t.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:as||se})}),e.jsxs("label",{className:t!=null&&t.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),s.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personFirstName&&e.jsx("span",{className:"error-form",children:s.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.personFirstName)||"",name:"personFirstName",id:"personFirstName1",required:!0,..._("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName1",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personLastName&&e.jsx("span",{className:"error-form",children:s.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.personLastName)||"",name:"personLastName",id:"personLastName1",required:!0,..._("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personNationalCode&&e.jsx("span",{className:"error-form",children:s.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(t==null?void 0:t.personNationalCode)??"",name:"personNationalCode",id:"personNationalCode2",required:!0,..._("personNationalCode",{required:"کد ملی را وارد کنید",minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personCertificateNo&&e.jsx("span",{className:"error-form",children:s.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(t==null?void 0:t.personCertificateNo)??"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,..._("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificateNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personFatherName&&e.jsx("span",{className:"error-form",children:s.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,..._("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:p,onChange:is,format:"jYYYY/jMM/jDD",onOpenChange:es,suffixIcon:e.jsx(ue,{color:"action"}),open:F,style:xe,wrapperStyle:he,pickerProps:{ref:y}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:h,onChange:q,format:"jYYYY/jMM/jDD",onOpenChange:us,suffixIcon:e.jsx(ue,{color:"action"}),open:Y,style:xe,wrapperStyle:he,pickerProps:{ref:B}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ عقد"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personBirthPlace&&e.jsx("span",{className:"error-form",children:s.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.personBirthPlace)||"",name:"personBirthPlace",id:"personBirthPlace1",required:!0,..._("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"pensionaryStatusID",control:Z,rules:{required:!0},render:({field:{onChange:M}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:re,options:We,onChange:I=>M(I?I.value:null),value:We.find(I=>I.value===(t==null?void 0:t.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت وابسته"]}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:ce||Ae})}),e.jsxs("label",{className:t!=null&&t.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت وابسته"]}),s.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:"وضعیت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:$,defaultValue:null,onChange:Ne,onOpenChange:Le,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(ue,{color:"action"}),open:ee,style:xe,wrapperStyle:he,pickerProps:{ref:R}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"maritalStatusID",control:Z,render:({field:{onChange:M}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:re,options:Ve,onChange:I=>M(I?I.value:null),value:Ve.find(I=>I.value===(t==null?void 0:t.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:Oe||ie})}),e.jsx("label",{className:t!=null&&t.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"educationTypeID",control:Z,render:({field:{onChange:M}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:re,options:Qe,onChange:I=>M(I?I.value:null),value:Qe.find(I=>I.value===(t==null?void 0:t.educationTypeID)),name:"educationTypeID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"مدرک تحصیلی"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:Ee||os})}),e.jsx("label",{className:t!=null&&t.educationTypeID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"مدرک تحصیلی"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.educationTypeCaption&&e.jsx("span",{className:"error-form",children:s.educationTypeCaption.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.educationTypeCaption)||"",name:"educationTypeCaption",id:"educationTypeCaption",required:!0,..._("educationTypeCaption",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"educationTypeCaption",children:"عنوان مدرک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"universityID",control:Z,render:({field:{onChange:M}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:re,options:Je,onChange:I=>M(I?I.value:null),value:Je.find(I=>I.value===(t==null?void 0:t.universityID)),name:"universityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"دانشگاه"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:Ue||ge})}),e.jsx("label",{className:t!=null&&t.universityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"دانشگاه"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.universityCaption&&e.jsx("span",{className:"error-form",children:s.universityCaption.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(t==null?void 0:t.universityCaption)||"",name:"universityCaption",id:"universityCaption",required:!0,..._("universityCaption",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"universityCaption",children:"واحد دانشگاهی"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personCellPhone&&e.jsx("span",{className:"error-form",children:s.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone",value:(t==null?void 0:t.personCellPhone)||"",id:"personCellPhone1",required:!0,..._("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone1",children:"تلفن همراه ۱"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personCellPhone2&&e.jsx("span",{className:"error-form",children:s.personCellPhone2.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone2",value:(t==null?void 0:t.personCellPhone2)||"",id:"personCellPhone22",required:!0,..._("personCellPhone2",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone22",children:"تلفن همراه ۲"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personPhone&&e.jsx("span",{className:"error-form",children:s.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPhone",value:(t==null?void 0:t.personPhone)||"",id:"personPhone1",required:!0,..._("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"},maxLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone1",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personRegion&&e.jsx("span",{className:"error-form",children:s.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personRegion",value:(t==null?void 0:t.personRegion)||"",id:"personRegion1",required:!0,..._("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personArea&&e.jsx("span",{className:"error-form",children:s.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personArea",value:(t==null?void 0:t.personArea)||"",id:"personArea1",required:!0,..._("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCountryID",control:Z,render:({field:{onChange:M}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:re,options:Ze,onChange:I=>M(I?I.value:null),value:Ze.find(I=>I.value===(t==null?void 0:t.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:qe||we})}),e.jsx("label",{className:t!=null&&t.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personStateID",control:Z,render:({field:{onChange:M}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:re,options:Xe,onChange:I=>M(I?I.value:null),value:Xe.find(I=>I.value===(t==null?void 0:t.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:ze||He})}),e.jsx("label",{className:t!=null&&t.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCityID",control:Z,render:({field:{onChange:M}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:re,options:Fe,onChange:I=>M(I?I.value:null),value:Fe.find(I=>I.value===(t==null?void 0:t.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:Ke||Ge})}),e.jsx("label",{className:t!=null&&t.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personPostalCode&&e.jsx("span",{className:"error-form",children:s.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPostalCode",value:(t==null?void 0:t.personPostalCode)??"",id:"personPostalCode1",required:!0,..._("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.personSpecialDisease&&e.jsx("span",{className:"error-form",children:s.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personSpecialDisease",value:(t==null?void 0:t.personSpecialDisease)||"",id:"personSpecialDisease1",required:!0,..._("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[s.personAddress&&e.jsx("span",{className:"error-form",children:s.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personAddress",value:(t==null?void 0:t.personAddress)||"",id:"personAddress1",required:!0,..._("personAddress",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف و اعداد فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[s.personDescription&&e.jsx("span",{className:"error-form",children:s.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",required:!0,name:"personDescription",value:(t==null?void 0:t.personDescription)||"",id:"personDescription1",..._("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription1",children:"توضیحات"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات خویش فرمایی"})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form col-span-2",children:[s.selfEmployeeTypeName&&e.jsx("span",{className:"error-form",children:s.selfEmployeeTypeName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"selfEmployeeTypeName",value:(t==null?void 0:t.selfEmployeeTypeName)||"",id:"selfEmployeeTypeName",required:!0,..._("selfEmployeeTypeName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"selfEmployeeTypeName",children:"وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:S,onChange:N,format:"jYYYY/jMM/jDD",onOpenChange:ds,suffixIcon:e.jsx(ue,{color:"action"}),open:u,style:xe,wrapperStyle:he,pickerProps:{ref:C}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ شروع"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:P,onChange:je,format:"jYYYY/jMM/jDD",onOpenChange:ms,suffixIcon:e.jsx(ue,{color:"action"}),open:U,wrapperStyle:he,pickerProps:{ref:x}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ پایان"})]}),e.jsxs("div",{className:"inputBox__form col-span-4",children:[s.selfEmployeeDesc&&e.jsx("span",{className:"error-form",children:s.selfEmployeeDesc.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",name:"selfEmployeeDesc",value:(t==null?void 0:t.selfEmployeeDesc)||"",id:"selfEmployeeDesc",required:!0,..._("selfEmployeeDesc",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف و اعداد فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"selfEmployeeDesc",children:"توضیحات"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:"اطلاعات پشتیبان"})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[s.backupFirstName&&e.jsx("span",{className:"error-form",children:s.backupFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupFirstName",value:(t==null?void 0:t.backupFirstName)||"",id:"backupFirstName1",required:!0,..._("backupFirstName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupFirstName1",children:"نام"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.backupLastName&&e.jsx("span",{className:"error-form",children:s.backupLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupLastName",value:(t==null?void 0:t.backupLastName)||"",id:"backupLastName1",required:!0,..._("backupLastName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupLastName1",children:"نام خانوادگی"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.backupRelation&&e.jsx("span",{className:"error-form",children:s.backupRelation.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupRelation",value:(t==null?void 0:t.backupRelation)||"",id:"backupRelation",required:!0,..._("backupRelation",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupRelation",children:"نسبت"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.backupPhone&&e.jsx("span",{className:"error-form",children:s.backupPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupPhone",value:(t==null?void 0:t.backupPhone)||"",id:"backupPhone",required:!0,..._("backupPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"},maxLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupPhone",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[s.backupCellphone&&e.jsx("span",{className:"error-form",children:s.backupCellphone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupCellphone",value:(t==null?void 0:t.backupCellphone)||"",id:"backupCellphone",required:!0,..._("backupCellphone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن همراه باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه ثابت باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه ثابت باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupCellphone",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[s.backupAddress&&e.jsx("span",{className:"error-form",children:s.backupAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupAddress",value:(t==null?void 0:t.backupAddress)||"",id:"backupAddress",required:!0,..._("backupAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupAddress",children:"نشانی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(De,{dir:"ltr",endIcon:e.jsx(Ys,{}),onClick:ne,loading:D,type:"submit",variant:"contained",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})}function yn({statusHistoryTableData:l,isLoading:m,isFetching:y,handleRefresh:B}){const[C,x]=o.useState({pageIndex:0,pageSize:3}),R=o.useMemo(()=>[{accessorKey:"pensionaryStatusRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:h})=>e.jsx("div",{children:f(h)})},{accessorKey:"pensionaryStatusName",header:"وضعیت",size:20,Cell:({renderedCellValue:h})=>e.jsx("div",{children:f(h)})},{accessorKey:"pensionaryStartdate",header:"تاریخ شروع",size:20,Cell:({renderedCellValue:h})=>e.jsx("div",{children:bs(h)})},{accessorKey:"isActive",header:"وضعیت",size:20,Cell:({renderedCellValue:h})=>e.jsx("div",{children:h===!0?"فعال":"غیرفعال"})}],[]),p=vs({...Ls,columns:R,data:l,muiTopToolbarProps:{sx:{overflow:"none"}},muiTableBodyRowProps:({row:h})=>({sx:{color:h.original.isActive?"#087a30":"","& td":{color:h.original.isActive?"#087a30":""}}}),muiTableHeadProps:{sx:{zIndex:0}},renderTopToolbarCustomActions:()=>e.jsx(Be,{children:m||y?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ve,{size:20,value:100})}):e.jsx(ye,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"info",onClick:B,children:e.jsx(Rs,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:h=>e.jsx(Ss,{...h,page:f(h.page),slots:{previous:Bs,next:_s,first:ks,last:Ps}})},initialState:{density:"compact",sorting:[{id:"isActive",desc:!0}]},onPaginationChange:x,state:{pagination:C}});return e.jsx(Os,{table:p})}function gt({setShowEditRelatedModal:l,personID:m,refetch:y}){const B=o.useRef(null),C=o.useRef(null),x=o.useRef(null),R=o.useRef(null),p=o.useRef(null),[L,h]=o.useState(null),[A,S]=o.useState(null),[E,P]=o.useState(null),[w,$]=o.useState(null),[H,ee]=o.useState(null),[c,F]=o.useState(!1),[O,Y]=o.useState(!1),[n,u]=o.useState(!1),[T,U]=o.useState(!1),[ae,ne]=o.useState(!1),[s,Z]=o.useState([]),{handleSubmit:_,formState:{errors:i},control:t,register:r,watch:D,setValue:K}=ps(),a=D(),[G,{isLoading:re}]=mt(),de=Gs(),se=new URLSearchParams(location.search).get("personID"),{data:te,isSuccess:ce,isLoading:Ae,isFetching:ts,refetch:Oe,error:ie}=Xs(m),{data:_e,isSuccess:Ee,isFetching:os,isLoading:ls,refetch:Ue,error:ge}=ut(m);o.useEffect(()=>{if(Oe(),ce){const k=te==null?void 0:te.itemList.map((b,ns)=>({id:b.pensionaryID,pensionaryStatusRowNum:ns+1,isActive:b.pensionaryIsActive,pensionaryStatusName:b.pensionaryStatusName||"-",pensionaryStartdate:Te(b.pensionaryStartdate)||"-"}));Z(k)}return()=>{Z([])}},[Oe,ce,te]),o.useEffect(()=>{Ue(),Ee&&Object.keys(_e).forEach(k=>{K(k,_e[k])})},[Ee,_e,Ue,K]),o.useEffect(()=>{var k;ge&&ge.status!=="FETCH_ERROR"&&le.error(((k=ge==null?void 0:ge.data)==null?void 0:k.message)||ge.error,{autoClose:2e3})},[ge]),o.useEffect(()=>{var k;ie&&(console.log(ie),le.error(((k=ie==null?void 0:ie.data)==null?void 0:k.message)||ie.error,{autoClose:2e3}))},[ie]);const{relationships:rs,relationshipIsLoading:qe,relationshipIsFetching:we}=Ks(),{pensionaryStatus:$e,pensionaryStatusIsLoading:ze,pensionaryStatusIsFetching:He}=Ms({pensionaryStatusCategory:"L"}),{lookUpItems:Ye,lookUpItemsIsLoading:Ke,lookUpItemsIsFetching:Ge}=J({lookUpType:"MaritialStatus"}),{lookUpItems:Me,lookUpItemsIsLoading:We,lookUpItemsIsFetching:Ve}=J({lookUpType:"EducationType"}),{lookUpItems:Qe,lookUpItemsIsLoading:Je,lookUpItemsIsFetching:Ze}=J({lookUpType:"UniversityType"}),{lookUpItems:Xe,lookUpItemsIsLoading:Fe,lookUpItemsIsFetching:is}=J({lookUpType:"Country"}),{lookUpItems:q,lookUpItemsIsLoading:N,lookUpItemsIsFetching:je}=J({lookUpType:"State"}),{lookUpItems:Ne,lookUpItemsIsLoading:es,lookUpItemsIsFetching:us}=J({lookUpType:"City"}),Le=W(rs,"relationshipID","relationshipName"),ds=W($e,"pensionaryStatusID","pensionaryStatusName"),ms=W(Ye,"lookUpID","lookUpName"),hs=W(Me,"lookUpID","lookUpName"),Cs=W(Qe,"lookUpID","lookUpName"),M=W(Xe,"lookUpID","lookUpName"),I=W(q,"lookUpID","lookUpName"),Se=W(Ne,"lookUpID","lookUpName"),ke=k=>{h(k),F(!1)},Re=k=>{S(k),Y(!1)},v=k=>{P(k),u(!1)},g=k=>{$(k),U(!1)},Pe=k=>{ee(k),ne(!1)},ss=k=>{ne(k)},Vs=k=>{F(k)},bn=k=>{Y(k)},Cn=k=>{u(k)},Dn=k=>{U(k)};o.useEffect(()=>{h(Te(a==null?void 0:a.personBirthDate))},[a==null?void 0:a.personBirthDate]),o.useEffect(()=>{S(Te(a==null?void 0:a.personMaritalDate))},[a==null?void 0:a.personMaritalDate]),o.useEffect(()=>{P(Te(a==null?void 0:a.selfEmployeeStartDate))},[a==null?void 0:a.selfEmployeeStartDate]),o.useEffect(()=>{$(Te(a==null?void 0:a.selfEmployeeEndDate))},[a==null?void 0:a.selfEmployeeEndDate]);const vn=()=>{Oe()},Sn=async()=>{var k;try{let b,ns,xs,gs,js;L?(b=new Date(L),b.setMinutes(b.getMinutes()-b.getTimezoneOffset())):b=null,H?(js=new Date(H),js.setMinutes(js.getMinutes()-js.getTimezoneOffset())):js=null,A?(ns=new Date(A),ns.setMinutes(ns.getMinutes()-ns.getTimezoneOffset())):ns=null,E?(xs=new Date(E),xs.setMinutes(xs.getMinutes()-xs.getTimezoneOffset())):xs=null,w?(gs=new Date(w),gs.setMinutes(gs.getMinutes()-gs.getTimezoneOffset())):gs=null;const cn=await G({...a,parentPersonID:se,relationshipWithParentID:d(a.relationshipWithParentID),personCertificateNo:d(a.personCertificateNo),personNationalCode:d(a.personNationalCode),pensionaryStatusID:d(a.pensionaryStatusID),maritalStatusID:d(a.maritalStatusID),educationTypeID:d(a.educationTypeID),universityID:d(a.universityID),personPhone:d(a.personPhone),personCellPhone:d(a.personCellPhone),personCellPhone2:d(a.personCellPhone2),personRegion:parseInt(d(a.personRegion))||null,personArea:parseInt(d(a.personArea))||null,personCountryID:d(a.personCountryID),personCityID:d(a.personCityID),personStateID:d(a.personStateID),personPostalCode:d(a.personPostalCode),backupPhone:d(a.backupPhone),backupCellphone:d(a.backupCellphone),personBirthDate:b,personMaritalDate:ns,selfEmployeeStartDate:xs,selfEmployeeEndDate:gs,pensionaryStartDate:js}).unwrap();console.log(cn),l(!1),y(),le.success(cn.message,{autoClose:2e3})}catch(b){console.log(b),le.error(((k=b==null?void 0:b.data)==null?void 0:k.message)||b.error,{autoClose:2e3})}};return Fs([B,C,x,R,p],[F,Y,u,U,ne]),e.jsx(e.Fragment,{children:ls||os?e.jsx(Be,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ve,{color:"primary"})}):e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:_(Sn),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"relationshipWithParentID",control:t,rules:{required:!0},render:({field:{onChange:k}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:de,options:Le,onChange:b=>k(b?b.value:null),value:Le.find(b=>b.value===(a==null?void 0:a.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:qe||we})}),e.jsxs("label",{className:a!=null&&a.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),i.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personFirstName&&e.jsx("span",{className:"error-form",children:i.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.personFirstName)||"",name:"personFirstName",id:"personFirstName2",required:!0,...r("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName2",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personLastName&&e.jsx("span",{className:"error-form",children:i.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.personLastName)||"",name:"personLastName",id:"personLastName1",required:!0,...r("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personNationalCode&&e.jsx("span",{className:"error-form",children:i.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(a==null?void 0:a.personNationalCode)??"",name:"personNationalCode",id:"personNationalCode2",required:!0,...r("personNationalCode",{required:"کد ملی را وارد کنید",minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personCertificateNo&&e.jsx("span",{className:"error-form",children:i.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(a==null?void 0:a.personCertificateNo)??"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,...r("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificateNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personFatherName&&e.jsx("span",{className:"error-form",children:i.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,...r("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:Te(L),onChange:ke,format:"jYYYY/jMM/jDD",onOpenChange:Vs,suffixIcon:e.jsx(ue,{color:"action"}),open:c,style:xe,wrapperStyle:he,pickerProps:{ref:B}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:A,onChange:Re,format:"jYYYY/jMM/jDD",onOpenChange:bn,suffixIcon:e.jsx(ue,{color:"action"}),open:O,style:xe,wrapperStyle:he,pickerProps:{ref:C}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ عقد"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personBirthPlace&&e.jsx("span",{className:"error-form",children:i.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.personBirthPlace)||"",name:"personBirthPlace",id:"personBirthPlace1",required:!0,...r("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"pensionaryStatusID",control:t,rules:{required:!0},render:({field:{onChange:k}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:de,options:ds,onChange:b=>k(b?b.value:null),value:ds.find(b=>b.value===(a==null?void 0:a.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت وابسته"]}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:ze||He})}),e.jsxs("label",{className:a!=null&&a.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت وابسته"]}),i.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:"وضعیت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:H,defaultValue:null,onChange:Pe,onOpenChange:ss,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(ue,{color:"action"}),open:ae,style:xe,wrapperStyle:he,pickerProps:{ref:p}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"maritalStatusID",control:t,render:({field:{onChange:k}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:de,options:ms,onChange:b=>k(b?b.value:null),value:ms.find(b=>b.value===(a==null?void 0:a.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:Ke||Ge})}),e.jsx("label",{className:a!=null&&a.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"educationTypeID",control:t,render:({field:{onChange:k}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:de,options:hs,onChange:b=>k(b?b.value:null),value:hs.find(b=>b.value===(a==null?void 0:a.educationTypeID)),name:"educationTypeID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"مدرک تحصیلی"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:We||Ve})}),e.jsx("label",{className:a!=null&&a.educationTypeID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"مدرک تحصیلی"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.educationTypeCaption&&e.jsx("span",{className:"error-form",children:i.educationTypeCaption.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.educationTypeCaption)||"",name:"educationTypeCaption",id:"educationTypeCaption",required:!0,...r("educationTypeCaption",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"educationTypeCaption",children:"عنوان مدرک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"universityID",control:t,render:({field:{onChange:k}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:de,options:Cs,onChange:b=>k(b?b.value:null),value:Cs.find(b=>b.value===(a==null?void 0:a.universityID)),name:"universityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"دانشگاه"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:Je||Ze})}),e.jsx("label",{className:a!=null&&a.universityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"دانشگاه"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.universityCaption&&e.jsx("span",{className:"error-form",children:i.universityCaption.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(a==null?void 0:a.universityCaption)||"",name:"universityCaption",id:"universityCaption",required:!0,...r("universityCaption",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"universityCaption",children:"واحد دانشگاهی"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personCellPhone&&e.jsx("span",{className:"error-form",children:i.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone",value:f(a==null?void 0:a.personCellPhone)??"",id:"personCellPhone1",required:!0,...r("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone1",children:"تلفن همراه ۱"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personCellPhone2&&e.jsx("span",{className:"error-form",children:i.personCellPhone2.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone2",value:f(a==null?void 0:a.personCellPhone2)??"",id:"personCellPhone22",required:!0,...r("personCellPhone2",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone22",children:"تلفن همراه ۲"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personPhone&&e.jsx("span",{className:"error-form",children:i.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPhone",value:f(a==null?void 0:a.personPhone)||"",id:"personPhone1",required:!0,...r("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"},maxLength:{value:8,message:"تلفن ثابت باید ۸ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone1",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personRegion&&e.jsx("span",{className:"error-form",children:i.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personRegion",value:f(a==null?void 0:a.personRegion)??"",id:"personRegion1",required:!0,...r("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personArea&&e.jsx("span",{className:"error-form",children:i.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personArea",value:f(a==null?void 0:a.personArea)??"",id:"personArea1",required:!0,...r("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCountryID",control:t,render:({field:{onChange:k}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:de,options:M,onChange:b=>k(b?b.value:null),value:M.find(b=>b.value===(a==null?void 0:a.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:Fe||is})}),e.jsx("label",{className:a!=null&&a.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personStateID",control:t,render:({field:{onChange:k}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:de,options:I,onChange:b=>k(b?b.value:null),value:I.find(b=>b.value===(a==null?void 0:a.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:N||je})}),e.jsx("label",{className:a!=null&&a.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCityID",control:t,render:({field:{onChange:k}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:de,options:Se,onChange:b=>k(b?b.value:null),value:Se.find(b=>b.value===(a==null?void 0:a.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:es||us})}),e.jsx("label",{className:a!=null&&a.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personPostalCode&&e.jsx("span",{className:"error-form",children:i.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPostalCode",value:f(a==null?void 0:a.personPostalCode)??"",id:"personPostalCode1",required:!0,...r("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.personSpecialDisease&&e.jsx("span",{className:"error-form",children:i.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personSpecialDisease",value:(a==null?void 0:a.personSpecialDisease)||"",id:"personSpecialDisease1",required:!0,...r("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[i.personAddress&&e.jsx("span",{className:"error-form",children:i.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personAddress",value:(a==null?void 0:a.personAddress)||"",id:"personAddress1",required:!0,...r("personAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[i.personDescription&&e.jsx("span",{className:"error-form",children:i.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",name:"personDescription",value:(a==null?void 0:a.personDescription)||"",id:"personDescription1",required:!0,...r("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription1",children:"توضیحات"})]})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(yn,{statusHistoryTableData:s,isLoading:Ae,isFetching:ts,handleRefresh:vn}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:"اطلاعات خویش فرمایی"})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form col-span-2",children:[i.selfEmployeeTypeName&&e.jsx("span",{className:"error-form",children:i.selfEmployeeTypeName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"selfEmployeeTypeName",value:(a==null?void 0:a.selfEmployeeTypeName)||"",id:"selfEmployeeTypeName",required:!0,...r("selfEmployeeTypeName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"selfEmployeeTypeName",children:"وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:E,onChange:v,format:"jYYYY/jMM/jDD",onOpenChange:Cn,suffixIcon:e.jsx(ue,{color:"action"}),open:n,style:xe,wrapperStyle:he,pickerProps:{ref:x}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ شروع"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:w,onChange:g,format:"jYYYY/jMM/jDD",onOpenChange:Dn,suffixIcon:e.jsx(ue,{color:"action"}),open:T,style:xe,wrapperStyle:he,pickerProps:{ref:R}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ پایان"})]}),e.jsxs("div",{className:"inputBox__form col-span-4",children:[i.selfEmployeeDesc&&e.jsx("span",{className:"error-form",children:i.selfEmployeeDesc.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",name:"selfEmployeeDesc",value:(a==null?void 0:a.selfEmployeeDesc)||"",id:"selfEmployeeDesc",required:!0,...r("selfEmployeeDesc",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف و اعداد فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"selfEmployeeDesc",children:"توضیحات"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:"اطلاعات پشتیبان"})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[i.backupFirstName&&e.jsx("span",{className:"error-form",children:i.backupFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupFirstName",value:(a==null?void 0:a.backupFirstName)||"",id:"backupFirstName1",required:!0,...r("backupFirstName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupFirstName1",children:"نام"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.backupLastName&&e.jsx("span",{className:"error-form",children:i.backupLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupLastName",value:(a==null?void 0:a.backupLastName)||"",id:"backupLastName1",required:!0,...r("backupLastName",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupLastName1",children:"نام خانوادگی"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.backupRelation&&e.jsx("span",{className:"error-form",children:i.backupRelation.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupRelation",value:(a==null?void 0:a.backupRelation)||"",id:"backupRelation",required:!0,...r("backupRelation",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupRelation",children:"نسبت"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.backupPhone&&e.jsx("span",{className:"error-form",children:i.backupPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupPhone",value:f(a==null?void 0:a.backupPhone)??"",id:"backupPhone",required:!0,...r("backupPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupPhone",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[i.backupCellphone&&e.jsx("span",{className:"error-form",children:i.backupCellphone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupCellphone",value:f(a==null?void 0:a.backupCellphone)??"",id:"backupCellphone",required:!0,...r("backupCellphone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن همراه باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه ثابت باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه ثابت باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupCellphone",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[i.backupAddress&&e.jsx("span",{className:"error-form",children:i.backupAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"backupAddress",value:(a==null?void 0:a.backupAddress)||"",id:"backupAddress",required:!0,...r("backupAddress",{pattern:{value:/^[آ-ی\s۰-۹]+$/,message:"از حروف و اعداد فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"backupAddress",children:"نشانی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(De,{dir:"ltr",endIcon:e.jsx(Ys,{}),variant:"contained",onClick:_,type:"submit",loading:re,color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})})}function jt(){const[l,m]=o.useState({}),[y,B]=o.useState([]),[C,x]=o.useState(!1),[R,p]=o.useState(!1),[L,h]=o.useState(!1),[A,S]=o.useState(""),[E,P]=o.useState(""),[w,{isLoading:$}]=ht(),H=Is(),c=new URLSearchParams(H.search).get("personID"),{data:F,isSuccess:O,isLoading:Y,isFetching:n,refetch:u,error:T}=pt(c);o.useEffect(()=>{if(u(),O){const r=F.itemList.map((D,K)=>({id:D.personID,relatedRowNum:K+1,pensionaryID:D.pensionaryID,relatedBirthDate:D.personBirthDate,relatedNtionalCode:D.personNationalCode,relatedFirstName:D.personFirstName,relatedLastName:D.personLastName,relatedStatus:D.pensionaryIsUnderGauranteeText,relation:D.relationshipWithParentName}));B(r)}},[O,F,u]),o.useEffect(()=>{var r;T&&(console.log(T),le.error(((r=T==null?void 0:T.data)==null?void 0:r.message)||T.error,{autoClose:2e3}))},[T]);const U=()=>{u()},ae=()=>{x(!0)},ne=()=>{p(!0)},s=()=>{h(!0)},Z=async()=>{var r;try{const D=await w({pensionaryID:E}).unwrap();u(),h(!1),le.success(D.message,{autoClose:2e3})}catch(D){console.log(D),le.error(((r=D==null?void 0:D.data)==null?void 0:r.message)||D.error,{autoClose:2e3})}},_=o.useMemo(()=>[{accessorKey:"relatedRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:r})=>e.jsx("div",{children:f(r)})},{accessorKey:"relatedNtionalCode",header:"کد ملی",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:f(r)})},{accessorKey:"relatedFirstName",header:"نام",size:20},{accessorKey:"relatedLastName",header:"نام خانوادگی",size:20},{accessorKey:"relatedStatus",header:"وضعیت",size:20},{accessorKey:"relatedBirthDate",header:"تاریخ تولد",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:f(bs(r))})},{accessorKey:"relation",header:"نسبت",size:20},{accessorKey:"editRelatedAction",header:"ویرایش",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:r})=>e.jsx(ye,{title:`ویرایش "${r.original.relatedFirstName} ${r.original.relatedLastName}"`,children:e.jsx(oe,{color:"success",onClick:ne,sx:{padding:"0"},children:e.jsx(Ts,{})})})},{accessorKey:"deleteRelatedAction",header:"حذف",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:r})=>e.jsx(ye,{title:`حذف "${r.original.relatedFirstName} ${r.original.relatedLastName}"`,children:e.jsx(oe,{color:"error",onClick:s,sx:{padding:"0"},children:e.jsx(Nn,{})})})}],[]),i=vs({...Ls,columns:_,data:y,muiTableBodyRowProps:({row:r})=>({onClick:()=>m(()=>({[r.id]:!0})),selected:l[r.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsxs(Be,{children:[n?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ve,{size:20,value:100})}):e.jsx(ye,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"info",onClick:U,children:e.jsx(Rs,{fontSize:"small"})})})}),n?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ve,{size:20,value:100})}):e.jsx(ye,{title:e.jsx("span",{style:{fontFamily:"sahel",fontSize:"0.8rem"},children:"ایجاد وابسته"}),children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"success",onClick:ae,children:e.jsx(fn,{fontSize:"small"})})})})]}),muiPaginationProps:{shape:"rounded",showRowsPerPage:!1,size:"small",renderItem:r=>e.jsx(Ss,{...r,page:f(r.page),slots:{previous:Bs,next:_s,first:ks,last:Ps}})},getRowId:r=>r.id,onRowSelectionChange:m,state:{rowSelection:l}});return o.useEffect(()=>{const r=Object.keys(i.getState().rowSelection)[0];if(r){const D=mn(y,r);S(r),P(D==null?void 0:D.pensionaryID)}},[i,l,y]),e.jsx(e.Fragment,{children:Y||n?e.jsx("div",{className:"skeleton-lg",children:e.jsx(Ws,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsxs(e.Fragment,{children:[C?e.jsx(cs,{title:"ایجاد وابسته",closeModal:()=>x(!1),children:e.jsx(xt,{setShowCreateRelatedModal:x,refetch:u})}):R&&A?e.jsx(cs,{title:"ویرایش اطلاعات وابسته",closeModal:()=>p(!1),children:e.jsx(gt,{setShowEditRelatedModal:p,personID:A,refetch:u})}):L?e.jsxs(cs,{title:"حذف وابسته",closeModal:()=>h(!1),children:[e.jsx("p",{className:"paragraph-primary",children:"آیا از حذف این وابسته اطمینان دارید؟"}),e.jsxs("div",{className:"flex-row flex-center",children:[e.jsx(De,{dir:"ltr",endIcon:e.jsx(hn,{}),onClick:Z,loading:$,variant:"contained",color:"success",children:e.jsx("span",{children:"بله"})}),e.jsx(xn,{dir:"ltr",endIcon:e.jsx(en,{}),onClick:()=>h(!1),variant:"contained",color:"error",children:e.jsx("span",{children:"خیر"})})]})]}):null,e.jsx(Os,{table:i})]})})}const Nt=dn.injectEndpoints({endpoints:l=>({getHeirListByParentPersonID:l.query({query:m=>({url:`${Ns}/GetHeirListByParentPersonID?parentPersonID=${m}`})}),getHeir:l.query({query:m=>({url:`${Ns}/GetHeir?personID=${m}`})}),insertHeir:l.mutation({query:m=>({url:`${Ns}/InsertHeir`,method:"POST",body:m})}),updateHeir:l.mutation({query:m=>({url:`${Ns}/UpdateHeir`,method:"POST",body:m})}),updateHeirAccount:l.mutation({query:({token:m,data:y})=>({url:`${Ns}/UpdateHeirAccount`,method:"POST",body:y,headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`}})}),removeHeir:l.mutation({query:({pensionaryID:m})=>({url:`${Ns}/RemoveHeir?pensionaryID=${m}`,method:"POST"})})})}),{useGetHeirListByParentPersonIDQuery:ft,useLazyGetHeirListByParentPersonIDQuery:co,useGetHeirQuery:yt,useRemoveHeirMutation:It,useUpdateHeirMutation:bt,useInsertHeirMutation:Ct}=Nt;function Dt({setShowEditHeirModal:l,personID:m,refetch:y}){const B=o.useRef(null),C=o.useRef(null),x=o.useRef(null),[R,p]=o.useState([]),[L,h]=o.useState([]),[A,S]=o.useState(null),[E,P]=o.useState(!1);o.useState(null);const[w,$]=o.useState(null),[H,ee]=o.useState(null),[c,F]=o.useState(!1),[O,Y]=o.useState(!1),{handleSubmit:n,formState:{errors:u},control:T,register:U,watch:ae,setValue:ne}=ps(),s=ae(),[Z,{isLoading:_}]=bt(),i=Gs(),r=new URLSearchParams(location.search).get("personID"),[D,{isLoading:K,isFetching:a}]=on(),{data:G,isSuccess:re,isLoading:de,isFetching:as,refetch:se,error:te}=Xs(m),{data:ce,isSuccess:Ae,isLoading:ts,isFetching:Oe,error:ie,refetch:_e}=yt(m);o.useEffect(()=>{if(se(),re){const v=G==null?void 0:G.itemList.map((g,Pe)=>({id:g.pensionaryID,isActive:g.pensionaryIsActive,pensionaryStatusRowNum:Pe+1,pensionaryStatusName:g.pensionaryStatusName||"-",pensionaryStartdate:Te(g.pensionaryStartdate)||"-"}));h(v)}return()=>{h([])}},[se,re,G]),o.useEffect(()=>{_e(),Ae&&Object.keys(ce).forEach(v=>{ne(v,ce[v])})},[Ae,ce,_e,ne]),o.useEffect(()=>{var v;ie&&ie.status!=="FETCH_ERROR"&&le.error(((v=ie==null?void 0:ie.data)==null?void 0:v.message)||ie.error,{autoClose:2e3})},[ie]),o.useEffect(()=>{var v;te&&(console.log(te),le.error(((v=te==null?void 0:te.data)==null?void 0:v.message)||te.error,{autoClose:2e3}))},[te]);const{relationships:Ee,relationshipIsLoading:os,relationshipIsFetching:ls}=Ks(),{lookUpItems:Ue,lookUpItemsIsLoading:ge,lookUpItemsIsFetching:rs}=J({lookUpType:"MaritialStatus"}),{lookUpItems:qe,lookUpItemsIsLoading:we,lookUpItemsIsFetching:$e}=J({lookUpType:"Country"}),{lookUpItems:ze,lookUpItemsIsLoading:He,lookUpItemsIsFetching:Ye}=J({lookUpType:"State"}),{lookUpItems:Ke,lookUpItemsIsLoading:Ge,lookUpItemsIsFetching:Me}=J({lookUpType:"City"}),{pensionaryStatus:We,pensionaryStatusIsLoading:Ve,pensionaryStatusIsFetching:Qe}=Ms({pensionaryStatusCategory:"H"}),{lookUpItems:Je,lookUpItemsIsLoading:Ze,lookUpItemsIsFetching:Xe}=J({lookUpType:"Bank"}),Fe=W(Ee,"relationshipID","relationshipName"),is=W(Ue,"lookUpID","lookUpName"),q=W(qe,"lookUpID","lookUpName"),N=W(ze,"lookUpID","lookUpName"),je=W(Ke,"lookUpID","lookUpName"),Ne=W(We,"pensionaryStatusID","pensionaryStatusName"),es=W(Je,"lookUpID","lookUpName"),us=W(R,"lookUpID","lookUpName"),Le=o.useCallback(async v=>{try{const g=await D({lookUpType:"BankBranch",lookUpParentID:v}).unwrap();p(g.itemList)}catch(g){console.log(g)}},[D,p]);o.useEffect(()=>{s.bankID&&Le(s.bankID)},[s.bankID,Le]),o.useEffect(()=>{s.bankID&&Le(s.bankID)},[s.bankID,Le]);const ds=v=>{S(v),P(!1)},ms=v=>{ee(v),F(!1)},hs=v=>{$(v),Y(!1)},Cs=v=>{Y(v)},M=v=>{P(v)},I=v=>{F(v)};o.useEffect(()=>{S(Te(s==null?void 0:s.personBirthDate))},[s==null?void 0:s.personBirthDate]),o.useEffect(()=>{ee(Te(s==null?void 0:s.personBaseFinishDate))},[s==null?void 0:s.personBaseFinishDate]);const Se=()=>{se()},ke=async()=>{var v;try{let g,Pe,ss;A?(g=new Date(A),g.setMinutes(g.getMinutes()-g.getTimezoneOffset())):g=null,w?(Pe=new Date(w),Pe.setMinutes(Pe.getMinutes()-Pe.getTimezoneOffset())):Pe=null,H?(ss=new Date(H),ss.setMinutes(ss.getMinutes()-ss.getTimezoneOffset())):ss=null;const Vs=await Z({...s,relationshipWithParentID:d(s==null?void 0:s.relationshipWithParentID),personNationalCode:d(s==null?void 0:s.personNationalCode),personCertificateNo:d(s==null?void 0:s.personCertificateNo),personBirthDate:g,maritalStatusID:d(s==null?void 0:s.maritalStatusID),personPhone:d(s==null?void 0:s.personPhone),personCellPhone:d(s==null?void 0:s.personCellPhone),personRegion:parseInt(d(s==null?void 0:s.personRegion))||null,personArea:parseInt(d(s==null?void 0:s.personArea))||null,personCountryID:d(s==null?void 0:s.personCountryID),personStateID:d(s==null?void 0:s.personStateID),personCityID:d(s==null?void 0:s.personCityID),personPostalCode:d(s==null?void 0:s.personPostalCode),pensionaryStatusID:d(s==null?void 0:s.pensionaryStatusID),personBaseFinishDate:ss,bankID:d(s==null?void 0:s.bankID),bankBranchID:d(s==null?void 0:s.bankBranchID),accountNo:d(s==null?void 0:s.accountNo),insuranceCoef:parseFloat(d(s==null?void 0:s.insuranceCoef))||0,insuranceAmount:parseFloat(d(s==null?void 0:s.insuranceAmount))||0,ledgerCode:parseInt(d(s.ledgerCode))||0,parentPersonID:r,pensionaryStartDate:Pe}).unwrap();l(!1),y(),le.success(Vs.message,{autoClose:2e3})}catch(g){console.log(g),le.error(((v=g==null?void 0:g.data)==null?void 0:v.message)||g.error,{auroClose:2e3})}};return Fs([B,C,x],[P,F,Y]),e.jsx(e.Fragment,{children:ts||Oe?e.jsx(Be,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ve,{color:"primary"})}):e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:n(ke),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"relationshipWithParentID",control:T,rules:{required:!0},render:({field:{onChange:v}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:i,options:Fe,onChange:g=>v(g?g.value:null),value:Fe.find(g=>g.value===(s==null?void 0:s.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:os||ls})}),e.jsxs("label",{className:s!=null&&s.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),u.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personFirstName&&e.jsx("span",{className:"error-form",children:u.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personFirstName)||"",name:"personFirstName",id:"personFirstName1",required:!0,...U("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName1",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personLastName&&e.jsx("span",{className:"error-form",children:u.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personLastName",value:(s==null?void 0:s.personLastName)||"",id:"personLastName1",required:!0,...U("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personNationalCode&&e.jsx("span",{className:"error-form",children:u.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.personNationalCode)??"",name:"personNationalCode",id:"personNationalCode2",required:!0,...U("personNationalCode",{required:"کد ملی را وارد کنید",minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personCertificateNo&&e.jsx("span",{className:"error-form",children:u.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.personCertificateNo)||"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,...U("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificatetNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personFatherName&&e.jsx("span",{className:"error-form",children:u.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,...U("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:A,onChange:ds,format:"jYYYY/jMM/jDD",onOpenChange:M,suffixIcon:e.jsx(ue,{color:"action"}),open:E,style:xe,wrapperStyle:he,pickerProps:{ref:B}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personBirthPlace&&e.jsx("span",{className:"error-form",children:u.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personBirthPlace",value:(s==null?void 0:s.personBirthPlace)||"",id:"personBirthPlace1",required:!0,...U("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"maritalStatusID",control:T,render:({field:{onChange:v}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:i,options:is,onChange:g=>v(g?g.value:null),value:is.find(g=>g.value===(s==null?void 0:s.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:ge||rs})}),e.jsx("label",{className:s!=null&&s.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personPhone&&e.jsx("span",{className:"error-form",children:u.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.personPhone)||"",name:"personPhone",id:"personPhone11",required:!0,...U("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone11",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personCellPhone&&e.jsx("span",{className:"error-form",children:u.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.personCellPhone)||"",name:"personCellPhone",id:"personCellPhone222",required:!0,...U("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone222",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personArea&&e.jsx("span",{className:"error-form",children:u.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.personArea)||"",name:"personArea",id:"personArea1",required:!0,...U("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personRegion&&e.jsx("span",{className:"error-form",children:u.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personRegion",value:f(s==null?void 0:s.personRegion)||"",id:"personRegion1",required:!0,...U("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCountryID",control:T,render:({field:{onChange:v}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:i,options:q,onChange:g=>v(g?g.value:null),value:q.find(g=>g.value===(s==null?void 0:s.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:we||$e})}),e.jsx("label",{className:s!=null&&s.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personStateID",control:T,render:({field:{onChange:v}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:i,options:N,onChange:g=>v(g?g.value:null),value:N.find(g=>g.value===(s==null?void 0:s.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:He||Ye})}),e.jsx("label",{className:s!=null&&s.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCityID",control:T,render:({field:{onChange:v}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:i,options:je,onChange:g=>v(g?g.value:null),value:je.find(g=>g.value===(s==null?void 0:s.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:Ge||Me})}),e.jsx("label",{className:s!=null&&s.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personPostalCode&&e.jsx("span",{className:"error-form",children:u.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.personPostalCode)||"",name:"personPostalCode",id:"personPostalCode1",required:!0,...U("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.personSpecialDisease&&e.jsx("span",{className:"error-form",children:u.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(s==null?void 0:s.personSpecialDisease)||"",name:"personSpecialDisease",id:"personSpecialDisease1",required:!0,...U("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[u.personAddress&&e.jsx("span",{className:"error-form",children:u.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.personAddress)||"",name:"personAddress",id:"personAddress1",required:!0,...U("personAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[u.personDescription&&e.jsx("span",{className:"error-form",children:u.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.personDescription)||"",name:"personDescription",id:"personDescription",required:!0,...U("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription",children:"توضیحات"})]})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات وظیفه بگیری "})}),e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"pensionaryStatusID",control:T,rules:{required:!0},render:({field:{onChange:v}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:i,options:Ne,onChange:g=>v(g?g.value:null),value:Ne.find(g=>g.value===(s==null?void 0:s.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:Ve||Qe})}),e.jsxs("label",{className:s!=null&&s.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),u.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:w,defaultValue:null,onChange:hs,onOpenChange:Cs,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(ue,{color:"action"}),open:O,style:xe,wrapperStyle:he,pickerProps:{ref:x}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:H,onChange:ms,format:"jYYYY/jMM/jDD",onOpenChange:I,suffixIcon:e.jsx(ue,{color:"action"}),open:c,style:xe,wrapperStyle:he,pickerProps:{ref:C}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",disabled:!0,value:f(s==null?void 0:s.heirID)||"-",name:"heirID",id:"heirID",...U("heirID")}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"heirID",children:"شماره وظیفه بگیری"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",className:"inputBox__form--input",disabled:!0,value:f(bs(s==null?void 0:s.pensionaryStartDate))||"-",name:"pensionaryStartDate",id:"pensionaryStartDate",...U("pensionaryStartDate")}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"pensionaryStartDate",children:"تاریخ وظیفه بگیری"})]})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(yn,{statusHistoryTableData:L,isLoading:de,isFetching:as,handleRefresh:Se}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات بانکی وظیفه بگیر "})}),e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"bankID",control:T,render:({field:{onChange:v}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:i,options:es,onChange:g=>v(g?g.value:null),value:es.find(g=>g.value===(s==null?void 0:s.bankID)),id:"bankID",name:"bankID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"بانک"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:Ze||Xe})}),e.jsx("label",{htmlFor:"bankID",className:s!=null&&s.bankID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"بانک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"bankBranchID",control:T,render:({field:{onChange:v}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:i,options:us,onChange:g=>v(g?g.value:null),isDisabled:K||a||!s.bankID,value:us.find(g=>g.value===(s==null?void 0:s.bankBranchID))||null,id:"bankBranchID",name:"bankBranchID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شعبه"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:K||a})}),e.jsx("label",{htmlFor:"bankBranchID",className:s!=null&&s.bankBranchID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شعبه"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.accountNo&&e.jsx("span",{className:"error-form",children:u.accountNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.accountNo)||"",name:"accountNo",id:"accountNoHeir",required:!0,...U("accountNo",{pattern:{value:/^[۰-۹0-9]+$/,message:"شماره حساب باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"accountNoHeir",children:"شماره حساب"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.ledgerCode&&e.jsx("span",{className:"error-form",children:u.ledgerCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.ledgerCode)||"",name:"ledgerCode",id:"ledgerCodeHeir",required:!0,...U("ledgerCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"ردیف ورثه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"ledgerCodeHeir",children:"ردیف ورثه"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.insuranceCoef&&e.jsx("span",{className:"error-form",children:u.insuranceCoef.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.insuranceCoef)||"",name:"insuranceCoef",id:"insuranceCoefHeir",required:!0,...U("insuranceCoef",{pattern:{value:/^[۰-۹0-9]+([.,][۰-۹0-9]+)?$/,message:"از اعداد یا اعشار استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceCoefHeir",children:"ضریب بیمه"})]}),e.jsxs("div",{className:"inputBox__form",children:[u.insuranceAmount&&e.jsx("span",{className:"error-form",children:u.insuranceAmount.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(s==null?void 0:s.insuranceAmount)||"",name:"insuranceAmount",id:"insuranceAmountHeir",required:!0,...U("insuranceAmount",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceAmountHeir",children:"بیمه تبعی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(De,{dir:"ltr",endIcon:e.jsx(Ys,{}),onClick:n,type:"submit",loading:_,variant:"contained",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})})}function vt({setShowCreateHeirModal:l,refetch:m}){const y=o.useRef(null),B=o.useRef(null),C=o.useRef(null),[x,R]=o.useState(null),[p,L]=o.useState(!1),[h,A]=o.useState(null),[S,E]=o.useState(null),[P,w]=o.useState(!1),[$,H]=o.useState(!1),{handleSubmit:ee,formState:{errors:c},control:F,register:O,watch:Y}=ps(),n=Y(),[u,{isLoading:T}]=Ct(),[U,ae]=o.useState([]),ne=Is(),Z=new URLSearchParams(ne.search).get("personID"),_=Gs(),[i,{isLoading:t,isFetching:r}]=on(),{relationships:D,relationshipIsLoading:K,relationshipIsFetching:a}=Ks(),{lookUpItems:G,lookUpItemsIsLoading:re,lookUpItemsIsFetching:de}=J({lookUpType:"MaritialStatus"}),{lookUpItems:as,lookUpItemsIsLoading:se,lookUpItemsIsFetching:te}=J({lookUpType:"Country"}),{lookUpItems:ce,lookUpItemsIsLoading:Ae,lookUpItemsIsFetching:ts}=J({lookUpType:"State"}),{lookUpItems:Oe,lookUpItemsIsLoading:ie,lookUpItemsIsFetching:_e}=J({lookUpType:"City"}),{pensionaryStatus:Ee,pensionaryStatusIsLoading:os,pensionaryStatusIsFetching:ls}=Ms({pensionaryStatusCategory:"H"}),{lookUpItems:Ue,lookUpItemsIsLoading:ge,lookUpItemsIsFetching:rs}=J({lookUpType:"Bank"}),qe=W(D,"relationshipID","relationshipName"),we=W(G,"lookUpID","lookUpName"),$e=W(as,"lookUpID","lookUpName"),ze=W(Ee,"pensionaryStatusID","pensionaryStatusName"),He=W(ce,"lookUpID","lookUpName"),Ye=W(Oe,"lookUpID","lookUpName"),Ke=W(Ue,"lookUpID","lookUpName"),Ge=W(U,"lookUpID","lookUpName"),Me=o.useCallback(async q=>{try{const N=await i({lookUpType:"BankBranch",lookUpParentID:d(q)}).unwrap();ae(N.itemList)}catch(N){console.log(N)}},[i,ae]);o.useEffect(()=>{n.bankID&&Me(n.bankID)},[n.bankID,Me]);const We=q=>{R(q),L(!1)},Ve=q=>{E(q),w(!1)},Qe=q=>{A(q),H(!1)},Je=q=>{H(q)},Ze=q=>{L(q)},Xe=q=>{w(q)},Fe=async()=>{var q;try{let N,je,Ne;x?(N=new Date(x),N.setMinutes(N.getMinutes()-N.getTimezoneOffset())):N=null,h?(Ne=new Date(h),Ne.setMinutes(Ne.getMinutes()-Ne.getTimezoneOffset())):Ne=null,S?(je=new Date(S),je.setMinutes(je.getMinutes()-je.getTimezoneOffset())):je=null;const es=await u({...n,relationshipWithParentID:d(n==null?void 0:n.relationshipWithParentID),personNationalCode:d(n==null?void 0:n.personNationalCode),personCertificateNo:d(n==null?void 0:n.personCertificateNo),personBirthDate:N,maritalStatusID:d(n==null?void 0:n.maritalStatusID),personPhone:d(n==null?void 0:n.personPhone),personCellPhone:d(n==null?void 0:n.personCellPhone),personRegion:parseInt(d(n==null?void 0:n.personRegion))||null,personArea:parseInt(d(n==null?void 0:n.personArea))||null,personCountryID:d(n==null?void 0:n.personCountryID),personStateID:d(n==null?void 0:n.personStateID),personCityID:d(n==null?void 0:n.personCityID),personPostalCode:d(n==null?void 0:n.personPostalCode),pensionaryStatusID:d(n==null?void 0:n.pensionaryStatusID),personBaseFinishDate:je,bankID:d(n==null?void 0:n.bankID),bankBranchID:d(n==null?void 0:n.bankBranchID),accountNo:d(n==null?void 0:n.accountNo),insuranceCoef:parseFloat(d(n==null?void 0:n.insuranceCoef))||0,insuranceAmount:parseFloat(d(n==null?void 0:n.insuranceAmount))||0,ledgerCode:parseInt(d(n.ledgerCode))||0,parentPersonID:Z,pensionaryStartDate:Ne}).unwrap();l(!1),m(),le.success(es.message,{autoClose:2e3})}catch(N){console.log(N),le.error(((q=N==null?void 0:N.data)==null?void 0:q.message)||N.error,{autoClose:2e3})}};return Fs([y,B],[L,w]),e.jsx("section",{className:"formContainer-transparent formContainer--width-lg flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:ee(Fe),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"relationshipWithParentID",control:F,rules:{required:!0},render:({field:{onChange:q}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:_,options:qe,onChange:N=>q(N?N.value:null),value:qe.find(N=>N.value===(n==null?void 0:n.relationshipWithParentID)),name:"relationshipWithParentID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نسبت"]}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:K||a})}),e.jsxs("label",{className:n!=null&&n.relationshipWithParentID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نسبت"]}),c.relationshipWithParentID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personFirstName&&e.jsx("span",{className:"error-form",children:c.personFirstName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personFirstName",value:(n==null?void 0:n.personFirstName)||"",id:"personFirstName1",required:!0,...O("personFirstName",{required:"نام اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personFirstName1",children:[e.jsx("span",{children:"*"})," نام"]})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personLastName&&e.jsx("span",{className:"error-form",children:c.personLastName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personLastName)||"",name:"personLastName",id:"personLastName1",required:!0,...O("personLastName",{required:"نام خانوادگی اجباری است",pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personLastName1",children:[e.jsx("span",{children:"*"})," نام خانوادگی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personNationalCode&&e.jsx("span",{className:"error-form",children:c.personNationalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personNationalCode",value:f(n==null?void 0:n.personNationalCode)||"",id:"personNationalCode2",required:!0,...O("personNationalCode",{required:"کد ملی را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:"کد ملی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"},maxLength:{value:10,message:"کد ملی باید ۱۰ رقم باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personNationalCode2",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personCertificateNo&&e.jsx("span",{className:"error-form",children:c.personCertificateNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(n==null?void 0:n.personCertificateNo)||"",name:"personCertificateNo",id:"personCertificateNo2",required:!0,...O("personCertificateNo",{required:"شماره شناسنامه را وارد کنید",pattern:{value:/^[۰-۹0-9]+$/,message:" شماره شناسنامه باید فقط شامل اعداد باشد"}})}),e.jsxs("label",{className:"inputBox__form--label",htmlFor:"personCertificateNo2",children:[e.jsx("span",{children:"*"})," شماره شناسنامه"]})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personFatherName&&e.jsx("span",{className:"error-form",children:c.personFatherName.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personFatherName)||"",name:"personFatherName",id:"personFatherName1",required:!0,...O("personFatherName",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personFatherName1",children:"نام پدر"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:x,onChange:We,format:"jYYYY/jMM/jDD",onOpenChange:Ze,suffixIcon:e.jsx(ue,{color:"action"}),open:p,style:xe,wrapperStyle:he,pickerProps:{ref:y}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personBirthPlace&&e.jsx("span",{className:"error-form",children:c.personBirthPlace.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.personBirthPlace)||"",name:"personBirthPlace",id:"personBirthPlace1",required:!0,...O("personBirthPlace",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personBirthPlace1",children:"محل تولد"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"maritalStatusID",control:F,render:({field:{onChange:q}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:_,options:we,onChange:N=>q(N?N.value:null),value:we.find(N=>N.value===(n==null?void 0:n.maritalStatusID)),name:"maritalStatusID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"وضعیت تاهل"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:re||de})}),e.jsx("label",{className:n!=null&&n.maritalStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"وضعیت تاهل"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personPhone&&e.jsx("span",{className:"error-form",children:c.personPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(n==null?void 0:n.personPhone)||"",name:"personPhone",id:"personPhone11",required:!0,...O("personPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPhone11",children:"تلفن ثابت"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personCellPhone&&e.jsx("span",{className:"error-form",children:c.personCellPhone.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personCellPhone",value:f(n==null?void 0:n.personCellPhone)||"",id:"personCellPhone222",required:!0,...O("personCellPhone",{pattern:{value:/^[۰-۹0-9]+$/,message:"تلفن باید فقط شامل اعداد باشد"},minLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"},maxLength:{value:11,message:"تلفن همراه باید ۱۱ رقم باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personCellPhone222",children:"تلفن همراه"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personArea&&e.jsx("span",{className:"error-form",children:c.personArea.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(n==null?void 0:n.personArea),name:"personArea",id:"personArea1",required:!0,...O("personArea",{pattern:{value:/^[۰-۹0-9]+$/,message:"ناحیه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personArea1",children:"ناحیه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personRegion&&e.jsx("span",{className:"error-form",children:c.personRegion.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(n==null?void 0:n.personRegion),name:"personRegion",id:"personRegion1",required:!0,...O("personRegion",{pattern:{value:/^[۰-۹0-9]+$/,message:"منطقه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personRegion1",children:"منطقه سکونت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCountryID",control:F,render:({field:{onChange:q}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:_,options:$e,onChange:N=>q(N?N.value:null),value:$e.find(N=>N.value===(n==null?void 0:n.personCountryID)),name:"personCountryID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"کشور"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:se||te})}),e.jsx("label",{className:n!=null&&n.personCountryID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"کشور"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personStateID",control:F,render:({field:{onChange:q}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:_,options:He,onChange:N=>q(N?N.value:null),value:He.find(N=>N.value===(n==null?void 0:n.personStateID)),name:"personStateID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"استان"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:Ae||ts})}),e.jsx("label",{className:n!=null&&n.personStateID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"استان"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"personCityID",control:F,render:({field:{onChange:q}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:_,options:Ye,onChange:N=>q(N?N.value:null),value:Ye.find(N=>N.value===(n==null?void 0:n.personCityID)),name:"personCityID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شهر"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:ie||_e})}),e.jsx("label",{className:n!=null&&n.personCityID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شهر"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personPostalCode&&e.jsx("span",{className:"error-form",children:c.personPostalCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personPostalCode",value:f(n==null?void 0:n.personPostalCode)||"",id:"personPostalCode1",required:!0,...O("personPostalCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"کد پستی باید فقط شامل اعداد باشد"},minLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"},maxLength:{value:10,message:"کد پستی باید ۱۰ رقمی باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personPostalCode1",children:"کد پستی"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.personSpecialDisease&&e.jsx("span",{className:"error-form",children:c.personSpecialDisease.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"personSpecialDisease",value:(n==null?void 0:n.personSpecialDisease)||"",id:"personSpecialDisease1",required:!0,...O("personSpecialDisease",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personSpecialDisease1",children:"بیماری خاص"})]}),e.jsxs("div",{className:"inputBox__form col-span-3",children:[c.personAddress&&e.jsx("span",{className:"error-form",children:c.personAddress.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(n==null?void 0:n.personAddress)||"",name:"personAddress",id:"personAddress1",required:!0,...O("personAddress",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personAddress1",children:"نشانی"})]}),e.jsxs("div",{className:"inputBox__form col-span-3 row-span-2",children:[c.personDescription&&e.jsx("span",{className:"error-form",children:c.personDescription.message}),e.jsx("textarea",{type:"text",className:"inputBox__form--input",value:f(n==null?void 0:n.personDescription)||"",name:"personDescription",id:"personDescription",required:!0,...O("personDescription",{})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"personDescription",children:"توضیحات"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات وظیفه بگیری "})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"pensionaryStatusID",control:F,rules:{required:!0},render:({field:{onChange:q}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:_,options:ze,onChange:N=>q(N?N.value:null),value:ze.find(N=>N.value===(n==null?void 0:n.pensionaryStatusID)),name:"pensionaryStatusID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:os||ls})}),e.jsxs("label",{className:n!=null&&n.pensionaryStatusID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," وضعیت موظف"]}),c.pensionaryStatusID&&e.jsx("span",{className:"error-form",children:" نسبت اجباری است"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:h,defaultValue:null,onChange:Qe,onOpenChange:Je,format:"jYYYY/jMM/jDD",suffixIcon:e.jsx(ue,{color:"action"}),open:$,style:xe,wrapperStyle:he,pickerProps:{ref:C}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ تغییر وضعیت"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(pe.InputDatePicker,{value:S,onChange:Ve,format:"jYYYY/jMM/jDD",onOpenChange:Xe,suffixIcon:e.jsx(ue,{color:"action"}),open:P,style:xe,wrapperStyle:he,pickerProps:{ref:B}}),e.jsx("div",{className:"inputBox__form--readOnly-label",children:"تاریخ مبنای قطع سهم"})]})]}),e.jsx("div",{className:"Modal__header u-margin-top-sm",children:e.jsx("h4",{className:"title-secondary",children:" اطلاعات بانکی وظیفه بگیر "})}),e.jsxs("div",{className:"grid grid--col-4",children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"bankID",control:F,render:({field:{onChange:q}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:_,options:Ke,onChange:N=>q(N?N.value:null),value:Ke.find(N=>N.value===(n==null?void 0:n.bankID)),id:"bankID",name:"bankID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"بانک"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:ge||rs})}),e.jsx("label",{htmlFor:"bankID",className:n!=null&&n.bankID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"بانک"})]}),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:"bankBranchID",control:F,render:({field:{onChange:q}})=>e.jsx(Q,{closeMenuOnSelect:!0,components:_,options:Ge,onChange:N=>q(N?N.value:null),isDisabled:t||r||!n.bankID,value:Ge.find(N=>N.value===(n==null?void 0:n.bankBranchID))||null,id:"bankBranchID",name:"bankBranchID",isClearable:!0,placeholder:e.jsx("div",{className:"react-select-placeholder",children:"شعبه"}),noOptionsMessage:j.noOptionsMessage,loadingMessage:j.loadingMessage,styles:V,isLoading:t||r})}),e.jsx("label",{htmlFor:"bankBranchID",className:n!=null&&n.bankBranchID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:"شعبه"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.accountNo&&e.jsx("span",{className:"error-form",children:c.accountNo.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(n==null?void 0:n.accountNo)||"",name:"accountNo",id:"accountNoHeir",required:!0,...O("accountNo",{pattern:{value:/^[۰-۹0-9]+$/,message:"شماره حساب باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"accountNoHeir",children:"شماره حساب"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.ledgerCode&&e.jsx("span",{className:"error-form",children:c.ledgerCode.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:f(n==null?void 0:n.ledgerCode)||"",name:"ledgerCode",id:"ledgerCodeHeir",required:!0,...O("ledgerCode",{pattern:{value:/^[۰-۹0-9]+$/,message:"ردیف ورثه باید فقط شامل اعداد باشد"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"ledgerCodeHeir",children:"ردیف ورثه"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.insuranceCoef&&e.jsx("span",{className:"error-form",children:c.insuranceCoef.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",name:"insuranceCoef",value:f(n==null?void 0:n.insuranceCoef)||"",id:"insuranceCoefHeir",required:!0,...O("insuranceCoef",{pattern:{value:/^[۰-۹0-9]+([.,][۰-۹0-9]+)?$/,message:"از اعداد یا اعشار استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceCoefHeir",children:"ضریب بیمه"})]}),e.jsxs("div",{className:"inputBox__form",children:[c.insuranceAmount&&e.jsx("span",{className:"error-form",children:c.insuranceAmount.message}),e.jsx("input",{type:"text",className:"inputBox__form--input",value:(n==null?void 0:n.insuranceAmount)||"",name:"insuranceAmount",id:"insuranceAmountHeir",required:!0,...O("insuranceAmount",{pattern:{value:/^[آ-ی\s]+$/,message:"از حروف فارسی استفاده کنید"}})}),e.jsx("label",{className:"inputBox__form--label",htmlFor:"insuranceAmountHeir",children:"بیمه تبعی"})]})]}),e.jsx("div",{style:{marginRight:"auto"},children:e.jsx(De,{dir:"ltr",endIcon:e.jsx(Ys,{}),onClick:ee,type:"submit",loading:T,variant:"contained",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})}function St(){const[l,m]=o.useState({}),[y,B]=o.useState([]),[C,x]=o.useState(!1),[R,p]=o.useState(!1),[L,h]=o.useState(!1),[A,S]=o.useState(""),[E,P]=o.useState(""),w=Is(),H=new URLSearchParams(w.search).get("personID"),[ee,{isLoading:c}]=It(),{data:F,isLoading:O,isSuccess:Y,isFetching:n,error:u,refetch:T}=ft(H);o.useEffect(()=>{if(T(),Y){const r=F.itemList.map((D,K)=>({id:D.personID,heirRowNum:K+1,pensionaryID:D.pensionaryID,personNationalCode:D.personNationalCode,personFirstName:D.personFirstName,personLastName:D.personLastName,pensionaryIsUnderGauranteeText:D.pensionaryIsUnderGauranteeText,personBirthDate:D.personBirthDate,relationshipWithParentName:D.relationshipWithParentName,parentPersonNationalCode:D.parentPersonNationalCode}));B(r)}},[Y,F,T]),o.useEffect(()=>{var r;u&&(console.log(u),le.error(((r=u==null?void 0:u.data)==null?void 0:r.message)||u.error,{autoClose:2e3}))},[u]);const U=()=>{T()},ae=()=>{p(!0)},ne=()=>{x(!0)},s=()=>{h(!0)},Z=async()=>{var r;try{const D=await ee({pensionaryID:E}).unwrap();h(!1),T(),le.success(D.message,{autoClose:2e3})}catch(D){console.log(D),le.error(((r=D==null?void 0:D.data)==null?void 0:r.message)||D.error,{autoClose:2e3})}},_=o.useMemo(()=>[{accessorKey:"heirRowNum",header:"ردیف",size:20,enableColumnActions:!1,enableSorting:!1,Cell:({renderedCellValue:r})=>e.jsx("div",{children:f(r)})},{accessorKey:"personNationalCode",header:"کد ملی",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:f(r)})},{accessorKey:"personFirstName",header:"نام",size:20},{accessorKey:"personLastName",header:"نام خانوادگی",size:20},{accessorKey:"pensionaryIsUnderGauranteeText",header:"وضعیت",size:20},{accessorKey:"personBirthDate",header:"تاریخ تولد",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:f(bs(r))})},{accessorKey:"relationshipWithParentName",size:20,header:"نسبت"},{accessorKey:"parentPersonNationalCode",header:"شماره پرونده",size:20,Cell:({renderedCellValue:r})=>e.jsx("div",{children:f(r)})},{accessorKey:"editHeirAction",header:"ویرایش",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:r})=>e.jsx(ye,{title:`ویرایش "${r.original.personFirstName} ${r.original.personLastName}"`,children:e.jsx(oe,{color:"success",onClick:ne,sx:{padding:"0"},children:e.jsx(Ts,{})})})},{accessorKey:"deleteHeirAction",header:"حذف",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:r})=>e.jsx(ye,{title:`حذف "${r.original.personFirstName} ${r.original.personLastName}"`,children:e.jsx(oe,{color:"error",onClick:s,sx:{padding:"0"},children:e.jsx(Nn,{})})})}],[]),i=vs({...Ls,columns:_,data:y,muiTableBodyRowProps:({row:r})=>({onClick:()=>m(()=>({[r.id]:!0})),selected:l[r.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsxs(Be,{children:[n?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ve,{size:20,value:100})}):e.jsx(ye,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"info",onClick:U,children:e.jsx(Rs,{fontSize:"small"})})})}),n?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ve,{size:20,value:100})}):e.jsx(ye,{title:e.jsx("span",{style:{fontFamily:"sahel",fontSize:"0.8rem"},children:"ایجاد موظف"}),children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"success",onClick:ae,children:e.jsx(fn,{fontSize:"small"})})})})]}),muiPaginationProps:{shape:"rounded",showRowsPerPage:!1,size:"small",renderItem:r=>e.jsx(Ss,{...r,page:f(r.page),slots:{previous:Bs,next:_s,first:ks,last:Ps}})},getRowId:r=>r.id,onRowSelectionChange:m,state:{rowSelection:l}});return o.useEffect(()=>{const r=Object.keys(i.getState().rowSelection)[0];if(r){const D=mn(y,r);S(r),P(D==null?void 0:D.pensionaryID)}},[i,l,y]),e.jsx(e.Fragment,{children:O||n?e.jsx("div",{className:"skeleton-lg",children:e.jsx(Ws,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsxs(e.Fragment,{children:[C&&A?e.jsx(cs,{title:"ویرایش اطلاعات موظف",closeModal:()=>x(!1),children:e.jsx(Dt,{setShowEditHeirModal:x,personID:A,refetch:T})}):L?e.jsxs(cs,{title:"حذف موظف",closeModal:()=>h(!1),children:[e.jsx("p",{className:"paragraph-primary",children:"آیا از حذف این موظف اطمینان دارید؟"}),e.jsxs("div",{className:"flex-row flex-center",children:[e.jsx(De,{dir:"ltr",endIcon:e.jsx(hn,{}),onClick:Z,loading:c,variant:"contained",color:"success",children:e.jsx("span",{children:"بله"})}),e.jsx(xn,{dir:"ltr",endIcon:e.jsx(en,{}),onClick:()=>h(!1),variant:"contained",color:"error",children:e.jsx("span",{children:"خیر"})})]})]}):R?e.jsx(cs,{title:"ایجاد موظف",closeModal:()=>p(!1),children:e.jsx(vt,{setShowCreateHeirModal:p,refetch:T})}):null,e.jsx(Os,{table:i})]})})}function Bt(){const[l,m]=o.useState({}),[y,B]=o.useState([]),C=Is(),x=new URLSearchParams(C.search),R=x.get("Role"),p=x.get("personID"),{data:L,isSuccess:h,isLoading:A,isFetching:S,error:E,refetch:P}=at({Role:R,personID:p});o.useEffect(()=>{if(P(),h){const c=L.itemList.map(F=>({id:F.requestID,type:F.requestTypeID,requestNO:F.requestNO||"-",personId:F.personID,requestTypeNameFa:F.requestTypeNameFa||"-",personName:F.personName||"-",date:F.requestDate||"-",body:F.requestText||"-"}));B(c),sessionStorage.setItem("requests",JSON.stringify(c))}},[L,h,P]),o.useEffect(()=>{var c;E&&le.error(((c=E==null?void 0:E.data)==null?void 0:c.message)||E.error,{autoClose:2e3})},[E]);const w=()=>{P()},$=o.useMemo(()=>[{accessorKey:"id",header:"شماره درخواست",size:20,Cell:({renderedCellValue:c})=>e.jsx("div",{children:f(c)})},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"ارسال کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:c})=>e.jsx("div",{children:f(bs(c))})},{accessorKey:"observeReq",header:"مشاهده درخواست",enableSorting:!1,enableColumnActions:!1,size:20,Cell:({row:c})=>e.jsx(ye,{title:f(c.original.requestNO),children:e.jsx(Bn,{to:`/retirement/request?requestID=${c.id}&Role=${R}&type=${c.original.type}`,children:e.jsx(oe,{color:"primary",sx:{padding:"0"},children:e.jsx(gn,{})})})})}],[R]),H=vs({...Ls,columns:$,data:y,muiTableBodyRowProps:({row:c})=>({onClick:()=>m(()=>({[c.id]:!0})),selected:l[c.id],sx:{cursor:"pointer"}}),renderTopToolbarCustomActions:()=>e.jsx(Be,{children:S?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ve,{size:20,value:100})}):e.jsx(ye,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"info",onClick:w,children:e.jsx(Rs,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:c=>e.jsx(Ss,{...c,page:f(c.page),slots:{previous:Bs,next:_s,first:ks,last:Ps}})},getRowId:c=>c.id,onRowSelectionChange:m,state:{rowSelection:l}});return e.jsx(e.Fragment,{children:A?e.jsx("div",{className:"skeleton-lg",children:e.jsx(Ws,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(Os,{table:H})})}function _t(){const[l,m]=o.useState({}),[y,B]=o.useState([]),[C,x]=o.useState(null),[R,p]=o.useState(!1),L=Is(),A=new URLSearchParams(L.search).get("personID"),{data:S,isLoading:E,isSuccess:P,isFetching:w,error:$,refetch:H}=tt({personID:A,payType:"M"}),ee=()=>{H()};o.useEffect(()=>{if(P){const n=S.itemList.map((u,T)=>({id:u.payID,payRowNum:T+1,payCreditAmount:u.payCreditAmount,payDebitAmount:u.payDebitAmount,payAmount:u.payAmount,payDate:u.payDate,currentYear:u.currentYear,currentMonth:u.currentMonth}));B(n)}},[P,H,S]),o.useEffect(()=>{var n;$&&le.error(((n=$==null?void 0:$.data)==null?void 0:n.message)||$.error,{autoClose:2e3})},[$]);const c=()=>{p(!0)},F=o.useMemo(()=>[{accessorKey:"payRowNum",header:"ردیف",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:f(n)})},{accessorKey:"payCreditAmount",header:"مبلغ بستانکاری",size:20,Cell:({renderedCellValue:n})=>e.jsxs("div",{children:[Qs(f(n))," ","ریال"]})},{accessorKey:"payDebitAmount",header:"مبلغ بدهکاری",size:20,Cell:({renderedCellValue:n})=>e.jsxs("div",{children:[Qs(f(n))," ","ریال"]})},{accessorKey:"payAmount",header:"مبلغ کل",size:20,Cell:({renderedCellValue:n})=>e.jsxs("div",{children:[Qs(f(n))," ","ریال"]})},{accessorKey:"payDate",header:"تاریخ پرداخت",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:bs(n)})},{accessorKey:"currentYear",header:"سال مالی",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:f(n)})},{accessorKey:"currentMonth",header:"ماه مالی",size:20,Cell:({renderedCellValue:n})=>e.jsx("div",{children:f(n)})},{accessorKey:"downloadRetiredSlip",header:"مشاهده/چاپ",enableSorting:!1,enableColumnActions:!1,size:20,Cell:()=>e.jsx(ye,{title:"دانلود و مشاهده فیش",children:e.jsx(oe,{color:"primary",sx:{padding:"0"},onClick:c,children:e.jsx(gn,{})})})}],[]),O=vs({...Ls,columns:F,data:y,renderTopToolbarCustomActions:()=>e.jsx(Be,{children:w?e.jsx(oe,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(ve,{size:20,value:100})}):e.jsx(ye,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(oe,{"aria-label":"refresh",color:"info",onClick:ee,children:e.jsx(Rs,{fontSize:"small"})})})})}),muiPaginationProps:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:n=>e.jsx(Ss,{...n,page:f(n.page),slots:{previous:Bs,next:_s,first:ks,last:Ps}})},muiTableBodyRowProps:({row:n})=>({onClick:()=>m(()=>({[n.id]:!0})),selected:l[n.id],sx:{cursor:"pointer"}}),getRowId:n=>n.id,onRowSelectionChange:m,state:{rowSelection:l}});return o.useEffect(()=>{const n=Object.keys(O.getState().rowSelection)[0];x(n||null)},[O,l]),e.jsxs(e.Fragment,{children:[R&&C&&e.jsx(cs,{closeModal:()=>p(!1),children:e.jsx(ot,{payID:C})},C),E?e.jsx("div",{className:"skeleton-lg",children:e.jsx(Ws,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(Os,{table:O})]})}const zs=({name:l,label:m,disabled:y,format:B="jYYYY/jMM/jDD",rules:C,control:x,required:R=!1,errors:p,setValue:L})=>{var w;const h=o.useRef(null),[A,S]=o.useState(!1),E=$=>{S($)},P=()=>{L(l,null)};return Fs([h],[S]),e.jsxs("div",{className:"inputBox__form",children:[e.jsx(z,{name:l,control:x,rules:C,render:({field:{onChange:$,value:H}})=>e.jsx(pe.InputDatePicker,{id:l,"aria-label":l,disabled:y,format:B,value:H,open:A,suffixIcon:H&&!y?e.jsx(oe,{color:"default",size:"small",onClick:P,children:e.jsx(en,{})}):e.jsx(ue,{color:"action"}),defaultValue:null,onOpenChange:E,onChange:ee=>{S(!1),$(ee)},pickerProps:{...h&&{ref:h}},style:{border:"none",cursor:"pointer"},wrapperStyle:{border:"1px solid var(--color-input-border)",width:"100%",height:"100%",paddingLeft:"20px",borderRadius:"4px",cursor:"pointer"}})}),e.jsxs("label",{htmlFor:l,className:"inputBox__form--readOnly-label",children:[R&&e.jsx("span",{children:"*"})," ",m]}),p&&e.jsx("span",{className:"error-form",children:(w=p==null?void 0:p[l])==null?void 0:w.message})]})},fs=({label:l,size:m="small",color:y="primary",disabled:B,control:C,name:x,errors:R,rules:p})=>e.jsxs("div",{className:"checkboxContainer__item",children:[e.jsx(z,{name:x,control:C,rules:p,render:({field:{onChange:L,value:h}})=>e.jsx(_n,{id:x,checked:!!h,onChange:A=>L(A.target.checked),size:m,color:y,disabled:B,sx:{padding:.5}})}),e.jsx("label",{htmlFor:x,className:B?"checkboxContainer__label--disabled":"checkboxContainer__label",children:l})]}),In=(l,m,y,B)=>{if(!l)return{};const C={...l};return console.log("TRANSFORMEDDATA IN FUNCTION:",C),Object.keys(C).forEach(x=>{var R;y.includes(x)?C[x]=C[x]===null?null:Js(C[x]):m.includes(x)&&(C[x]=C[x]===null?null:(R=B[x])==null?void 0:R.find(p=>p.value===C[x]))}),C},rn=(l,m,y)=>{const B={...l};return y.forEach(C=>{if(l[C]){const x=new Date(l[C]);x.setMinutes(x.getMinutes()-x.getTimezoneOffset()),B[C]=x}else B[C]=null}),m.forEach(C=>{l[C]&&l[C].value!==void 0&&(B[C]=l[C].value)}),B},kt=()=>{const[l,m]=sn(!1),[y]=Hs(),B=kn(),C=y.get("personID"),x=o.useMemo(()=>["genderID","personCountryID","personStateID","personCityID","housingTypeID","educationTypeID","maritalStatusID"],[]),R=o.useMemo(()=>["personDeathDate","personBirthDate"],[]),{control:p,handleSubmit:L,formState:{errors:h},setValue:A}=ps(),{data:S,isLoading:E,isFetching:P,isSuccess:w,refetch:$}=Pn(C),[H,{isLoading:ee}]=On(),{lookUpItems:c,lookUpItemsIsLoading:F}=J({lookUpType:"Gender"}),O=o.useMemo(()=>Ie(c,"lookUpID","lookUpName"),[c]),{lookUpItems:Y,lookUpItemsIsLoading:n}=J({lookUpType:"EducationType"}),u=o.useMemo(()=>Ie(Y,"lookUpID","lookUpName"),[Y]),{lookUpItems:T,lookUpItemsIsLoading:U}=J({lookUpType:"Country"}),ae=o.useMemo(()=>Ie(T,"lookUpID","lookUpName"),[T]),{lookUpItems:ne,lookUpItemsIsLoading:s}=J({lookUpType:"State"}),Z=o.useMemo(()=>Ie(ne,"lookUpID","lookUpName"),[ne]),{lookUpItems:_,lookUpItemsIsLoading:i}=J({lookUpType:"City"}),t=o.useMemo(()=>Ie(_,"lookUpID","lookUpName"),[_]),{lookUpItems:r,lookUpItemsIsLoading:D}=J({lookUpType:"HousingType"}),K=o.useMemo(()=>Ie(r,"lookUpID","lookUpName"),[r]),{lookUpItems:a,lookUpItemsIsLoading:G}=J({lookUpType:"MaritialStatus"}),re=o.useMemo(()=>Ie(a,"lookUpID","lookUpName"),[a]),de=async se=>{const te=rn(se,x,R),ce=await H({...te,personNationalCode:me(se.personNationalCode),personCertificateNo:me(se.personCertificateNo),retiredID:me(se.retiredID),personPhone:me(se.personPhone),personCellPhone:me(se.personCellPhone),backupPhone:me(se.backupPhone),personRegion:me(se.personRegion),personArea:me(se.personArea)}).unwrap();$(),m(),tn.success(ce.message)};return o.useEffect(()=>{if(w){const se=S==null?void 0:S.itemList[0];B(pn((se==null?void 0:se.personDeathDate)!==null));const te=In(se,x,R,{genderID:O,educationTypeID:u,personCountryID:ae,personStateID:Z,personCityID:t,housingTypeID:K,maritalStatusID:re});Object.keys(te).forEach(ce=>{te[ce]===null?A(ce,""):A(ce,te[ce])})}return()=>{B(pn(null))}},[B,w,S==null?void 0:S.itemList,A,O,ae,u,Z,t,K,re,R,x]),e.jsx(e.Fragment,{children:E||P?e.jsx(Be,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ve,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:L(de),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(X,{name:"personFirstName",label:Mn,rules:Ce,required:!0,control:p,editable:l,type:"text"}),e.jsx(X,{name:"personLastName",label:Fn,rules:Ce,required:!0,control:p,editable:l,type:"text"}),e.jsx(X,{name:"personNationalCode",label:Ln,rules:{...Rn,...Ce},required:!0,control:p,editable:l,type:"text"}),e.jsx(X,{name:"personCertificateNo",label:Tn,rules:{...fe,...Ce},required:!0,control:p,editable:l,type:"text"}),e.jsx(X,{name:"personFatherName",label:An,rules:ys,required:!0,control:p,editable:l,type:"text"}),e.jsx(be,{name:"genderID",control:p,label:En,required:!0,isClearable:!0,isDisabled:!l,options:O,isLoading:F,rules:Ce,errors:h}),e.jsx(zs,{name:"personBirthDate",label:Un,control:p,disabled:!l,required:!0,errors:h,rules:Ce,setValue:A}),e.jsx(X,{name:"personBirthPlace",label:qn,rules:ys,required:!1,control:p,editable:l,type:"text"}),e.jsx(X,{name:"personPreviousName",label:wn,rules:ys,required:!1,control:p,editable:l,type:"text"}),e.jsxs("div",{className:l?"checkboxContainer col-span-3":"checkboxContainer--disabled col-span-3",children:[e.jsx("p",{className:"inputBox__form--readOnly-label",children:$n}),e.jsx(fs,{disabled:!l,control:p,label:zn,name:"personIsSacrificedFamily"}),e.jsx(fs,{disabled:!l,control:p,label:Hn,name:"personIsWarrior"}),e.jsx(fs,{disabled:!l,control:p,label:Yn,name:"personIsChildOfSacrificed"}),e.jsx(fs,{disabled:!l,control:p,label:Kn,name:"personIsValiant"}),e.jsx(fs,{disabled:!l,control:p,label:Gn,name:"personIsSacrificed"}),e.jsx(fs,{disabled:!l,control:p,label:Wn,name:"personIsCaptive"})]}),e.jsx(X,{name:"retiredID",label:Vn,required:!1,control:p,editable:!1,type:"text"}),e.jsx(X,{name:"personPhone",label:Qn,required:!1,rules:fe,control:p,editable:l,type:"text"}),e.jsx(X,{name:"personCellPhone",label:Jn,required:!1,rules:Zn,control:p,editable:l,type:"text"}),e.jsx(X,{name:"backupPhone",label:Xn,required:!1,rules:fe,control:p,editable:l,type:"text"}),e.jsx(X,{name:"backupFirstName",label:ea,required:!1,rules:ys,control:p,editable:l,type:"text"}),e.jsx(X,{name:"backupLastName",label:sa,required:!1,rules:ys,control:p,editable:l,type:"text"}),e.jsx(X,{name:"personEmail",label:na,required:!1,rules:aa,control:p,editable:l,type:"text"}),e.jsx(be,{name:"educationTypeID",control:p,label:ta,required:!1,isClearable:!0,isDisabled:!l,options:u,isLoading:n}),e.jsx(be,{name:"personCountryID",control:p,label:oa,required:!1,isClearable:!0,isDisabled:!l,options:ae,isLoading:U}),e.jsx(be,{name:"personStateID",control:p,label:la,required:!1,isClearable:!0,isDisabled:!l,options:Z,isLoading:s}),e.jsx(be,{name:"personCityID",control:p,label:ra,required:!1,isClearable:!0,isDisabled:!l,options:t,isLoading:i}),e.jsx(X,{name:"personRegion",label:ia,required:!1,control:p,editable:l,rules:fe,type:"text"}),e.jsx(X,{name:"personArea",label:ca,required:!1,control:p,editable:l,rules:fe,type:"text"}),e.jsx(X,{name:"personPostalCode",label:pa,required:!1,control:p,editable:l,rules:ua,type:"text"}),e.jsx(be,{name:"housingTypeID",control:p,label:da,required:!1,isClearable:!0,isDisabled:!l,options:K,isLoading:D}),e.jsx(be,{name:"maritalStatusID",control:p,label:ma,required:!1,isClearable:!0,isDisabled:!l,options:re,isLoading:G}),e.jsx(zs,{name:"personDeathDate",label:ha,control:p,disabled:!l,required:!1,setValue:A}),e.jsx(un,{name:"personAddress",label:xa,required:!0,control:p,editable:l,containerClassNames:"col-span-3"}),e.jsx(un,{name:"personDescription",label:ga,required:!0,control:p,editable:l,containerClassNames:"col-span-4 row-span-2"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(De,{dir:"ltr",endIcon:e.jsx(ln,{}),disabled:!l,variant:"contained",type:"submit",loading:ee,color:"success",children:e.jsx("span",{children:nn})}),e.jsx(De,{dir:"ltr",endIcon:e.jsx(Ts,{}),onClick:m,disabled:l,variant:"contained",color:"primary",children:e.jsx("span",{children:an})})]})]})})})},Pt=()=>[{accessorKey:"pensionaryStatusRowNum",header:ja,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"pensionaryStatusName",header:Zs,size:20},{accessorKey:"pensionaryStartdate",header:Na,size:20,Cell:({renderedCellValue:l})=>e.jsx("div",{children:fa(l)})},{accessorKey:"isActive",header:Zs,size:20,Cell:({renderedCellValue:l})=>e.jsx("div",{children:l===!0?"فعال":"غیرفعال"})}],Ot=({data:l,isLoading:m,isFetching:y})=>{const B=Pt();return e.jsx(ya,{data:l,columns:B,scroll:!1,isLoading:m,isFetching:y,sorting:[{id:"isActive",desc:!0}],highlightActive:!0})},Mt=()=>{const[l,m]=o.useState([]),[y,B]=sn(!1),[C]=Hs(),x=C.get("personID"),{personDeathDate:R}=jn(K=>K.person),p=o.useMemo(()=>["retiredOrganizationID","employmentTypeID","pensionaryStatusID"],[]),L=o.useMemo(()=>["retirementDate","pensionaryStartdate"],[]),{control:h,handleSubmit:A,formState:{errors:S},setValue:E}=ps(),{data:P,isSuccess:w,isLoading:$,isFetching:H,refetch:ee}=Ia(x),{data:c,isSuccess:F,isLoading:O,isFetching:Y,refetch:n}=Xs(x),[u,{isLoading:T}]=ba(),{organizations:U,organizationIsLoading:ae}=st({}),{lookUpItems:ne,lookUpItemsIsLoading:s}=J({lookUpType:"EmploymentType"}),{pensionaryStatus:Z,pensionaryStatusIsLoading:_}=Ms({pensionaryStatusCategory:"R",pensionaryStatusIsDead:R}),i=o.useMemo(()=>Ie(U,"organizationID","organizationName"),[U]),t=o.useMemo(()=>Ie(ne,"lookUpID","lookUpName"),[ne]),r=o.useMemo(()=>Ie(Z,"pensionaryStatusID","pensionaryStatusName"),[Z]);o.useEffect(()=>{if(w){const K=P==null?void 0:P.itemList[0];if(K){const a={...K};Object.keys(a).forEach(G=>{G==="retirementDate"&&(a[G]=a[G]===null?null:Js(a[G])),G==="pensionaryStartdate"&&(a[G]=a[G]===null?null:Js(a[G])),E(G,a[G])})}}},[w,P==null?void 0:P.itemList,E]);const D=async K=>{const a=rn(K,p,L),G=await u({...a,retiredGroup:parseInt(me(K.retiredGroup)),retiredJobDegreeCoef:parseInt(me(K.retiredJobDegreeCoef)),retiredRealDuration:parseInt(me(K.retiredRealDuration)),retiredGrantDuration:parseInt(me(K.retiredGrantDuration)),personID:x}).unwrap();B(),ee(),n(),tn.success(G.message)};return o.useEffect(()=>{if(w){const K=P==null?void 0:P.itemList[0],a=In(K,p,L,{retiredOrganizationID:i,employmentTypeID:t,pensionaryStatusID:r});Object.keys(a).forEach(G=>{a[G]===null?E(G,""):E(G,a[G])})}},[w,P==null?void 0:P.itemList,i,t,r,E,p,L]),o.useEffect(()=>{if(F){const K=c==null?void 0:c.itemList.map((a,G)=>({id:a.pensionaryID,isActive:a.pensionaryIsActive,pensionaryStatusRowNum:G+1,pensionaryStatusName:a.pensionaryStatusName||"-",pensionaryStartdate:a.pensionaryStartdate||"-"}));m(K)}},[F,c==null?void 0:c.itemList]),e.jsx(e.Fragment,{children:$||H?e.jsx(Be,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ve,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:A(D),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(X,{name:"retiredGroup",label:Ca,control:h,required:!0,editable:y,rules:{...Ce,...fe},type:"text"}),e.jsx(be,{name:"retiredOrganizationID",control:h,label:Da,required:!0,isClearable:!0,isDisabled:!y,options:i,isLoading:ae,rules:Ce,errors:S}),e.jsx(X,{name:"retiredLastPosition",label:va,control:h,required:!1,editable:y,rules:ys,type:"text"}),e.jsx(be,{name:"employmentTypeID",control:h,label:Sa,required:!0,isClearable:!0,isDisabled:!y,options:t,isLoading:s,rules:Ce,errors:S}),e.jsx(zs,{name:"retirementDate",label:Ba,control:h,disabled:!y,required:!1,errors:S,rules:Ce,setValue:E}),e.jsx(be,{name:"pensionaryStatusID",control:h,label:Zs,required:!0,isClearable:!0,isDisabled:!y,options:r,isLoading:_,rules:Ce,errors:S}),e.jsx(zs,{name:"pensionaryStartdate",label:_a,control:h,disabled:!y,required:!0,errors:S,rules:Ce,setValue:E}),e.jsx(X,{name:"retiredJobDegreeCoef",label:ka,control:h,required:!1,editable:y,rules:fe,type:"text"}),e.jsx(X,{name:"retiredGrantDuration",label:Pa,control:h,required:!1,editable:y,rules:fe,type:"text"}),e.jsx(X,{name:"retiredRealDuration",label:Oa,control:h,required:!1,editable:y,rules:fe,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(De,{dir:"ltr",endIcon:e.jsx(ln,{}),disabled:!y,variant:"contained",type:"submit",loading:T,color:"success",children:e.jsx("span",{children:nn})}),e.jsx(De,{dir:"ltr",endIcon:e.jsx(Ts,{}),onClick:B,disabled:y,variant:"contained",color:"primary",children:e.jsx("span",{children:an})})]}),e.jsx("div",{className:"flex-col flex-center",children:e.jsx("h5",{className:"title-secondary",children:"تاریخچه وضعیت ها"})}),e.jsx(Ot,{data:l,isLoading:O,isFetching:Y})]})})})},Ft=()=>{const[l,m]=sn(!1),[y,B]=o.useState([]),[C]=Hs(),x=C.get("personID"),R=o.useMemo(()=>["bankID","bankBranchID"],[]),p=o.useMemo(()=>[],[]),{control:L,handleSubmit:h,formState:{errors:A},setValue:S,watch:E}=ps(),P=E("bankID"),{lookUpItems:w,lookUpItemsIsLoading:$}=J({lookUpType:"Bank"}),H=o.useMemo(()=>Ie(w,"lookUpID","lookUpName"),[w]),[ee,{isLoading:c,isFetching:F}]=on(),O=o.useMemo(()=>Ie(y,"lookUpID","lookUpName"),[y]),{data:Y,isSuccess:n,isLoading:u,isFetching:T,refetch:U}=Ma(x),[ae,{isLoading:ne}]=Fa(),s=o.useCallback(async i=>{const t=await ee({lookUpType:"BankBranch",lookUpParentID:i}).unwrap();B(t.itemList)},[ee]),Z=async i=>{const t=rn(i,R,p),r=await ae({...t,accountNo:me(i.accountNo)||null,ledgerCode:parseInt(me(i.ledgerCode))||null,insuranceAmount:parseFloat(me(i.insuranceAmount))||null,insuranceCoef:parseFloat(me(i.insuranceCoef))||null,personID:x}).unwrap();U(),m(),tn.success(r.message)};return o.useEffect(()=>{P?s(P.value):(S("bankBranchID",null),B([]))},[P,s,S]),o.useEffect(()=>{n&&({...Y},Object.keys(Y).forEach(i=>{Y[i]===null?S(i,""):S(i,Y[i])}))},[n,Y,S]),o.useEffect(()=>{n&&H.length>0&&S("bankID",H.find(i=>i.value===Y.bankID))},[n,Y,S,H]),o.useEffect(()=>{n&&O.length>0&&S("bankBranchID",O.find(i=>i.value===Y.bankBranchID))},[n,Y,S,O]),e.jsx(e.Fragment,{children:u||T?e.jsx(Be,{sx:{display:"flex",justifyContent:"center",padding:"2rem 10rem"},children:e.jsx(ve,{color:"primary"})}):e.jsx("section",{className:"flex-col",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:h(Z),noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx(be,{name:"bankID",control:L,label:La,required:!1,isClearable:!0,isDisabled:!l,options:H,isLoading:$,errors:A}),e.jsx(be,{name:"bankBranchID",control:L,label:Ra,required:!1,isClearable:!0,isDisabled:!l,options:O,isLoading:c||F,errors:A}),e.jsx(X,{name:"accountNo",label:Ta,rules:fe,required:!1,control:L,editable:l,type:"text"}),e.jsx(X,{name:"ledgerCode",label:Aa,rules:fe,required:!1,control:L,editable:l,type:"text"}),e.jsx(X,{name:"insuranceCoef",label:Ea,rules:fe,required:!1,control:L,editable:l,type:"text"}),e.jsx(X,{name:"insuranceAmount",label:Ua,rules:fe,required:!1,control:L,editable:l,type:"text"})]}),e.jsxs("div",{className:"flex-row mr-auto",children:[e.jsx(De,{dir:"ltr",endIcon:e.jsx(ln,{}),disabled:!l,variant:"contained",type:"submit",loading:ne,color:"success",children:e.jsx("span",{children:nn})}),e.jsx(De,{dir:"ltr",endIcon:e.jsx(Ts,{}),onClick:m,disabled:l,variant:"contained",color:"primary",children:e.jsx("span",{children:an})})]})]})})})},po=()=>{const[l,m]=o.useState("1"),{personDeathDate:y}=jn(x=>x.person),B=(x,R)=>{m(R)};return e.jsxs("section",{className:"flex-col",children:[e.jsx(et,{title:qa,back:!0}),e.jsxs("div",{"data-name":"retired-forms",children:[e.jsxs(Es,{children:[e.jsx(Us,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(qs,{}),children:wa}),e.jsx(ws,{children:e.jsx(kt,{})})]}),e.jsxs(Es,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(Us,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(qs,{}),children:$a}),e.jsx(ws,{children:e.jsx(Mt,{})})]}),e.jsxs(Es,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(Us,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(qs,{}),children:za}),e.jsx(ws,{children:e.jsx(Ft,{})})]}),e.jsxs(Es,{slotProps:{transition:{unmountOnExit:!0}},children:[e.jsx(Us,{id:"panel-header","aria-controls":"panel-content",expandIcon:e.jsx(qs,{}),children:Ha}),e.jsx(ws,{children:e.jsx(it,{})})]})]}),e.jsx("div",{"data-name":"retired-grids",children:e.jsxs(lt,{value:l,children:[e.jsx(Be,{sx:{bgcolor:"background.paper",borderRadius:1},children:e.jsxs(rt,{onChange:B,"aria-label":"tabs",variant:"fullWidth",children:[e.jsx(As,{label:y?Ya:Ka,value:"1"}),e.jsx(As,{label:Ga,value:"2"}),e.jsx(As,{label:Wa,value:"3"}),e.jsx(As,{label:Va,value:"4"})]})}),e.jsx($s,{value:"1",sx:{padding:"0"},children:y?e.jsx(St,{}):e.jsx(jt,{})}),e.jsx($s,{value:"2",sx:{padding:"0"},children:e.jsx(nt,{})}),e.jsx($s,{value:"3",sx:{padding:"0"},children:e.jsx(_t,{})}),e.jsx($s,{value:"4",sx:{padding:"0"},children:e.jsx(Bt,{})})]})})]})};export{po as default};
