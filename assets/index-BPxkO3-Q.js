import{c as R,j as e,r as c,a as f,b as q,T as y,L as j,I as b,u as I,s as x,B as v,C as D,d as F}from"./index-DSED7iL5.js";import{u as P,a as N}from"./requestApi-Br5OXDtR.js";import{u as S,M as z,P as A,C as L,a as B,L as E,F as $,b as k}from"./index.esm-CfiMa6Ot.js";import{E as H}from"./VisibilityOutlined-DlqzXHnG.js";import{u as M}from"./index.esm-DqZpPg4P.js";import{S as K}from"./SelectInput-CmZ-lV3g.js";import{R as O}from"./Refresh-CwSfKJ82.js";import"./Save-DiCw1evn.js";import"./index-DTryfL7Q.js";import"./react-select-animated.esm-CV2p-T-N.js";const V=R(e.jsx("path",{d:"M14.17 5 19 9.83V19H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9.83c0-.53-.21-1.04-.59-1.41l-4.83-4.83c-.37-.38-.88-.59-1.41-.59M7 15h10v2H7zm0-4h10v2H7zm0-4h7v2H7z"}),"TextSnippetOutlined"),G=({columns:t,data:s,topBarActions:a,bottomBarActions:o,scroll:n,props:u,isLoading:d,isFetching:g})=>{const[p,h]=c.useState({}),i=S({columns:t,data:s,renderTopToolbarCustomActions:()=>a,renderBottomToolbarCustomActions:()=>o,muiLinearProgressProps:{color:"info",sx:{height:2}},muiCircularProgressProps:{color:"info"},muiTopToolbarProps:a?{sx:{overflow:"none"}}:void 0,muiTableHeadProps:a?{sx:{zIndex:0}}:void 0,muiTableBodyRowProps:({row:r})=>({onClick:()=>h(()=>({[r.id]:!0})),selected:p[r.id],sx:{cursor:"pointer"}}),localization:z,paginationDisplayMode:"pages",enableFullScreenToggle:!1,positionToolbarAlertBanner:"none",enableStickyHeader:!0,enableStickyFooter:!0,enableDensityToggle:!1,enableFilterMatchHighlighting:!1,muiTableBodyCellProps:{align:"center",sx:{fontFamily:"IranYekan",fontWeight:"300",borderRight:"1px solid #cfcfcf"}},muiTableHeadCellProps:{align:"center",sx:{borderRight:"1px solid #cfcfcf",fontFamily:"Vazir",fontWeight:"600"}},initialState:{density:"compact"},enablePagination:!n,enableBottomToolbar:!n,muiTableContainerProps:n?{sx:{height:"300px"}}:void 0,muiPaginationProps:n?void 0:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:r=>e.jsx(A,{...r,page:f(r.page),slots:{previous:L,next:B,first:E,last:$}})},getRowId:r=>r.id,onRowSelectionChange:h,state:{rowSelection:p,isLoading:d,showProgressBars:g},...u});return e.jsx(k,{table:i})},w=({role:t})=>[{accessorKey:"requestRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:s})=>e.jsx("div",{children:f(s)})},{accessorKey:"requestNO",header:"شماره درخواست",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:f(s)})},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"درخواست کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:q(s)})},{accessorKey:"senderInfo",header:"بررسی درخواست",enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(y,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s.original.requestTypeNameFa})," ",e.jsx("br",{}),e.jsx("span",{children:s.original.personName})]}),children:e.jsx(j,{to:s.original.requestTypeID==="62A54585-F331-434A-9027-C9F3060F683A"?`/retirement/group-slips?requestID=${s.original.id}`:s.original.requestTypeID==="EC1E7E50-9815-442F-9CCB-27F47AB05199"?`/retirement/group-slips?requestID=${s.original.id}&personID=${s.original.personID}`:s.original.requestTypeID==="6E7BA26E-A1DC-4A5E-9700-17820A36158D"?`/retirement/batch-statements?requestID=${s.original.id}`:`/retirement/retired?personID=${s.original.personID}&Role=${t==null?void 0:t.value}&requestID=${s.original.id}`,children:e.jsx("span",{children:e.jsx(b,{color:"success",sx:{padding:"0"},children:e.jsx(V,{color:"success"})})})})})},{accessorKey:"observe",header:"مشاهده درخواست",enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(y,{title:f(s.original.requestNO),children:e.jsx(j,{to:`/retirement/request?requestID=${s.id}&Role=${t==null?void 0:t.value}&type=${s.original.requestTypeID}`,children:e.jsx("span",{children:e.jsx(b,{sx:{padding:"0"},color:"info",children:e.jsx(H,{color:"info"})})})})})}],Q=(t,s,a)=>t.map(o=>({value:o[s],label:o[a]})),W=()=>{const[t,s]=c.useState([]),a=I(),{control:o,setValue:n}=M({}),[u,{isLoading:d,isFetching:g}]=P(),p=c.useCallback(async()=>{const i=await u().unwrap(),r=Q(i==null?void 0:i.itemList,"url","itemName");s(r),a(x(r[0])),n("role",r[0])},[a,u,n]);c.useEffect(()=>{p()},[p]),c.useEffect(()=>()=>{a(x(null))},[a]);const h=i=>{a(i?x(i):x(null))};return e.jsx("div",{style:{width:"300px",height:"40px",margin:"10px auto"},children:e.jsx(K,{control:o,options:t,isLoading:d||g,onValueChange:h,name:"role",label:"نقش",required:!1})})},_=({isLoading:t,isFetching:s,handleRefresh:a})=>e.jsxs(v,{sx:{display:"flex",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[t||s?e.jsx(b,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(D,{size:20,value:100})}):e.jsx(y,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(b,{"aria-label":"refresh",color:"info",onClick:a,children:e.jsx(O,{fontSize:"small"})})})}),e.jsx(W,{})]}),Y=()=>{const[t,s]=c.useState([]),{role:a}=F(r=>r.role),[o,{isLoading:n,isFetching:u}]=N(),d=c.useCallback(async r=>{try{const m=await o({Role:r}).unwrap(),T=m==null?void 0:m.itemList.map((l,C)=>({id:l.requestID,requestRowNum:C+1,requestNO:l.requestNO||"-",requestTypeID:l.requestTypeID,personID:l.personID,requestTypeNameFa:l.requestTypeNameFa,personName:l.personFirstName+" "+l.personLastName||"-",date:l.requestDate,body:l.requestText}));s(T)}catch(m){console.log(m)}},[o]);c.useEffect(()=>{a?d(a==null?void 0:a.value):s([])},[a,d]);const p=_({isLoading:n,isFetching:u,handleRefresh:()=>{a&&d(a==null?void 0:a.value)}}),h=w({role:a});return e.jsx(G,{columns:h,data:t,topBarActions:p,scroll:!1,isLoading:n,isFetching:u})};function oe(){return e.jsxs("section",{className:"flex-col",children:[e.jsx("div",{className:"title-primary--container flex-row flex-center",children:e.jsxs("h4",{className:"title-primary",children:[e.jsx("span",{className:"title-primary--underline"}),"کارتابل"]})}),e.jsx(Y,{})]})}export{oe as Cartable};
