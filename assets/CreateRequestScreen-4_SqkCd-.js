import{r as l,m as r,e as S,j as e,a as B,k as E,n as F}from"./index-DSED7iL5.js";import{u as L,i as I,j as w}from"./requestApi-Br5OXDtR.js";import{i as D,S as A}from"./react-select-animated.esm-CV2p-T-N.js";import{o as M,s as h,a as b}from"./reactSelect-BGq5yAQc.js";import{S as k}from"./ArrowUpwardOutlined-DwrmhyhL.js";const G=["62A54585-F331-434A-9027-C9F3060F683A","6E7BA26E-A1DC-4A5E-9700-17820A36158D"];function Q(){const[o,g]=l.useState(null),[c,f]=l.useState([]),[u,{isLoading:z,isFetching:P}]=L(),[d,{isLoading:y,isFetching:C}]=I(),m=l.useCallback(async()=>{var a;try{const n=await u().unwrap();g(n==null?void 0:n.itemList[0].url)}catch(n){console.log(n);const t=n;r.error(((a=t.data)==null?void 0:a.message)||t.error,{autoClose:2e3})}},[u]),p=l.useCallback(async()=>{try{console.log("ROLE BEFORE REQUEST:",o);const a=await d(o).unwrap(),n=M(a.itemList,"requestTypeID","name");f(n)}catch(a){console.log(a)}},[d,o]);l.useEffect(()=>{m()},[m]),l.useEffect(()=>{o&&(console.log(o),p())},[o,p]);const[R,{isLoading:N}]=w(),T=S(),j=D(),[s,i]=l.useState({}),x=a=>{const{name:n,value:t}=a.target;i({...s,[n]:t})},_=(a,n)=>{const{name:t}=n;if(a){const{value:q}=a;i({...s,[t]:q||""})}else i({...s,[t]:null})},v=async()=>{var a;try{const n=s!=null&&s.nationalCode?F(s.nationalCode):"-1",t=await R({...s,requestFrom:1,nationalCode:n}).unwrap();T("/retirement/cartable"),r.success(t.message,{autoClose:2e3})}catch(n){console.log(n),r.error(((a=n==null?void 0:n.data)==null?void 0:a.message)||n.error,{autoClose:2e3})}};return e.jsxs("section",{className:"formContainer flex-col",children:[e.jsxs("form",{method:"POST",className:"grid grid--col-4 u-margin-top-md",noValidate:!0,children:[e.jsxs("div",{className:"inputBox__form",children:[e.jsx(A,{closeMenuOnSelect:!0,components:j,options:c,onChange:_,value:c.find(a=>a.value===(s==null?void 0:s.requestTypeID)),name:"requestTypeID",isClearable:!0,placeholder:e.jsxs("div",{className:"react-select-placeholder",children:[e.jsx("span",{children:"*"})," نوع درخواست"]}),noOptionsMessage:h.noOptionsMessage,loadingMessage:h.loadingMessage,styles:b,isLoading:y||C}),e.jsxs("label",{className:s!=null&&s.requestTypeID?"inputBox__form--readOnly-label":"inputBox__form--readOnly-label-hidden",children:[e.jsx("span",{children:"*"})," نوع درخواست"]})]}),!G.includes(s==null?void 0:s.requestTypeID)&&e.jsxs("div",{className:"inputBox__form",children:[e.jsx("input",{type:"text",name:"nationalCode",id:"nationalCode",onChange:x,className:"inputBox__form--input",value:B(s==null?void 0:s.nationalCode)??"",required:!0}),e.jsxs("label",{htmlFor:"nationalCode",className:"inputBox__form--label",children:[e.jsx("span",{children:"*"})," کد ملی"]})]}),e.jsxs("div",{className:"inputBox__form col-span-4 row-span-3",children:[e.jsx("textarea",{type:"text",id:"requestText",name:"requestText",onChange:x,value:(s==null?void 0:s.requestText)||"",className:"inputBox__form--input",required:!0}),e.jsxs("label",{htmlFor:"requestText",className:"inputBox__form--label",children:[e.jsx("span",{children:"*"})," متن درخواست"]})]})]}),e.jsx("div",{style:{marginRight:"auto"},className:"flex-row",children:e.jsx(E,{dir:"ltr",endIcon:e.jsx(k,{}),variant:"contained",onClick:v,loading:N,color:"success",sx:{fontFamily:"sahel"},children:e.jsx("span",{children:"ارسال درخواست"})})})]})}function K(){return e.jsxs("section",{className:"flex-col",children:[e.jsx("div",{className:"title-primary--container flex-row flex-center",children:e.jsxs("h4",{className:"title-primary",children:[e.jsx("span",{className:"title-primary--underline"}),"ایجاد درخواست"]})}),e.jsx(Q,{})]})}export{K as default};
