import{q as P,b0 as m,r as a,j as e,h as $,D as F,A as G}from"./index-DXLU_PyE.js";import{u as A}from"./index.esm-BbqTopL3.js";import{I as B}from"./Input-CGe5v-_f.js";import{c as N,S as I}from"./SelectInput-C8DT0J5s.js";import{T as V}from"./TextArea-BOEjD7Hg.js";import"./react-select-animated.esm-DpIcM5qF.js";import"./messages-C1aWCoMO.js";const Q=P.injectEndpoints({endpoints:o=>({getLookup:o.query({query:({lookupType:n,lookupName:r})=>{let i=`${m}/GetLookup?LookupType=${n}`;return r&&(i+=`&lookUpName=${r}`),{url:i}}}),getLookupDistinct:o.query({query:()=>({url:`${m}/GetLookupDistinct`})}),insertLookup:o.mutation({query:n=>({url:`${m}/InsertLookup`,method:"POST",body:n})})})}),{useLazyGetLookupQuery:z,useGetLookupDistinctQuery:K,useInsertLookupMutation:M}=Q,R=()=>{var x,g;const[o,n]=a.useState([]),[r,i]=a.useState([]),{handleSubmit:S,control:l,formState:{errors:b},watch:q,reset:v,setValue:d}=A({defaultValues:{title:"",type:null,parent:null,description:""}}),t=q(),{data:p,isLoading:T,isSuccess:y}=K(),[k,{isLoading:D,isFetching:O}]=z(),[w,{isLoading:C}]=M(),L=a.useCallback(async()=>{var c;const s=await k({lookupType:(c=t==null?void 0:t.type)==null?void 0:c.value}).unwrap(),u=N(s.itemList,"lookUpID","lookUpName");i(u),console.log(s)},[k,(x=t==null?void 0:t.type)==null?void 0:x.value]),E=async s=>{var j,h,f,U;const u={lookUpID:"string",lookUpType:(j=s.type)==null?void 0:j.value,lookUpTypeName:(h=s.type)==null?void 0:h.label,lookUpName:s.title,lookUpParentID:((f=s.parent)==null?void 0:f.value)||"",lookUpDescription:s.description,lookUpParentIDName:((U=s.parent)==null?void 0:U.label)||"",isDeleted:!1},c=await w(u).unwrap();G.success(c.message),v()};return a.useEffect(()=>{if(y){const s=N(p.itemList,"lookUpType","lookUpTypeName");n(s)}},[p==null?void 0:p.itemList,y]),a.useEffect(()=>{var s;(s=t==null?void 0:t.type)!=null&&s.value?L():(d("parent",null),i([]))},[(g=t==null?void 0:t.type)==null?void 0:g.value,L,d]),e.jsx("section",{className:"flex-col formContainer",children:e.jsxs("form",{method:"POST",className:"flex-col",onSubmit:S(E),noValidate:!0,children:[e.jsxs("div",{className:"grid grid--col-3",children:[e.jsx(B,{name:"title",label:"عنوان",control:l,required:!0,rules:{required:{value:!0,message:"این فیلد اجباری است"}}}),e.jsx(I,{name:"type",label:"نوع",options:o,control:l,required:!0,isClearable:!0,isLoading:T,errors:b,rules:{required:{value:!0,message:"این فیلد اجباری است"}}}),e.jsx(I,{name:"parent",label:"از مجموعه",options:r,isLoading:D||O,control:l,required:!1,isClearable:!0}),e.jsx(V,{name:"description",label:"شرح",control:l,required:!0,containerClassNames:"col-span-2 row-span-2"})]}),e.jsx("div",{className:"flex mr-auto",children:e.jsx($,{dir:"ltr",endIcon:e.jsx(F,{}),loading:C,variant:"contained",type:"submit",color:"success",children:e.jsx("span",{children:"ذخیره"})})})]})})},se=()=>e.jsxs("section",{className:"flex-col",children:[e.jsx("div",{className:"title-primary--container flex-row flex-center",children:e.jsxs("h4",{className:"title-primary",children:[e.jsx("span",{className:"title-primary--underline"}),"اطلاعات پایه ۲"]})}),e.jsx(R,{})]});export{se as default};
