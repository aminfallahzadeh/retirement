import{c as I,j as e,R as D,a as C,b,T as f,L as j,I as x,O as T,E as A,r as o,u as F,d as N,s as g,B as E,C as v,e as z,G as L,f as S}from"./index-DJK9IeUF.js";import{u as B,a as O}from"./requestApi-HUB0tuMW.js";import{c as $,S as K}from"./SelectInput-B6aD3pdf.js";import{R as V}from"./Refresh-DDBBxFuN.js";import{T as k}from"./Title-CRhYWHj_.js";import"./react-select-animated.esm-BvZj5eF1.js";const G=I(e.jsx("path",{d:"M14.17 5 19 9.83V19H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9.83c0-.53-.21-1.04-.59-1.41l-4.83-4.83c-.37-.38-.88-.59-1.41-.59M7 15h10v2H7zm0-4h10v2H7zm0-4h7v2H7z"}),"TextSnippetOutlined"),H=({role:a})=>[{accessorKey:"requestRowNum",header:D,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"requestNO",header:"شماره درخواست",size:20},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"درخواست کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:C(s)})},{accessorKey:"senderInfo",header:b,enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(f,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s.original.requestTypeNameFa})," ",e.jsx("br",{}),e.jsx("span",{children:s.original.personName})]}),children:e.jsx(j,{to:s.original.requestTypeID==="62A54585-F331-434A-9027-C9F3060F683A"?`/retirement/group-slips?requestID=${s.original.id}`:s.original.requestTypeID==="EC1E7E50-9815-442F-9CCB-27F47AB05199"?`/retirement/group-slips?requestID=${s.original.id}&personID=${s.original.personID}`:s.original.requestTypeID==="6E7BA26E-A1DC-4A5E-9700-17820A36158D"?`/retirement/batch-statements?requestID=${s.original.id}`:`/retirement/retired?personID=${s.original.personID}&Role=${a==null?void 0:a.value}&requestID=${s.original.id}`,children:e.jsx("span",{children:e.jsx(x,{color:"success",sx:{padding:"0"},children:e.jsx(G,{color:"success"})})})})})},{accessorKey:"observe",header:T,enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(f,{title:s.original.requestNO,children:e.jsx(j,{to:`/retirement/request?requestID=${s.id}&Role=${a==null?void 0:a.value}&type=${s.original.requestTypeID}`,children:e.jsx("span",{children:e.jsx(x,{sx:{padding:"0"},color:"info",children:e.jsx(A,{color:"info"})})})})})}],P=()=>{const[a,s]=o.useState([]),t=F(),{control:p,setValue:l}=N({}),[c,{isLoading:u,isFetching:q}]=B(),h=o.useCallback(async()=>{const r=await c().unwrap(),i=$(r==null?void 0:r.itemList,"url","itemName");s(i),t(g(i[0])),l("role",i[0])},[t,c,l]);o.useEffect(()=>{h()},[h]);const m=r=>{t(r?g(r):g(null))};return e.jsx("div",{style:{width:"300px",height:"40px",margin:"10px auto"},children:e.jsx(K,{control:p,options:a,isLoading:u||q,onValueChange:m,name:"role",label:"نقش",required:!1})})},M=({isLoading:a,isFetching:s,handleRefresh:t})=>e.jsxs(E,{sx:{display:"flex",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[a||s?e.jsx(x,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(v,{size:20,value:100})}):e.jsx(f,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(x,{"aria-label":"refresh",color:"info",onClick:t,children:e.jsx(V,{fontSize:"small"})})})}),e.jsx(P,{})]}),Q=()=>{const[a,s]=o.useState([]),{role:t}=z(i=>i.role),[p,{isLoading:l,isFetching:c}]=O(),u=o.useCallback(async i=>{try{const d=await p({Role:i}).unwrap(),y=d==null?void 0:d.itemList.map((n,R)=>({id:n.requestID,requestRowNum:R+1,requestNO:n.requestNO||"-",requestTypeID:n.requestTypeID,personID:n.personID,requestTypeNameFa:n.requestTypeNameFa,personName:n.personFirstName+" "+n.personLastName||"-",date:n.requestDate,body:n.requestText}));s(y)}catch(d){console.log(d)}},[p]);o.useEffect(()=>{t?u(t==null?void 0:t.value):s([])},[t,u]);const h=M({isLoading:l,isFetching:c,handleRefresh:()=>{t&&u(t==null?void 0:t.value)}}),m=H({role:t});return e.jsx(L,{columns:m,data:a,topBarActions:h,scroll:!1,isLoading:l,isFetching:c})};function Z(){return e.jsxs("section",{className:"flex-col",children:[e.jsx(k,{title:S,back:!1}),e.jsx(Q,{})]})}export{Z as Cartable};
