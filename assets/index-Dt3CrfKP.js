import{c as I,j as e,R as D,a as C,T as f,L as j,I as x,O as b,r as o,u as T,b as A,s as m,B as E,C as F,d as N,G as v,e as z}from"./index-DQyzDCLR.js";import{u as L,a as S}from"./requestApi-6QKBOa2y.js";import{c as B}from"./dateConverter-DQ6TS0e_.js";import{E as O}from"./VisibilityOutlined-BGjXDbT2.js";import{c as $,S as K}from"./SelectInput-CUIAdSfY.js";import{R as V}from"./Refresh-XGF5Rwvg.js";import{T as k}from"./Title-DlqA6fKB.js";import"./numberConverter-BZ7BcCwm.js";import"./react-select-animated.esm-BBTJRA6k.js";const G=I(e.jsx("path",{d:"M14.17 5 19 9.83V19H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9.83c0-.53-.21-1.04-.59-1.41l-4.83-4.83c-.37-.38-.88-.59-1.41-.59M7 15h10v2H7zm0-4h10v2H7zm0-4h7v2H7z"}),"TextSnippetOutlined"),H=({role:a})=>[{accessorKey:"requestRowNum",header:D,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"requestNO",header:"شماره درخواست",size:20},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"درخواست کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:B(s)})},{accessorKey:"senderInfo",header:C,enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(f,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s.original.requestTypeNameFa})," ",e.jsx("br",{}),e.jsx("span",{children:s.original.personName})]}),children:e.jsx(j,{to:s.original.requestTypeID==="62A54585-F331-434A-9027-C9F3060F683A"?`/retirement/group-slips?requestID=${s.original.id}`:s.original.requestTypeID==="EC1E7E50-9815-442F-9CCB-27F47AB05199"?`/retirement/group-slips?requestID=${s.original.id}&personID=${s.original.personID}`:s.original.requestTypeID==="6E7BA26E-A1DC-4A5E-9700-17820A36158D"?`/retirement/batch-statements?requestID=${s.original.id}`:`/retirement/retired?personID=${s.original.personID}&Role=${a==null?void 0:a.value}&requestID=${s.original.id}`,children:e.jsx("span",{children:e.jsx(x,{color:"success",sx:{padding:"0"},children:e.jsx(G,{color:"success"})})})})})},{accessorKey:"observe",header:b,enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(f,{title:s.original.requestNO,children:e.jsx(j,{to:`/retirement/request?requestID=${s.id}&Role=${a==null?void 0:a.value}&type=${s.original.requestTypeID}`,children:e.jsx("span",{children:e.jsx(x,{sx:{padding:"0"},color:"info",children:e.jsx(O,{color:"info"})})})})})}],P=()=>{const[a,s]=o.useState([]),t=T(),{control:d,setValue:l}=A({}),[c,{isLoading:u,isFetching:q}]=L(),h=o.useCallback(async()=>{const r=await c().unwrap(),i=$(r==null?void 0:r.itemList,"url","itemName");s(i),t(m(i[0])),l("role",i[0])},[t,c,l]);o.useEffect(()=>{h()},[h]),o.useEffect(()=>()=>{t(m(null))},[t]);const g=r=>{t(r?m(r):m(null))};return e.jsx("div",{style:{width:"300px",height:"40px",margin:"10px auto"},children:e.jsx(K,{control:d,options:a,isLoading:u||q,onValueChange:g,name:"role",label:"نقش",required:!1})})},M=({isLoading:a,isFetching:s,handleRefresh:t})=>e.jsxs(E,{sx:{display:"flex",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[a||s?e.jsx(x,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(F,{size:20,value:100})}):e.jsx(f,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(x,{"aria-label":"refresh",color:"info",onClick:t,children:e.jsx(V,{fontSize:"small"})})})}),e.jsx(P,{})]}),Q=()=>{const[a,s]=o.useState([]),{role:t}=N(i=>i.role),[d,{isLoading:l,isFetching:c}]=S(),u=o.useCallback(async i=>{try{const p=await d({Role:i}).unwrap(),y=p==null?void 0:p.itemList.map((n,R)=>({id:n.requestID,requestRowNum:R+1,requestNO:n.requestNO||"-",requestTypeID:n.requestTypeID,personID:n.personID,requestTypeNameFa:n.requestTypeNameFa,personName:n.personFirstName+" "+n.personLastName||"-",date:n.requestDate,body:n.requestText}));s(y)}catch(p){console.log(p)}},[d]);o.useEffect(()=>{t?u(t==null?void 0:t.value):s([])},[t,u]);const h=M({isLoading:l,isFetching:c,handleRefresh:()=>{t&&u(t==null?void 0:t.value)}}),g=H({role:t});return e.jsx(v,{columns:g,data:a,topBarActions:h,scroll:!1,isLoading:l,isFetching:c})};function se(){return e.jsxs("section",{className:"flex-col",children:[e.jsx(k,{title:z,back:!1}),e.jsx(Q,{})]})}export{se as Cartable};
