import{c as I,j as e,T as g,L as j,I as x,r as o,u as D,s as h,B as C,C as b,a as T}from"./index-DXLU_PyE.js";import{u as A,a as E}from"./requestApi-CRha_uBp.js";import{G as F}from"./Grid-D4u5Jkje.js";import{c as N}from"./dateConverter-CxDHzNZk.js";import{R as v,a as z,O as L,C as S}from"./const-XmctE7J8.js";import{E as B}from"./VisibilityOutlined-DFmMH2Oe.js";import{u as O}from"./index.esm-BbqTopL3.js";import{c as $,S as K}from"./SelectInput-C8DT0J5s.js";import{R as V}from"./Refresh-CMDgE-rc.js";import{T as k}from"./Title-CbSrYmGb.js";import"./index.esm-C4cCMZs-.js";import"./index-BEKQ4JXP.js";import"./numberConverter-DcI1FAjY.js";import"./react-select-animated.esm-DpIcM5qF.js";import"./messages-C1aWCoMO.js";const G=I(e.jsx("path",{d:"M14.17 5 19 9.83V19H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9.83c0-.53-.21-1.04-.59-1.41l-4.83-4.83c-.37-.38-.88-.59-1.41-.59M7 15h10v2H7zm0-4h10v2H7zm0-4h7v2H7z"}),"TextSnippetOutlined"),H=({role:a})=>[{accessorKey:"requestRowNum",header:v,size:20,enableSorting:!1,enableColumnActions:!1},{accessorKey:"requestNO",header:"شماره درخواست",size:20},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"درخواست کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:N(s)})},{accessorKey:"senderInfo",header:z,enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(g,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s.original.requestTypeNameFa})," ",e.jsx("br",{}),e.jsx("span",{children:s.original.personName})]}),children:e.jsx(j,{to:s.original.requestTypeID==="62A54585-F331-434A-9027-C9F3060F683A"?`/retirement/group-slips?requestID=${s.original.id}`:s.original.requestTypeID==="EC1E7E50-9815-442F-9CCB-27F47AB05199"?`/retirement/group-slips?requestID=${s.original.id}&personID=${s.original.personID}`:s.original.requestTypeID==="6E7BA26E-A1DC-4A5E-9700-17820A36158D"?`/retirement/batch-statements?requestID=${s.original.id}`:`/retirement/retired?personID=${s.original.personID}&Role=${a==null?void 0:a.value}&requestID=${s.original.id}`,children:e.jsx("span",{children:e.jsx(x,{color:"success",sx:{padding:"0"},children:e.jsx(G,{color:"success"})})})})})},{accessorKey:"observe",header:L,enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(g,{title:s.original.requestNO,children:e.jsx(j,{to:`/retirement/request?requestID=${s.id}&Role=${a==null?void 0:a.value}&type=${s.original.requestTypeID}`,children:e.jsx("span",{children:e.jsx(x,{sx:{padding:"0"},color:"info",children:e.jsx(B,{color:"info"})})})})})}],P=()=>{const[a,s]=o.useState([]),t=D(),{control:d,setValue:l}=O({}),[c,{isLoading:u,isFetching:q}]=A(),m=o.useCallback(async()=>{const n=await c().unwrap(),i=$(n==null?void 0:n.itemList,"url","itemName");s(i),t(h(i[0])),l("role",i[0])},[t,c,l]);o.useEffect(()=>{m()},[m]),o.useEffect(()=>()=>{t(h(null))},[t]);const f=n=>{t(n?h(n):h(null))};return e.jsx("div",{style:{width:"300px",height:"40px",margin:"10px auto"},children:e.jsx(K,{control:d,options:a,isLoading:u||q,onValueChange:f,name:"role",label:"نقش",required:!1})})},M=({isLoading:a,isFetching:s,handleRefresh:t})=>e.jsxs(C,{sx:{display:"flex",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[a||s?e.jsx(x,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(b,{size:20,value:100})}):e.jsx(g,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(x,{"aria-label":"refresh",color:"info",onClick:t,children:e.jsx(V,{fontSize:"small"})})})}),e.jsx(P,{})]}),Q=()=>{const[a,s]=o.useState([]),{role:t}=T(i=>i.role),[d,{isLoading:l,isFetching:c}]=E(),u=o.useCallback(async i=>{try{const p=await d({Role:i}).unwrap(),y=p==null?void 0:p.itemList.map((r,R)=>({id:r.requestID,requestRowNum:R+1,requestNO:r.requestNO||"-",requestTypeID:r.requestTypeID,personID:r.personID,requestTypeNameFa:r.requestTypeNameFa,personName:r.personFirstName+" "+r.personLastName||"-",date:r.requestDate,body:r.requestText}));s(y)}catch(p){console.log(p)}},[d]);o.useEffect(()=>{t?u(t==null?void 0:t.value):s([])},[t,u]);const m=M({isLoading:l,isFetching:c,handleRefresh:()=>{t&&u(t==null?void 0:t.value)}}),f=H({role:t});return e.jsx(F,{columns:f,data:a,topBarActions:m,scroll:!1,isLoading:l,isFetching:c})};function oe(){return e.jsxs("section",{className:"flex-col",children:[e.jsx(k,{title:S,back:!1}),e.jsx(Q,{})]})}export{oe as Cartable};
