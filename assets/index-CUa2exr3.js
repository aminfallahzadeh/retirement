import{c as N,j as e,r as d,u as S,M as P,P as z,a as g,C as A,b as L,L as B,F as E,d as k,e as $,T as y,f as C,I as m,E as H,g as M,h as q,i as K,s as x,B as O,k as V,R as G,l as w,m as Q,n as _,S as W}from"./index-X3WDRIPv.js";import{S as Y}from"./SelectInput-B-rlQ6Ey.js";const J=N(e.jsx("path",{d:"M14.17 5 19 9.83V19H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9.83c0-.53-.21-1.04-.59-1.41l-4.83-4.83c-.37-.38-.88-.59-1.41-.59M7 15h10v2H7zm0-4h10v2H7zm0-4h7v2H7z"}),"TextSnippetOutlined"),U=({columns:a,data:s,topBarActions:i,bottomBarActions:o,scroll:r,props:n})=>{const[p,c]=d.useState({}),f=S({columns:a,data:s,renderTopToolbarCustomActions:()=>i,renderBottomToolbarCustomActions:()=>o,muiTopToolbarProps:i?{sx:{overflow:"none"}}:void 0,muiTableHeadProps:i?{sx:{zIndex:0}}:void 0,muiTableBodyRowProps:({row:l})=>({onClick:()=>c(()=>({[l.id]:!0})),selected:p[l.id],sx:{cursor:"pointer"}}),localization:P,paginationDisplayMode:"pages",enableFullScreenToggle:!1,positionToolbarAlertBanner:"none",enableStickyHeader:!0,enableStickyFooter:!0,enableDensityToggle:!1,enableFilterMatchHighlighting:!1,muiTableBodyCellProps:{align:"center",sx:{fontFamily:"IranYekan",borderRight:"1px solid #cfcfcf"}},muiTableHeadCellProps:{align:"center",sx:{borderRight:"1px solid #cfcfcf",fontFamily:"Vazir",fontWeight:"600"}},initialState:{density:"compact"},enablePagination:!r,enableBottomToolbar:!r,muiTableContainerProps:r?{sx:{height:"300px"}}:void 0,muiPaginationProps:r?void 0:{size:"small",shape:"rounded",showRowsPerPage:!1,renderItem:l=>e.jsx(z,{...l,page:g(l.page),slots:{previous:A,next:L,first:B,last:E}})},getRowId:l=>l.id,onRowSelectionChange:c,state:{rowSelection:p},...n});return e.jsx(k,{table:f})},X=({role:a})=>[{accessorKey:"requestRowNum",header:"ردیف",size:20,enableSorting:!1,enableColumnActions:!1,Cell:({renderedCellValue:s})=>e.jsx("div",{children:g(s)})},{accessorKey:"requestNO",header:"شماره درخواست",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:g(s)})},{accessorKey:"requestTypeNameFa",header:"نوع درخواست",size:20},{accessorKey:"personName",header:"درخواست کننده",size:20},{accessorKey:"date",header:"تاریخ درخواست",size:20,Cell:({renderedCellValue:s})=>e.jsx("div",{children:$(s)})},{accessorKey:"senderInfo",header:"بررسی درخواست",enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(y,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s.original.requestTypeNameFa})," ",e.jsx("br",{}),e.jsx("span",{children:s.original.personName})]}),children:e.jsx(C,{to:s.original.requestTypeID==="62A54585-F331-434A-9027-C9F3060F683A"?`/retirement/group-slips?requestID=${s.original.id}`:s.original.requestTypeID==="EC1E7E50-9815-442F-9CCB-27F47AB05199"?`/retirement/group-slips?requestID=${s.original.id}&personID=${s.original.personID}`:s.original.requestTypeID==="6E7BA26E-A1DC-4A5E-9700-17820A36158D"?`/retirement/batch-statements?requestID=${s.original.id}`:`/retirement/retired?personID=${s.original.personID}&Role=${a==null?void 0:a.value}&requestID=${s.original.id}`,children:e.jsx("span",{children:e.jsx(m,{color:"success",sx:{padding:"0"},children:e.jsx(J,{color:"success"})})})})})},{accessorKey:"observe",header:"مشاهده درخواست",enableSorting:!1,enableColumnActions:!1,muiTableBodyCellProps:{align:"center"},size:20,Cell:({row:s})=>e.jsx(y,{title:g(s.original.requestNO),children:e.jsx(C,{to:`/retirement/request?requestID=${s.id}&Role=${a==null?void 0:a.value}&type=${s.original.requestTypeID}`,children:e.jsx("span",{children:e.jsx(m,{sx:{padding:"0"},color:"info",children:e.jsx(H,{color:"info"})})})})})}],Z=(a,s,i)=>a.map(o=>({value:o[s],label:o[i]})),ee=({isLoading:a,roles:s})=>{const i=M(),{role:o}=q(c=>c.role),{control:r}=K(),n=Z(s,"url","itemName"),p=c=>{i(c?x(c):x(null))};return e.jsx("div",{style:{width:"300px",height:"40px",margin:"10px auto"},children:e.jsx(Y,{control:r,options:n,defaultValue:o||void 0,isLoading:a,onValueChange:p,name:"role",label:"نقش",required:!1})})},se=({isLoading:a,isFetching:s,roles:i,handleRefresh:o})=>e.jsxs(O,{sx:{display:"flex",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[a||s?e.jsx(m,{"aria-label":"refresh",color:"info",disabled:!0,children:e.jsx(V,{size:20,value:100})}):e.jsx(y,{title:"بروز رسانی",children:e.jsx("span",{children:e.jsx(m,{"aria-label":"refresh",color:"info",onClick:o,children:e.jsx(G,{fontSize:"small"})})})}),e.jsx(ee,{isLoading:a,roles:i})]}),ae=()=>{const[a,s]=d.useState([]),[i,o]=d.useState([]),r=w(),{role:n}=q(t=>t.role),[p,{isLoading:c,isFetching:f}]=Q(),[l,{isLoading:j,isFetching:R}]=_(),T=d.useCallback(async()=>{try{const t=await p().unwrap();r(x({value:t==null?void 0:t.itemList[0].url,label:t==null?void 0:t.itemList[0].itemName})),o(t==null?void 0:t.itemList)}catch(t){console.log(t)}},[r,p]),b=d.useCallback(async t=>{try{const h=await l({Role:t}).unwrap(),D=h==null?void 0:h.itemList.map((u,F)=>({id:u.requestID,requestRowNum:F+1,requestNO:u.requestNO||"-",requestTypeID:u.requestTypeID,personID:u.personID,requestTypeNameFa:u.requestTypeNameFa,personName:u.personFirstName+" "+u.personLastName||"-",date:u.requestDate,body:u.requestText}));s(D)}catch(h){console.log(h)}},[l]);d.useEffect(()=>{T()},[T]),d.useEffect(()=>()=>{r(x(null))},[r]),d.useEffect(()=>{n&&b(n==null?void 0:n.value)},[n,b]);const I=se({isLoading:j,isFetching:R,roles:i,handleRefresh:()=>{n&&b(n==null?void 0:n.value)}}),v=X({role:n});return e.jsx(e.Fragment,{children:j||R||f||c?e.jsx("div",{className:"skeleton-lg",children:e.jsx(W,{count:5,baseColor:"#dfdfdf",highlightColor:"#9f9f9f",duration:1,direction:"rtl"})}):e.jsx(U,{columns:v,data:a,topBarActions:I,scroll:!1})})};function re(){return e.jsxs("section",{className:"flex-col",children:[e.jsx("div",{className:"title-primary--container flex-row flex-center",children:e.jsxs("h4",{className:"title-primary",children:[e.jsx("span",{className:"title-primary--underline"}),"کارتابل"]})}),e.jsx(ae,{})]})}export{re as Cartable};
